<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NutriValor - Value your Nutrition</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=Poppins:wght@600;700&display=swap" rel="stylesheet">
    <link rel="icon" type="image/x-icon" href="./src/assets/favico.ico">
</head>
<body>
    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loading-spinner"></div>
                    <p>Loading NutriValor...</p>
    </div>

    <!-- Authentication Section -->
    <div id="auth-section" class="auth-section" style="display: none;">
        <div class="auth-container">
                            <img src="./src/assets/nutrivalor_logo.png" alt="NutriValor" class="auth-logo">
                <h1>Welcome to NutriValor</h1>
                            <p>Value your Nutrition</p>
            
            <div class="auth-tabs">
                <button class="auth-tab active" data-auth-tab="login">Login</button>
                <button class="auth-tab" data-auth-tab="signup">Sign Up</button>
            </div>

            <!-- Login Form -->
            <div id="loginForm" class="auth-form">
                <form>
                    <input type="email" name="email" placeholder="Email" required autocomplete="username">
                    <input type="password" name="password" placeholder="Password" required autocomplete="current-password">
                    <button type="submit" class="auth-btn">Login</button>
                </form>
                <p class="auth-link">
                    <a href="#" data-forgot-password>Forgot Password?</a>
                </p>
            </div>

            <!-- Sign Up Form -->
            <div id="signupForm" class="auth-form" style="display: none;">
                <form>
                    <input type="text" name="name" placeholder="Full Name" required autocomplete="name">
                    <input type="email" name="email" placeholder="Email" required autocomplete="username">
                    <input type="password" name="password" placeholder="Password" required autocomplete="new-password">
                    <button type="submit" class="auth-btn">Sign Up</button>
                </form>
            </div>

            <!-- Forgot Password Form -->
            <div id="forgotForm" class="auth-form" style="display: none;">
                <form>
                    <input type="email" name="email" placeholder="Email" required autocomplete="username">
                    <button type="submit" class="auth-btn">Reset Password</button>
                </form>
                <p class="auth-link">
                    <a href="#" data-auth-tab="login">Back to Login</a>
                </p>
            </div>
        </div>
    </div>
    
    <!-- Email Verification Modal -->
    <div id="verificationModal" class="modal" style="display: none;">
        <div class="modal-content verification-modal">
            <div class="modal-header">
                <h3>‚úÖ You're Almost There!</h3>
            </div>
            <div class="modal-body">
                <p>Just one more step to get started with Nutrivalor!</p>
                <p>We've sent a confirmation link to <span id="verificationEmail"></span> ‚Äî click it to verify your account and unlock full access.</p>
                <div class="verification-actions">
                    <button id="verificationGotIt" class="primary-btn">Got it!</button>
                    <button id="verificationGoBack" class="secondary-btn">Send me back</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Application -->
    <div id="app-section" class="main-app" style="display: none;">
        <!-- Header -->
        <header class="app-header">
            <div class="header-content">
                <img src="./src/assets/nutrivalor_logo.png" alt="NutriValor" class="header-logo">
                <div class="header-actions">
                    <div class="user-profile">
                        <div class="header-avatar">
                            <img id="headerAvatar" src="" alt="User Avatar" style="display: none;">
                            <div id="headerAvatarPlaceholder" class="header-avatar-placeholder">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                                </svg>
                            </div>
                        </div>
                        <span id="userEmail" class="user-info"></span>
                    </div>
                    <button id="logoutBtn" class="logout-btn">Logout</button>
                </div>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="nav-menu">
            <div class="nav-tabs">
                <button class="nav-tab active" onclick="showSection('food-tracker')" data-section="food-tracker">
                    Food Tracker
                </button>
                <button class="nav-tab" onclick="showSection('meals')" data-section="meals">
                    Meals
                </button>
                <button class="nav-tab" onclick="showSection('shopping-list')" data-section="shopping-list">
                    Shopping List
                </button>

                <button class="nav-tab" onclick="showSection('weekly-meal-plan')" data-section="weekly-meal-plan">
                    Meal Plan
                </button>
                <button class="nav-tab" onclick="showSection('macro-calculator')" data-section="macro-calculator">
                    Macro Calculator
                </button>
                <button class="nav-tab" onclick="showSection('weight-tracker')" data-section="weight-tracker">
                    Weight Tracker
                </button>
                <button class="nav-tab" onclick="showSection('settings')" data-section="settings">
                    Settings
                </button>
                <button class="nav-tab" onclick="showSection('admin')" data-section="admin" id="adminTab" style="display: none;">
                    Admin
                </button>
            </div>
        </nav>

        <!-- Main Container -->
        <div class="container">
            <!-- Food Tracker Section -->
            <section id="food-tracker" class="content-section active">
                <div class="section-header">
                    <h2>Food Tracker</h2>
                    <div class="section-actions">
                        <button class="load-btn-color" disabled style="opacity:0.5;cursor:not-allowed;">Load Updated Food Data (Disabled)</button>
                        <button onclick="handleClearFoodTracker()" class="remove-btn-color">Clear List</button>
                    </div>
                </div>

                <!-- Last Update Info -->
                <div id="lastUpdateInfo" class="last-update-info" style="display: none;">
                    <span class="last-update-text">Last Update: <span id="lastUpdateDate"></span></span>
                </div>

                <!-- Category Filters -->
                <div class="category-filters">
                    <button class="filter-btn active" onclick="filterByCategory('all')">All</button>
                </div>

                <!-- Food Grid -->
                <div id="foodGrid" class="food-grid">
                    <p class="empty-state">Upload your food data to get started!</p>
                </div>
            </section>

            <!-- Meals Section -->
            <section id="meals" class="content-section">
                <div class="section-header">
                    <h2>Meals</h2>
                    <div class="section-actions">
                        <button class="load-btn-color" disabled style="opacity:0.5;cursor:not-allowed;">Load Updated Meal Data (Disabled)</button>
                        <button onclick="handleClearMeals()" class="remove-btn-color">Clear Meals</button>
                    </div>
                </div>

                <!-- Last Update Info -->
                <div id="lastMealUpdateInfo" class="last-update-info" style="display: none;">
                    <span class="last-update-text">Last Update: <span id="lastMealUpdateDate"></span></span>
                </div>

                <!-- Meal Filters -->
                <div class="meal-filters">
                    <button class="filter-btn active" onclick="filterMealsByCategory('all')" data-category="all">All</button>
                </div>

                <!-- Meal Grid -->
                <div id="mealGrid" class="meal-grid">
                    <p class="empty-state">Upload your meal data to see available meals!</p>
                </div>
            </section>

            <!-- Shopping List Section -->
            <section id="shopping-list" class="content-section">
                <div class="section-header">
                    <h2>Shopping List</h2>
                    <div class="section-actions">
                                            <button onclick="printShoppingList()" class="export-btn-color">Print List</button>
                    <button onclick="handleClearShoppingList()" class="remove-btn-color">Clear List</button>
                    </div>
                </div>

                <div id="shoppingItems" class="shopping-items">
                    <p class="empty-state">Your shopping list is empty. Add items from the Food Tracker!</p>
                </div>

                <div id="shoppingTotals" class="shopping-totals" style="display: none;"></div>
            </section>



            <!-- Meal Plan Section -->
            <section id="weekly-meal-plan" class="content-section">
                <div class="section-header">
                    <h2>Meal Plan</h2>
                    <div class="section-actions">
                        <button onclick="clearMealShoppingCheckboxes()" class="clear-data-btn-color">Clear</button>
                    </div>
                </div>

                <div class="weekly-plan-container">
                    <div id="weeklyMealPlan" class="weekly-plan-grid">
                        <!-- Days will be generated here -->
                    </div>
                </div>
            </section>

            <!-- Macro Calculator Section -->
            <section id="macro-calculator" class="content-section">
                <div class="section-header">
                    <h2>Calculate Your Daily Macro Targets</h2>
                </div>

                <div class="macro-calculator-grid">
                    <div class="calculator-inputs">
                        <div class="input-row">
                            <div class="input-group">
                                <label for="macro-age">Age:</label>
                                <input type="number" id="macro-age" placeholder="e.g., 30">
                            </div>
                            <div class="input-group">
                                <label for="macro-gender">Gender:</label>
                                <select id="macro-gender">
                                    <option value="male">Male</option>
                                    <option value="female">Female</option>
                                </select>
                            </div>
                            <div class="input-group">
                                <label for="macro-weight">Weight (kg):</label>
                                <input type="number" id="macro-weight" step="0.1" placeholder="e.g., 70">
                            </div>
                            <div class="input-group">
                                <label for="macro-height">Height (cm):</label>
                                <input type="number" id="macro-height" placeholder="e.g., 175">
                            </div>
                        </div>

                        <div class="input-row">
                            <div class="input-group">
                                <label for="macro-activity">Activity Level:</label>
                                <select id="macro-activity">
                                    <option value="1.2">Sedentary (little or no exercise)</option>
                                    <option value="1.375">Lightly active (light exercise 1-3 days/week)</option>
                                    <option value="1.55" selected>Moderately active (moderate exercise 3-5 days/week)</option>
                                    <option value="1.725">Very active (hard exercise 6-7 days/week)</option>
                                    <option value="1.9">Extra active (very hard exercise, physical job)</option>
                                </select>
                            </div>
                            <div class="input-group">
                                <label for="macro-lossRate">Weight Loss Rate:</label>
                                <select id="macro-lossRate">
                                    <option value="0">No weight loss (maintain)</option>
                                    <option value="-275">0.25 kg/week</option>
                                    <option value="-550">0.5 kg/week</option>
                                    <option value="-825">0.75 kg/week</option>
                                    <option value="-1100">1 kg/week</option>
                                </select>
                            </div>
                        </div>

                        <div class="input-row">
                            <div class="input-group">
                                <label for="macro-proteinRatio">Protein Ratio:</label>
                                <select id="macro-proteinRatio">
                                    <option value="2.0">2.0g per kg (High)</option>
                                    <option value="2.2" selected>2.2g per kg (Very High)</option>
                                    <option value="2.4">2.4g per kg (Max)</option>
                                </select>
                            </div>
                            <div class="input-group">
                                <label for="macro-fatRatio">Fat Ratio:</label>
                                <select id="macro-fatRatio">
                                    <option value="0.8" selected>0.8g per kg (Low)</option>
                                    <option value="1.0">1.0g per kg (Moderate)</option>
                                </select>
                            </div>
                        </div>

                        <div class="macro-actions">
                                                    <button onclick="calculateMacros()" class="calculate-btn-color">Calculate Macros</button>
                        <button onclick="saveMacroProfile()" class="save-btn-color">Save Profile</button>
                        </div>
                    </div>

                    <div class="macro-results-container">
                        <div id="macro-results" class="macro-results" style="display: none;">
                            <div class="result-card protein">
                                <h4>Daily Protein</h4>
                                <div class="macro-value" id="protein-value">0g</div>
                                <p class="macro-desc">Essential for muscle maintenance</p>
                            </div>
                            <div class="result-card carbs">
                                <h4>Daily Carbs</h4>
                                <div class="macro-value" id="carbs-value">0g</div>
                                <p class="macro-desc">Primary energy source</p>
                            </div>
                            <div class="result-card fat">
                                <h4>Daily Fat</h4>
                                <div class="macro-value" id="fat-value">0g</div>
                                <p class="macro-desc">Hormone production & satiety</p>
                            </div>
                            <div class="result-card calories">
                                <h4>Daily Calories</h4>
                                <div class="macro-value" id="calories-value">0</div>
                                <p class="macro-desc">Total daily energy needs</p>
                            </div>
                        </div>

                        <div id="macro-explanation" class="macro-explanation" style="display: none;">
                            <h4>Your Calculation Breakdown:</h4>
                            <div class="calculation-details">
                                <p><strong>BMR:</strong> <span id="bmr-value">0</span> calories</p>
                                <p><strong>TDEE:</strong> <span id="tdee-value">0</span> calories</p>
                                <p><strong>Adjusted for goal:</strong> <span id="adjusted-calories">0</span> calories</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Weight Tracker Section -->
            <section id="weight-tracker" class="content-section">
                <div class="section-header">
                    <h2>Weight Loss Tracker</h2>
                </div>

                <div class="weight-tracker-grid">
                    <div class="weight-input-section">
                        <div class="input-row">
                            <div class="input-group">
                                <label for="startingWeight">Starting Weight (kg):</label>
                                <input type="number" id="startingWeight" step="0.1" />
                            </div>
                            <div class="input-group">
                                <label for="idealWeight">Ideal Weight (kg):</label>
                                <input type="number" id="idealWeight" step="0.1" />
                            </div>
                            <div class="input-group">
                                <label for="targetDate">Target Date:</label>
                                <input type="date" id="targetDate" />
                            </div>
                        </div>

                        <div class="input-row entry-section">
                            <div class="input-group">
                                <label for="entryDate">Date:</label>
                                <input type="date" id="entryDate" />
                            </div>
                            <div class="input-group">
                                <label for="entryWeight">Weight (kg):</label>
                                <input type="number" id="entryWeight" step="0.1" placeholder="Today's Weight" />
                            </div>
                        </div>
                        
                        <div class="weight-actions">
                                                    <button onclick="addWeightEntry()" class="add-btn-color">Add Entry</button>
                        <button onclick="clearWeightData()" class="clear-data-btn-color">Clear All Data</button>
                        </div>

                        <div id="progressText" class="progress-text"></div>
                    </div>

                    <div class="chart-container">
                        <canvas id="weightChart"></canvas>
                    </div>
                </div>
            </section>

            <!-- Settings Section -->
            <section id="settings" class="content-section">
                <div class="section-header">
                    <h2>Settings</h2>
                </div>

                <div class="settings-grid">
                    <div class="setting-group profile-section">
                        <h3>Profile Information</h3>
                        
                        <!-- Avatar Section -->
                        <div class="avatar-section">
                            <div class="avatar-preview">
                                <img id="avatarPreview" src="" alt="Profile Avatar" style="display: none;">
                                <div id="avatarPlaceholder" class="avatar-placeholder">
                                    <span>üì∑</span>
                                </div>
                            </div>
                            <div class="avatar-controls">
                                <input type="file" id="avatarInput" accept="image/*" style="display: none;">
                                <button onclick="document.getElementById('avatarInput').click()" class="avatar-btn-color" id="chooseAvatarBtn">Choose Avatar</button>
                                <button onclick="document.getElementById('avatarInput').click()" class="avatar-btn-color" id="changeAvatarBtn" style="display: none;">Change Avatar</button>
                            </div>
                        </div>

                        <!-- Profile Fields -->
                        <div class="profile-form-grid">
                            <div class="input-group">
                                <label for="profileName">Full Name:</label>
                                <input type="text" id="profileName" placeholder="Enter your full name">
                            </div>
                            
                            <div class="input-group">
                                <label for="dateOfBirth">Date of Birth:</label>
                                <input type="date" id="dateOfBirth">
                            </div>
                            
                            <div class="input-group">
                                <label for="profileAge">Age:</label>
                                <input type="number" id="profileAge" placeholder="Auto-calculated" readonly>
                            </div>
                            
                            <div class="input-group">
                                <label for="profileGender">Gender:</label>
                                <select id="profileGender">
                                    <option value="">Select</option>
                                    <option value="male">Male</option>
                                    <option value="female">Female</option>
                                    <option value="other">Other</option>
                                </select>
                            </div>
                            
                            <div class="input-group">
                                <label for="profileHeight">Height:</label>
                                <div class="height-input-group">
                                    <input type="number" id="profileHeight" step="0.1" placeholder="Height">
                                    <select id="heightUnit">
                                        <option value="cm">cm</option>
                                        <option value="ft">ft</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="input-group">
                                <label for="profileIdealWeight">Ideal Weight:</label>
                                <div class="weight-input-group">
                                    <input type="number" id="profileIdealWeight" step="0.1" placeholder="Weight">
                                    <select id="weightUnit">
                                        <option value="kg">kg</option>
                                        <option value="lbs">lbs</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="input-group">
                            <label for="profileCountry">Country:</label>
                            <select id="profileCountry">
                                <option value="">Select your country</option>
                                <option value="US">United States</option>
                                <option value="CA">Canada</option>
                                <option value="GB">United Kingdom</option>
                                <option value="AU">Australia</option>
                                <option value="DE">Germany</option>
                                <option value="FR">France</option>
                                <option value="IT">Italy</option>
                                <option value="ES">Spain</option>
                                <option value="NL">Netherlands</option>
                                <option value="BE">Belgium</option>
                                <option value="CH">Switzerland</option>
                                <option value="AT">Austria</option>
                                <option value="SE">Sweden</option>
                                <option value="NO">Norway</option>
                                <option value="DK">Denmark</option>
                                <option value="FI">Finland</option>
                                <option value="IE">Ireland</option>
                                <option value="PT">Portugal</option>
                                <option value="PL">Poland</option>
                                <option value="CZ">Czech Republic</option>
                                <option value="HU">Hungary</option>
                                <option value="GR">Greece</option>
                                <option value="HR">Croatia</option>
                                <option value="SI">Slovenia</option>
                                <option value="SK">Slovakia</option>
                                <option value="BG">Bulgaria</option>
                                <option value="RO">Romania</option>
                                <option value="LT">Lithuania</option>
                                <option value="LV">Latvia</option>
                                <option value="EE">Estonia</option>
                                <option value="MT">Malta</option>
                                <option value="CY">Cyprus</option>
                                <option value="LU">Luxembourg</option>
                                <option value="JP">Japan</option>
                                <option value="KR">South Korea</option>
                                <option value="CN">China</option>
                                <option value="IN">India</option>
                                <option value="BR">Brazil</option>
                                <option value="MX">Mexico</option>
                                <option value="AR">Argentina</option>
                                <option value="CL">Chile</option>
                                <option value="CO">Colombia</option>
                                <option value="PE">Peru</option>
                                <option value="ZA">South Africa</option>
                                <option value="NG">Nigeria</option>
                                <option value="EG">Egypt</option>
                                <option value="MA">Morocco</option>
                                <option value="KE">Kenya</option>
                                <option value="GH">Ghana</option>
                                <option value="TZ">Tanzania</option>
                                <option value="UG">Uganda</option>
                                <option value="ET">Ethiopia</option>
                                <option value="ZW">Zimbabwe</option>
                                <option value="BW">Botswana</option>
                                <option value="NA">Namibia</option>
                                <option value="ZM">Zambia</option>
                                <option value="MW">Malawi</option>
                                <option value="MZ">Mozambique</option>
                                <option value="SZ">Eswatini</option>
                                <option value="LS">Lesotho</option>
                                <option value="OTHER">Other</option>
                            </select>
                        </div>

                        <div class="profile-actions">
                            <button onclick="updateProfile()" class="update-profile-btn-color">Update Profile</button>
                        </div>
                    </div>

                    <div class="setting-group">
                        <h3>Data Management</h3>
                        <div class="data-actions">
                            <button onclick="exportData()" class="export-btn-color">Export Data</button>
                            <button onclick="clearAllData()" class="clear-data-btn-color">Clear All Data</button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Admin Section -->
            <section id="admin" class="content-section">
                <div class="section-header">
                    <h2>Admin Panel</h2>
                    <div class="role-display">
                        <span id="currentUserRole" class="role-badge">Loading...</span>
                    </div>
                </div>

                <!-- User Management Section -->
                <div class="admin-content">
                    <div class="admin-card">
                        <h3>User Management</h3>
                        <p class="admin-description">Grant or revoke admin privileges for users (Super Admin only)</p>
                        
                        <div class="user-management-container">
                            <div class="user-list-header">
                                <h4>All Users</h4>
                                <button onclick="refreshUserList()" class="refresh-btn">Refresh</button>
                            </div>
                            
                            <div id="userListContainer" class="user-list">
                                <div class="loading-users">Loading users...</div>
                            </div>
                        </div>
                    </div>

                    <!-- Food Management Card -->
                    <div class="admin-card">
                        <h3>Food Database Management</h3>
                        <p class="admin-description">Add new food items and edit existing foods in the database</p>
                        
                        <div class="two-column-layout">
                            <!-- Add Food Section -->
                            <div class="column-section">
                                <h4>Add New Food</h4>
                                <p>Add a new food to your list.</p>
                                <form id="addFoodForm" class="add-food-form">
                                    <div class="food-form-grid">
                                        <div class="input-group">
                                            <label for="foodName">Food Name *</label>
                                            <input type="text" id="foodName" name="foodName" required placeholder="e.g., Almond Milk - Unsweetened">
                                            <div id="duplicateWarning" class="duplicate-warning" style="display: none;">
                                                ‚ö†Ô∏è This food item already exists in the database
                                            </div>
                                        </div>
                                        
                                        <div class="input-group">
                                            <label for="foodBrand">Brand (Optional)</label>
                                            <input type="text" id="foodBrand" name="foodBrand" placeholder="e.g., Silk, Organic Valley">
                                        </div>
                                        
                                        <div class="input-group">
                                            <label for="foodCategory">Category</label>
                                            <select id="foodCategory" name="foodCategory" required>
                                                <option value="">Select Category</option>
                                                <option value="VEGETABLES">Vegetables</option>
                                                <option value="SALAD">Salad</option>
                                                <option value="DAIRY">Dairy</option>
                                                <option value="PROTEIN">Protein</option>
                                                <option value="CONDIMENTS">Condiments</option>
                                                <option value="DRINKS">Drinks</option>
                                                <option value="OTHER">Other</option>
                                            </select>
                                        </div>
                                        
                                        <div class="input-group">
                                            <label for="foodCarbs">Carbs (g)</label>
                                            <input type="number" id="foodCarbs" name="foodCarbs" step="0.1" min="0" placeholder="0" value="0">
                                        </div>
                                        
                                        <div class="input-group">
                                            <label for="foodFat">Fat (g)</label>
                                            <input type="number" id="foodFat" name="foodFat" step="0.1" min="0" placeholder="0" value="0">
                                        </div>
                                        
                                        <div class="input-group">
                                            <label for="foodProtein">Protein (g)</label>
                                            <input type="number" id="foodProtein" name="foodProtein" step="0.1" min="0" placeholder="0" value="0">
                                        </div>
                                    </div>
                                    
                                    <div class="form-actions">
                                        <button type="submit" class="save-btn-color">Add Food Item</button>
                                        <button type="reset" class="cancel-btn">Clear Form</button>
                                    </div>
                                </form>
                            </div>

                            <!-- Edit Food Section -->
                            <div class="column-section">
                                <h4>Edit Food</h4>
                                <p>Edit a food you've already added.</p>
                                <div class="form-card">
                                    <button onclick="openEditFoodModal()" class="primary-btn">Edit Food</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Meal Management Card -->
                    <div class="admin-card">
                        <h3>Meal Database Management</h3>
                        <p class="admin-description">Create new meals/recipes using ingredients from the food database</p>
                        <div class="two-column-layout">
                            <!-- Add Meal Section -->
                            <div class="column-section">
                                <h4>Add New Meal</h4>
                                <p>Add a new meal to your list.</p>
                                <form id="addMealForm" class="add-food-form">
                                    <div class="food-form-grid meal-form-grid">
                                        <div class="form-fields-col">
                                            <div class="input-group">
                                                <label for="mealName">Meal Name *</label>
                                                <input type="text" id="mealName" name="mealName" required placeholder="e.g., Bacon and Eggs Breakfast">
                                            </div>
                                            <div class="input-group">
                                                <label for="mealType">Meal Type *</label>
                                                <select id="mealType" name="mealType" class="form-input" required>
                                                    <option value="">Select Type</option>
                                                    <option value="BREAKFAST">Breakfast</option>
                                                    <option value="LUNCH">Lunch</option>
                                                    <option value="DINNER">Dinner</option>
                                                    <option value="SNACK">Snack</option>
                                                    <option value="DESSERT">Dessert</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="form-image-col">
                                            <label for="mealPicture">Picture (Optional)</label>
                                            <div class="meal-picture-upload compact">
                                                <input type="file" id="mealPictureFile" accept="image/*" style="display: none;">
                                                <input type="hidden" id="mealPicture" name="mealPicture">
                                                <div class="picture-preview-container compact">
                                                    <img id="mealPicturePreview" class="meal-picture-preview compact" style="display: none;" alt="Meal preview">
                                                    <div id="mealPicturePlaceholder" class="meal-picture-placeholder compact">
                                                        <span>üì∑ No image selected</span>
                                                    </div>
                                                </div>
                                                <div class="picture-upload-buttons compact">
                                                    <button type="button" onclick="document.getElementById('mealPictureFile').click()" class="upload-picture-btn">Choose Image</button>
                                                    <button type="button" onclick="removeMealPicture()" id="removeMealPictureBtn" class="remove-picture-btn" style="display: none;">Remove</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="cooking-instructions-section">
                                        <h4>Cooking Instructions</h4>
                                        <div class="input-group">
                                            <label for="cookingInstructions">Instructions (Optional)</label>
                                            <div class="rich-text-toolbar">
                                                <button type="button" onclick="formatText('bold')" class="format-btn" title="Bold"><strong>B</strong></button>
                                                <button type="button" onclick="formatText('italic')" class="format-btn" title="Italic"><em>I</em></button>
                                                <button type="button" onclick="formatText('underline')" class="format-btn" title="Underline"><u>U</u></button>
                                            </div>
                                            <div id="cookingInstructions" contenteditable="true" class="rich-text-editor" placeholder="Enter cooking instructions here... (You can use the buttons above for formatting)"></div>
                                            <input type="hidden" id="cookingInstructionsHidden" name="cookingInstructions">
                                        </div>
                                    </div>
                                    <div class="ingredients-section">
                                        <h4>Ingredients</h4>
                                        <div id="ingredientsList" class="ingredient-list">
                                            <!-- Ingredient items will be rendered here -->
                                        </div>
                                        <button type="button" class="add-ingredient-btn" onclick="window.openIngredientModal('add_to_meal')">+ Add Food to Meal</button>
                                    </div>
                                    <div class="form-actions">
                                        <button type="submit" class="save-btn-color">Create Meal</button>
                                        <button type="reset" class="cancel-btn">Clear Form</button>
                                    </div>
                                </form>
                            </div>
                            <!-- Edit Meal Section -->
                            <div class="column-section">
                                <h4>Edit Meal</h4>
                                <p>Edit a meal you've already added.</p>
                                <div class="form-card">
                                    <button onclick="openEditMealModal()" class="primary-btn">Edit Meal</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Future Features Card -->
                    <div class="admin-card future-features">
                        <h3>Coming Soon</h3>
                        <p class="admin-description">Additional admin features will be added here:</p>
                        <ul class="feature-list">
                            <li>System Analytics</li>
                            <li>User Activity Logs</li>
                            <li>Food Database Analytics</li>
                            <li>Meal Analytics</li>
                        </ul>
                    </div>
                </div>


            </section>
        </div>
    </div>

    <!-- Upload Modal -->
    <div id="uploadModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Upload Food Data</h3>
                <button onclick="closeUploadModal()" class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="upload-area">
                    <input type="file" id="foodFileInput" accept=".xlsx,.xls" style="display: none;">
                    <button onclick="document.getElementById('foodFileInput').click()" class="upload-btn">
                        Choose Excel File
                    </button>
                    <p class="upload-hint">Upload your food database Excel file</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Meal Upload Modal -->
    <div id="mealUploadModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Upload Meal Data</h3>
                <button onclick="closeMealUploadModal()" class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="upload-area">
                    <input type="file" id="mealFileInput" accept=".xlsx,.xls" style="display: none;">
                    <button onclick="document.getElementById('mealFileInput').click()" class="upload-btn">
                        Choose Excel File
                    </button>
                    <p class="upload-hint">Upload your meal database Excel file</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Message Toast -->
    <div id="messageToast" class="message-toast" style="display: none;"></div>

    <!-- Footer -->
    <footer class="app-footer">
        <p>Copyright ¬© 2025 NutriValor. All rights reserved</p>
    </footer>

    <!-- Vite TypeScript Entry Point -->
    <script type="module" src="/src/main.ts"></script>

    <!-- SIMPLE EDIT FOOD MODAL -->
    <div id="editFoodModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Edit Food</h3>
                <button class="close-btn" onclick="closeEditFoodModal()">&times;</button>
            </div>
            <div class="modal-body">
                <!-- Food Selection -->
                <div class="form-group">
                    <label for="editFoodSelect">Select Food to Edit:</label>
                    <select id="editFoodSelect" onchange="loadFoodForEdit(this.value)">
                        <option value="">Choose a food...</option>
                    </select>
                </div>

                <!-- Food Edit Form -->
                <form id="editFoodForm" onsubmit="saveEditedFood(event)" style="display: none;">
                    <input type="hidden" id="editFoodId">
                    
                    <div class="form-group">
                        <label for="editFoodName">Food Name*</label>
                        <input type="text" id="editFoodName" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="editFoodBrand">Brand</label>
                        <input type="text" id="editFoodBrand">
                    </div>
                    
                    <div class="form-group">
                        <label for="editFoodCategory">Category*</label>
                        <select id="editFoodCategory" required>
                            <option value="">Select Category</option>
                            <option value="VEGETABLES">Vegetables</option>
                            <option value="SALAD">Salad</option>
                            <option value="DAIRY">Dairy</option>
                            <option value="PROTEIN">Protein</option>
                            <option value="CONDIMENTS">Condiments</option>
                            <option value="DRINKS">Drinks</option>
                            <option value="OTHER">Other</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="editFoodCarbs">Carbs (g)*</label>
                        <input type="number" id="editFoodCarbs" min="0" step="0.1" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="editFoodFat">Fat (g)*</label>
                        <input type="number" id="editFoodFat" min="0" step="0.1" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="editFoodProtein">Protein (g)*</label>
                        <input type="number" id="editFoodProtein" min="0" step="0.1" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="editFoodInstructions">Cooking Instructions</label>
                        <textarea id="editFoodInstructions" rows="8" style="min-height: 200px;"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="editFoodImage">Food Image</label>
                        <div class="image-upload-section">
                            <div class="image-preview-container">
                                <img id="editFoodImagePreview" src="" alt="Food preview" style="display: none; max-width: 200px; max-height: 150px; border-radius: 8px;">
                                <div id="editFoodImagePlaceholder" class="image-placeholder">
                                    <span>No image uploaded</span>
                                </div>
                            </div>
                            <div class="image-upload-controls">
                                <input type="file" id="editFoodImage" accept="image/*" onchange="previewFoodImage(this)">
                                <button type="button" class="secondary-btn" onclick="removeFoodImage()">Remove Image</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-actions">
                        <button type="submit" class="primary-btn">Save Changes</button>
                        <button type="button" class="secondary-btn" onclick="closeEditFoodModal()">Cancel</button>
                        <button type="button" class="danger-btn" onclick="deleteEditedFood()">Delete Food</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- SIMPLE EDIT MEAL MODAL -->
    <div id="editMealModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Edit Meal</h3>
                <button class="close-btn" onclick="closeEditMealModal()">&times;</button>
            </div>
            <div class="modal-body">
                <!-- Meal Selection -->
                <div class="form-group">
                    <label for="editMealSelect">Select Meal to Edit:</label>
                    <select id="editMealSelect" onchange="loadMealForEdit(this.value)">
                        <option value="">Choose a meal...</option>
                    </select>
                </div>

                <!-- Meal Edit Form -->
                <form id="editMealForm" onsubmit="saveEditedMeal(event)" style="display: none;">
                    <input type="hidden" id="editMealId">
                    
                    <div class="form-group">
                        <label for="editMealName">Meal Name*</label>
                        <input type="text" id="editMealName" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="editMealType">Meal Type*</label>
                        <select id="editMealType" required>
                            <option value="">Select Type</option>
                            <option value="BREAKFAST">Breakfast</option>
                            <option value="LUNCH">Lunch</option>
                            <option value="DINNER">Dinner</option>
                            <option value="SNACK">Snack</option>
                            <option value="DESSERT">Dessert</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="editMealInstructions">Overall Cooking Instructions</label>
                        <textarea id="editMealInstructions" rows="8" style="min-height: 200px;"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="editMealImage">Meal Image</label>
                        <div class="image-upload-section">
                            <div class="image-preview-container">
                                <img id="editMealImagePreview" src="" alt="Meal preview" style="display: none; max-width: 200px; max-height: 150px; border-radius: 8px;">
                                <div id="editMealImagePlaceholder" class="image-placeholder">
                                    <span>No image uploaded</span>
                                </div>
                            </div>
                            <div class="image-upload-controls">
                                <input type="file" id="editMealImage" accept="image/*" onchange="previewMealImage(this)">
                                <button type="button" class="secondary-btn" onclick="removeMealImage()">Remove Image</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Ingredients Section -->
                    <div class="form-group">
                        <label>Ingredients</label>
                        <div id="editMealIngredients">
                            <!-- Ingredients will be added here -->
                        </div>
                        <button type="button" class="secondary-btn" onclick="addIngredientToMeal()">Add Ingredient</button>
                    </div>
                    
                    <div class="form-actions">
                        <button type="submit" class="primary-btn">Save Changes</button>
                        <button type="button" class="secondary-btn" onclick="closeEditMealModal()">Cancel</button>
                        <button type="button" class="danger-btn" onclick="deleteEditedMeal()">Delete Meal</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</body>
</html> 