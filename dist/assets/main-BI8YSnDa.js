(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function t(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(n){if(n.ep)return;n.ep=!0;const s=t(n);fetch(n.href,s)}})();const eu="modulepreload",tu=function(e){return"/"+e},fo={},Ue=function(r,t,a){let n=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),o=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));n=Promise.allSettled(t.map(c=>{if(c=tu(c),c in fo)return;fo[c]=!0;const l=c.endsWith(".css"),f=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${f}`))return;const u=document.createElement("link");if(u.rel=l?"stylesheet":eu,l||(u.as="script"),u.crossOrigin="",u.href=c,o&&u.setAttribute("nonce",o),document.head.appendChild(u),l)return new Promise((d,h)=>{u.addEventListener("load",d),u.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(i){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i}return n.then(i=>{for(const o of i||[])o.status==="rejected"&&s(o.reason);return r().catch(s)})},ru=e=>{let r;return e?r=e:typeof fetch>"u"?r=(...t)=>Ue(async()=>{const{default:a}=await Promise.resolve().then(()=>ba);return{default:a}},void 0).then(({default:a})=>a(...t)):r=fetch,(...t)=>r(...t)};class oi extends Error{constructor(r,t="FunctionsError",a){super(r),this.name=t,this.context=a}}class au extends oi{constructor(r){super("Failed to send a request to the Edge Function","FunctionsFetchError",r)}}class nu extends oi{constructor(r){super("Relay Error invoking the Edge Function","FunctionsRelayError",r)}}class su extends oi{constructor(r){super("Edge Function returned a non-2xx status code","FunctionsHttpError",r)}}var $s;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})($s||($s={}));var iu=function(e,r,t,a){function n(s){return s instanceof t?s:new t(function(i){i(s)})}return new(t||(t=Promise))(function(s,i){function o(f){try{l(a.next(f))}catch(u){i(u)}}function c(f){try{l(a.throw(f))}catch(u){i(u)}}function l(f){f.done?s(f.value):n(f.value).then(o,c)}l((a=a.apply(e,r||[])).next())})};class ou{constructor(r,{headers:t={},customFetch:a,region:n=$s.Any}={}){this.url=r,this.headers=t,this.region=n,this.fetch=ru(a)}setAuth(r){this.headers.Authorization=`Bearer ${r}`}invoke(r,t={}){var a;return iu(this,void 0,void 0,function*(){try{const{headers:n,method:s,body:i}=t;let o={},{region:c}=t;c||(c=this.region),c&&c!=="any"&&(o["x-region"]=c);let l;i&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&(typeof Blob<"u"&&i instanceof Blob||i instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",l=i):typeof i=="string"?(o["Content-Type"]="text/plain",l=i):typeof FormData<"u"&&i instanceof FormData?l=i:(o["Content-Type"]="application/json",l=JSON.stringify(i)));const f=yield this.fetch(`${this.url}/${r}`,{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),n),body:l}).catch(g=>{throw new au(g)}),u=f.headers.get("x-relay-error");if(u&&u==="true")throw new nu(f);if(!f.ok)throw new su(f);let d=((a=f.headers.get("Content-Type"))!==null&&a!==void 0?a:"text/plain").split(";")[0].trim(),h;return d==="application/json"?h=yield f.json():d==="application/octet-stream"?h=yield f.blob():d==="text/event-stream"?h=f:d==="multipart/form-data"?h=yield f.formData():h=yield f.text(),{data:h,error:null}}catch(n){return{data:null,error:n}}})}}var Gt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function cu(e){if(e.__esModule)return e;var r=e.default;if(typeof r=="function"){var t=function a(){return this instanceof a?Reflect.construct(r,arguments,this.constructor):r.apply(this,arguments)};t.prototype=r.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(e).forEach(function(a){var n=Object.getOwnPropertyDescriptor(e,a);Object.defineProperty(t,a,n.get?n:{enumerable:!0,get:function(){return e[a]}})}),t}var Ct={},ci={},as={},vn={},ns={},ss={},lu=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Ta=lu();const fu=Ta.fetch,Rc=Ta.fetch.bind(Ta),Lc=Ta.Headers,uu=Ta.Request,du=Ta.Response,ba=Object.freeze(Object.defineProperty({__proto__:null,Headers:Lc,Request:uu,Response:du,default:Rc,fetch:fu},Symbol.toStringTag,{value:"Module"})),hu=cu(ba);var is={};Object.defineProperty(is,"__esModule",{value:!0});let gu=class extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}};is.default=gu;var Bc=Gt&&Gt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ss,"__esModule",{value:!0});const pu=Bc(hu),mu=Bc(is);let xu=class{constructor(r){this.shouldThrowOnError=!1,this.method=r.method,this.url=r.url,this.headers=r.headers,this.schema=r.schema,this.body=r.body,this.shouldThrowOnError=r.shouldThrowOnError,this.signal=r.signal,this.isMaybeSingle=r.isMaybeSingle,r.fetch?this.fetch=r.fetch:typeof fetch>"u"?this.fetch=pu.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(r,t){return this.headers=Object.assign({},this.headers),this.headers[r]=t,this}then(r,t){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const a=this.fetch;let n=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{var i,o,c;let l=null,f=null,u=null,d=s.status,h=s.statusText;if(s.ok){if(this.method!=="HEAD"){const _=await s.text();_===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?f=_:f=JSON.parse(_))}const p=(i=this.headers.Prefer)===null||i===void 0?void 0:i.match(/count=(exact|planned|estimated)/),m=(o=s.headers.get("content-range"))===null||o===void 0?void 0:o.split("/");p&&m&&m.length>1&&(u=parseInt(m[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(f)&&(f.length>1?(l={code:"PGRST116",details:`Results contain ${f.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},f=null,u=null,d=406,h="Not Acceptable"):f.length===1?f=f[0]:f=null)}else{const p=await s.text();try{l=JSON.parse(p),Array.isArray(l)&&s.status===404&&(f=[],l=null,d=200,h="OK")}catch{s.status===404&&p===""?(d=204,h="No Content"):l={message:p}}if(l&&this.isMaybeSingle&&(!((c=l==null?void 0:l.details)===null||c===void 0)&&c.includes("0 rows"))&&(l=null,d=200,h="OK"),l&&this.shouldThrowOnError)throw new mu.default(l)}return{error:l,data:f,count:u,status:d,statusText:h}});return this.shouldThrowOnError||(n=n.catch(s=>{var i,o,c;return{error:{message:`${(i=s==null?void 0:s.name)!==null&&i!==void 0?i:"FetchError"}: ${s==null?void 0:s.message}`,details:`${(o=s==null?void 0:s.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(c=s==null?void 0:s.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),n.then(r,t)}returns(){return this}overrideTypes(){return this}};ss.default=xu;var vu=Gt&&Gt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ns,"__esModule",{value:!0});const wu=vu(ss);let yu=class extends wu.default{select(r){let t=!1;const a=(r??"*").split("").map(n=>/\s/.test(n)&&!t?"":(n==='"'&&(t=!t),n)).join("");return this.url.searchParams.set("select",a),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(r,{ascending:t=!0,nullsFirst:a,foreignTable:n,referencedTable:s=n}={}){const i=s?`${s}.order`:"order",o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${r}.${t?"asc":"desc"}${a===void 0?"":a?".nullsfirst":".nullslast"}`),this}limit(r,{foreignTable:t,referencedTable:a=t}={}){const n=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(n,`${r}`),this}range(r,t,{foreignTable:a,referencedTable:n=a}={}){const s=typeof n>"u"?"offset":`${n}.offset`,i=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(s,`${r}`),this.url.searchParams.set(i,`${t-r+1}`),this}abortSignal(r){return this.signal=r,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:r=!1,verbose:t=!1,settings:a=!1,buffers:n=!1,wal:s=!1,format:i="text"}={}){var o;const c=[r?"analyze":null,t?"verbose":null,a?"settings":null,n?"buffers":null,s?"wal":null].filter(Boolean).join("|"),l=(o=this.headers.Accept)!==null&&o!==void 0?o:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${i}; for="${l}"; options=${c};`,i==="json"?this:this}rollback(){var r;return((r=this.headers.Prefer)!==null&&r!==void 0?r:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};ns.default=yu;var _u=Gt&&Gt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(vn,"__esModule",{value:!0});const Eu=_u(ns);let ku=class extends Eu.default{eq(r,t){return this.url.searchParams.append(r,`eq.${t}`),this}neq(r,t){return this.url.searchParams.append(r,`neq.${t}`),this}gt(r,t){return this.url.searchParams.append(r,`gt.${t}`),this}gte(r,t){return this.url.searchParams.append(r,`gte.${t}`),this}lt(r,t){return this.url.searchParams.append(r,`lt.${t}`),this}lte(r,t){return this.url.searchParams.append(r,`lte.${t}`),this}like(r,t){return this.url.searchParams.append(r,`like.${t}`),this}likeAllOf(r,t){return this.url.searchParams.append(r,`like(all).{${t.join(",")}}`),this}likeAnyOf(r,t){return this.url.searchParams.append(r,`like(any).{${t.join(",")}}`),this}ilike(r,t){return this.url.searchParams.append(r,`ilike.${t}`),this}ilikeAllOf(r,t){return this.url.searchParams.append(r,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(r,t){return this.url.searchParams.append(r,`ilike(any).{${t.join(",")}}`),this}is(r,t){return this.url.searchParams.append(r,`is.${t}`),this}in(r,t){const a=Array.from(new Set(t)).map(n=>typeof n=="string"&&new RegExp("[,()]").test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(r,`in.(${a})`),this}contains(r,t){return typeof t=="string"?this.url.searchParams.append(r,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(r,`cs.{${t.join(",")}}`):this.url.searchParams.append(r,`cs.${JSON.stringify(t)}`),this}containedBy(r,t){return typeof t=="string"?this.url.searchParams.append(r,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(r,`cd.{${t.join(",")}}`):this.url.searchParams.append(r,`cd.${JSON.stringify(t)}`),this}rangeGt(r,t){return this.url.searchParams.append(r,`sr.${t}`),this}rangeGte(r,t){return this.url.searchParams.append(r,`nxl.${t}`),this}rangeLt(r,t){return this.url.searchParams.append(r,`sl.${t}`),this}rangeLte(r,t){return this.url.searchParams.append(r,`nxr.${t}`),this}rangeAdjacent(r,t){return this.url.searchParams.append(r,`adj.${t}`),this}overlaps(r,t){return typeof t=="string"?this.url.searchParams.append(r,`ov.${t}`):this.url.searchParams.append(r,`ov.{${t.join(",")}}`),this}textSearch(r,t,{config:a,type:n}={}){let s="";n==="plain"?s="pl":n==="phrase"?s="ph":n==="websearch"&&(s="w");const i=a===void 0?"":`(${a})`;return this.url.searchParams.append(r,`${s}fts${i}.${t}`),this}match(r){return Object.entries(r).forEach(([t,a])=>{this.url.searchParams.append(t,`eq.${a}`)}),this}not(r,t,a){return this.url.searchParams.append(r,`not.${t}.${a}`),this}or(r,{foreignTable:t,referencedTable:a=t}={}){const n=a?`${a}.or`:"or";return this.url.searchParams.append(n,`(${r})`),this}filter(r,t,a){return this.url.searchParams.append(r,`${t}.${a}`),this}};vn.default=ku;var Tu=Gt&&Gt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(as,"__esModule",{value:!0});const Ua=Tu(vn);let Su=class{constructor(r,{headers:t={},schema:a,fetch:n}){this.url=r,this.headers=t,this.schema=a,this.fetch=n}select(r,{head:t=!1,count:a}={}){const n=t?"HEAD":"GET";let s=!1;const i=(r??"*").split("").map(o=>/\s/.test(o)&&!s?"":(o==='"'&&(s=!s),o)).join("");return this.url.searchParams.set("select",i),a&&(this.headers.Prefer=`count=${a}`),new Ua.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(r,{count:t,defaultToNull:a=!0}={}){const n="POST",s=[];if(this.headers.Prefer&&s.push(this.headers.Prefer),t&&s.push(`count=${t}`),a||s.push("missing=default"),this.headers.Prefer=s.join(","),Array.isArray(r)){const i=r.reduce((o,c)=>o.concat(Object.keys(c)),[]);if(i.length>0){const o=[...new Set(i)].map(c=>`"${c}"`);this.url.searchParams.set("columns",o.join(","))}}return new Ua.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:this.fetch,allowEmpty:!1})}upsert(r,{onConflict:t,ignoreDuplicates:a=!1,count:n,defaultToNull:s=!0}={}){const i="POST",o=[`resolution=${a?"ignore":"merge"}-duplicates`];if(t!==void 0&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&o.push(this.headers.Prefer),n&&o.push(`count=${n}`),s||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(r)){const c=r.reduce((l,f)=>l.concat(Object.keys(f)),[]);if(c.length>0){const l=[...new Set(c)].map(f=>`"${f}"`);this.url.searchParams.set("columns",l.join(","))}}return new Ua.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:this.fetch,allowEmpty:!1})}update(r,{count:t}={}){const a="PATCH",n=[];return this.headers.Prefer&&n.push(this.headers.Prefer),t&&n.push(`count=${t}`),this.headers.Prefer=n.join(","),new Ua.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:this.fetch,allowEmpty:!1})}delete({count:r}={}){const t="DELETE",a=[];return r&&a.push(`count=${r}`),this.headers.Prefer&&a.unshift(this.headers.Prefer),this.headers.Prefer=a.join(","),new Ua.default({method:t,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};as.default=Su;var os={},cs={};Object.defineProperty(cs,"__esModule",{value:!0});cs.version=void 0;cs.version="0.0.0-automated";Object.defineProperty(os,"__esModule",{value:!0});os.DEFAULT_HEADERS=void 0;const Au=cs;os.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${Au.version}`};var Mc=Gt&&Gt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ci,"__esModule",{value:!0});const bu=Mc(as),Fu=Mc(vn),Cu=os;let Iu=class Nc{constructor(r,{headers:t={},schema:a,fetch:n}={}){this.url=r,this.headers=Object.assign(Object.assign({},Cu.DEFAULT_HEADERS),t),this.schemaName=a,this.fetch=n}from(r){const t=new URL(`${this.url}/${r}`);return new bu.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(r){return new Nc(this.url,{headers:this.headers,schema:r,fetch:this.fetch})}rpc(r,t={},{head:a=!1,get:n=!1,count:s}={}){let i;const o=new URL(`${this.url}/rpc/${r}`);let c;a||n?(i=a?"HEAD":"GET",Object.entries(t).filter(([f,u])=>u!==void 0).map(([f,u])=>[f,Array.isArray(u)?`{${u.join(",")}}`:`${u}`]).forEach(([f,u])=>{o.searchParams.append(f,u)})):(i="POST",c=t);const l=Object.assign({},this.headers);return s&&(l.Prefer=`count=${s}`),new Fu.default({method:i,url:o,headers:l,schema:this.schemaName,body:c,fetch:this.fetch,allowEmpty:!1})}};ci.default=Iu;var Fa=Gt&&Gt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ct,"__esModule",{value:!0});Ct.PostgrestError=Ct.PostgrestBuilder=Ct.PostgrestTransformBuilder=Ct.PostgrestFilterBuilder=Ct.PostgrestQueryBuilder=Ct.PostgrestClient=void 0;const $c=Fa(ci);Ct.PostgrestClient=$c.default;const Uc=Fa(as);Ct.PostgrestQueryBuilder=Uc.default;const jc=Fa(vn);Ct.PostgrestFilterBuilder=jc.default;const Hc=Fa(ns);Ct.PostgrestTransformBuilder=Hc.default;const Wc=Fa(ss);Ct.PostgrestBuilder=Wc.default;const Vc=Fa(is);Ct.PostgrestError=Vc.default;var Pu=Ct.default={PostgrestClient:$c.default,PostgrestQueryBuilder:Uc.default,PostgrestFilterBuilder:jc.default,PostgrestTransformBuilder:Hc.default,PostgrestBuilder:Wc.default,PostgrestError:Vc.default};const{PostgrestClient:Du,PostgrestQueryBuilder:D2,PostgrestFilterBuilder:O2,PostgrestTransformBuilder:R2,PostgrestBuilder:L2,PostgrestError:B2}=Pu;function Ou(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const Ru=Ou(),Lu="2.11.15",Bu=`realtime-js/${Lu}`,Mu="1.0.0",Gc=1e4,Nu=1e3;var qa;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(qa||(qa={}));var ft;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(ft||(ft={}));var Jt;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Jt||(Jt={}));var Us;(function(e){e.websocket="websocket"})(Us||(Us={}));var qr;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(qr||(qr={}));class $u{constructor(){this.HEADER_LENGTH=1}decode(r,t){return r.constructor===ArrayBuffer?t(this._binaryDecode(r)):t(typeof r=="string"?JSON.parse(r):{})}_binaryDecode(r){const t=new DataView(r),a=new TextDecoder;return this._decodeBroadcast(r,t,a)}_decodeBroadcast(r,t,a){const n=t.getUint8(1),s=t.getUint8(2);let i=this.HEADER_LENGTH+2;const o=a.decode(r.slice(i,i+n));i=i+n;const c=a.decode(r.slice(i,i+s));i=i+s;const l=JSON.parse(a.decode(r.slice(i,r.byteLength)));return{ref:null,topic:o,event:c,payload:l}}}class qc{constructor(r,t){this.callback=r,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=r,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var De;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(De||(De={}));const uo=(e,r,t={})=>{var a;const n=(a=t.skipTypes)!==null&&a!==void 0?a:[];return Object.keys(r).reduce((s,i)=>(s[i]=Uu(i,e,r,n),s),{})},Uu=(e,r,t,a)=>{const n=r.find(o=>o.name===e),s=n==null?void 0:n.type,i=t[e];return s&&!a.includes(s)?zc(s,i):js(i)},zc=(e,r)=>{if(e.charAt(0)==="_"){const t=e.slice(1,e.length);return Vu(r,t)}switch(e){case De.bool:return ju(r);case De.float4:case De.float8:case De.int2:case De.int4:case De.int8:case De.numeric:case De.oid:return Hu(r);case De.json:case De.jsonb:return Wu(r);case De.timestamp:return Gu(r);case De.abstime:case De.date:case De.daterange:case De.int4range:case De.int8range:case De.money:case De.reltime:case De.text:case De.time:case De.timestamptz:case De.timetz:case De.tsrange:case De.tstzrange:return js(r);default:return js(r)}},js=e=>e,ju=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},Hu=e=>{if(typeof e=="string"){const r=parseFloat(e);if(!Number.isNaN(r))return r}return e},Wu=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(r){return console.log(`JSON parse error: ${r}`),e}return e},Vu=(e,r)=>{if(typeof e!="string")return e;const t=e.length-1,a=e[t];if(e[0]==="{"&&a==="}"){let s;const i=e.slice(1,t);try{s=JSON.parse("["+i+"]")}catch{s=i?i.split(","):[]}return s.map(o=>zc(r,o))}return e},Gu=e=>typeof e=="string"?e.replace(" ","T"):e,Kc=e=>{let r=e;return r=r.replace(/^ws/i,"http"),r=r.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),r.replace(/\/+$/,"")};class Es{constructor(r,t,a={},n=Gc){this.channel=r,this.event=t,this.payload=a,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(r){this.timeout=r,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(r){this.payload=Object.assign(Object.assign({},this.payload),r)}receive(r,t){var a;return this._hasReceived(r)&&t((a=this.receivedResp)===null||a===void 0?void 0:a.response),this.recHooks.push({status:r,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const r=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},r),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(r,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:r,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:r,response:t}){this.recHooks.filter(a=>a.status===r).forEach(a=>a.callback(t))}_hasReceived(r){return this.receivedResp&&this.receivedResp.status===r}}var ho;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(ho||(ho={}));class za{constructor(r,t){this.channel=r,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const a=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(a.state,{},n=>{const{onJoin:s,onLeave:i,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=za.syncState(this.state,n,s,i),this.pendingDiffs.forEach(c=>{this.state=za.syncDiff(this.state,c,s,i)}),this.pendingDiffs=[],o()}),this.channel._on(a.diff,{},n=>{const{onJoin:s,onLeave:i,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=za.syncDiff(this.state,n,s,i),o())}),this.onJoin((n,s,i)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:s,newPresences:i})}),this.onLeave((n,s,i)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:s,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(r,t,a,n){const s=this.cloneDeep(r),i=this.transformState(t),o={},c={};return this.map(s,(l,f)=>{i[l]||(c[l]=f)}),this.map(i,(l,f)=>{const u=s[l];if(u){const d=f.map(m=>m.presence_ref),h=u.map(m=>m.presence_ref),g=f.filter(m=>h.indexOf(m.presence_ref)<0),p=u.filter(m=>d.indexOf(m.presence_ref)<0);g.length>0&&(o[l]=g),p.length>0&&(c[l]=p)}else o[l]=f}),this.syncDiff(s,{joins:o,leaves:c},a,n)}static syncDiff(r,t,a,n){const{joins:s,leaves:i}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return a||(a=()=>{}),n||(n=()=>{}),this.map(s,(o,c)=>{var l;const f=(l=r[o])!==null&&l!==void 0?l:[];if(r[o]=this.cloneDeep(c),f.length>0){const u=r[o].map(h=>h.presence_ref),d=f.filter(h=>u.indexOf(h.presence_ref)<0);r[o].unshift(...d)}a(o,f,c)}),this.map(i,(o,c)=>{let l=r[o];if(!l)return;const f=c.map(u=>u.presence_ref);l=l.filter(u=>f.indexOf(u.presence_ref)<0),r[o]=l,n(o,l,c),l.length===0&&delete r[o]}),r}static map(r,t){return Object.getOwnPropertyNames(r).map(a=>t(a,r[a]))}static transformState(r){return r=this.cloneDeep(r),Object.getOwnPropertyNames(r).reduce((t,a)=>{const n=r[a];return"metas"in n?t[a]=n.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):t[a]=n,t},{})}static cloneDeep(r){return JSON.parse(JSON.stringify(r))}onJoin(r){this.caller.onJoin=r}onLeave(r){this.caller.onLeave=r}onSync(r){this.caller.onSync=r}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var go;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(go||(go={}));var po;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(po||(po={}));var gr;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(gr||(gr={}));class li{constructor(r,t={config:{}},a){this.topic=r,this.params=t,this.socket=a,this.bindings={},this.state=ft.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=r.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Es(this,Jt.join,this.params,this.timeout),this.rejoinTimer=new qc(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ft.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(n=>n.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ft.closed,this.socket._remove(this)}),this._onError(n=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=ft.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ft.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Jt.reply,{},(n,s)=>{this._trigger(this._replyEventName(s),n)}),this.presence=new za(this),this.broadcastEndpointURL=Kc(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(r,t=this.timeout){var a,n;if(this.socket.isConnected()||this.socket.connect(),this.state==ft.closed){const{config:{broadcast:s,presence:i,private:o}}=this.params;this._onError(f=>r==null?void 0:r(gr.CHANNEL_ERROR,f)),this._onClose(()=>r==null?void 0:r(gr.CLOSED));const c={},l={broadcast:s,presence:i,postgres_changes:(n=(a=this.bindings.postgres_changes)===null||a===void 0?void 0:a.map(f=>f.filter))!==null&&n!==void 0?n:[],private:o};this.socket.accessTokenValue&&(c.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:l},c)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:f})=>{var u;if(this.socket.setAuth(),f===void 0){r==null||r(gr.SUBSCRIBED);return}else{const d=this.bindings.postgres_changes,h=(u=d==null?void 0:d.length)!==null&&u!==void 0?u:0,g=[];for(let p=0;p<h;p++){const m=d[p],{filter:{event:_,schema:b,table:v,filter:C}}=m,R=f&&f[p];if(R&&R.event===_&&R.schema===b&&R.table===v&&R.filter===C)g.push(Object.assign(Object.assign({},m),{id:R.id}));else{this.unsubscribe(),this.state=ft.errored,r==null||r(gr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=g,r&&r(gr.SUBSCRIBED);return}}).receive("error",f=>{this.state=ft.errored,r==null||r(gr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(f).join(", ")||"error")))}).receive("timeout",()=>{r==null||r(gr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(r,t={}){return await this.send({type:"presence",event:"track",payload:r},t.timeout||this.timeout)}async untrack(r={}){return await this.send({type:"presence",event:"untrack"},r)}on(r,t,a){return this._on(r,t,a)}async send(r,t={}){var a,n;if(!this._canPush()&&r.type==="broadcast"){const{event:s,payload:i}=r,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:i,private:this.private}]})};try{const l=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(a=t.timeout)!==null&&a!==void 0?a:this.timeout);return await((n=l.body)===null||n===void 0?void 0:n.cancel()),l.ok?"ok":"error"}catch(l){return l.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var i,o,c;const l=this._push(r.type,r,t.timeout||this.timeout);r.type==="broadcast"&&!(!((c=(o=(i=this.params)===null||i===void 0?void 0:i.config)===null||o===void 0?void 0:o.broadcast)===null||c===void 0)&&c.ack)&&s("ok"),l.receive("ok",()=>s("ok")),l.receive("error",()=>s("error")),l.receive("timeout",()=>s("timed out"))})}updateJoinPayload(r){this.joinPush.updatePayload(r)}unsubscribe(r=this.timeout){this.state=ft.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Jt.close,"leave",this._joinRef())};this.joinPush.destroy();let a=null;return new Promise(n=>{a=new Es(this,Jt.leave,{},r),a.receive("ok",()=>{t(),n("ok")}).receive("timeout",()=>{t(),n("timed out")}).receive("error",()=>{n("error")}),a.send(),this._canPush()||a.trigger("ok",{})}).finally(()=>{a==null||a.destroy()})}teardown(){this.pushBuffer.forEach(r=>r.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(r,t,a){const n=new AbortController,s=setTimeout(()=>n.abort(),a),i=await this.socket.fetch(r,Object.assign(Object.assign({},t),{signal:n.signal}));return clearTimeout(s),i}_push(r,t,a=this.timeout){if(!this.joinedOnce)throw`tried to push '${r}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new Es(this,r,t,a);return this._canPush()?n.send():(n.startTimeout(),this.pushBuffer.push(n)),n}_onMessage(r,t,a){return t}_isMember(r){return this.topic===r}_joinRef(){return this.joinPush.ref}_trigger(r,t,a){var n,s;const i=r.toLocaleLowerCase(),{close:o,error:c,leave:l,join:f}=Jt;if(a&&[o,c,l,f].indexOf(i)>=0&&a!==this._joinRef())return;let d=this._onMessage(i,t,a);if(t&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(h=>{var g,p,m;return((g=h.filter)===null||g===void 0?void 0:g.event)==="*"||((m=(p=h.filter)===null||p===void 0?void 0:p.event)===null||m===void 0?void 0:m.toLocaleLowerCase())===i}).map(h=>h.callback(d,a)):(s=this.bindings[i])===null||s===void 0||s.filter(h=>{var g,p,m,_,b,v;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in h){const C=h.id,R=(g=h.filter)===null||g===void 0?void 0:g.event;return C&&((p=t.ids)===null||p===void 0?void 0:p.includes(C))&&(R==="*"||(R==null?void 0:R.toLocaleLowerCase())===((m=t.data)===null||m===void 0?void 0:m.type.toLocaleLowerCase()))}else{const C=(b=(_=h==null?void 0:h.filter)===null||_===void 0?void 0:_.event)===null||b===void 0?void 0:b.toLocaleLowerCase();return C==="*"||C===((v=t==null?void 0:t.event)===null||v===void 0?void 0:v.toLocaleLowerCase())}else return h.type.toLocaleLowerCase()===i}).map(h=>{if(typeof d=="object"&&"ids"in d){const g=d.data,{schema:p,table:m,commit_timestamp:_,type:b,errors:v}=g;d=Object.assign(Object.assign({},{schema:p,table:m,commit_timestamp:_,eventType:b,new:{},old:{},errors:v}),this._getPayloadRecords(g))}h.callback(d,a)})}_isClosed(){return this.state===ft.closed}_isJoined(){return this.state===ft.joined}_isJoining(){return this.state===ft.joining}_isLeaving(){return this.state===ft.leaving}_replyEventName(r){return`chan_reply_${r}`}_on(r,t,a){const n=r.toLocaleLowerCase(),s={type:n,filter:t,callback:a};return this.bindings[n]?this.bindings[n].push(s):this.bindings[n]=[s],this}_off(r,t){const a=r.toLocaleLowerCase();return this.bindings[a]=this.bindings[a].filter(n=>{var s;return!(((s=n.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===a&&li.isEqual(n.filter,t))}),this}static isEqual(r,t){if(Object.keys(r).length!==Object.keys(t).length)return!1;for(const a in r)if(r[a]!==t[a])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(r){this._on(Jt.close,{},r)}_onError(r){this._on(Jt.error,{},t=>r(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(r=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ft.joining,this.joinPush.resend(r))}_getPayloadRecords(r){const t={new:{},old:{}};return(r.type==="INSERT"||r.type==="UPDATE")&&(t.new=uo(r.columns,r.record)),(r.type==="UPDATE"||r.type==="DELETE")&&(t.old=uo(r.columns,r.old_record)),t}}const mo=()=>{},qu=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class zu{constructor(r,t){var a;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Gc,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=mo,this.ref=0,this.logger=mo,this.conn=null,this.sendBuffer=[],this.serializer=new $u,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=s=>{let i;return s?i=s:typeof fetch>"u"?i=(...o)=>Ue(async()=>{const{default:c}=await Promise.resolve().then(()=>ba);return{default:c}},void 0).then(({default:c})=>c(...o)):i=fetch,(...o)=>i(...o)},this.endPoint=`${r}/${Us.websocket}`,this.httpEndpoint=Kc(r),t!=null&&t.transport?this.transport=t.transport:this.transport=null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const n=(a=t==null?void 0:t.params)===null||a===void 0?void 0:a.apikey;if(n&&(this.accessTokenValue=n,this.apiKey=n),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(s,i)=>i(JSON.stringify(s)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new qc(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t==null?void 0:t.fetch),t!=null&&t.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(t==null?void 0:t.worker)||!1,this.workerUrl=t==null?void 0:t.workerUrl}this.accessToken=(t==null?void 0:t.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=Ru),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Mu}))}disconnect(r,t){this.conn&&(this.conn.onclose=function(){},r?this.conn.close(r,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(a=>a.teardown()))}getChannels(){return this.channels}async removeChannel(r){const t=await r.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const r=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),r}log(r,t,a){this.logger(r,t,a)}connectionState(){switch(this.conn&&this.conn.readyState){case qa.connecting:return qr.Connecting;case qa.open:return qr.Open;case qa.closing:return qr.Closing;default:return qr.Closed}}isConnected(){return this.connectionState()===qr.Open}channel(r,t={config:{}}){const a=`realtime:${r}`,n=this.getChannels().find(s=>s.topic===a);if(n)return n;{const s=new li(`realtime:${r}`,t,this);return this.channels.push(s),s}}push(r){const{topic:t,event:a,payload:n,ref:s}=r,i=()=>{this.encode(r,o=>{var c;(c=this.conn)===null||c===void 0||c.send(o)})};this.log("push",`${t} ${a} (${s})`,n),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(r=null){let t=r||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(a=>{const n={access_token:t,version:Bu};t&&a.updateJoinPayload(n),a.joinedOnce&&a._isJoined()&&a._push(Jt.access_token,{access_token:t})}))}async sendHeartbeat(){var r;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(r=this.conn)===null||r===void 0||r.close(Nu,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(r){this.heartbeatCallback=r}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(r=>r()),this.sendBuffer=[])}_makeRef(){let r=this.ref+1;return r===this.ref?this.ref=0:this.ref=r,this.ref.toString()}_leaveOpenTopic(r){let t=this.channels.find(a=>a.topic===r&&(a._isJoined()||a._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${r}"`),t.unsubscribe())}_remove(r){this.channels=this.channels.filter(t=>t.topic!==r.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=r=>this._onConnError(r),this.conn.onmessage=r=>this._onConnMessage(r),this.conn.onclose=r=>this._onConnClose(r))}_onConnMessage(r){this.decode(r.data,t=>{let{topic:a,event:n,payload:s,ref:i}=t;a==="phoenix"&&n==="phx_reply"&&this.heartbeatCallback(t.payload.status=="ok"?"ok":"error"),i&&i===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${s.status||""} ${a} ${n} ${i&&"("+i+")"||""}`,s),Array.from(this.channels).filter(o=>o._isMember(a)).forEach(o=>o._trigger(n,s,i)),this.stateChangeCallbacks.message.forEach(o=>o(t))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(r=>r())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const r=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(r),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(r){this.log("transport","close",r),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(r))}_onConnError(r){this.log("transport",`${r}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(r))}_triggerChanError(){this.channels.forEach(r=>r._trigger(Jt.error))}_appendParams(r,t){if(Object.keys(t).length===0)return r;const a=r.match(/\?/)?"&":"?",n=new URLSearchParams(t);return`${r}${a}${n}`}_workerObjectUrl(r){let t;if(r)t=r;else{const a=new Blob([qu],{type:"application/javascript"});t=URL.createObjectURL(a)}return t}}class fi extends Error{constructor(r){super(r),this.__isStorageError=!0,this.name="StorageError"}}function tt(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class Ku extends fi{constructor(r,t){super(r),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Hs extends fi{constructor(r,t){super(r),this.name="StorageUnknownError",this.originalError=t}}var Xu=function(e,r,t,a){function n(s){return s instanceof t?s:new t(function(i){i(s)})}return new(t||(t=Promise))(function(s,i){function o(f){try{l(a.next(f))}catch(u){i(u)}}function c(f){try{l(a.throw(f))}catch(u){i(u)}}function l(f){f.done?s(f.value):n(f.value).then(o,c)}l((a=a.apply(e,r||[])).next())})};const Xc=e=>{let r;return e?r=e:typeof fetch>"u"?r=(...t)=>Ue(async()=>{const{default:a}=await Promise.resolve().then(()=>ba);return{default:a}},void 0).then(({default:a})=>a(...t)):r=fetch,(...t)=>r(...t)},Yu=()=>Xu(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Ue(()=>Promise.resolve().then(()=>ba),void 0)).Response:Response}),Ws=e=>{if(Array.isArray(e))return e.map(t=>Ws(t));if(typeof e=="function"||e!==Object(e))return e;const r={};return Object.entries(e).forEach(([t,a])=>{const n=t.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));r[n]=Ws(a)}),r};var aa=function(e,r,t,a){function n(s){return s instanceof t?s:new t(function(i){i(s)})}return new(t||(t=Promise))(function(s,i){function o(f){try{l(a.next(f))}catch(u){i(u)}}function c(f){try{l(a.throw(f))}catch(u){i(u)}}function l(f){f.done?s(f.value):n(f.value).then(o,c)}l((a=a.apply(e,r||[])).next())})};const ks=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Ju=(e,r,t)=>aa(void 0,void 0,void 0,function*(){const a=yield Yu();e instanceof a&&!(t!=null&&t.noResolveJson)?e.json().then(n=>{r(new Ku(ks(n),e.status||500))}).catch(n=>{r(new Hs(ks(n),n))}):r(new Hs(ks(e),e))}),Qu=(e,r,t,a)=>{const n={method:e,headers:(r==null?void 0:r.headers)||{}};return e==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json"},r==null?void 0:r.headers),a&&(n.body=JSON.stringify(a)),Object.assign(Object.assign({},n),t))};function wn(e,r,t,a,n,s){return aa(this,void 0,void 0,function*(){return new Promise((i,o)=>{e(t,Qu(r,a,n,s)).then(c=>{if(!c.ok)throw c;return a!=null&&a.noResolveJson?c:c.json()}).then(c=>i(c)).catch(c=>Ju(c,o,a))})})}function Vn(e,r,t,a){return aa(this,void 0,void 0,function*(){return wn(e,"GET",r,t,a)})}function br(e,r,t,a,n){return aa(this,void 0,void 0,function*(){return wn(e,"POST",r,a,n,t)})}function Zu(e,r,t,a,n){return aa(this,void 0,void 0,function*(){return wn(e,"PUT",r,a,n,t)})}function ed(e,r,t,a){return aa(this,void 0,void 0,function*(){return wn(e,"HEAD",r,Object.assign(Object.assign({},t),{noResolveJson:!0}),a)})}function Yc(e,r,t,a,n){return aa(this,void 0,void 0,function*(){return wn(e,"DELETE",r,a,n,t)})}var bt=function(e,r,t,a){function n(s){return s instanceof t?s:new t(function(i){i(s)})}return new(t||(t=Promise))(function(s,i){function o(f){try{l(a.next(f))}catch(u){i(u)}}function c(f){try{l(a.throw(f))}catch(u){i(u)}}function l(f){f.done?s(f.value):n(f.value).then(o,c)}l((a=a.apply(e,r||[])).next())})};const td={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},xo={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class rd{constructor(r,t={},a,n){this.url=r,this.headers=t,this.bucketId=a,this.fetch=Xc(n)}uploadOrUpdate(r,t,a,n){return bt(this,void 0,void 0,function*(){try{let s;const i=Object.assign(Object.assign({},xo),n);let o=Object.assign(Object.assign({},this.headers),r==="POST"&&{"x-upsert":String(i.upsert)});const c=i.metadata;typeof Blob<"u"&&a instanceof Blob?(s=new FormData,s.append("cacheControl",i.cacheControl),c&&s.append("metadata",this.encodeMetadata(c)),s.append("",a)):typeof FormData<"u"&&a instanceof FormData?(s=a,s.append("cacheControl",i.cacheControl),c&&s.append("metadata",this.encodeMetadata(c))):(s=a,o["cache-control"]=`max-age=${i.cacheControl}`,o["content-type"]=i.contentType,c&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),n!=null&&n.headers&&(o=Object.assign(Object.assign({},o),n.headers));const l=this._removeEmptyFolders(t),f=this._getFinalPath(l),u=yield this.fetch(`${this.url}/object/${f}`,Object.assign({method:r,body:s,headers:o},i!=null&&i.duplex?{duplex:i.duplex}:{})),d=yield u.json();return u.ok?{data:{path:l,id:d.Id,fullPath:d.Key},error:null}:{data:null,error:d}}catch(s){if(tt(s))return{data:null,error:s};throw s}})}upload(r,t,a){return bt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",r,t,a)})}uploadToSignedUrl(r,t,a,n){return bt(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(r),i=this._getFinalPath(s),o=new URL(this.url+`/object/upload/sign/${i}`);o.searchParams.set("token",t);try{let c;const l=Object.assign({upsert:xo.upsert},n),f=Object.assign(Object.assign({},this.headers),{"x-upsert":String(l.upsert)});typeof Blob<"u"&&a instanceof Blob?(c=new FormData,c.append("cacheControl",l.cacheControl),c.append("",a)):typeof FormData<"u"&&a instanceof FormData?(c=a,c.append("cacheControl",l.cacheControl)):(c=a,f["cache-control"]=`max-age=${l.cacheControl}`,f["content-type"]=l.contentType);const u=yield this.fetch(o.toString(),{method:"PUT",body:c,headers:f}),d=yield u.json();return u.ok?{data:{path:s,fullPath:d.Key},error:null}:{data:null,error:d}}catch(c){if(tt(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(r,t){return bt(this,void 0,void 0,function*(){try{let a=this._getFinalPath(r);const n=Object.assign({},this.headers);t!=null&&t.upsert&&(n["x-upsert"]="true");const s=yield br(this.fetch,`${this.url}/object/upload/sign/${a}`,{},{headers:n}),i=new URL(this.url+s.url),o=i.searchParams.get("token");if(!o)throw new fi("No token returned by API");return{data:{signedUrl:i.toString(),path:r,token:o},error:null}}catch(a){if(tt(a))return{data:null,error:a};throw a}})}update(r,t,a){return bt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",r,t,a)})}move(r,t,a){return bt(this,void 0,void 0,function*(){try{return{data:yield br(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:r,destinationKey:t,destinationBucket:a==null?void 0:a.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(tt(n))return{data:null,error:n};throw n}})}copy(r,t,a){return bt(this,void 0,void 0,function*(){try{return{data:{path:(yield br(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:r,destinationKey:t,destinationBucket:a==null?void 0:a.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(tt(n))return{data:null,error:n};throw n}})}createSignedUrl(r,t,a){return bt(this,void 0,void 0,function*(){try{let n=this._getFinalPath(r),s=yield br(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:t},a!=null&&a.transform?{transform:a.transform}:{}),{headers:this.headers});const i=a!=null&&a.download?`&download=${a.download===!0?"":a.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${i}`)},{data:s,error:null}}catch(n){if(tt(n))return{data:null,error:n};throw n}})}createSignedUrls(r,t,a){return bt(this,void 0,void 0,function*(){try{const n=yield br(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:r},{headers:this.headers}),s=a!=null&&a.download?`&download=${a.download===!0?"":a.download}`:"";return{data:n.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${s}`):null})),error:null}}catch(n){if(tt(n))return{data:null,error:n};throw n}})}download(r,t){return bt(this,void 0,void 0,function*(){const n=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),i=s?`?${s}`:"";try{const o=this._getFinalPath(r);return{data:yield(yield Vn(this.fetch,`${this.url}/${n}/${o}${i}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(tt(o))return{data:null,error:o};throw o}})}info(r){return bt(this,void 0,void 0,function*(){const t=this._getFinalPath(r);try{const a=yield Vn(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:Ws(a),error:null}}catch(a){if(tt(a))return{data:null,error:a};throw a}})}exists(r){return bt(this,void 0,void 0,function*(){const t=this._getFinalPath(r);try{return yield ed(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(a){if(tt(a)&&a instanceof Hs){const n=a.originalError;if([400,404].includes(n==null?void 0:n.status))return{data:!1,error:a}}throw a}})}getPublicUrl(r,t){const a=this._getFinalPath(r),n=[],s=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";s!==""&&n.push(s);const o=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});c!==""&&n.push(c);let l=n.join("&");return l!==""&&(l=`?${l}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${a}${l}`)}}}remove(r){return bt(this,void 0,void 0,function*(){try{return{data:yield Yc(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:r},{headers:this.headers}),error:null}}catch(t){if(tt(t))return{data:null,error:t};throw t}})}list(r,t,a){return bt(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},td),t),{prefix:r||""});return{data:yield br(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},a),error:null}}catch(n){if(tt(n))return{data:null,error:n};throw n}})}encodeMetadata(r){return JSON.stringify(r)}toBase64(r){return typeof Buffer<"u"?Buffer.from(r).toString("base64"):btoa(r)}_getFinalPath(r){return`${this.bucketId}/${r}`}_removeEmptyFolders(r){return r.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(r){const t=[];return r.width&&t.push(`width=${r.width}`),r.height&&t.push(`height=${r.height}`),r.resize&&t.push(`resize=${r.resize}`),r.format&&t.push(`format=${r.format}`),r.quality&&t.push(`quality=${r.quality}`),t.join("&")}}const ad="2.7.1",nd={"X-Client-Info":`storage-js/${ad}`};var ua=function(e,r,t,a){function n(s){return s instanceof t?s:new t(function(i){i(s)})}return new(t||(t=Promise))(function(s,i){function o(f){try{l(a.next(f))}catch(u){i(u)}}function c(f){try{l(a.throw(f))}catch(u){i(u)}}function l(f){f.done?s(f.value):n(f.value).then(o,c)}l((a=a.apply(e,r||[])).next())})};class sd{constructor(r,t={},a){this.url=r,this.headers=Object.assign(Object.assign({},nd),t),this.fetch=Xc(a)}listBuckets(){return ua(this,void 0,void 0,function*(){try{return{data:yield Vn(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(r){if(tt(r))return{data:null,error:r};throw r}})}getBucket(r){return ua(this,void 0,void 0,function*(){try{return{data:yield Vn(this.fetch,`${this.url}/bucket/${r}`,{headers:this.headers}),error:null}}catch(t){if(tt(t))return{data:null,error:t};throw t}})}createBucket(r,t={public:!1}){return ua(this,void 0,void 0,function*(){try{return{data:yield br(this.fetch,`${this.url}/bucket`,{id:r,name:r,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(tt(a))return{data:null,error:a};throw a}})}updateBucket(r,t){return ua(this,void 0,void 0,function*(){try{return{data:yield Zu(this.fetch,`${this.url}/bucket/${r}`,{id:r,name:r,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(tt(a))return{data:null,error:a};throw a}})}emptyBucket(r){return ua(this,void 0,void 0,function*(){try{return{data:yield br(this.fetch,`${this.url}/bucket/${r}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(tt(t))return{data:null,error:t};throw t}})}deleteBucket(r){return ua(this,void 0,void 0,function*(){try{return{data:yield Yc(this.fetch,`${this.url}/bucket/${r}`,{},{headers:this.headers}),error:null}}catch(t){if(tt(t))return{data:null,error:t};throw t}})}}class id extends sd{constructor(r,t={},a){super(r,t,a)}from(r){return new rd(this.url,this.headers,r,this.fetch)}}const od="2.50.2";let ja="";typeof Deno<"u"?ja="deno":typeof document<"u"?ja="web":typeof navigator<"u"&&navigator.product==="ReactNative"?ja="react-native":ja="node";const cd={"X-Client-Info":`supabase-js-${ja}/${od}`},ld={headers:cd},fd={schema:"public"},ud={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},dd={};var hd=function(e,r,t,a){function n(s){return s instanceof t?s:new t(function(i){i(s)})}return new(t||(t=Promise))(function(s,i){function o(f){try{l(a.next(f))}catch(u){i(u)}}function c(f){try{l(a.throw(f))}catch(u){i(u)}}function l(f){f.done?s(f.value):n(f.value).then(o,c)}l((a=a.apply(e,r||[])).next())})};const gd=e=>{let r;return e?r=e:typeof fetch>"u"?r=Rc:r=fetch,(...t)=>r(...t)},pd=()=>typeof Headers>"u"?Lc:Headers,md=(e,r,t)=>{const a=gd(t),n=pd();return(s,i)=>hd(void 0,void 0,void 0,function*(){var o;const c=(o=yield r())!==null&&o!==void 0?o:e;let l=new n(i==null?void 0:i.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization",`Bearer ${c}`),a(s,Object.assign(Object.assign({},i),{headers:l}))})};var xd=function(e,r,t,a){function n(s){return s instanceof t?s:new t(function(i){i(s)})}return new(t||(t=Promise))(function(s,i){function o(f){try{l(a.next(f))}catch(u){i(u)}}function c(f){try{l(a.throw(f))}catch(u){i(u)}}function l(f){f.done?s(f.value):n(f.value).then(o,c)}l((a=a.apply(e,r||[])).next())})};function vd(e){return e.endsWith("/")?e:e+"/"}function wd(e,r){var t,a;const{db:n,auth:s,realtime:i,global:o}=e,{db:c,auth:l,realtime:f,global:u}=r,d={db:Object.assign(Object.assign({},c),n),auth:Object.assign(Object.assign({},l),s),realtime:Object.assign(Object.assign({},f),i),global:Object.assign(Object.assign(Object.assign({},u),o),{headers:Object.assign(Object.assign({},(t=u==null?void 0:u.headers)!==null&&t!==void 0?t:{}),(a=o==null?void 0:o.headers)!==null&&a!==void 0?a:{})}),accessToken:()=>xd(this,void 0,void 0,function*(){return""})};return e.accessToken?d.accessToken=e.accessToken:delete d.accessToken,d}const Jc="2.70.0",ma=30*1e3,Vs=3,Ts=Vs*ma,yd="http://localhost:9999",_d="supabase.auth.token",Ed={"X-Client-Info":`gotrue-js/${Jc}`},Gs="X-Supabase-Api-Version",Qc={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},kd=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Td=6e5;class ui extends Error{constructor(r,t,a){super(r),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=a}}function pe(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class Sd extends ui{constructor(r,t,a){super(r,t,a),this.name="AuthApiError",this.status=t,this.code=a}}function Ad(e){return pe(e)&&e.name==="AuthApiError"}class Zc extends ui{constructor(r,t){super(r),this.name="AuthUnknownError",this.originalError=t}}class $r extends ui{constructor(r,t,a,n){super(r,a,n),this.name=t,this.status=a}}class Ar extends $r{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function bd(e){return pe(e)&&e.name==="AuthSessionMissingError"}class Fn extends $r{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Cn extends $r{constructor(r){super(r,"AuthInvalidCredentialsError",400,void 0)}}class In extends $r{constructor(r,t=null){super(r,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Fd(e){return pe(e)&&e.name==="AuthImplicitGrantRedirectError"}class vo extends $r{constructor(r,t=null){super(r,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class qs extends $r{constructor(r,t){super(r,"AuthRetryableFetchError",t,void 0)}}function Ss(e){return pe(e)&&e.name==="AuthRetryableFetchError"}class wo extends $r{constructor(r,t,a){super(r,"AuthWeakPasswordError",t,"weak_password"),this.reasons=a}}class Ka extends $r{constructor(r){super(r,"AuthInvalidJwtError",400,"invalid_jwt")}}const Gn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),yo=` 	
\r=`.split(""),Cd=(()=>{const e=new Array(128);for(let r=0;r<e.length;r+=1)e[r]=-1;for(let r=0;r<yo.length;r+=1)e[yo[r].charCodeAt(0)]=-2;for(let r=0;r<Gn.length;r+=1)e[Gn[r].charCodeAt(0)]=r;return e})();function _o(e,r,t){if(e!==null)for(r.queue=r.queue<<8|e,r.queuedBits+=8;r.queuedBits>=6;){const a=r.queue>>r.queuedBits-6&63;t(Gn[a]),r.queuedBits-=6}else if(r.queuedBits>0)for(r.queue=r.queue<<6-r.queuedBits,r.queuedBits=6;r.queuedBits>=6;){const a=r.queue>>r.queuedBits-6&63;t(Gn[a]),r.queuedBits-=6}}function el(e,r,t){const a=Cd[e];if(a>-1)for(r.queue=r.queue<<6|a,r.queuedBits+=6;r.queuedBits>=8;)t(r.queue>>r.queuedBits-8&255),r.queuedBits-=8;else{if(a===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function Eo(e){const r=[],t=i=>{r.push(String.fromCodePoint(i))},a={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},s=i=>{Dd(i,a,t)};for(let i=0;i<e.length;i+=1)el(e.charCodeAt(i),n,s);return r.join("")}function Id(e,r){if(e<=127){r(e);return}else if(e<=2047){r(192|e>>6),r(128|e&63);return}else if(e<=65535){r(224|e>>12),r(128|e>>6&63),r(128|e&63);return}else if(e<=1114111){r(240|e>>18),r(128|e>>12&63),r(128|e>>6&63),r(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function Pd(e,r){for(let t=0;t<e.length;t+=1){let a=e.charCodeAt(t);if(a>55295&&a<=56319){const n=(a-55296)*1024&65535;a=(e.charCodeAt(t+1)-56320&65535|n)+65536,t+=1}Id(a,r)}}function Dd(e,r,t){if(r.utf8seq===0){if(e<=127){t(e);return}for(let a=1;a<6;a+=1)if(!(e>>7-a&1)){r.utf8seq=a;break}if(r.utf8seq===2)r.codepoint=e&31;else if(r.utf8seq===3)r.codepoint=e&15;else if(r.utf8seq===4)r.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");r.utf8seq-=1}else if(r.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");r.codepoint=r.codepoint<<6|e&63,r.utf8seq-=1,r.utf8seq===0&&t(r.codepoint)}}function Od(e){const r=[],t={queue:0,queuedBits:0},a=n=>{r.push(n)};for(let n=0;n<e.length;n+=1)el(e.charCodeAt(n),t,a);return new Uint8Array(r)}function Rd(e){const r=[];return Pd(e,t=>r.push(t)),new Uint8Array(r)}function Ld(e){const r=[],t={queue:0,queuedBits:0},a=n=>{r.push(n)};return e.forEach(n=>_o(n,t,a)),_o(null,t,a),r.join("")}function Bd(e){return Math.round(Date.now()/1e3)+e}function Md(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const r=Math.random()*16|0;return(e=="x"?r:r&3|8).toString(16)})}const Yt=()=>typeof window<"u"&&typeof document<"u",Vr={tested:!1,writable:!1},Xa=()=>{if(!Yt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Vr.tested)return Vr.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Vr.tested=!0,Vr.writable=!0}catch{Vr.tested=!0,Vr.writable=!1}return Vr.writable};function Nd(e){const r={},t=new URL(e);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((n,s)=>{r[s]=n})}catch{}return t.searchParams.forEach((a,n)=>{r[n]=a}),r}const tl=e=>{let r;return e?r=e:typeof fetch>"u"?r=(...t)=>Ue(async()=>{const{default:a}=await Promise.resolve().then(()=>ba);return{default:a}},void 0).then(({default:a})=>a(...t)):r=fetch,(...t)=>r(...t)},$d=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",rl=async(e,r,t)=>{await e.setItem(r,JSON.stringify(t))},Pn=async(e,r)=>{const t=await e.getItem(r);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Dn=async(e,r)=>{await e.removeItem(r)};class ls{constructor(){this.promise=new ls.promiseConstructor((r,t)=>{this.resolve=r,this.reject=t})}}ls.promiseConstructor=Promise;function As(e){const r=e.split(".");if(r.length!==3)throw new Ka("Invalid JWT structure");for(let a=0;a<r.length;a++)if(!kd.test(r[a]))throw new Ka("JWT not in base64url format");return{header:JSON.parse(Eo(r[0])),payload:JSON.parse(Eo(r[1])),signature:Od(r[2]),raw:{header:r[0],payload:r[1]}}}async function Ud(e){return await new Promise(r=>{setTimeout(()=>r(null),e)})}function jd(e,r){return new Promise((a,n)=>{(async()=>{for(let s=0;s<1/0;s++)try{const i=await e(s);if(!r(s,null,i)){a(i);return}}catch(i){if(!r(s,i)){n(i);return}}})()})}function Hd(e){return("0"+e.toString(16)).substr(-2)}function Wd(){const r=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",a=t.length;let n="";for(let s=0;s<56;s++)n+=t.charAt(Math.floor(Math.random()*a));return n}return crypto.getRandomValues(r),Array.from(r,Hd).join("")}async function Vd(e){const t=new TextEncoder().encode(e),a=await crypto.subtle.digest("SHA-256",t),n=new Uint8Array(a);return Array.from(n).map(s=>String.fromCharCode(s)).join("")}async function Gd(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const t=await Vd(e);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function da(e,r,t=!1){const a=Wd();let n=a;t&&(n+="/PASSWORD_RECOVERY"),await rl(e,`${r}-code-verifier`,n);const s=await Gd(a);return[s,a===s?"plain":"s256"]}const qd=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function zd(e){const r=e.headers.get(Gs);if(!r||!r.match(qd))return null;try{return new Date(`${r}T00:00:00.0Z`)}catch{return null}}function Kd(e){if(!e)throw new Error("Missing exp claim");const r=Math.floor(Date.now()/1e3);if(e<=r)throw new Error("JWT has expired")}function Xd(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Yd=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function ha(e){if(!Yd.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}var Jd=function(e,r){var t={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&r.indexOf(a)<0&&(t[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,a=Object.getOwnPropertySymbols(e);n<a.length;n++)r.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(t[a[n]]=e[a[n]]);return t};const Gr=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Qd=[502,503,504];async function ko(e){var r;if(!$d(e))throw new qs(Gr(e),0);if(Qd.includes(e.status))throw new qs(Gr(e),e.status);let t;try{t=await e.json()}catch(s){throw new Zc(Gr(s),s)}let a;const n=zd(e);if(n&&n.getTime()>=Qc["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?a=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(a=t.error_code),a){if(a==="weak_password")throw new wo(Gr(t),e.status,((r=t.weak_password)===null||r===void 0?void 0:r.reasons)||[]);if(a==="session_not_found")throw new Ar}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((s,i)=>s&&typeof i=="string",!0))throw new wo(Gr(t),e.status,t.weak_password.reasons);throw new Sd(Gr(t),e.status||500,a)}const Zd=(e,r,t,a)=>{const n={method:e,headers:(r==null?void 0:r.headers)||{}};return e==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},r==null?void 0:r.headers),n.body=JSON.stringify(a),Object.assign(Object.assign({},n),t))};async function ye(e,r,t,a){var n;const s=Object.assign({},a==null?void 0:a.headers);s[Gs]||(s[Gs]=Qc["2024-01-01"].name),a!=null&&a.jwt&&(s.Authorization=`Bearer ${a.jwt}`);const i=(n=a==null?void 0:a.query)!==null&&n!==void 0?n:{};a!=null&&a.redirectTo&&(i.redirect_to=a.redirectTo);const o=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",c=await eh(e,r,t+o,{headers:s,noResolveJson:a==null?void 0:a.noResolveJson},{},a==null?void 0:a.body);return a!=null&&a.xform?a==null?void 0:a.xform(c):{data:Object.assign({},c),error:null}}async function eh(e,r,t,a,n,s){const i=Zd(r,a,n,s);let o;try{o=await e(t,Object.assign({},i))}catch(c){throw console.error(c),new qs(Gr(c),0)}if(o.ok||await ko(o),a!=null&&a.noResolveJson)return o;try{return await o.json()}catch(c){await ko(c)}}function hr(e){var r;let t=null;nh(e)&&(t=Object.assign({},e),e.expires_at||(t.expires_at=Bd(e.expires_in)));const a=(r=e.user)!==null&&r!==void 0?r:e;return{data:{session:t,user:a},error:null}}function To(e){const r=hr(e);return!r.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((t,a)=>t&&typeof a=="string",!0)&&(r.data.weak_password=e.weak_password),r}function Fr(e){var r;return{data:{user:(r=e.user)!==null&&r!==void 0?r:e},error:null}}function th(e){return{data:e,error:null}}function rh(e){const{action_link:r,email_otp:t,hashed_token:a,redirect_to:n,verification_type:s}=e,i=Jd(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:r,email_otp:t,hashed_token:a,redirect_to:n,verification_type:s},c=Object.assign({},i);return{data:{properties:o,user:c},error:null}}function ah(e){return e}function nh(e){return e.access_token&&e.refresh_token&&e.expires_in}const bs=["global","local","others"];var sh=function(e,r){var t={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&r.indexOf(a)<0&&(t[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,a=Object.getOwnPropertySymbols(e);n<a.length;n++)r.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(t[a[n]]=e[a[n]]);return t};class ih{constructor({url:r="",headers:t={},fetch:a}){this.url=r,this.headers=t,this.fetch=tl(a),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(r,t=bs[0]){if(bs.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${bs.join(", ")}`);try{return await ye(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:r,noResolveJson:!0}),{data:null,error:null}}catch(a){if(pe(a))return{data:null,error:a};throw a}}async inviteUserByEmail(r,t={}){try{return await ye(this.fetch,"POST",`${this.url}/invite`,{body:{email:r,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Fr})}catch(a){if(pe(a))return{data:{user:null},error:a};throw a}}async generateLink(r){try{const{options:t}=r,a=sh(r,["options"]),n=Object.assign(Object.assign({},a),t);return"newEmail"in a&&(n.new_email=a==null?void 0:a.newEmail,delete n.newEmail),await ye(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:rh,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(pe(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(r){try{return await ye(this.fetch,"POST",`${this.url}/admin/users`,{body:r,headers:this.headers,xform:Fr})}catch(t){if(pe(t))return{data:{user:null},error:t};throw t}}async listUsers(r){var t,a,n,s,i,o,c;try{const l={nextPage:null,lastPage:0,total:0},f=await ye(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(t=r==null?void 0:r.page)===null||t===void 0?void 0:t.toString())!==null&&a!==void 0?a:"",per_page:(s=(n=r==null?void 0:r.perPage)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:""},xform:ah});if(f.error)throw f.error;const u=await f.json(),d=(i=f.headers.get("x-total-count"))!==null&&i!==void 0?i:0,h=(c=(o=f.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&c!==void 0?c:[];return h.length>0&&(h.forEach(g=>{const p=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),m=JSON.parse(g.split(";")[1].split("=")[1]);l[`${m}Page`]=p}),l.total=parseInt(d)),{data:Object.assign(Object.assign({},u),l),error:null}}catch(l){if(pe(l))return{data:{users:[]},error:l};throw l}}async getUserById(r){ha(r);try{return await ye(this.fetch,"GET",`${this.url}/admin/users/${r}`,{headers:this.headers,xform:Fr})}catch(t){if(pe(t))return{data:{user:null},error:t};throw t}}async updateUserById(r,t){ha(r);try{return await ye(this.fetch,"PUT",`${this.url}/admin/users/${r}`,{body:t,headers:this.headers,xform:Fr})}catch(a){if(pe(a))return{data:{user:null},error:a};throw a}}async deleteUser(r,t=!1){ha(r);try{return await ye(this.fetch,"DELETE",`${this.url}/admin/users/${r}`,{headers:this.headers,body:{should_soft_delete:t},xform:Fr})}catch(a){if(pe(a))return{data:{user:null},error:a};throw a}}async _listFactors(r){ha(r.userId);try{const{data:t,error:a}=await ye(this.fetch,"GET",`${this.url}/admin/users/${r.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:t,error:a}}catch(t){if(pe(t))return{data:null,error:t};throw t}}async _deleteFactor(r){ha(r.userId),ha(r.id);try{return{data:await ye(this.fetch,"DELETE",`${this.url}/admin/users/${r.userId}/factors/${r.id}`,{headers:this.headers}),error:null}}catch(t){if(pe(t))return{data:null,error:t};throw t}}}const oh={getItem:e=>Xa()?globalThis.localStorage.getItem(e):null,setItem:(e,r)=>{Xa()&&globalThis.localStorage.setItem(e,r)},removeItem:e=>{Xa()&&globalThis.localStorage.removeItem(e)}};function So(e={}){return{getItem:r=>e[r]||null,setItem:(r,t)=>{e[r]=t},removeItem:r=>{delete e[r]}}}function ch(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const ga={debug:!!(globalThis&&Xa()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class al extends Error{constructor(r){super(r),this.isAcquireTimeout=!0}}class lh extends al{}async function fh(e,r,t){ga.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,r);const a=new globalThis.AbortController;return r>0&&setTimeout(()=>{a.abort(),ga.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},r),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,r===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:a.signal},async n=>{if(n){ga.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,n.name);try{return await t()}finally{ga.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,n.name)}}else{if(r===0)throw ga.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new lh(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(ga.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}ch();const uh={url:yd,storageKey:_d,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Ed,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Ao(e,r,t){return await t()}class sn{constructor(r){var t,a;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=sn.nextInstanceID,sn.nextInstanceID+=1,this.instanceID>0&&Yt()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},uh),r);if(this.logDebugMessages=!!n.debug,typeof n.debug=="function"&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new ih({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=tl(n.fetch),this.lock=n.lock||Ao,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:Yt()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=fh:this.lock=Ao,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?n.storage?this.storage=n.storage:Xa()?this.storage=oh:(this.memoryStorage={},this.storage=So(this.memoryStorage)):(this.memoryStorage={},this.storage=So(this.memoryStorage)),Yt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(a=this.broadcastChannel)===null||a===void 0||a.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}_debug(...r){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Jc}) ${new Date().toISOString()}`,...r),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var r;try{const t=Nd(window.location.href);let a="none";if(this._isImplicitGrantCallback(t)?a="implicit":await this._isPKCECallback(t)&&(a="pkce"),Yt()&&this.detectSessionInUrl&&a!=="none"){const{data:n,error:s}=await this._getSessionFromURL(t,a);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),Fd(s)){const c=(r=s.details)===null||r===void 0?void 0:r.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:i,redirectType:o}=n;return this._debug("#_initialize()","detected session in URL",i,"redirect type",o),await this._saveSession(i),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return pe(t)?{error:t}:{error:new Zc("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(r){var t,a,n;try{const s=await ye(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(a=(t=r==null?void 0:r.options)===null||t===void 0?void 0:t.data)!==null&&a!==void 0?a:{},gotrue_meta_security:{captcha_token:(n=r==null?void 0:r.options)===null||n===void 0?void 0:n.captchaToken}},xform:hr}),{data:i,error:o}=s;if(o||!i)return{data:{user:null,session:null},error:o};const c=i.session,l=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:l,session:c},error:null}}catch(s){if(pe(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(r){var t,a,n;try{let s;if("email"in r){const{email:f,password:u,options:d}=r;let h=null,g=null;this.flowType==="pkce"&&([h,g]=await da(this.storage,this.storageKey)),s=await ye(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:d==null?void 0:d.emailRedirectTo,body:{email:f,password:u,data:(t=d==null?void 0:d.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:h,code_challenge_method:g},xform:hr})}else if("phone"in r){const{phone:f,password:u,options:d}=r;s=await ye(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:f,password:u,data:(a=d==null?void 0:d.data)!==null&&a!==void 0?a:{},channel:(n=d==null?void 0:d.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:hr})}else throw new Cn("You must provide either an email or phone number and a password");const{data:i,error:o}=s;if(o||!i)return{data:{user:null,session:null},error:o};const c=i.session,l=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:l,session:c},error:null}}catch(s){if(pe(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(r){try{let t;if("email"in r){const{email:s,password:i,options:o}=r;t=await ye(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:To})}else if("phone"in r){const{phone:s,password:i,options:o}=r;t=await ye(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:To})}else throw new Cn("You must provide either an email or phone number and a password");const{data:a,error:n}=t;return n?{data:{user:null,session:null},error:n}:!a||!a.session||!a.user?{data:{user:null,session:null},error:new Fn}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign({user:a.user,session:a.session},a.weak_password?{weakPassword:a.weak_password}:null),error:n})}catch(t){if(pe(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(r){var t,a,n,s;return await this._handleProviderSignIn(r.provider,{redirectTo:(t=r.options)===null||t===void 0?void 0:t.redirectTo,scopes:(a=r.options)===null||a===void 0?void 0:a.scopes,queryParams:(n=r.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(s=r.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(r){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(r))}async signInWithWeb3(r){const{chain:t}=r;if(t==="solana")return await this.signInWithSolana(r);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(r){var t,a,n,s,i,o,c,l,f,u,d,h;let g,p;if("message"in r)g=r.message,p=r.signature;else{const{chain:m,wallet:_,statement:b,options:v}=r;let C;if(Yt())if(typeof _=="object")C=_;else{const I=window;if("solana"in I&&typeof I.solana=="object"&&("signIn"in I.solana&&typeof I.solana.signIn=="function"||"signMessage"in I.solana&&typeof I.solana.signMessage=="function"))C=I.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof _!="object"||!(v!=null&&v.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");C=_}const R=new URL((t=v==null?void 0:v.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in C&&C.signIn){const I=await C.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},v==null?void 0:v.signInWithSolana),{version:"1",domain:R.host,uri:R.href}),b?{statement:b}:null));let T;if(Array.isArray(I)&&I[0]&&typeof I[0]=="object")T=I[0];else if(I&&typeof I=="object"&&"signedMessage"in I&&"signature"in I)T=I;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in T&&"signature"in T&&(typeof T.signedMessage=="string"||T.signedMessage instanceof Uint8Array)&&T.signature instanceof Uint8Array)g=typeof T.signedMessage=="string"?T.signedMessage:new TextDecoder().decode(T.signedMessage),p=T.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in C)||typeof C.signMessage!="function"||!("publicKey"in C)||typeof C!="object"||!C.publicKey||!("toBase58"in C.publicKey)||typeof C.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");g=[`${R.host} wants you to sign in with your Solana account:`,C.publicKey.toBase58(),...b?["",b,""]:[""],"Version: 1",`URI: ${R.href}`,`Issued At: ${(n=(a=v==null?void 0:v.signInWithSolana)===null||a===void 0?void 0:a.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((s=v==null?void 0:v.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${v.signInWithSolana.notBefore}`]:[],...!((i=v==null?void 0:v.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${v.signInWithSolana.expirationTime}`]:[],...!((o=v==null?void 0:v.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${v.signInWithSolana.chainId}`]:[],...!((c=v==null?void 0:v.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${v.signInWithSolana.nonce}`]:[],...!((l=v==null?void 0:v.signInWithSolana)===null||l===void 0)&&l.requestId?[`Request ID: ${v.signInWithSolana.requestId}`]:[],...!((u=(f=v==null?void 0:v.signInWithSolana)===null||f===void 0?void 0:f.resources)===null||u===void 0)&&u.length?["Resources",...v.signInWithSolana.resources.map(T=>`- ${T}`)]:[]].join(`
`);const I=await C.signMessage(new TextEncoder().encode(g),"utf8");if(!I||!(I instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");p=I}}try{const{data:m,error:_}=await ye(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:g,signature:Ld(p)},!((d=r.options)===null||d===void 0)&&d.captchaToken?{gotrue_meta_security:{captcha_token:(h=r.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:hr});if(_)throw _;return!m||!m.session||!m.user?{data:{user:null,session:null},error:new Fn}:(m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),{data:Object.assign({},m),error:_})}catch(m){if(pe(m))return{data:{user:null,session:null},error:m};throw m}}async _exchangeCodeForSession(r){const t=await Pn(this.storage,`${this.storageKey}-code-verifier`),[a,n]=(t??"").split("/");try{const{data:s,error:i}=await ye(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:r,code_verifier:a},xform:hr});if(await Dn(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new Fn}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:n??null}),error:i})}catch(s){if(pe(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(r){try{const{options:t,provider:a,token:n,access_token:s,nonce:i}=r,o=await ye(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:a,id_token:n,access_token:s,nonce:i,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:hr}),{data:c,error:l}=o;return l?{data:{user:null,session:null},error:l}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new Fn}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:l})}catch(t){if(pe(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(r){var t,a,n,s,i;try{if("email"in r){const{email:o,options:c}=r;let l=null,f=null;this.flowType==="pkce"&&([l,f]=await da(this.storage,this.storageKey));const{error:u}=await ye(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(t=c==null?void 0:c.data)!==null&&t!==void 0?t:{},create_user:(a=c==null?void 0:c.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:l,code_challenge_method:f},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:u}}if("phone"in r){const{phone:o,options:c}=r,{data:l,error:f}=await ye(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(n=c==null?void 0:c.data)!==null&&n!==void 0?n:{},create_user:(s=c==null?void 0:c.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(i=c==null?void 0:c.channel)!==null&&i!==void 0?i:"sms"}});return{data:{user:null,session:null,messageId:l==null?void 0:l.message_id},error:f}}throw new Cn("You must provide either an email or phone number.")}catch(o){if(pe(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(r){var t,a;try{let n,s;"options"in r&&(n=(t=r.options)===null||t===void 0?void 0:t.redirectTo,s=(a=r.options)===null||a===void 0?void 0:a.captchaToken);const{data:i,error:o}=await ye(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},r),{gotrue_meta_security:{captcha_token:s}}),redirectTo:n,xform:hr});if(o)throw o;if(!i)throw new Error("An error occurred on token verification.");const c=i.session,l=i.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(r.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:l,session:c},error:null}}catch(n){if(pe(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithSSO(r){var t,a,n;try{let s=null,i=null;return this.flowType==="pkce"&&([s,i]=await da(this.storage,this.storageKey)),await ye(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in r?{provider_id:r.providerId}:null),"domain"in r?{domain:r.domain}:null),{redirect_to:(a=(t=r.options)===null||t===void 0?void 0:t.redirectTo)!==null&&a!==void 0?a:void 0}),!((n=r==null?void 0:r.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:r.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:i}),headers:this.headers,xform:th})}catch(s){if(pe(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async r=>{const{data:{session:t},error:a}=r;if(a)throw a;if(!t)throw new Ar;const{error:n}=await ye(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:n}})}catch(r){if(pe(r))return{data:{user:null,session:null},error:r};throw r}}async resend(r){try{const t=`${this.url}/resend`;if("email"in r){const{email:a,type:n,options:s}=r,{error:i}=await ye(this.fetch,"POST",t,{headers:this.headers,body:{email:a,type:n,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:i}}else if("phone"in r){const{phone:a,type:n,options:s}=r,{data:i,error:o}=await ye(this.fetch,"POST",t,{headers:this.headers,body:{phone:a,type:n,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:o}}throw new Cn("You must provide either an email or phone number and a type")}catch(t){if(pe(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(r,t){this._debug("#_acquireLock","begin",r);try{if(this.lockAcquired){const a=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await a,await t()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,r,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const a=t();for(this.pendingInLock.push((async()=>{try{await a}catch{}})()),await a;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await a}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(r){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await r(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let r=null;const t=await Pn(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?r=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!r)return{data:{session:null},error:null};const a=r.expires_at?r.expires_at*1e3-Date.now()<Ts:!1;if(this._debug("#__loadSession()",`session has${a?"":" not"} expired`,"expires_at",r.expires_at),!a){if(this.storage.isServer){let i=this.suppressGetSessionWarning;r=new Proxy(r,{get:(c,l,f)=>(!i&&l==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),i=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,l,f))})}return{data:{session:r},error:null}}const{session:n,error:s}=await this._callRefreshToken(r.refresh_token);return s?{data:{session:null},error:s}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(r){return r?await this._getUser(r):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(r){try{return r?await ye(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:r,xform:Fr}):await this._useSession(async t=>{var a,n,s;const{data:i,error:o}=t;if(o)throw o;return!(!((a=i.session)===null||a===void 0)&&a.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ar}:await ye(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0,xform:Fr})})}catch(t){if(pe(t))return bd(t)&&(await this._removeSession(),await Dn(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(r,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(r,t))}async _updateUser(r,t={}){try{return await this._useSession(async a=>{const{data:n,error:s}=a;if(s)throw s;if(!n.session)throw new Ar;const i=n.session;let o=null,c=null;this.flowType==="pkce"&&r.email!=null&&([o,c]=await da(this.storage,this.storageKey));const{data:l,error:f}=await ye(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},r),{code_challenge:o,code_challenge_method:c}),jwt:i.access_token,xform:Fr});if(f)throw f;return i.user=l.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(a){if(pe(a))return{data:{user:null},error:a};throw a}}async setSession(r){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(r))}async _setSession(r){try{if(!r.access_token||!r.refresh_token)throw new Ar;const t=Date.now()/1e3;let a=t,n=!0,s=null;const{payload:i}=As(r.access_token);if(i.exp&&(a=i.exp,n=a<=t),n){const{session:o,error:c}=await this._callRefreshToken(r.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!o)return{data:{user:null,session:null},error:null};s=o}else{const{data:o,error:c}=await this._getUser(r.access_token);if(c)throw c;s={access_token:r.access_token,refresh_token:r.refresh_token,user:o.user,token_type:"bearer",expires_in:a-t,expires_at:a},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(t){if(pe(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(r){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(r))}async _refreshSession(r){try{return await this._useSession(async t=>{var a;if(!r){const{data:i,error:o}=t;if(o)throw o;r=(a=i.session)!==null&&a!==void 0?a:void 0}if(!(r!=null&&r.refresh_token))throw new Ar;const{session:n,error:s}=await this._callRefreshToken(r.refresh_token);return s?{data:{user:null,session:null},error:s}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(pe(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(r,t){try{if(!Yt())throw new In("No browser detected.");if(r.error||r.error_description||r.error_code)throw new In(r.error_description||"Error in URL with unspecified error_description",{error:r.error||"unspecified_error",code:r.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new vo("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new In("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!r.code)throw new vo("No code detected.");const{data:b,error:v}=await this._exchangeCodeForSession(r.code);if(v)throw v;const C=new URL(window.location.href);return C.searchParams.delete("code"),window.history.replaceState(window.history.state,"",C.toString()),{data:{session:b.session,redirectType:null},error:null}}const{provider_token:a,provider_refresh_token:n,access_token:s,refresh_token:i,expires_in:o,expires_at:c,token_type:l}=r;if(!s||!o||!i||!l)throw new In("No session defined in URL");const f=Math.round(Date.now()/1e3),u=parseInt(o);let d=f+u;c&&(d=parseInt(c));const h=d-f;h*1e3<=ma&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${u}s`);const g=d-u;f-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,d,f):f-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",g,d,f);const{data:p,error:m}=await this._getUser(s);if(m)throw m;const _={provider_token:a,provider_refresh_token:n,access_token:s,expires_in:u,expires_at:d,refresh_token:i,token_type:l,user:p.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:_,redirectType:r.type},error:null}}catch(a){if(pe(a))return{data:{session:null,redirectType:null},error:a};throw a}}_isImplicitGrantCallback(r){return!!(r.access_token||r.error_description)}async _isPKCECallback(r){const t=await Pn(this.storage,`${this.storageKey}-code-verifier`);return!!(r.code&&t)}async signOut(r={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(r))}async _signOut({scope:r}={scope:"global"}){return await this._useSession(async t=>{var a;const{data:n,error:s}=t;if(s)return{error:s};const i=(a=n.session)===null||a===void 0?void 0:a.access_token;if(i){const{error:o}=await this.admin.signOut(i,r);if(o&&!(Ad(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return r!=="others"&&(await this._removeSession(),await Dn(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(r){const t=Md(),a={id:t,callback:r,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,a),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:a}}}async _emitInitialSession(r){return await this._useSession(async t=>{var a,n;try{const{data:{session:s},error:i}=t;if(i)throw i;await((a=this.stateChangeEmitters.get(r))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",r,"session",s)}catch(s){await((n=this.stateChangeEmitters.get(r))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",r,"error",s),console.error(s)}})}async resetPasswordForEmail(r,t={}){let a=null,n=null;this.flowType==="pkce"&&([a,n]=await da(this.storage,this.storageKey,!0));try{return await ye(this.fetch,"POST",`${this.url}/recover`,{body:{email:r,code_challenge:a,code_challenge_method:n,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(s){if(pe(s))return{data:null,error:s};throw s}}async getUserIdentities(){var r;try{const{data:t,error:a}=await this.getUser();if(a)throw a;return{data:{identities:(r=t.user.identities)!==null&&r!==void 0?r:[]},error:null}}catch(t){if(pe(t))return{data:null,error:t};throw t}}async linkIdentity(r){var t;try{const{data:a,error:n}=await this._useSession(async s=>{var i,o,c,l,f;const{data:u,error:d}=s;if(d)throw d;const h=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,r.provider,{redirectTo:(i=r.options)===null||i===void 0?void 0:i.redirectTo,scopes:(o=r.options)===null||o===void 0?void 0:o.scopes,queryParams:(c=r.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await ye(this.fetch,"GET",h,{headers:this.headers,jwt:(f=(l=u.session)===null||l===void 0?void 0:l.access_token)!==null&&f!==void 0?f:void 0})});if(n)throw n;return Yt()&&!(!((t=r.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(a==null?void 0:a.url),{data:{provider:r.provider,url:a==null?void 0:a.url},error:null}}catch(a){if(pe(a))return{data:{provider:r.provider,url:null},error:a};throw a}}async unlinkIdentity(r){try{return await this._useSession(async t=>{var a,n;const{data:s,error:i}=t;if(i)throw i;return await ye(this.fetch,"DELETE",`${this.url}/user/identities/${r.identity_id}`,{headers:this.headers,jwt:(n=(a=s.session)===null||a===void 0?void 0:a.access_token)!==null&&n!==void 0?n:void 0})})}catch(t){if(pe(t))return{data:null,error:t};throw t}}async _refreshAccessToken(r){const t=`#_refreshAccessToken(${r.substring(0,5)}...)`;this._debug(t,"begin");try{const a=Date.now();return await jd(async n=>(n>0&&await Ud(200*Math.pow(2,n-1)),this._debug(t,"refreshing attempt",n),await ye(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:r},headers:this.headers,xform:hr})),(n,s)=>{const i=200*Math.pow(2,n);return s&&Ss(s)&&Date.now()+i-a<ma})}catch(a){if(this._debug(t,"error",a),pe(a))return{data:{session:null,user:null},error:a};throw a}finally{this._debug(t,"end")}}_isValidSession(r){return typeof r=="object"&&r!==null&&"access_token"in r&&"refresh_token"in r&&"expires_at"in r}async _handleProviderSignIn(r,t){const a=await this._getUrlForProvider(`${this.url}/authorize`,r,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",r,"options",t,"url",a),Yt()&&!t.skipBrowserRedirect&&window.location.assign(a),{data:{provider:r,url:a},error:null}}async _recoverAndRefresh(){var r;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const a=await Pn(this.storage,this.storageKey);if(this._debug(t,"session from storage",a),!this._isValidSession(a)){this._debug(t,"session is not valid"),a!==null&&await this._removeSession();return}const n=((r=a.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Ts;if(this._debug(t,`session has${n?"":" not"} expired with margin of ${Ts}s`),n){if(this.autoRefreshToken&&a.refresh_token){const{error:s}=await this._callRefreshToken(a.refresh_token);s&&(console.error(s),Ss(s)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",s),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(t,"error",a),console.error(a);return}finally{this._debug(t,"end")}}async _callRefreshToken(r){var t,a;if(!r)throw new Ar;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${r.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new ls;const{data:s,error:i}=await this._refreshAccessToken(r);if(i)throw i;if(!s.session)throw new Ar;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const o={session:s.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(s){if(this._debug(n,"error",s),pe(s)){const i={session:null,error:s};return Ss(s)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(i),i}throw(a=this.refreshingDeferred)===null||a===void 0||a.reject(s),s}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(r,t,a=!0){const n=`#_notifyAllSubscribers(${r})`;this._debug(n,"begin",t,`broadcast = ${a}`);try{this.broadcastChannel&&a&&this.broadcastChannel.postMessage({event:r,session:t});const s=[],i=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(r,t)}catch(c){s.push(c)}});if(await Promise.all(i),s.length>0){for(let o=0;o<s.length;o+=1)console.error(s[o]);throw s[0]}}finally{this._debug(n,"end")}}async _saveSession(r){this._debug("#_saveSession()",r),this.suppressGetSessionWarning=!0,await rl(this.storage,this.storageKey,r)}async _removeSession(){this._debug("#_removeSession()"),await Dn(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const r=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{r&&Yt()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",r)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const r=setInterval(()=>this._autoRefreshTokenTick(),ma);this.autoRefreshTicker=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const r=this.autoRefreshTicker;this.autoRefreshTicker=null,r&&clearInterval(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const r=Date.now();try{return await this._useSession(async t=>{const{data:{session:a}}=t;if(!a||!a.refresh_token||!a.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((a.expires_at*1e3-r)/ma);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${ma}ms, refresh threshold is ${Vs} ticks`),n<=Vs&&await this._callRefreshToken(a.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(r){if(r.isAcquireTimeout||r instanceof al)this._debug("auto refresh token tick lock not available");else throw r}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Yt()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(r){console.error("_handleVisibilityChange",r)}}async _onVisibilityChanged(r){const t=`#_onVisibilityChanged(${r})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),r||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(r,t,a){const n=[`provider=${encodeURIComponent(t)}`];if(a!=null&&a.redirectTo&&n.push(`redirect_to=${encodeURIComponent(a.redirectTo)}`),a!=null&&a.scopes&&n.push(`scopes=${encodeURIComponent(a.scopes)}`),this.flowType==="pkce"){const[s,i]=await da(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(i)}`});n.push(o.toString())}if(a!=null&&a.queryParams){const s=new URLSearchParams(a.queryParams);n.push(s.toString())}return a!=null&&a.skipBrowserRedirect&&n.push(`skip_http_redirect=${a.skipBrowserRedirect}`),`${r}?${n.join("&")}`}async _unenroll(r){try{return await this._useSession(async t=>{var a;const{data:n,error:s}=t;return s?{data:null,error:s}:await ye(this.fetch,"DELETE",`${this.url}/factors/${r.factorId}`,{headers:this.headers,jwt:(a=n==null?void 0:n.session)===null||a===void 0?void 0:a.access_token})})}catch(t){if(pe(t))return{data:null,error:t};throw t}}async _enroll(r){try{return await this._useSession(async t=>{var a,n;const{data:s,error:i}=t;if(i)return{data:null,error:i};const o=Object.assign({friendly_name:r.friendlyName,factor_type:r.factorType},r.factorType==="phone"?{phone:r.phone}:{issuer:r.issuer}),{data:c,error:l}=await ye(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(a=s==null?void 0:s.session)===null||a===void 0?void 0:a.access_token});return l?{data:null,error:l}:(r.factorType==="totp"&&(!((n=c==null?void 0:c.totp)===null||n===void 0)&&n.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(t){if(pe(t))return{data:null,error:t};throw t}}async _verify(r){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var a;const{data:n,error:s}=t;if(s)return{data:null,error:s};const{data:i,error:o}=await ye(this.fetch,"POST",`${this.url}/factors/${r.factorId}/verify`,{body:{code:r.code,challenge_id:r.challengeId},headers:this.headers,jwt:(a=n==null?void 0:n.session)===null||a===void 0?void 0:a.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:o})})}catch(t){if(pe(t))return{data:null,error:t};throw t}})}async _challenge(r){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var a;const{data:n,error:s}=t;return s?{data:null,error:s}:await ye(this.fetch,"POST",`${this.url}/factors/${r.factorId}/challenge`,{body:{channel:r.channel},headers:this.headers,jwt:(a=n==null?void 0:n.session)===null||a===void 0?void 0:a.access_token})})}catch(t){if(pe(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(r){const{data:t,error:a}=await this._challenge({factorId:r.factorId});return a?{data:null,error:a}:await this._verify({factorId:r.factorId,challengeId:t.id,code:r.code})}async _listFactors(){const{data:{user:r},error:t}=await this.getUser();if(t)return{data:null,error:t};const a=(r==null?void 0:r.factors)||[],n=a.filter(i=>i.factor_type==="totp"&&i.status==="verified"),s=a.filter(i=>i.factor_type==="phone"&&i.status==="verified");return{data:{all:a,totp:n,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async r=>{var t,a;const{data:{session:n},error:s}=r;if(s)return{data:null,error:s};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=As(n.access_token);let o=null;i.aal&&(o=i.aal);let c=o;((a=(t=n.user.factors)===null||t===void 0?void 0:t.filter(u=>u.status==="verified"))!==null&&a!==void 0?a:[]).length>0&&(c="aal2");const f=i.amr||[];return{data:{currentLevel:o,nextLevel:c,currentAuthenticationMethods:f},error:null}}))}async fetchJwk(r,t={keys:[]}){let a=t.keys.find(i=>i.kid===r);if(a||(a=this.jwks.keys.find(i=>i.kid===r),a&&this.jwks_cached_at+Td>Date.now()))return a;const{data:n,error:s}=await ye(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(s)throw s;if(!n.keys||n.keys.length===0)throw new Ka("JWKS is empty");if(this.jwks=n,this.jwks_cached_at=Date.now(),a=n.keys.find(i=>i.kid===r),!a)throw new Ka("No matching signing key found in JWKS");return a}async getClaims(r,t={keys:[]}){try{let a=r;if(!a){const{data:h,error:g}=await this.getSession();if(g||!h.session)return{data:null,error:g};a=h.session.access_token}const{header:n,payload:s,signature:i,raw:{header:o,payload:c}}=As(a);if(Kd(s.exp),!n.kid||n.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:h}=await this.getUser(a);if(h)throw h;return{data:{claims:s,header:n,signature:i},error:null}}const l=Xd(n.alg),f=await this.fetchJwk(n.kid,t),u=await crypto.subtle.importKey("jwk",f,l,!0,["verify"]);if(!await crypto.subtle.verify(l,u,i,Rd(`${o}.${c}`)))throw new Ka("Invalid JWT signature");return{data:{claims:s,header:n,signature:i},error:null}}catch(a){if(pe(a))return{data:null,error:a};throw a}}}sn.nextInstanceID=0;const dh=sn;class hh extends dh{constructor(r){super(r)}}var gh=function(e,r,t,a){function n(s){return s instanceof t?s:new t(function(i){i(s)})}return new(t||(t=Promise))(function(s,i){function o(f){try{l(a.next(f))}catch(u){i(u)}}function c(f){try{l(a.throw(f))}catch(u){i(u)}}function l(f){f.done?s(f.value):n(f.value).then(o,c)}l((a=a.apply(e,r||[])).next())})};class ph{constructor(r,t,a){var n,s,i;if(this.supabaseUrl=r,this.supabaseKey=t,!r)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const o=vd(r),c=new URL(o);this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const l=`sb-${c.hostname.split(".")[0]}-auth-token`,f={db:fd,realtime:dd,auth:Object.assign(Object.assign({},ud),{storageKey:l}),global:ld},u=wd(a??{},f);this.storageKey=(n=u.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(s=u.global.headers)!==null&&s!==void 0?s:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(d,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=u.auth)!==null&&i!==void 0?i:{},this.headers,u.global.fetch),this.fetch=md(t,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new Du(new URL("rest/v1",c).href,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),u.accessToken||this._listenForAuthEvents()}get functions(){return new ou(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new id(this.storageUrl.href,this.headers,this.fetch)}from(r){return this.rest.from(r)}schema(r){return this.rest.schema(r)}rpc(r,t={},a={}){return this.rest.rpc(r,t,a)}channel(r,t={config:{}}){return this.realtime.channel(r,t)}getChannels(){return this.realtime.getChannels()}removeChannel(r){return this.realtime.removeChannel(r)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var r,t;return gh(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:a}=yield this.auth.getSession();return(t=(r=a.session)===null||r===void 0?void 0:r.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:r,persistSession:t,detectSessionInUrl:a,storage:n,storageKey:s,flowType:i,lock:o,debug:c},l,f){const u={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new hh({url:this.authUrl.href,headers:Object.assign(Object.assign({},u),l),storageKey:s,autoRefreshToken:r,persistSession:t,detectSessionInUrl:a,storage:n,flowType:i,lock:o,debug:c,fetch:f,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(r){return new zu(this.realtimeUrl.href,Object.assign(Object.assign({},r),{params:Object.assign({apikey:this.supabaseKey},r==null?void 0:r.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,a)=>{this._handleTokenChanged(t,"CLIENT",a==null?void 0:a.access_token)})}_handleTokenChanged(r,t,a){(r==="TOKEN_REFRESHED"||r==="SIGNED_IN")&&this.changedAccessToken!==a?this.changedAccessToken=a:r==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const mh=(e,r,t)=>new ph(e,r,t),xh="https://ehutpsrutyiorhqrwstz.supabase.co",vh="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVodXRwc3J1dHlpb3JocXJ3c3R6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTExMTMyNzQsImV4cCI6MjA2NjY4OTI3NH0.lcfz59Uc2S6q9Mn2lj2OC_WAMG5CncrNbEnHX7MFTeI";let K=null;function nl(){try{K=mh(xh,vh)}catch{K=null}}const Vt={getItem:e=>localStorage.getItem(`nutrivalor_${e}`),setItem:(e,r)=>localStorage.setItem(`nutrivalor_${e}`,r),removeItem:e=>localStorage.removeItem(`nutrivalor_${e}`)};async function Ca(){if(K)try{const{data:{user:r}}=await K.auth.getUser();return r}catch{return null}const e=Vt.getItem("currentUser");return e?JSON.parse(e):null}const sl=Object.freeze(Object.defineProperty({__proto__:null,getCurrentUser:Ca,initializeSupabase:nl,localStorageWrapper:Vt,get supabase(){return K}},Symbol.toStringTag,{value:"Module"}));let zr=null;async function il(){await ol(),wh()}function wh(){const e=document.querySelector("#loginForm form"),r=document.querySelector("#signupForm form"),t=document.querySelector("#forgotForm form"),a=document.getElementById("logoutBtn");e?e.addEventListener("submit",Eh):console.warn("❌ Login form not found"),r?r.addEventListener("submit",kh):console.warn("❌ Signup form not found"),t?t.addEventListener("submit",Th):console.warn("❌ Forgot password form not found"),a?a.addEventListener("click",ll):console.warn("❌ Logout button not found"),document.querySelectorAll("[data-auth-tab]").forEach(s=>{s.addEventListener("click",i=>{const c=i.target.getAttribute("data-auth-tab");c&&gi(c)})});const n=document.querySelector("[data-forgot-password]");n&&n.addEventListener("click",s=>{s.preventDefault(),cl()})}async function ol(){try{di();const e=await Ca();e?await on(e):mr()}catch(e){console.error("Error checking auth state:",e),mr()}}function ir(){return zr}async function on(e){zr=e,hi(),yh(),await _h(e),Ah();try{const r=await Ue(()=>Promise.resolve().then(()=>A2),void 0);"loadProfile"in r&&typeof r.loadProfile=="function"&&(await r.loadProfile(),console.log("✅ Profile auto-loaded after login"))}catch(r){console.log("ℹ️ Profile auto-load skipped (not available or error):",r)}mi()}function di(){const e=document.getElementById("loadingScreen"),r=document.getElementById("auth-section"),t=document.getElementById("app-section");e&&(e.style.display="flex"),r&&(r.style.display="none"),t&&(t.style.display="none")}function hi(){const e=document.getElementById("loadingScreen");e&&(e.style.display="none")}function mr(){hi();const e=document.getElementById("auth-section"),r=document.getElementById("app-section");e&&(e.style.display="flex"),r&&(r.style.display="none")}function yh(){hi();const e=document.getElementById("auth-section"),r=document.getElementById("app-section");e&&(e.style.display="none"),r&&(r.style.display="block")}async function _h(e){const r=document.getElementById("userEmail"),t=document.getElementById("headerAvatar"),a=document.getElementById("headerAvatarPlaceholder");if(r){let n=e.email||"User",s=null;try{const{loadProfileFromDatabase:i}=await Ue(async()=>{const{loadProfileFromDatabase:c}=await Promise.resolve().then(()=>yr);return{loadProfileFromDatabase:c}},void 0),o=await i();o&&(o.name&&o.name.trim()&&(n=o.name),o.avatar_url&&(s=o.avatar_url))}catch(i){console.log("Could not load profile from database for header display:",i);const o=localStorage.getItem("nutrivalor_profile");if(o)try{const c=JSON.parse(o);c.name&&c.name.trim()&&(n=c.name),c.avatar&&(s=c.avatar)}catch{console.log("Could not parse saved profile for display name")}}r.textContent=n,t&&a&&(s?(t.src=s,t.style.display="block",a.style.display="none"):(t.style.display="none",a.style.display="flex"))}}function gi(e){document.querySelectorAll(".auth-tab").forEach(n=>n.classList.remove("active"));const r=document.getElementById("loginForm"),t=document.getElementById("signupForm"),a=document.getElementById("forgotForm");if(r&&(r.style.display="none"),t&&(t.style.display="none"),a&&(a.style.display="none"),e==="login"){const n=document.querySelector(".auth-tab");n&&n.classList.add("active"),r&&(r.style.display="block")}else if(e==="signup"){const n=document.querySelectorAll(".auth-tab")[1];n&&n.classList.add("active"),t&&(t.style.display="block")}}function cl(){document.querySelectorAll(".auth-tab").forEach(a=>a.classList.remove("active"));const e=document.getElementById("loginForm"),r=document.getElementById("signupForm"),t=document.getElementById("forgotForm");e&&(e.style.display="none"),r&&(r.style.display="none"),t&&(t.style.display="block")}function at(e,r="success"){let t=document.getElementById("auth-message");if(!t){t=document.createElement("div"),t.id="auth-message",t.className="message";const a=document.getElementById("auth-section");a&&a.insertBefore(t,a.firstChild)}t.textContent=e,t.className=`message ${r}`,t.style.display="block",setTimeout(()=>{t&&(t.style.display="none")},5e3)}async function Eh(e){e.preventDefault();const r=e.target,t=new FormData(r),a=t.get("email"),n=t.get("password");if(!a||!n){at("Please fill in all fields","error");return}try{if(di(),!K){const c=JSON.parse(Vt.getItem("users")||"[]").find(f=>f.email===a&&f.password===n);if(!c){at("Invalid email or password","error"),mr();return}const l={...c};delete l.password,Vt.setItem("currentUser",JSON.stringify(l)),await on(l);return}const{data:s,error:i}=await K.auth.signInWithPassword({email:a,password:n});if(i){at(i.message,"error"),mr();return}s.user&&(await on(s.user),at("Login successful!","success"))}catch(s){console.error("Login error:",s),at("An error occurred during login","error"),mr()}}async function kh(e){e.preventDefault();const r=e.target,t=new FormData(r),a=t.get("name"),n=t.get("email"),s=t.get("password");if(!a||!n||!s){at("Please fill in all fields","error");return}if(s.length<6){at("Password must be at least 6 characters","error");return}try{if(di(),!K){const c=JSON.parse(Vt.getItem("users")||"[]");if(c.find(u=>u.email===n)){at("User already exists","error"),mr();return}const f={id:bh(),email:n,user_metadata:{name:a},app_metadata:{},aud:"authenticated",created_at:new Date().toISOString()};c.push({...f,password:s}),Vt.setItem("users",JSON.stringify(c)),Vt.setItem("currentUser",JSON.stringify(f)),await on(f),at("Account created successfully!","success");return}const{data:i,error:o}=await K.auth.signUp({email:n,password:s,options:{data:{name:a}}});if(o){at(o.message,"error"),mr();return}i.user&&(await on(i.user),at("Account created successfully!","success"))}catch(i){console.error("Signup error:",i),at("An error occurred during signup","error"),mr()}}async function Th(e){e.preventDefault();const r=e.target,a=new FormData(r).get("email");if(!a){at("Please enter your email","error");return}try{if(!K){at("Password reset functionality requires Supabase connection","error");return}const{error:n}=await K.auth.resetPasswordForEmail(a);if(n){at(n.message,"error");return}at("Password reset email sent!","success"),gi("login")}catch(n){console.error("Password reset error:",n),at("An error occurred sending reset email","error")}}async function ll(){try{K&&await K.auth.signOut(),Vt.removeItem("currentUser"),Vt.removeItem("nutrivalor_profile"),Vt.removeItem("nutrivalor_meals"),Vt.removeItem("nutrivalor_weeklyPlan"),Sh(),zr!=null&&zr.id&&Vt.removeItem(`macroProfile_${zr.id}`);try{const e=await Ue(()=>Promise.resolve().then(()=>Rl),void 0);"clearAllData"in e&&await e.clearAllData();const r=document.getElementById("foodGrid");r&&(r.innerHTML='<p class="empty-state">Please log in to view your food data.</p>');const t=document.getElementById("shoppingListContainer");t&&(t.innerHTML='<p class="empty-state">Please log in to view your shopping list.</p>');const a=await Ue(()=>Promise.resolve().then(()=>Of),void 0);"clearAllMealData"in a&&await a.clearAllMealData();const n=document.getElementById("mealGrid");n&&(n.innerHTML='<p class="empty-state">Please log in to view your meals.</p>');const s=document.querySelector(".weekly-meal-plan-container");s&&(s.innerHTML='<p class="empty-state">Please log in to view your meal plan.</p>'),console.log("🧹 All user data cleared from memory and display")}catch(e){console.warn("⚠️ Some data clearing operations failed (this is okay):",e)}zr=null,mr(),console.log("🔐 User logged out - all data cleared for next user")}catch(e){console.error("Logout error:",e),at("Error during logout","error")}}function Sh(){try{["profileName","dateOfBirth","profileAge","profileGender","profileHeight","heightUnit","profileIdealWeight","weightUnit","profileCountry"].forEach(o=>{const c=document.getElementById(o);c&&(c instanceof HTMLSelectElement?c.selectedIndex=0:c.value="")});const r=document.getElementById("avatarPreview"),t=document.getElementById("avatarPlaceholder"),a=document.getElementById("removeAvatarBtn");r&&(r.src="",r.style.display="none"),t&&(t.style.display="flex"),a&&(a.style.display="none");const n=document.getElementById("userEmail"),s=document.getElementById("headerAvatar"),i=document.getElementById("headerAvatarPlaceholder");n&&(n.textContent="User"),s&&(s.style.display="none"),i&&(i.style.display="flex"),console.log("🧹 Profile form cleared for next user")}catch(e){console.error("Error clearing profile form:",e)}}async function Ah(){try{const{initializeFoodTracker:e}=await Ue(async()=>{const{initializeFoodTracker:t}=await Promise.resolve().then(()=>Rl);return{initializeFoodTracker:t}},void 0);await e();const{initializeMeals:r}=await Ue(async()=>{const{initializeMeals:t}=await Promise.resolve().then(()=>Of);return{initializeMeals:t}},void 0);await r()}catch(e){console.error("❌ Error loading user data:",e)}}function bh(){return"id_"+Math.random().toString(36).substr(2,9)+Date.now().toString(36)}async function pi(){try{const e=await Ca();if(!e)return console.log("🔐 No user found, returning false"),!1;const{data:r,error:t}=await K.from("user_roles").select("role").eq("user_id",e.id).single();if(t&&t.code!=="PGRST116")return console.error("❌ Error checking admin status:",t),!1;t&&t.code==="PGRST116"&&console.log("🔐 No role record found for user, defaulting to user role");const a=(r==null?void 0:r.role)||"user";return a==="admin"||a==="super_admin"}catch(e){return console.error("❌ Error checking admin status:",e),!1}}async function fl(){try{const e=await Ca();if(!e)return!1;const{data:r,error:t}=await K.from("user_roles").select("role").eq("user_id",e.id).single();if(t&&t.code!=="PGRST116")return console.error("Error checking super admin status:",t),!1;const a=(r==null?void 0:r.role)||"user";return console.log("🔐 User role:",a),a==="super_admin"}catch(e){return console.error("Error checking super admin status:",e),!1}}async function ul(){try{const e=await Ca();if(!e)return"guest";const{data:r,error:t}=await K.from("user_roles").select("role").eq("user_id",e.id).single();return t&&t.code!=="PGRST116"?(console.error("Error getting user role:",t),"user"):(r==null?void 0:r.role)||"user"}catch(e){return console.error("Error getting user role:",e),"user"}}async function mi(){const e=document.getElementById("adminTab");if(!e){console.error("❌ Admin tab element not found in DOM");return}try{const r=await pi();e.style.display=r?"block":"none"}catch(r){console.error("❌ Error in updateAdminNavigation:",r),e.style.display="none"}}async function dl(){console.log("🐛 === ADMIN DEBUG START ===");const e=await Ca();if(console.log("🐛 Current user:",e),!e){console.log("🐛 No user logged in");return}try{const r=await ul();console.log("🐛 User role:",r);const t=await pi();console.log("🐛 Is admin:",t);const a=await fl();console.log("🐛 Is super admin:",a);const n=document.getElementById("adminTab");console.log("🐛 Admin tab element:",n),console.log("🐛 Admin tab display:",n==null?void 0:n.style.display),await mi()}catch(r){console.error("🐛 Debug error:",r)}console.log("🐛 === ADMIN DEBUG END ===")}window.debugAdminStatus=dl;const Fh=Object.freeze(Object.defineProperty({__proto__:null,checkAuthState:ol,debugAdminStatus:dl,getCurrentAuthUser:ir,getCurrentUserRole:ul,handleLogout:ll,initializeAuth:il,isCurrentUserAdmin:pi,isCurrentUserSuperAdmin:fl,showAuthTab:gi,showForgotPassword:cl,updateAdminNavigation:mi},Symbol.toStringTag,{value:"Module"}));async function hl(){if(!K)throw new Error("Supabase client not initialized");try{const{data:e,error:r}=await K.from("foods").select("count").limit(1);r&&r.code!=="PGRST116"&&(console.warn("Database tables may not be created yet:",r.message),console.log("Please run the SQL script from database-setup.sql in your Supabase dashboard"))}catch(e){console.warn("Database verification failed:",e)}}async function xi(e){if(!K)throw new Error("Supabase not initialized");const{data:{user:r},error:t}=await K.auth.getUser();let a="Unknown User";if(!t&&r)try{const{data:o}=await K.from("user_profiles").select("name").eq("user_id",r.id).single();a=(o==null?void 0:o.name)||r.email||"Unknown User"}catch{a=r.email||"Unknown User"}const n={...e,created_by:a},{data:s,error:i}=await K.from("foods").insert([n]).select();if(i)throw i;return s[0]}async function gl(e){if(!K)throw new Error("Supabase not initialized");const{data:r,error:t}=await K.from("foods").insert(e).select();if(t)throw t;return r||[]}async function pl(){if(!K)throw new Error("Supabase not initialized");const{data:{user:e},error:r}=await K.auth.getUser();if(r||!e)return console.log("No authenticated user, returning empty food list"),[];const{data:t,error:a}=await K.from("foods").select("*").order("name");if(a)throw a;return t||[]}async function ml(e,r){if(!K)throw new Error("Supabase not initialized");const{data:t,error:a}=await K.from("foods").update(r).eq("id",e).select();if(a)throw a;return t[0]}async function xl(e){if(!K)throw new Error("Supabase not initialized");const{error:r}=await K.from("foods").delete().eq("id",e);if(r)throw r}async function vi(){if(!K)throw new Error("Supabase not initialized");const{data:{user:e},error:r}=await K.auth.getUser();if(r||!e)throw new Error("User must be authenticated to clear foods");const{error:t}=await K.from("foods").delete().eq("user_id",e.id);if(t)throw t;console.log("✅ Cleared all existing foods for user:",e.id)}async function vl(e,r=1){if(console.log(`🗄️ DATABASE: addToShoppingList called with foodId="${e}", quantity=${r}`),!K)throw new Error("Supabase not initialized");const{data:{user:t},error:a}=await K.auth.getUser();if(a||!t)throw new Error("User must be authenticated to add to shopping list");const{data:n,error:s}=await K.from("foods").select("*").eq("id",e).single();if(s||!n)throw console.error("🗄️ DATABASE: Food lookup failed:",s),new Error(`Food not found with ID: ${e}`);const{data:i,error:o}=await K.from("shopping_list").select("*").eq("food_id",e).eq("user_id",t.id).single();if(o&&o.code!=="PGRST116")throw o;if(i){console.log(`📦 Found existing item "${n.name}" with quantity ${i.quantity}, adding ${r}`);const{data:c,error:l}=await K.from("shopping_list").update({quantity:i.quantity+r}).eq("id",i.id).eq("user_id",t.id).select();if(l)throw l;return console.log(`✅ DATABASE: Updated "${n.name}" quantity to ${i.quantity+r}`),console.log("🗄️ DATABASE: Update response:",c[0]),c[0]}else{console.log(`📦 Adding new item "${n.name}" with quantity ${r}`);const{data:c,error:l}=await K.from("shopping_list").insert([{food_id:e,quantity:r,user_id:t.id,name:n.name,brand:n.brand||"",carbs:n.carbs||0,fat:n.fat||0,protein:n.protein||0,category:n.category||"General"}]).select();if(l)throw l;return console.log(`✅ DATABASE: Added new item "${n.name}" to shopping list`),console.log("🗄️ DATABASE: Insert response:",c[0]),c[0]}}async function wi(){if(!K)throw new Error("Supabase not initialized");const{data:{user:e},error:r}=await K.auth.getUser();if(r||!e)throw new Error("User must be authenticated to view shopping list");const{data:t,error:a}=await K.from("shopping_list").select("*").eq("user_id",e.id).order("created_at");if(a)throw console.error("🗄️ DATABASE: Error querying shopping list:",a),a;return t||[]}async function wl(e){if(!K)throw new Error("Supabase not initialized");const{data:{user:r},error:t}=await K.auth.getUser();if(t||!r)throw new Error("User must be authenticated to remove from shopping list");const{error:a}=await K.from("shopping_list").delete().eq("id",e).eq("user_id",r.id);if(a)throw a}async function yl(e,r){if(!K)throw new Error("Supabase not initialized");const{data:{user:t},error:a}=await K.auth.getUser();if(a||!t)throw new Error("User must be authenticated to update shopping list");const{data:n,error:s}=await K.from("shopping_list").update({quantity:r}).eq("id",e).eq("user_id",t.id).select();if(s)throw s;return n[0]}async function fs(){if(!K)throw new Error("Supabase not initialized");const{data:{user:e},error:r}=await K.auth.getUser();if(r||!e)throw new Error("User must be authenticated to clear shopping list");const{error:t}=await K.from("shopping_list").delete().eq("user_id",e.id);if(t)throw t;console.log("✅ Cleared shopping list for user:",e.id)}async function _l(e){if(!K)throw new Error("Supabase not initialized");const{data:{user:r},error:t}=await K.auth.getUser();if(t||!r)throw new Error("User must be authenticated to save profile");const a={user_id:r.id,name:e.name,date_of_birth:e.dateOfBirth,age:e.age?parseInt(e.age):null,gender:e.gender,height:e.height?parseFloat(e.height):null,height_unit:e.heightUnit||"cm",ideal_weight:e.idealWeight?parseFloat(e.idealWeight):null,weight_unit:e.weightUnit||"kg",country:e.country,avatar_url:e.avatar,updated_at:new Date().toISOString()},{data:n,error:s}=await K.from("user_profiles").select("id").eq("user_id",r.id).single();if(s&&s.code!=="PGRST116")throw s;if(n){const{data:i,error:o}=await K.from("user_profiles").update(a).eq("user_id",r.id).select();if(o)throw o;return i[0]}else{const{data:i,error:o}=await K.from("user_profiles").insert([a]).select();if(o)throw o;return i[0]}}async function yi(){if(!K)throw new Error("Supabase not initialized");const{data:{user:e},error:r}=await K.auth.getUser();if(r||!e)return console.log("No authenticated user, returning null profile"),null;const{data:t,error:a}=await K.from("user_profiles").select("*").eq("user_id",e.id).single();if(a){if(a.code==="PGRST116")return null;throw a}return t}async function El(e,r,t){if(!K)throw new Error("Supabase not initialized");const{data:{user:a},error:n}=await K.auth.getUser();if(n||!a)throw new Error("User must be authenticated to save weight entry");const s={user_id:a.id,weight:e,entry_date:r,notes:null},{data:i,error:o}=await K.from("weight_entries").insert([s]).select();if(o)throw o;return i[0]}async function _i(){if(!K)throw new Error("Supabase not initialized");const{data:{user:e},error:r}=await K.auth.getUser();if(r||!e)return console.log("No authenticated user, returning empty weight entries"),[];const{data:t,error:a}=await K.from("weight_entries").select("*").eq("user_id",e.id).order("entry_date",{ascending:!0});if(a)throw a;return t||[]}async function kl(){if(!K)throw new Error("Supabase not initialized");const{data:{user:e},error:r}=await K.auth.getUser();if(r||!e)throw new Error("User must be authenticated to clear weight entries");const{error:t}=await K.from("weight_entries").delete().eq("user_id",e.id);if(t)throw t;console.log("✅ Cleared all weight entries for user:",e.id)}const yr=Object.freeze(Object.defineProperty({__proto__:null,addToShoppingList:vl,clearAllFoodsForUser:vi,clearAllWeightEntriesFromDatabase:kl,clearShoppingListFromDatabase:fs,deleteFoodFromDatabase:xl,initializeDatabase:hl,loadFoodsFromDatabase:pl,loadProfileFromDatabase:yi,loadShoppingListFromDatabase:wi,loadWeightEntriesFromDatabase:_i,removeFromShoppingList:wl,saveAllFoodsToDatabase:gl,saveFoodToDatabase:xi,saveProfileToDatabase:_l,saveWeightEntryToDatabase:El,updateFoodInDatabase:ml,updateShoppingListQuantity:yl},Symbol.toStringTag,{value:"Module"}));async function Tl(){Ch(),await Ur(),await us(),Al()}function Ch(){const e=document.getElementById("foodFileInput");e?e.addEventListener("change",bl):console.warn("❌ Food file input not found")}let Qe=[],Be=[];async function us(){try{Be=await wi()||[],na()}catch(e){console.error("❌ Error loading shopping list:",e),Be=[]}}async function Ur(){try{const e=await pl();Qe=e,Ih(e),_r(e)}catch(e){console.error("❌ Error loading foods:",e),Fe("Error loading foods: "+e.message,"error")}}function Ih(e){const r=document.querySelector(".category-filters");if(!r)return;const t=[...new Set(e.map(s=>s.category).filter(s=>s&&s!=="General"))],n=["all",...["VEGETABLES","SALAD","DAIRY","PROTEIN","CONDIMENTS","DRINKS","OTHER"].filter(s=>t.includes(s))];r.innerHTML=n.map((s,i)=>`
      <button class="filter-btn ${i===0?"active":""}" onclick="filterByCategory('${s}')" data-category="${s}">
        ${s==="all"?"ALL":s}
      </button>
    `).join("")}function Sl(e){console.log(`🔍 Filtering by category: ${e}`),document.querySelectorAll(".filter-btn").forEach(a=>{a.classList.remove("active")});const r=document.querySelector(`[data-category="${e}"]`);r&&r.classList.add("active");let t=Qe;e!=="all"&&(t=Qe.filter(a=>a.category&&a.category.toLowerCase()===e.toLowerCase())),console.log(`📊 Filtered to ${t.length} foods`),_r(t)}function _r(e){const r=document.getElementById("foodGrid");if(!r){console.warn("❌ Food grid element not found");return}if(e.length===0){r.innerHTML='<p class="empty-state">No foods found. Upload your food data to get started!</p>';return}e.sort((t,a)=>t.name.localeCompare(a.name)),r.innerHTML=e.map(t=>{const a=Be.some(o=>o.id===t.id||o.food_id===t.id),n=a?"add-btn added":"add-btn",s=a?"Remove from List":"Add to List",i=a?`handleRemoveFromShoppingList('${t.id}', true)`:`addToShoppingList('${t.id}')`;return`
      <div class="food-card">
        <h4>${t.name}</h4>
        ${t.brand?`<div class="brand-info">Brand: ${t.brand}</div>`:""}
        <div class="nutrition-info">
          <span>Carbs: ${wa(t.carbs)}g</span>
          <span>Fat: ${wa(t.fat)}g</span>
          <span>Protein: ${wa(t.protein)}g</span>
        </div>
        ${t.instructions?`<div class="food-instructions">${t.instructions}</div>`:""}
        <div class="food-attribution">
          Created by: ${t.created_by}
        </div>
        <div class="food-actions">
          <input type="number" class="quantity-input" value="1" min="1" id="qty-${t.id}">
          <button class="${n}" onclick="${i}">
            ${s}
          </button>
        </div>
      </div>
    `}).join("")}function wa(e){if(e==null||e==="")return"0";const r=parseFloat(e);return isNaN(r)?"0":r.toFixed(1)}function Ph(){const e=new Date,r=e.toLocaleDateString()+" "+e.toLocaleTimeString();localStorage.setItem("lastFoodUploadDate",r),Al()}function Al(){const e=localStorage.getItem("lastFoodUploadDate"),r=document.getElementById("lastUpdateInfo"),t=document.getElementById("lastUpdateDate");e&&r&&t?(t.textContent=e,r.style.display="block"):r&&(r.style.display="none")}async function bl(e){const r=e.target;if(!r.files||r.files.length===0)return;const t=r.files[0];try{if(Fe("Processing file...","success"),console.log("📄 Processing file:",t.name),!t.name.endsWith(".xlsx")&&!t.name.endsWith(".xls"))throw new Error("Please upload an Excel file (.xlsx or .xls)");if(!K)throw new Error("Supabase client not initialized");const{data:{user:a},error:n}=await K.auth.getUser();if(n||!a)throw new Error("You must be logged in to upload food data");console.log("👤 Current user:",a.id);const s=await Dh(t);if(s&&s.length>0){console.log(`📊 Parsed ${s.length} foods from Excel`),Fe("Clearing existing foods and uploading new data...","success");const{isCurrentUserAdmin:i}=await Ue(async()=>{const{isCurrentUserAdmin:g}=await Promise.resolve().then(()=>Fh);return{isCurrentUserAdmin:g}},void 0),o=await i();let c=!1;if(o)if(console.log("🔧 Admin upload detected - choosing upload strategy"),confirm(`🔧 SMART MODE UPLOAD (Recommended) 🔧

This will:
✅ Replace Excel-uploaded foods with new data
✅ PRESERVE your manually added foods
✅ Keep admin panel foods safe

Click OK to use Smart Mode (recommended)
Click Cancel for old "Replace All" mode`)){console.log("🔧 Smart Mode activated: Preserving manually added admin foods");try{const{error:p}=await K.from("foods").delete().eq("created_by","Excel Upload").is("user_id",null);if(p)throw p;console.log("🗑️ Cleared only Excel-uploaded foods, manually added admin foods preserved")}catch(p){console.warn("⚠️ Could not clear Excel foods:",p)}}else{if(!confirm(`⚠️ FINAL WARNING ⚠️

This will DELETE ALL FOODS including manually added ones.
Are you absolutely sure?`)){Fe("Upload cancelled","error"),r.value="";return}try{const{error:m}=await K.from("foods").delete().neq("id","00000000-0000-0000-0000-000000000000");if(m)throw m;console.log("🗑️ Cleared entire food database")}catch(m){console.warn("⚠️ Could not clear database:",m)}}else if(console.log("👤 User upload detected - using smart sharing approach"),c=confirm(`🌍 SMART SHARING (Recommended) 🌍

To prevent database bloat, we recommend sharing Excel data globally:

✅ Adds foods to shared global database
✅ Prevents duplicate storage
✅ All users benefit from shared data
✅ Shows your name as contributor

Click OK to share globally (recommended)
Click Cancel for personal-only storage`),c){console.log("🌍 Smart sharing mode: Adding to global database");try{const{error:g}=await K.from("foods").delete().eq("created_by","Excel Upload").is("user_id",null);if(g)throw g;console.log("🗑️ Cleared previous Excel uploads to prevent duplication")}catch(g){console.warn("⚠️ Could not clear previous Excel uploads:",g)}}else{console.log("👤 Personal mode: User-specific storage");try{await vi(),console.log("🗑️ Cleared user's existing foods")}catch(g){console.warn("⚠️ Could not clear existing foods:",g)}}let l;o?l=s.map(g=>({...g,user_id:null,created_by:"Excel Upload"})):c?l=s.map(g=>({...g,user_id:null,created_by:`Excel Upload by ${a.email||"User"}`})):l=s.map(g=>({...g,user_id:a.id,created_by:a.email})),console.log(`💾 Saving ${l.length} foods in bulk...`);let f=0,u=0;try{await gl(l),console.log(`✅ Successfully saved all ${l.length} foods`),f=l.length,u=0}catch(g){console.error("❌ Failed to save foods in bulk:",g),console.log("🔄 Falling back to individual saves..."),f=0,u=0;for(const p of l)try{await xi(p),f++}catch(m){console.warn("❌ Failed to save food:",p.name,m),u++}}console.log(`📊 Save results: ${f} saved, ${u} errors`),await Ur();const d=document.getElementById("uploadModal");d&&(d.style.display="none");const h=u>0?`Uploaded ${f} foods (${u} failed)`:`Successfully uploaded ${f} food items!`;Fe(h,"success"),Ph()}else Fe("No valid food data found in the file","error")}catch(a){console.error("❌ Error processing food file:",a),Fe(`Error: ${a instanceof Error?a.message:"Unknown error"}`,"error")}r.value=""}async function Dh(e){return new Promise((r,t)=>{const a=new FileReader;a.onload=function(n){var s;try{typeof window.XLSX>"u"?Oh(()=>{var i;bo((i=n.target)==null?void 0:i.result,r,t)}):bo((s=n.target)==null?void 0:s.result,r,t)}catch(i){t(i)}},a.onerror=()=>t(new Error("Failed to read file")),a.readAsArrayBuffer(e)})}function Oh(e){const r=document.createElement("script");r.src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js",r.onload=e,r.onerror=()=>{throw new Error("Failed to load XLSX library")},document.head.appendChild(r)}function bo(e,r,t){try{const a=window.XLSX,n=a.read(e,{type:"array"}),s=n.SheetNames[0],i=n.Sheets[s],o=a.utils.decode_range(i["!ref"]),c=[];for(let f=o.s.r;f<=o.e.r;f++){const u=[];for(let d=o.s.c;d<=o.e.c;d++){const h=a.utils.encode_cell({r:f,c:d}),g=i[h],p=g&&g.v||"";u.push(p.toString().trim())}c.push(u)}console.log("📊 Excel data converted to 2D array, first 3 rows:",c.slice(0,3));const l=Rh(c);console.log(`📊 Parsed ${l.length} foods from Excel file`),r(l)}catch(a){console.error("❌ Error parsing Excel data:",a),t(new Error("Failed to parse Excel file. Please check the format."))}}function Rh(e){const r=[];if(e.length<3)return console.error("Excel has too few rows to parse."),[];const t=e[0].length;for(let a=0;a+4<t;a+=6){const n=(e[0][a]||"").toString().trim();if(!n)continue;const s=[(e[1][a]||"").toString().trim().toLowerCase(),(e[1][a+1]||"").toString().trim().toLowerCase(),(e[1][a+2]||"").toString().trim().toLowerCase(),(e[1][a+3]||"").toString().trim().toLowerCase(),(e[1][a+4]||"").toString().trim().toLowerCase()];if(s.join(",")!=="food item,brand,carb,fat,prot"){console.log(`⚠️ Skipping section "${n}" - headers don't match expected format:`,s);continue}console.log(`📊 Processing section "${n}" at column ${a}`);for(let i=2;i<e.length;i++){const o=e[i];if(!o||o.length<=a+4)continue;const c=(o[a]||"").toString().trim();if(!c)continue;let l=(o[a+1]||"").toString().trim();const f=parseFloat(o[a+2])||0,u=parseFloat(o[a+3])||0,d=parseFloat(o[a+4])||0;if((!l||l.length<=1||/^\d+$/.test(l)||/^\d+\.\d+$/.test(l)||/^[0-9\s\.]+$/.test(l)||l.toLowerCase().includes("carb")||l.toLowerCase().includes("fat")||l.toLowerCase().includes("prot")||l.toLowerCase().includes("protein")||l.toLowerCase().includes("brand")||l.toLowerCase().includes("item")||l.toLowerCase().includes("total")||l.toLowerCase().includes("example"))&&(l=""),c&&c.length>0&&c.length<100){const h=c.toLowerCase();if(["food item","foor item","brand","item","carb","fat","prot","total","add up values","example"].some(m=>h.includes(m)))continue;r.find(m=>m.name.toLowerCase()===On(c).toLowerCase()&&m.brand.toLowerCase()===(l?On(l):"").toLowerCase()&&m.category===n)||r.push({name:On(c),brand:l?On(l):"",carbs:f,fat:u,instructions:"",protein:d,category:n,created_at:new Date().toISOString(),updated_at:new Date().toISOString()})}}}return r}function On(e){return e.replace(/\w\S*/g,r=>r.charAt(0).toUpperCase()+r.substr(1).toLowerCase())}async function Lh(e){try{if(!K)throw new Error("Supabase client not initialized");const{data:{user:r},error:t}=await K.auth.getUser();if(t||!r)throw new Error("You must be logged in to add food data");const a={...e,user_id:r.id,created_by:r.email};await xi(a),await Ur(),Fe("Food added successfully","success")}catch(r){console.error("Error adding food:",r),Fe("Error adding food","error")}}async function Fl(e){try{const r=Qe.find(n=>n.id===e),t=document.getElementById(`qty-${e}`),a=t?parseInt(t.value):1;if(r){const n=Be.find(s=>s.food_id===e||s.id===e);if(n)n.quantity+=a;else{const s={...r,food_id:e,quantity:a};Be.push(s)}await vl(e,a),await us(),_r(Qe.filter(s=>{var c;const i=document.querySelector(".filter-btn.active"),o=(i==null?void 0:i.getAttribute("data-category"))||"all";return o==="all"||((c=s.category)==null?void 0:c.toLowerCase())===o.toLowerCase()}));try{typeof window.loadAndDisplayShoppingList=="function"&&(await window.loadAndDisplayShoppingList(),console.log("✅ Shopping list display refreshed"));const s=new CustomEvent("shoppingListNeedsRefresh",{detail:{source:"food-tracker",timestamp:Date.now()}});window.dispatchEvent(s)}catch(s){console.warn("⚠️ Could not refresh shopping list display:",s)}}else console.error("Could not find food with ID:",e),Fe("Error: Could not add item to list.","error")}catch(r){console.error("Error adding to shopping list:",r),Fe("Error adding to shopping list","error")}}function Fe(e,r="success"){let t=document.getElementById("food-tracker-message");if(!t){t=document.createElement("div"),t.id="food-tracker-message",t.className="message";const a=document.getElementById("food-tracker")||document.body;a.insertBefore(t,a.firstChild)}t.textContent=e,t.className=`message ${r}`,t.style.display="block",setTimeout(()=>{t&&(t.style.display="none")},3e3)}async function Ei(e,r=!1){try{const t=Be.find(a=>a.food_id===e||a.id===e);if(t){const{removeFromShoppingList:a}=await Ue(async()=>{const{removeFromShoppingList:n}=await Promise.resolve().then(()=>yr);return{removeFromShoppingList:n}},void 0);await a(t.id),Be=Be.filter(n=>n.food_id!==e&&n.id!==e),na(),_r(Qe.filter(n=>{var o;const s=document.querySelector(".filter-btn.active"),i=(s==null?void 0:s.getAttribute("data-category"))||"all";return i==="all"||((o=n.category)==null?void 0:o.toLowerCase())===i.toLowerCase()})),setTimeout(()=>{document.querySelectorAll(".food-card").forEach(s=>{const i=s.querySelector(".add-btn"),o=s.getAttribute("data-food-id");if(i&&o){const c=Be.some(l=>l.food_id===o||l.id===o);i.textContent=c?"Remove":"Add to List",i.classList.toggle("added",c)}})},100)}}catch(t){console.error("Error removing from shopping list:",t),Fe("Error removing item from shopping list","error")}}function na(){const e=document.getElementById("shoppingItems");if(!e)return;e.innerHTML="";let r=0,t=0,a=0;if(Be.length===0)e.innerHTML='<p class="empty-state">Your shopping list is empty. Add some foods from the Food Tracker!</p>',r=0,t=0,a=0;else{const o={};Be.forEach(c=>{const l=c.category||"Other";o[l]||(o[l]=[]),o[l].push(c)}),Object.keys(o).sort().forEach(c=>{const l=document.createElement("div");l.className="shopping-category-group",l.innerHTML=`<h4 class="shopping-category-heading">${c}</h4>`;const f=document.createElement("div");f.className="shopping-category-items",o[c].forEach(u=>{const d=document.createElement("div");d.className="shopping-item";const h=u.brand||"",g=u.name||"",p=parseFloat(u.carbs)||0,m=parseFloat(u.fat)||0,_=parseFloat(u.protein)||0;d.innerHTML=`
          <div class="item-info">
            <h4>${g}</h4>
            ${h?`<span class="item-brand">Brand: ${h}</span>`:""}
            <div class="item-nutrition">
              <span>Carbs: ${p.toFixed(1)}g</span>
              <span>Fat: ${m.toFixed(1)}g</span>  
              <span>Protein: ${_.toFixed(1)}g</span>
            </div>
          </div>
          <div class="food-attribution">
            <span>Quantity: ${u.quantity}</span>
            <button class="remove-btn" onclick="handleRemoveFromShoppingList('${u.food_id||u.id}')">Remove</button>
          </div>
        `,f.appendChild(d),r+=p*u.quantity,t+=m*u.quantity,a+=_*u.quantity}),l.appendChild(f),e.appendChild(l)})}const n=document.getElementById("totalCarbs"),s=document.getElementById("totalFat"),i=document.getElementById("totalProtein");n&&(n.textContent=r.toFixed(1)+"g"),s&&(s.textContent=t.toFixed(1)+"g"),i&&(i.textContent=a.toFixed(1)+"g"),Be.length===0&&(r>0||t>0||a>0)&&(console.warn("⚠️ Detected orphaned shopping list data - clearing..."),Cl())}async function Cl(){try{console.log("🔧 Force refreshing shopping list to clear orphaned data..."),await fs(),Be=[],await us(),console.log("✅ Shopping list force refresh completed")}catch(e){console.error("❌ Error during force refresh:",e)}}async function ki(){try{console.log("🧹 FOOD-TRACKER: Starting shopping list clear..."),await fs(),console.log("✅ Database cleared"),Be=[],console.log("✅ Local food-tracker array cleared");try{typeof window.clearAllShoppingItems=="function"&&(await window.clearAllShoppingItems(!0),console.log("✅ shopping-list.ts system also cleared"))}catch(e){console.warn("⚠️ Could not clear shopping-list.ts system:",e)}na(),_r(Qe.filter(e=>{var a;const r=document.querySelector(".filter-btn.active"),t=(r==null?void 0:r.getAttribute("data-category"))||"all";return t==="all"||((a=e.category)==null?void 0:a.toLowerCase())===t.toLowerCase()})),console.log("🎉 Shopping list fully cleared!"),Fe("Shopping list cleared! 🧹","success")}catch(e){console.error("❌ Error clearing shopping list:",e),Fe("Error clearing shopping list","error")}}async function Il(){console.log("🔄 Reloading shopping list from database..."),await us(),console.log("✅ Shopping list reloaded successfully")}window.addToShoppingList=Fl;window.removeFromShoppingList=Ei;window.handleRemoveFromShoppingList=Mh;window.filterByCategory=Sl;window.clearShoppingList=ki;window.handleClearShoppingList=Bh;window.updateShoppingListDisplay=na;window.reloadShoppingListFromDatabase=Il;window.printShoppingList=Pl;window.loadAndDisplayFoods=Ur;window.reloadFoodTracker=Ur;window.editFood=Ol;window.debugShoppingList=function(){if(console.log("🔧 DEBUG: Shopping List State"),console.log("📊 FOOD-TRACKER array length:",Be.length),console.log("📋 FOOD-TRACKER array contents:",Be),typeof window.getCurrentShoppingList=="function"){const e=window.getCurrentShoppingList();console.log("📊 SHOPPING-LIST array length:",e.length),console.log("📋 SHOPPING-LIST array contents:",e)}na()};window.forceFixShoppingList=function(){console.log("🔧 FORCE FIX: Clearing shopping list completely"),Cl().then(()=>{console.log("✅ Shopping list force fix completed")}).catch(e=>{console.error("❌ Error during force fix:",e)})};window.handleClearFoodTracker=()=>{Dl().catch(e=>{console.error("Error clearing food tracker:",e),Fe("Error clearing food tracker","error")})};function Bh(){if(console.log("🗑️ FOOD-TRACKER: Clear shopping list requested..."),!Be||Be.length===0){Fe("Shopping list is already empty!","success");return}confirm(`Are you sure you want to clear all ${Be.length} items from your shopping list? This cannot be undone.`)?ki().catch(r=>{console.error("Error clearing shopping list:",r),Fe("Error clearing shopping list","error")}):console.log("🚫 Clear shopping list cancelled by user")}function Mh(e,r=!1){Ei(e,r).catch(t=>{console.error("Error removing from shopping list:",t),Fe("Error removing item","error")})}function Pl(){var l;if(!Be||Be.length===0){Fe("Your shopping list is empty. Add some items first!","error");return}const e=ir(),r=((l=e==null?void 0:e.user_metadata)==null?void 0:l.name)||(e==null?void 0:e.email)||"User",t=window.open("","_blank");if(!t){Fe("Please allow popups to print your shopping list","error");return}let a=0,n=0,s=0,i=0;Be.forEach(f=>{a+=(parseFloat(f.carbs)||0)*f.quantity,n+=(parseFloat(f.fat)||0)*f.quantity,s+=(parseFloat(f.protein)||0)*f.quantity,i+=f.quantity});const o={};Be.forEach(f=>{const u=f.category||"Other";o[u]||(o[u]=[]),o[u].push(f)});const c=`
    <!DOCTYPE html>
    <html>
    <head>
      <title>NutriValor - Shopping List</title>
      <style>
        body { 
          font-family: Arial, sans-serif; 
          margin: 10px; 
          line-height: 1.2;
          font-size: 12px;
        }
        .header {
          text-align: center;
          border-bottom: 1px solid #333;
          padding-bottom: 8px;
          margin-bottom: 15px;
        }
        .header h1 {
          font-size: 18px;
          margin: 0 0 5px 0;
        }
        .user-info {
          font-size: 12px;
          color: #667eea;
          font-weight: bold;
          margin-bottom: 5px;
        }
        .header p {
          font-size: 10px;
          margin: 0;
          color: #666;
        }
        .content-wrapper {
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 15px;
          column-fill: balance;
        }
        .category {
          margin-bottom: 12px;
          break-inside: avoid;
          page-break-inside: avoid;
        }
        .category-title {
          background: #f5f5f5;
          padding: 4px 8px;
          font-weight: bold;
          font-size: 13px;
          border-left: 3px solid #667eea;
          margin-bottom: 5px;
        }
        .item {
          padding: 3px 8px;
          border-bottom: 1px solid #eee;
          display: flex;
          justify-content: space-between;
          align-items: flex-start;
          font-size: 11px;
        }
        .item-checkbox {
          width: 12px;
          height: 12px;
          border: 1px solid #333;
          margin-right: 8px;
          margin-top: 2px;
          flex-shrink: 0;
        }
        .item-details {
          flex: 1;
          margin-right: 8px;
        }
        .item-name {
          font-weight: bold;
          font-size: 12px;
          line-height: 1.2;
        }
        .item-brand {
          color: #666;
          font-style: italic;
          font-size: 10px;
          line-height: 1.1;
        }
        .item-nutrition {
          font-size: 9px;
          color: #888;
          line-height: 1.1;
          margin-top: 2px;
        }
        .item-quantity {
          font-weight: bold;
          color: #667eea;
          font-size: 11px;
          white-space: nowrap;
        }
        .totals {
          margin-top: 15px;
          border: 1px solid #333;
          padding: 10px;
          background: #f9f9f9;
          break-inside: avoid;
          page-break-inside: avoid;
          grid-column: 1 / -1;
        }
        .totals-title {
          font-size: 14px;
          font-weight: bold;
          margin-bottom: 8px;
          text-align: center;
        }
        .totals-grid {
          display: grid;
          grid-template-columns: repeat(4, 1fr);
          gap: 8px;
          text-align: center;
        }
        .total-item {
          padding: 5px;
          background: white;
          border-radius: 3px;
        }
        .total-label {
          font-size: 9px;
          color: #666;
          display: block;
        }
        .total-value {
          font-size: 12px;
          font-weight: bold;
          color: #333;
        }
        .footer {
          margin-top: 15px;
          text-align: center;
          font-size: 9px;
          color: #666;
          border-top: 1px solid #ccc;
          padding-top: 5px;
          grid-column: 1 / -1;
        }
        @media screen and (max-width: 600px) {
          .content-wrapper {
            grid-template-columns: 1fr;
          }
        }
        @media print {
          body { margin: 5px; }
          .category { break-inside: avoid; page-break-inside: avoid; }
          .item { break-inside: avoid; }
          .totals { break-inside: avoid; page-break-inside: avoid; }
        }
      </style>
    </head>
    <body>
      <div class="header">
        <h1>NutriValor Shopping List</h1>
        <div class="user-info">For: ${r}</div>
        <p>${new Date().toLocaleDateString()} ${new Date().toLocaleTimeString()}</p>
      </div>
      
      <div class="content-wrapper">
        ${Object.keys(o).sort().map(f=>`
          <div class="category">
            <div class="category-title">${f}</div>
            ${o[f].map(u=>`
              <div class="item">
                <div class="item-checkbox"></div>
                <div class="item-details">
                  <div class="item-name">${u.name}</div>
                  ${u.brand?`<div class="item-brand">${u.brand}</div>`:""}
                  <div class="item-nutrition">
                    C:${wa(u.carbs)}g F:${wa(u.fat)}g P:${wa(u.protein)}g
                  </div>
                </div>
                <div class="item-quantity">${u.quantity}</div>
              </div>
            `).join("")}
          </div>
        `).join("")}
        
        <div class="totals">
          <div class="totals-title">Nutrition Totals</div>
          <div class="totals-grid">
            <div class="total-item">
              <span class="total-label">Items</span>
              <div class="total-value">${i}</div>
            </div>
            <div class="total-item">
              <span class="total-label">Carbs</span>
              <div class="total-value">${a.toFixed(1)}g</div>
            </div>
            <div class="total-item">
              <span class="total-label">Fat</span>
              <div class="total-value">${n.toFixed(1)}g</div>
            </div>
            <div class="total-item">
              <span class="total-label">Protein</span>
              <div class="total-value">${s.toFixed(1)}g</div>
            </div>
          </div>
        </div>
        
        <div class="footer">
          <p>© NutriValor - Value your Nutrition</p>
        </div>
      </div>
      
      <script>
        window.onload = function() {
          window.print();
        }
      <\/script>
    </body>
    </html>
  `;t.document.write(c),t.document.close(),Fe("Opening print dialog...","success")}async function Dl(){if(console.log("🗑️ Clear food tracker requested..."),!Qe||Qe.length===0){Fe("Food tracker is already empty!","error");return}if(!confirm(`Are you sure you want to clear all ${Qe.length} food items from the Food Tracker? This will also clear your shopping list. This action cannot be undone.`)){console.log("🚫 Clear food tracker cancelled by user");return}try{if(!await ir()){Fe("Please log in first.","error");return}console.log("🗑️ Clearing all foods for user..."),await vi(),await fs(),Qe=[],Be=[],_r([]),na();const t=document.querySelector(".category-filters");t&&(t.innerHTML=`<button class="filter-btn active" onclick="filterByCategory('all')">ALL</button>`),localStorage.removeItem("lastFoodUploadDate");const a=document.getElementById("lastUpdateInfo");a&&(a.style.display="none"),Fe("Food tracker and shopping list cleared successfully!","success"),console.log("✅ Food tracker cleared successfully")}catch(r){console.error("❌ Error clearing food tracker:",r),Fe("Error clearing food tracker: "+r.message,"error")}}function Ol(e){const r=Qe.find(d=>d.id===e);if(!r){console.error("Food not found:",e);return}const t=document.getElementById("editFoodForm"),a=document.getElementById("editFoodId"),n=document.getElementById("editFoodName"),s=document.getElementById("editFoodBrand"),i=document.getElementById("editFoodCarbs"),o=document.getElementById("editFoodFat"),c=document.getElementById("editFoodProtein"),l=document.getElementById("editFoodInstructions"),f=document.getElementById("editFoodCategory");if(!t||!a||!n||!s||!i||!o||!c||!l||!f){console.error("Edit form elements not found");return}a.value=r.id,n.value=r.name,s.value=r.brand||"",i.value=r.carbs||"0",o.value=r.fat||"0",c.value=r.protein||"0",l.value=r.instructions||"",f.value=r.category||"OTHER";const u=document.getElementById("editFoodModal");u&&(u.style.display="block")}function Ti(){const e=document.getElementById("editFoodModal");e&&(e.style.display="none")}async function Nh(){const e=document.getElementById("editFoodId");if(!e||!e.value){Fe("No food selected for deletion","error");return}if(confirm("Are you sure you want to delete this food?"))try{await xl(e.value),Fe("Food deleted successfully","success"),Ti(),await Ur()}catch(t){console.error("Error deleting food:",t),Fe("Error deleting food","error")}}document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("editFoodForm");e&&e.addEventListener("submit",async r=>{r.preventDefault();const t=document.getElementById("editFoodId").value,a=document.getElementById("editFoodName").value,n=document.getElementById("editFoodBrand").value,s=parseFloat(document.getElementById("editFoodCarbs").value),i=parseFloat(document.getElementById("editFoodFat").value),o=parseFloat(document.getElementById("editFoodProtein").value),c=document.getElementById("editFoodInstructions").value,l=document.getElementById("editFoodCategory").value;try{await ml({id:t,name:a,brand:n,carbs:s,fat:i,protein:o,instructions:c,category:l}),Fe("Food updated successfully","success"),Ti(),await Ur()}catch(f){console.error("Error updating food:",f),Fe("Error updating food","error")}})});const Rl=Object.freeze(Object.defineProperty({__proto__:null,addFood:Lh,addToShoppingList:Fl,get allFoods(){return Qe},cancelFoodEdit:Ti,clearShoppingList:ki,deleteFoodFromEdit:Nh,displayFoods:_r,editFood:Ol,filterByCategory:Sl,handleClearFoodTracker:Dl,handleFoodFileUpload:bl,initializeFoodTracker:Tl,loadAndDisplayFoods:Ur,printShoppingList:Pl,reloadShoppingListFromDatabase:Il,removeFromShoppingList:Ei,updateShoppingListDisplay:na},Symbol.toStringTag,{value:"Module"}));let ht=[],It="",pt="",Lt="",_t=null,zs=!1;async function $h(){await Ll(),Vh(),Wh(),Uh(),ds(),hs(),Hh(),jh()}function Uh(){const e=document.getElementById("idealWeight"),r=()=>{e!=null&&e.value&&Si()};e&&e.addEventListener("input",r)}function jh(){setTimeout(()=>{const e=document.getElementById("idealWeight");e!=null&&e.value?Si():Xh("💡 Tip: Fill out your ideal weight in Settings → Profile to auto-populate here")},500)}async function Ll(){if(zs)return;try{ht=(await _i()).map(a=>({date:a.entry_date,weight:a.weight,user_id:a.user_id}))}catch{ht=[]}const e=ir(),r=(e==null?void 0:e.id)||"anonymous";try{const{loadProfileFromDatabase:t}=await Ue(async()=>{const{loadProfileFromDatabase:n}=await Promise.resolve().then(()=>yr);return{loadProfileFromDatabase:n}},void 0),a=await t();if(a&&a.ideal_weight){let n=a.ideal_weight;a.weight_unit==="lbs"&&(n=a.ideal_weight*.453592),pt=n.toString(),setTimeout(()=>{const s=document.getElementById("idealWeight");s&&Ml(s,`Ideal weight loaded from profile (${a.ideal_weight} ${a.weight_unit})`)},100)}else pt=localStorage.getItem(`idealWeight_${r}`)||""}catch{pt=localStorage.getItem(`idealWeight_${r}`)||""}It=localStorage.getItem(`startingWeight_${r}`)||"",Lt=localStorage.getItem(`targetDate_${r}`)||""}function Bl(){const e=ir(),r=(e==null?void 0:e.id)||"anonymous";localStorage.setItem(`startingWeight_${r}`,It),localStorage.setItem(`idealWeight_${r}`,pt),localStorage.setItem(`targetDate_${r}`,Lt)}function Hh(){const e=new Date().toISOString().split("T")[0],r=document.getElementById("entryDate");r&&!r.value&&(r.value=e)}function Wh(){const e=document.getElementById("startingWeight"),r=document.getElementById("idealWeight"),t=document.getElementById("targetDate");e&&(e.value=It,e.addEventListener("input",zh),e.addEventListener("change",Rn),e.addEventListener("blur",()=>{Rn()})),r&&(r.value=pt,r.addEventListener("change",Rn)),t&&(t.value=Lt,t.addEventListener("change",Rn))}function Vh(){if(document.getElementById("weightChart"))if(typeof window.Chart>"u"){const r=document.createElement("script");r.src="https://cdn.jsdelivr.net/npm/chart.js",r.onload=()=>Fo(),document.head.appendChild(r)}else Fo()}function Fo(){const e=document.getElementById("weightChart");if(!e)return;_t&&(_t.destroy(),_t=null);const r=e.getContext("2d");r&&(_t=new window.Chart(r,{type:"line",data:{labels:[],datasets:[{label:"Actual Weight",data:[],borderColor:"#667eea",backgroundColor:"rgba(102, 126, 234, 0.1)",tension:.3,fill:!0},{label:"Ideal Path",data:[],borderColor:"#10b981",borderDash:[5,5],tension:0,fill:!1,pointRadius:0}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{x:{title:{display:!0,text:"Date"}},y:{title:{display:!0,text:"Weight (kg)"}}},plugins:{title:{display:!0,text:"Weight Progress",font:{size:16,weight:"bold"}},legend:{position:"bottom",labels:{padding:20,font:{size:12}}}}}}))}function Gh(e){if(!It||!pt||ht.length===0)return[];const r=ht[0].date,t=new Date(r).getTime();let a;Lt?a=new Date(Lt).getTime():a=t+6*30*24*60*60*1e3;const n=a-t;if(n<=0)return[];const s=parseFloat(It),o=parseFloat(pt)-s;return(Lt?[...new Set([...e,Lt])].sort():e).map(f=>{const u=new Date(f).getTime();if(u<t)return null;const d=u-t,h=Math.min(1,d/n),g=s+o*h;return{x:f,y:parseFloat(g.toFixed(1))}}).filter(f=>f!==null)}function ds(){if(!_t)return;ht.sort((n,s)=>new Date(n.date).getTime()-new Date(s.date).getTime());const e=ht.map(n=>n.date),r=ht.map(n=>({x:n.date,y:n.weight}));_t.data.datasets[0].data=r;const t=Gh(e);_t.data.datasets[1].data=t;const a=[...new Set([...e,Lt].filter(Boolean))].sort();Lt&&It&&pt?_t.data.labels=a:_t.data.labels=e,_t.update()}function hs(){const e=document.getElementById("progressText");if(!e)return;if(!It||ht.length===0){e.textContent="";return}const r=parseFloat(It);if(isNaN(r)){e.textContent="";return}if(ht.length>0&&!It){e.textContent='Please click "Clear All Data" to reset tracking.',e.style.color="#d97706";return}const t=ht[ht.length-1].weight,a=(r-t).toFixed(1);parseFloat(a)>0?(e.textContent=`Congratulations! You've lost ${a}kg so far.`,e.style.color="#065f46"):parseFloat(a)<0?(e.textContent=`You've gained ${Math.abs(parseFloat(a))}kg. Keep going!`,e.style.color="#991b1b"):(e.textContent="You're at your starting weight. Keep going!",e.style.color="#1e293b")}async function qh(){const e=document.getElementById("entryDate"),r=document.getElementById("entryWeight"),t=document.getElementById("startingWeight"),a=e==null?void 0:e.value,n=parseFloat((r==null?void 0:r.value)||"0"),s=parseFloat((t==null?void 0:t.value)||"0");if(!a||!n){Pr("Please enter a date and weight.");return}if(!s&&!It){Pr("Please enter a starting weight first.");return}s&&!It&&(It=s.toString());try{await El(n,a);const i=ht.findIndex(o=>o.date===a);i>-1?ht[i].weight=n:ht.push({date:a,weight:n}),Bl(),ds(),hs(),r&&(r.value=""),Pr("Weight entry added successfully!")}catch{Pr("Error saving weight entry. Please try again.")}}async function zh(){document.getElementById("startingWeight");const e=document.getElementById("idealWeight"),r=document.getElementById("targetDate"),t=(e==null?void 0:e.value)||"",a=(r==null?void 0:r.value)||"",n=t&&t!==pt;pt=t,Lt=a;const s=ir(),i=(s==null?void 0:s.id)||"anonymous";if(localStorage.setItem(`idealWeight_${i}`,pt),localStorage.setItem(`targetDate_${i}`,Lt),n)try{const{loadProfileFromDatabase:o,saveProfileToDatabase:c}=await Ue(async()=>{const{loadProfileFromDatabase:f,saveProfileToDatabase:u}=await Promise.resolve().then(()=>yr);return{loadProfileFromDatabase:f,saveProfileToDatabase:u}},void 0),l=await o();if(l){const f={name:l.name,dateOfBirth:l.date_of_birth,age:l.age,gender:l.gender,height:l.height,heightUnit:l.height_unit,idealWeight:t,weightUnit:l.weight_unit||"kg",country:l.country,avatar:l.avatar_url};await c(f)}}catch{}ds(),hs()}async function Rn(){const e=document.getElementById("startingWeight"),r=document.getElementById("idealWeight"),t=document.getElementById("targetDate"),a=(e==null?void 0:e.value)||"",n=(r==null?void 0:r.value)||"",s=(t==null?void 0:t.value)||"",i=n&&n!==pt;It=a,pt=n,Lt=s,Bl();const o=document.getElementById("entryWeight"),c=new Date().toISOString().split("T")[0],l=ht.find(u=>u.date===c);if(a&&o&&!o.value&&!l&&(o.value=a,Pr(`💡 Your starting weight (${a}kg) has been added to today's weight field. Click "Add Entry" to save it.`)),i)try{const{loadProfileFromDatabase:u,saveProfileToDatabase:d}=await Ue(async()=>{const{loadProfileFromDatabase:g,saveProfileToDatabase:p}=await Promise.resolve().then(()=>yr);return{loadProfileFromDatabase:g,saveProfileToDatabase:p}},void 0),h=await u();if(h){const g={name:h.name,dateOfBirth:h.date_of_birth,age:h.age,gender:h.gender,height:h.height,heightUnit:h.height_unit,idealWeight:n,weightUnit:h.weight_unit||"kg",country:h.country,avatar:h.avatar_url};await d(g)}}catch{}ds(),hs()}async function Kh(){if(confirm("Are you sure you want to delete all weight data? This cannot be undone.")){zs=!0;try{if(await kl(),(await _i()).length>0){Pr("Warning: Not all data was cleared. Please try again.");return}const r=ir(),t=(r==null?void 0:r.id)||"anonymous";localStorage.removeItem(`startingWeight_${t}`),localStorage.removeItem(`idealWeight_${t}`),localStorage.removeItem(`targetDate_${t}`),ht=[],It="",pt="",Lt="";const a=document.getElementById("startingWeight"),n=document.getElementById("idealWeight"),s=document.getElementById("targetDate"),i=document.getElementById("progressText"),o=document.getElementById("entryWeight");a&&(a.value=""),n&&(n.value=""),s&&(s.value=""),o&&(o.value=""),i&&(i.textContent="");let c=!1;try{const{loadProfileFromDatabase:l}=await Ue(async()=>{const{loadProfileFromDatabase:u}=await Promise.resolve().then(()=>yr);return{loadProfileFromDatabase:u}},void 0),f=await l();f&&f.ideal_weight&&(c=!0)}catch{}if(_t&&(_t.data.labels=[],_t.data.datasets[0].data=[],_t.data.datasets[1].data=[],_t.update()),Si(),c){await Ll();const l=document.getElementById("idealWeight");l&&pt&&(l.value=pt,Ml(l,"Ideal weight from profile"))}Pr("All weight data cleared successfully!")}catch{Pr("Error clearing weight data. Please try again.")}finally{zs=!1}}}function Pr(e,r="success"){let t=document.getElementById("weight-message");if(!t){t=document.createElement("div"),t.id="weight-message",t.className="message";const a=document.getElementById("weight-tracker")||document.body;a.insertBefore(t,a.firstChild)}t.textContent=e,t.className=`message ${r}`,t.style.display="block",setTimeout(()=>{t&&(t.style.display="none")},3e3)}function Xh(e){let r=document.getElementById("weight-profile-tip");if(!r){r=document.createElement("div"),r.id="weight-profile-tip",r.className="message warning";const t=document.getElementById("weight-tracker")||document.body;t.insertBefore(r,t.firstChild)}r.textContent=e,r.className="message warning",r.style.display="block"}function Si(){const e=document.getElementById("weight-profile-tip");e&&(e.style.display="none")}function Ml(e,r){var n;const t=(n=e.parentElement)==null?void 0:n.querySelector(".profile-indicator");t&&t.remove();const a=document.createElement("span");a.className="profile-indicator",a.innerHTML="👤",a.title=r,a.style.marginLeft="8px",a.style.color="#10b981",a.style.fontSize="14px",a.style.cursor="help",a.style.filter="grayscale(0.3) brightness(1.2)",e.style.borderLeft="3px solid #10b981",e.parentElement&&(e.parentElement.style.position="relative",e.parentElement.appendChild(a))}window.addWeightEntry=qh;window.clearWeightData=Kh;async function Yh(){await Qh(),Zh(),Jh()}function Jh(){const e=document.getElementById("macro-age"),r=document.getElementById("macro-gender"),t=document.getElementById("macro-height"),a=()=>{e!=null&&e.value&&(r!=null&&r.value)&&(t!=null&&t.value)&&Nl()};e&&e.addEventListener("input",a),r&&r.addEventListener("change",a),t&&t.addEventListener("input",a)}async function Qh(){try{const e=await yi();if(e){const n=document.getElementById("macro-age"),s=document.getElementById("macro-gender"),i=document.getElementById("macro-height");if(n&&e.age&&(n.value=e.age.toString(),Fs(n,"Age loaded from profile")),s&&e.gender&&(s.value=e.gender,Fs(s,"Gender loaded from profile")),i&&e.height){let o=e.height;e.height_unit==="ft"&&(o=e.height*30.48),i.value=o.toString(),Fs(i,`Height loaded from profile (${e.height} ${e.height_unit})`)}}setTimeout(()=>{const n=document.getElementById("macro-age"),s=document.getElementById("macro-gender"),i=document.getElementById("macro-height"),o=[];if(n!=null&&n.value||o.push("Age"),(!(s!=null&&s.value)||(s==null?void 0:s.value)==="")&&o.push("Gender"),i!=null&&i.value||o.push("Height"),o.length>0){const c=o.join(", ");ag(`💡 Tip: Fill out your profile in Settings to auto-populate ${c}`)}else Nl()},500);const r=ir(),t=(r==null?void 0:r.id)||"anonymous",a=localStorage.getItem(`macroProfile_${t}`);if(a)try{const n=JSON.parse(a);if(console.log("📦 Found localStorage macro profile:",n),!e)console.log("⚠️ No Supabase profile, using full localStorage profile"),Co(n);else{console.log("✅ Using Supabase profile + localStorage macro settings");const s=document.getElementById("macro-weight"),i=document.getElementById("macro-activity"),o=document.getElementById("macro-lossRate"),c=document.getElementById("macro-proteinRatio"),l=document.getElementById("macro-fatRatio");i&&(i.value=n.activity.toString()),o&&(o.value=n.lossRate.toString()),c&&(c.value=n.proteinRatio.toString()),l&&(l.value=n.fatRatio.toString()),console.log("ℹ️ Skipped loading weight from localStorage - user should enter manually")}}catch(n){console.error("Error loading saved macro profile:",n)}}catch(e){console.error("Error loading profile from database:",e);const r=ir(),t=(r==null?void 0:r.id)||"anonymous",a=localStorage.getItem(`macroProfile_${t}`);if(a)try{const n=JSON.parse(a);Co(n)}catch(n){console.error("Error loading saved macro profile:",n)}}}function Zh(){const e=document.getElementById("macro-activity"),r=document.getElementById("macro-lossRate"),t=document.getElementById("macro-proteinRatio"),a=document.getElementById("macro-fatRatio");e&&!e.value&&(e.value="1.55"),r&&!r.value&&(r.value="0"),t&&!t.value&&(t.value="2.2"),a&&!a.value&&(a.value="0.8")}function Co(e){const r=document.getElementById("macro-age"),t=document.getElementById("macro-gender"),a=document.getElementById("macro-weight"),n=document.getElementById("macro-height"),s=document.getElementById("macro-activity"),i=document.getElementById("macro-lossRate"),o=document.getElementById("macro-proteinRatio"),c=document.getElementById("macro-fatRatio");r&&(r.value=e.age.toString()),t&&(t.value=e.gender),a&&(a.value=e.weight.toString()),n&&(n.value=e.height.toString()),s&&(s.value=e.activity.toString()),i&&(i.value=e.lossRate.toString()),o&&(o.value=e.proteinRatio.toString()),c&&(c.value=e.fatRatio.toString())}function eg(){const e=document.getElementById("macro-age"),r=document.getElementById("macro-gender"),t=document.getElementById("macro-weight"),a=document.getElementById("macro-height"),n=document.getElementById("macro-activity"),s=document.getElementById("macro-lossRate"),i=document.getElementById("macro-proteinRatio"),o=document.getElementById("macro-fatRatio"),c=parseFloat((e==null?void 0:e.value)||"0"),l=(r==null?void 0:r.value)||"male",f=parseFloat((t==null?void 0:t.value)||"0"),u=parseFloat((a==null?void 0:a.value)||"0"),d=parseFloat((n==null?void 0:n.value)||"1.55"),h=parseFloat((s==null?void 0:s.value)||"0"),g=parseFloat((i==null?void 0:i.value)||"2.2"),p=parseFloat((o==null?void 0:o.value)||"0.8");if(!c||!f||!u){Cr("Please fill in all required fields (Age, Weight, Height)","error");return}if(c<10||c>120){Cr("Please enter a valid age between 10 and 120","error");return}if(f<20||f>300){Cr("Please enter a valid weight between 20 and 300 kg","error");return}if(u<100||u>250){Cr("Please enter a valid height between 100 and 250 cm","error");return}let m;l==="male"?m=10*f+6.25*u-5*c+5:m=10*f+6.25*u-5*c-161;let _=m*d;const b=_+h;let v=f*g,C=f*p,R=(b-v*4-C*9)/4;v=Math.max(0,Math.round(v)),C=Math.max(0,Math.round(C)),R=Math.max(10,Math.round(R));const I={protein:v,carbs:R,fat:C,calories:Math.round(b),bmr:Math.round(m),tdee:Math.round(_)};tg(I),Cr("Macro calculations completed successfully!","success")}function tg(e){const r=document.getElementById("protein-value"),t=document.getElementById("carbs-value"),a=document.getElementById("fat-value"),n=document.getElementById("calories-value"),s=document.getElementById("bmr-value"),i=document.getElementById("tdee-value"),o=document.getElementById("adjusted-calories"),c=document.getElementById("macro-results"),l=document.getElementById("macro-explanation");r&&(r.textContent=`${e.protein}g`),t&&(t.textContent=`${e.carbs}g`),a&&(a.textContent=`${e.fat}g`),n&&(n.textContent=e.calories.toString()),s&&(s.textContent=e.bmr.toString()),i&&(i.textContent=e.tdee.toString()),o&&(o.textContent=e.calories.toString()),c&&(c.style.display="grid",c.classList.add("show-results")),l&&(l.style.display="block")}function rg(){const e=document.getElementById("macro-age"),r=document.getElementById("macro-gender"),t=document.getElementById("macro-weight"),a=document.getElementById("macro-height"),n=document.getElementById("macro-activity"),s=document.getElementById("macro-lossRate"),i=document.getElementById("macro-proteinRatio"),o=document.getElementById("macro-fatRatio"),c={age:parseFloat((e==null?void 0:e.value)||"0"),gender:(r==null?void 0:r.value)||"male",weight:parseFloat((t==null?void 0:t.value)||"0"),height:parseFloat((a==null?void 0:a.value)||"0"),activity:parseFloat((n==null?void 0:n.value)||"1.55"),lossRate:parseFloat((s==null?void 0:s.value)||"0"),proteinRatio:parseFloat((i==null?void 0:i.value)||"2.2"),fatRatio:parseFloat((o==null?void 0:o.value)||"0.8")};if(!c.age||!c.weight||!c.height){Cr("Please fill in all required fields before saving","error");return}const l=ir(),f=(l==null?void 0:l.id)||"anonymous";try{localStorage.setItem(`macroProfile_${f}`,JSON.stringify(c)),Cr("Macro profile saved successfully!","success")}catch(u){console.error("Error saving macro profile:",u),Cr("Error saving macro profile","error")}}function Cr(e,r="success"){let t=document.getElementById("macro-message");if(!t){t=document.createElement("div"),t.id="macro-message",t.className="message";const a=document.getElementById("macro-calculator")||document.body;a.insertBefore(t,a.firstChild)}t.textContent=e,t.className=`message ${r}`,t.style.display="block",setTimeout(()=>{t&&(t.style.display="none")},4e3)}function ag(e){let r=document.getElementById("macro-profile-tip");if(!r){r=document.createElement("div"),r.id="macro-profile-tip",r.className="message warning";const t=document.getElementById("macro-calculator")||document.body;t.insertBefore(r,t.firstChild)}r.textContent=e,r.className="message warning",r.style.display="block"}function Nl(){const e=document.getElementById("macro-profile-tip");e&&(e.style.display="none")}function Fs(e,r){var n;const t=(n=e.parentElement)==null?void 0:n.querySelector(".profile-indicator");t&&t.remove();const a=document.createElement("span");a.className="profile-indicator",a.innerHTML="👤",a.title=r,a.style.marginLeft="8px",a.style.color="#10b981",a.style.fontSize="14px",a.style.cursor="help",a.style.filter="grayscale(0.3) brightness(1.2)",e.style.borderLeft="3px solid #10b981",e.parentElement&&(e.parentElement.style.position="relative",e.parentElement.appendChild(a))}window.calculateMacros=eg;window.saveMacroProfile=rg;/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var $l=1252,ng=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Ai={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},bi=function(e){ng.indexOf(e)!=-1&&($l=Ai[0]=e)};function sg(){bi(1252)}var Zt=function(e){bi(e)};function Ul(){Zt(1200),sg()}function Io(e){for(var r=[],t=0,a=e.length;t<a;++t)r[t]=e.charCodeAt(t);return r}function ig(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return r.join("")}function jl(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return r.join("")}var Ha=function(e){var r=e.charCodeAt(0),t=e.charCodeAt(1);return r==255&&t==254?ig(e.slice(2)):r==254&&t==255?jl(e.slice(2)):r==65279?e.slice(1):e},Ln=function(r){return String.fromCharCode(r)},Po=function(r){return String.fromCharCode(r)},cn,Dr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Do(e){for(var r="",t=0,a=0,n=0,s=0,i=0,o=0,c=0,l=0;l<e.length;)t=e.charCodeAt(l++),s=t>>2,a=e.charCodeAt(l++),i=(t&3)<<4|a>>4,n=e.charCodeAt(l++),o=(a&15)<<2|n>>6,c=n&63,isNaN(a)?o=c=64:isNaN(n)&&(c=64),r+=Dr.charAt(s)+Dr.charAt(i)+Dr.charAt(o)+Dr.charAt(c);return r}function Nt(e){var r="",t=0,a=0,n=0,s=0,i=0,o=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)s=Dr.indexOf(e.charAt(l++)),i=Dr.indexOf(e.charAt(l++)),t=s<<2|i>>4,r+=String.fromCharCode(t),o=Dr.indexOf(e.charAt(l++)),a=(i&15)<<4|o>>2,o!==64&&(r+=String.fromCharCode(a)),c=Dr.indexOf(e.charAt(l++)),n=(o&3)<<6|c,c!==64&&(r+=String.fromCharCode(n));return r}var _e=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),sa=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(r,t){return t?new Buffer(r,t):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}}();function Mr(e){return _e?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Oo(e){return _e?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Qt=function(r){return _e?sa(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)&255})};function ia(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var r=[],t=0;t<e.length;++t)r[t]=String.fromCharCode(e[t]);return r.join("")}function Fi(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Fi(new Uint8Array(e));for(var r=new Array(e.length),t=0;t<e.length;++t)r[t]=e[t];return r}var Ir=_e?function(e){return Buffer.concat(e.map(function(r){return Buffer.isBuffer(r)?r:sa(r)}))}:function(e){if(typeof Uint8Array<"u"){var r=0,t=0;for(r=0;r<e.length;++r)t+=e[r].length;var a=new Uint8Array(t),n=0;for(r=0,t=0;r<e.length;t+=n,++r)if(n=e[r].length,e[r]instanceof Uint8Array)a.set(e[r],t);else{if(typeof e[r]=="string")throw"wtf";a.set(new Uint8Array(e[r]),t)}return a}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function og(e){for(var r=[],t=0,a=e.length+250,n=Mr(e.length+255),s=0;s<e.length;++s){var i=e.charCodeAt(s);if(i<128)n[t++]=i;else if(i<2048)n[t++]=192|i>>6&31,n[t++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=e.charCodeAt(++s)&1023;n[t++]=240|i>>8&7,n[t++]=128|i>>2&63,n[t++]=128|o>>6&15|(i&3)<<4,n[t++]=128|o&63}else n[t++]=224|i>>12&15,n[t++]=128|i>>6&63,n[t++]=128|i&63;t>a&&(r.push(n.slice(0,t)),t=0,n=Mr(65535),a=65530)}return r.push(n.slice(0,t)),Ir(r)}var St=/\u0000/g,Wa=/[\u0001-\u0006]/g;function ya(e){for(var r="",t=e.length-1;t>=0;)r+=e.charAt(t--);return r}function er(e,r){var t=""+e;return t.length>=r?t:je("0",r-t.length)+t}function Ci(e,r){var t=""+e;return t.length>=r?t:je(" ",r-t.length)+t}function qn(e,r){var t=""+e;return t.length>=r?t:t+je(" ",r-t.length)}function cg(e,r){var t=""+Math.round(e);return t.length>=r?t:je("0",r-t.length)+t}function lg(e,r){var t=""+e;return t.length>=r?t:je("0",r-t.length)+t}var Ro=Math.pow(2,32);function pa(e,r){if(e>Ro||e<-Ro)return cg(e,r);var t=Math.round(e);return lg(t,r)}function zn(e,r){return r=r||0,e.length>=7+r&&(e.charCodeAt(r)|32)===103&&(e.charCodeAt(r+1)|32)===101&&(e.charCodeAt(r+2)|32)===110&&(e.charCodeAt(r+3)|32)===101&&(e.charCodeAt(r+4)|32)===114&&(e.charCodeAt(r+5)|32)===97&&(e.charCodeAt(r+6)|32)===108}var Lo=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Cs=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function fg(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var me={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},Bo={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},ug={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Kn(e,r,t){for(var a=e<0?-1:1,n=e*a,s=0,i=1,o=0,c=1,l=0,f=0,u=Math.floor(n);l<r&&(u=Math.floor(n),o=u*i+s,f=u*l+c,!(n-u<5e-8));)n=1/(n-u),s=i,i=o,c=l,l=f;if(f>r&&(l>r?(f=c,o=s):(f=l,o=i)),!t)return[0,a*o,f];var d=Math.floor(a*o/f);return[d,a*o-d*f,f]}function Xr(e,r,t){if(e>2958465||e<0)return null;var a=e|0,n=Math.floor(86400*(e-a)),s=0,i=[],o={D:a,T:n,u:86400*(e-a)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),r&&r.date1904&&(a+=1462),o.u>.9999&&(o.u=0,++n==86400&&(o.T=n=0,++a,++o.D)),a===60)i=t?[1317,10,29]:[1900,2,29],s=3;else if(a===0)i=t?[1317,8,29]:[1900,1,0],s=6;else{a>60&&--a;var c=new Date(1900,0,1);c.setDate(c.getDate()+a-1),i=[c.getFullYear(),c.getMonth()+1,c.getDate()],s=c.getDay(),a<60&&(s=(s+6)%7),t&&(s=xg(c,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=n%60,n=Math.floor(n/60),o.M=n%60,n=Math.floor(n/60),o.H=n,o.q=s,o}var Hl=new Date(1899,11,31,0,0,0),dg=Hl.getTime(),hg=new Date(1900,2,1,0,0,0);function Wl(e,r){var t=e.getTime();return r?t-=1461*24*60*60*1e3:e>=hg&&(t+=24*60*60*1e3),(t-(dg+(e.getTimezoneOffset()-Hl.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Ii(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function gg(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function pg(e){var r=e<0?12:11,t=Ii(e.toFixed(12));return t.length<=r||(t=e.toPrecision(10),t.length<=r)?t:e.toExponential(5)}function mg(e){var r=Ii(e.toFixed(11));return r.length>(e<0?12:11)||r==="0"||r==="-0"?e.toPrecision(6):r}function ln(e){var r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return r>=-4&&r<=-1?t=e.toPrecision(10+r):Math.abs(r)<=9?t=pg(e):r===10?t=e.toFixed(10).substr(0,12):t=mg(e),Ii(gg(t.toUpperCase()))}function ea(e,r){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):ln(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return qt(14,Wl(e,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+e)}function xg(e,r){r[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function vg(e,r,t,a){var n="",s=0,i=0,o=t.y,c,l=0;switch(e){case 98:o=t.y+543;case 121:switch(r.length){case 1:case 2:c=o%100,l=2;break;default:c=o%1e4,l=4;break}break;case 109:switch(r.length){case 1:case 2:c=t.m,l=r.length;break;case 3:return Cs[t.m-1][1];case 5:return Cs[t.m-1][0];default:return Cs[t.m-1][2]}break;case 100:switch(r.length){case 1:case 2:c=t.d,l=r.length;break;case 3:return Lo[t.q][0];default:return Lo[t.q][1]}break;case 104:switch(r.length){case 1:case 2:c=1+(t.H+11)%12,l=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:c=t.H,l=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:c=t.M,l=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return t.u===0&&(r=="s"||r=="ss")?er(t.S,r.length):(a>=2?i=a===3?1e3:100:i=a===1?10:1,s=Math.round(i*(t.S+t.u)),s>=60*i&&(s=0),r==="s"?s===0?"0":""+s/i:(n=er(s,2+a),r==="ss"?n.substr(0,2):"."+n.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":c=t.D*24+t.H;break;case"[m]":case"[mm]":c=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":c=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+r}l=r.length===3?1:2;break;case 101:c=o,l=1;break}var f=l>0?er(c,l):"";return f}function Or(e){var r=3;if(e.length<=r)return e;for(var t=e.length%r,a=e.substr(0,t);t!=e.length;t+=r)a+=(a.length>0?",":"")+e.substr(t,r);return a}var Vl=/%/g;function wg(e,r,t){var a=r.replace(Vl,""),n=r.length-a.length;return xr(e,a,t*Math.pow(10,2*n))+je("%",n)}function yg(e,r,t){for(var a=r.length-1;r.charCodeAt(a-1)===44;)--a;return xr(e,r.substr(0,a),t/Math.pow(10,3*(r.length-a)))}function Gl(e,r){var t,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+Gl(e,-r);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var s=Math.floor(Math.log(r)*Math.LOG10E)%n;if(s<0&&(s+=n),t=(r/Math.pow(10,s)).toPrecision(a+1+(n+s)%n),t.indexOf("e")===-1){var i=Math.floor(Math.log(r)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(i-t.length+s):t+="E+"+(i-s);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,n)+"."+t.substr(2+n),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,f){return c+l+f.substr(0,(n+s)%n)+"."+f.substr(s)+"E"})}else t=r.toExponential(a);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var ql=/# (\?+)( ?)\/( ?)(\d+)/;function _g(e,r,t){var a=parseInt(e[4],10),n=Math.round(r*a),s=Math.floor(n/a),i=n-s*a,o=a;return t+(s===0?"":""+s)+" "+(i===0?je(" ",e[1].length+1+e[4].length):Ci(i,e[1].length)+e[2]+"/"+e[3]+er(o,e[4].length))}function Eg(e,r,t){return t+(r===0?"":""+r)+je(" ",e[1].length+2+e[4].length)}var zl=/^#*0*\.([0#]+)/,Kl=/\).*[0#]/,Xl=/\(###\) ###\\?-####/;function yt(e){for(var r="",t,a=0;a!=e.length;++a)switch(t=e.charCodeAt(a)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function Mo(e,r){var t=Math.pow(10,r);return""+Math.round(e*t)/t}function No(e,r){var t=e-Math.floor(e),a=Math.pow(10,r);return r<(""+Math.round(t*a)).length?0:Math.round(t*a)}function kg(e,r){return r<(""+Math.round((e-Math.floor(e))*Math.pow(10,r))).length?1:0}function Tg(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Ht(e,r,t){if(e.charCodeAt(0)===40&&!r.match(Kl)){var a=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Ht("n",a,t):"("+Ht("n",a,-t)+")"}if(r.charCodeAt(r.length-1)===44)return yg(e,r,t);if(r.indexOf("%")!==-1)return wg(e,r,t);if(r.indexOf("E")!==-1)return Gl(r,t);if(r.charCodeAt(0)===36)return"$"+Ht(e,r.substr(r.charAt(1)==" "?2:1),t);var n,s,i,o,c=Math.abs(t),l=t<0?"-":"";if(r.match(/^00+$/))return l+pa(c,r.length);if(r.match(/^[#?]+$/))return n=pa(t,0),n==="0"&&(n=""),n.length>r.length?n:yt(r.substr(0,r.length-n.length))+n;if(s=r.match(ql))return _g(s,c,l);if(r.match(/^#+0+$/))return l+pa(c,r.length-r.indexOf("0"));if(s=r.match(zl))return n=Mo(t,s[1].length).replace(/^([^\.]+)$/,"$1."+yt(s[1])).replace(/\.$/,"."+yt(s[1])).replace(/\.(\d*)$/,function(g,p){return"."+p+je("0",yt(s[1]).length-p.length)}),r.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),s=r.match(/^(0*)\.(#*)$/))return l+Mo(c,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=r.match(/^#{1,3},##0(\.?)$/))return l+Or(pa(c,0));if(s=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Ht(e,r,-t):Or(""+(Math.floor(t)+kg(t,s[1].length)))+"."+er(No(t,s[1].length),s[1].length);if(s=r.match(/^#,#*,#0/))return Ht(e,r.replace(/^#,#*,/,""),t);if(s=r.match(/^([0#]+)(\\?-([0#]+))+$/))return n=ya(Ht(e,r.replace(/[\\-]/g,""),t)),i=0,ya(ya(r.replace(/\\/g,"")).replace(/[0#]/g,function(g){return i<n.length?n.charAt(i++):g==="0"?"0":""}));if(r.match(Xl))return n=Ht(e,"##########",t),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var f="";if(s=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=Kn(c,Math.pow(10,i)-1,!1),n=""+l,f=xr("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),n+=f+s[2]+"/"+s[3],f=qn(o[2],i),f.length<s[4].length&&(f=yt(s[4].substr(s[4].length-f.length))+f),n+=f,n;if(s=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=Kn(c,Math.pow(10,i)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Ci(o[1],i)+s[2]+"/"+s[3]+qn(o[2],i):je(" ",2*i+1+s[2].length+s[3].length));if(s=r.match(/^[#0?]+$/))return n=pa(t,0),r.length<=n.length?n:yt(r.substr(0,r.length-n.length))+n;if(s=r.match(/^([#0?]+)\.([#0]+)$/)){n=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=n.indexOf(".");var u=r.indexOf(".")-i,d=r.length-n.length-u;return yt(r.substr(0,u)+n+r.substr(r.length-d))}if(s=r.match(/^00,000\.([#0]*0)$/))return i=No(t,s[1].length),t<0?"-"+Ht(e,r,-t):Or(Tg(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?er(0,3-g.length):"")+g})+"."+er(i,s[1].length);switch(r){case"###,##0.00":return Ht(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var h=Or(pa(c,0));return h!=="0"?l+h:"";case"###,###.00":return Ht(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return Ht(e,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function Sg(e,r,t){for(var a=r.length-1;r.charCodeAt(a-1)===44;)--a;return xr(e,r.substr(0,a),t/Math.pow(10,3*(r.length-a)))}function Ag(e,r,t){var a=r.replace(Vl,""),n=r.length-a.length;return xr(e,a,t*Math.pow(10,2*n))+je("%",n)}function Yl(e,r){var t,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+Yl(e,-r);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var s=Math.floor(Math.log(r)*Math.LOG10E)%n;if(s<0&&(s+=n),t=(r/Math.pow(10,s)).toPrecision(a+1+(n+s)%n),!t.match(/[Ee]/)){var i=Math.floor(Math.log(r)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(i-t.length+s):t+="E+"+(i-s),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,f){return c+l+f.substr(0,(n+s)%n)+"."+f.substr(s)+"E"})}else t=r.toExponential(a);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function sr(e,r,t){if(e.charCodeAt(0)===40&&!r.match(Kl)){var a=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?sr("n",a,t):"("+sr("n",a,-t)+")"}if(r.charCodeAt(r.length-1)===44)return Sg(e,r,t);if(r.indexOf("%")!==-1)return Ag(e,r,t);if(r.indexOf("E")!==-1)return Yl(r,t);if(r.charCodeAt(0)===36)return"$"+sr(e,r.substr(r.charAt(1)==" "?2:1),t);var n,s,i,o,c=Math.abs(t),l=t<0?"-":"";if(r.match(/^00+$/))return l+er(c,r.length);if(r.match(/^[#?]+$/))return n=""+t,t===0&&(n=""),n.length>r.length?n:yt(r.substr(0,r.length-n.length))+n;if(s=r.match(ql))return Eg(s,c,l);if(r.match(/^#+0+$/))return l+er(c,r.length-r.indexOf("0"));if(s=r.match(zl))return n=(""+t).replace(/^([^\.]+)$/,"$1."+yt(s[1])).replace(/\.$/,"."+yt(s[1])),n=n.replace(/\.(\d*)$/,function(g,p){return"."+p+je("0",yt(s[1]).length-p.length)}),r.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),s=r.match(/^(0*)\.(#*)$/))return l+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=r.match(/^#{1,3},##0(\.?)$/))return l+Or(""+c);if(s=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+sr(e,r,-t):Or(""+t)+"."+je("0",s[1].length);if(s=r.match(/^#,#*,#0/))return sr(e,r.replace(/^#,#*,/,""),t);if(s=r.match(/^([0#]+)(\\?-([0#]+))+$/))return n=ya(sr(e,r.replace(/[\\-]/g,""),t)),i=0,ya(ya(r.replace(/\\/g,"")).replace(/[0#]/g,function(g){return i<n.length?n.charAt(i++):g==="0"?"0":""}));if(r.match(Xl))return n=sr(e,"##########",t),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var f="";if(s=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=Kn(c,Math.pow(10,i)-1,!1),n=""+l,f=xr("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),n+=f+s[2]+"/"+s[3],f=qn(o[2],i),f.length<s[4].length&&(f=yt(s[4].substr(s[4].length-f.length))+f),n+=f,n;if(s=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=Kn(c,Math.pow(10,i)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Ci(o[1],i)+s[2]+"/"+s[3]+qn(o[2],i):je(" ",2*i+1+s[2].length+s[3].length));if(s=r.match(/^[#0?]+$/))return n=""+t,r.length<=n.length?n:yt(r.substr(0,r.length-n.length))+n;if(s=r.match(/^([#0]+)\.([#0]+)$/)){n=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=n.indexOf(".");var u=r.indexOf(".")-i,d=r.length-n.length-u;return yt(r.substr(0,u)+n+r.substr(r.length-d))}if(s=r.match(/^00,000\.([#0]*0)$/))return t<0?"-"+sr(e,r,-t):Or(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?er(0,3-g.length):"")+g})+"."+er(0,s[1].length);switch(r){case"###,###":case"##,###":case"#,###":var h=Or(""+c);return h!=="0"?l+h:"";default:if(r.match(/\.[0#?]*$/))return sr(e,r.slice(0,r.lastIndexOf(".")),t)+yt(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function xr(e,r,t){return(t|0)===t?sr(e,r,t):Ht(e,r,t)}function bg(e){for(var r=[],t=!1,a=0,n=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:t=!t;break;case 95:case 42:case 92:++a;break;case 59:r[r.length]=e.substr(n,a-n),n=a+1}if(r[r.length]=e.substr(n),t===!0)throw new Error("Format |"+e+"| unterminated string ");return r}var Jl=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Ia(e){for(var r=0,t="",a="";r<e.length;)switch(t=e.charAt(r)){case"G":zn(e,r)&&(r+=6),r++;break;case'"':for(;e.charCodeAt(++r)!==34&&r<e.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(e.charAt(r+1)==="1"||e.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(r,3).toUpperCase()==="A/P"||e.substr(r,5).toUpperCase()==="AM/PM"||e.substr(r,5).toUpperCase()==="上午/下午")return!0;++r;break;case"[":for(a=t;e.charAt(r++)!=="]"&&r<e.length;)a+=e.charAt(r);if(a.match(Jl))return!0;break;case".":case"0":case"#":for(;r<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++r))>-1||t=="\\"&&e.charAt(r+1)=="-"&&"0#".indexOf(e.charAt(r+2))>-1););break;case"?":for(;e.charAt(++r)===t;);break;case"*":++r,(e.charAt(r)==" "||e.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<e.length&&"0123456789".indexOf(e.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function Fg(e,r,t,a){for(var n=[],s="",i=0,o="",c="t",l,f,u,d="H";i<e.length;)switch(o=e.charAt(i)){case"G":if(!zn(e,i))throw new Error("unrecognized character "+o+" in "+e);n[n.length]={t:"G",v:"General"},i+=7;break;case'"':for(s="";(u=e.charCodeAt(++i))!==34&&i<e.length;)s+=String.fromCharCode(u);n[n.length]={t:"t",v:s},++i;break;case"\\":var h=e.charAt(++i),g=h==="("||h===")"?h:"t";n[n.length]={t:g,v:h},++i;break;case"_":n[n.length]={t:"t",v:" "},i+=2;break;case"@":n[n.length]={t:"T",v:r},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(l==null&&(l=Xr(r,t,e.charAt(i+1)==="2"),l==null))return"";n[n.length]={t:"X",v:e.substr(i,2)},c=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||l==null&&(l=Xr(r,t),l==null))return"";for(s=o;++i<e.length&&e.charAt(i).toLowerCase()===o;)s+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=d),n[n.length]={t:o,v:s},c=o;break;case"A":case"a":case"上":var p={t:o,v:o};if(l==null&&(l=Xr(r,t)),e.substr(i,3).toUpperCase()==="A/P"?(l!=null&&(p.v=l.H>=12?"P":"A"),p.t="T",d="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(l!=null&&(p.v=l.H>=12?"PM":"AM"),p.t="T",i+=5,d="h"):e.substr(i,5).toUpperCase()==="上午/下午"?(l!=null&&(p.v=l.H>=12?"下午":"上午"),p.t="T",i+=5,d="h"):(p.t="t",++i),l==null&&p.t==="T")return"";n[n.length]=p,c=o;break;case"[":for(s=o;e.charAt(i++)!=="]"&&i<e.length;)s+=e.charAt(i);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(Jl)){if(l==null&&(l=Xr(r,t),l==null))return"";n[n.length]={t:"Z",v:s.toLowerCase()},c=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Ia(e)||(n[n.length]={t:"t",v:s}));break;case".":if(l!=null){for(s=o;++i<e.length&&(o=e.charAt(i))==="0";)s+=o;n[n.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++i<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(i))>-1;)s+=o;n[n.length]={t:"n",v:s};break;case"?":for(s=o;e.charAt(++i)===o;)s+=o;n[n.length]={t:o,v:s},c=o;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":n[n.length]={t:a===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)s+=e.charAt(i);n[n.length]={t:"D",v:s};break;case" ":n[n.length]={t:o,v:o},++i;break;case"$":n[n.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);n[n.length]={t:"t",v:o},++i;break}var m=0,_=0,b;for(i=n.length-1,c="t";i>=0;--i)switch(n[i].t){case"h":case"H":n[i].t=d,c="h",m<1&&(m=1);break;case"s":(b=n[i].v.match(/\.0+$/))&&(_=Math.max(_,b[0].length-1)),m<3&&(m=3);case"d":case"y":case"M":case"e":c=n[i].t;break;case"m":c==="s"&&(n[i].t="M",m<2&&(m=2));break;case"X":break;case"Z":m<1&&n[i].v.match(/[Hh]/)&&(m=1),m<2&&n[i].v.match(/[Mm]/)&&(m=2),m<3&&n[i].v.match(/[Ss]/)&&(m=3)}switch(m){case 0:break;case 1:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M),l.M>=60&&(l.M=0,++l.H);break;case 2:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M);break}var v="",C;for(i=0;i<n.length;++i)switch(n[i].t){case"t":case"T":case" ":case"D":break;case"X":n[i].v="",n[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[i].v=vg(n[i].t.charCodeAt(0),n[i].v,l,_),n[i].t="t";break;case"n":case"?":for(C=i+1;n[C]!=null&&((o=n[C].t)==="?"||o==="D"||(o===" "||o==="t")&&n[C+1]!=null&&(n[C+1].t==="?"||n[C+1].t==="t"&&n[C+1].v==="/")||n[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(n[C].v==="/"||n[C].v===" "&&n[C+1]!=null&&n[C+1].t=="?"));)n[i].v+=n[C].v,n[C]={v:"",t:";"},++C;v+=n[i].v,i=C-1;break;case"G":n[i].t="t",n[i].v=ea(r,t);break}var R="",I,T;if(v.length>0){v.charCodeAt(0)==40?(I=r<0&&v.charCodeAt(0)===45?-r:r,T=xr("n",v,I)):(I=r<0&&a>1?-r:r,T=xr("n",v,I),I<0&&n[0]&&n[0].t=="t"&&(T=T.substr(1),n[0].v="-"+n[0].v)),C=T.length-1;var H=n.length;for(i=0;i<n.length;++i)if(n[i]!=null&&n[i].t!="t"&&n[i].v.indexOf(".")>-1){H=i;break}var P=n.length;if(H===n.length&&T.indexOf("E")===-1){for(i=n.length-1;i>=0;--i)n[i]==null||"n?".indexOf(n[i].t)===-1||(C>=n[i].v.length-1?(C-=n[i].v.length,n[i].v=T.substr(C+1,n[i].v.length)):C<0?n[i].v="":(n[i].v=T.substr(0,C+1),C=-1),n[i].t="t",P=i);C>=0&&P<n.length&&(n[P].v=T.substr(0,C+1)+n[P].v)}else if(H!==n.length&&T.indexOf("E")===-1){for(C=T.indexOf(".")-1,i=H;i>=0;--i)if(!(n[i]==null||"n?".indexOf(n[i].t)===-1)){for(f=n[i].v.indexOf(".")>-1&&i===H?n[i].v.indexOf(".")-1:n[i].v.length-1,R=n[i].v.substr(f+1);f>=0;--f)C>=0&&(n[i].v.charAt(f)==="0"||n[i].v.charAt(f)==="#")&&(R=T.charAt(C--)+R);n[i].v=R,n[i].t="t",P=i}for(C>=0&&P<n.length&&(n[P].v=T.substr(0,C+1)+n[P].v),C=T.indexOf(".")+1,i=H;i<n.length;++i)if(!(n[i]==null||"n?(".indexOf(n[i].t)===-1&&i!==H)){for(f=n[i].v.indexOf(".")>-1&&i===H?n[i].v.indexOf(".")+1:0,R=n[i].v.substr(0,f);f<n[i].v.length;++f)C<T.length&&(R+=T.charAt(C++));n[i].v=R,n[i].t="t",P=i}}}for(i=0;i<n.length;++i)n[i]!=null&&"n?".indexOf(n[i].t)>-1&&(I=a>1&&r<0&&i>0&&n[i-1].v==="-"?-r:r,n[i].v=xr(n[i].t,n[i].v,I),n[i].t="t");var q="";for(i=0;i!==n.length;++i)n[i]!=null&&(q+=n[i].v);return q}var $o=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Uo(e,r){if(r==null)return!1;var t=parseFloat(r[2]);switch(r[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function Cg(e,r){var t=bg(e),a=t.length,n=t[a-1].indexOf("@");if(a<4&&n>-1&&--a,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof r!="number")return[4,t.length===4||n>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=n>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=n>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=n>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var s=r>0?t[0]:r<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[a,s];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var i=t[0].match($o),o=t[1].match($o);return Uo(r,i)?[a,t[0]]:Uo(r,o)?[a,t[1]]:[a,t[i!=null&&o!=null?2:1]]}return[a,s]}function qt(e,r,t){t==null&&(t={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?a=t.dateNF:a=e;break;case"number":e==14&&t.dateNF?a=t.dateNF:a=(t.table!=null?t.table:me)[e],a==null&&(a=t.table&&t.table[Bo[e]]||me[Bo[e]]),a==null&&(a=ug[e]||"General");break}if(zn(a,0))return ea(r,t);r instanceof Date&&(r=Wl(r,t.date1904));var n=Cg(a,r);if(zn(n[1]))return ea(r,t);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return Fg(n[1],r,t,n[0])}function Yr(e,r){if(typeof r!="number"){r=+r||-1;for(var t=0;t<392;++t){if(me[t]==null){r<0&&(r=t);continue}if(me[t]==e){r=t;break}}r<0&&(r=391)}return me[r]=e,r}function Ql(){me=fg()}var Ig={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Zl=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Pg(e){var r=typeof e=="number"?me[e]:e;return r=r.replace(Zl,"(\\d+)"),new RegExp("^"+r+"$")}function Dg(e,r,t){var a=-1,n=-1,s=-1,i=-1,o=-1,c=-1;(r.match(Zl)||[]).forEach(function(u,d){var h=parseInt(t[d+1],10);switch(u.toLowerCase().charAt(0)){case"y":a=h;break;case"d":s=h;break;case"h":i=h;break;case"s":c=h;break;case"m":i>=0?o=h:n=h;break}}),c>=0&&o==-1&&n>=0&&(o=n,n=-1);var l=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);l.length==7&&(l="0"+l),l.length==8&&(l="20"+l);var f=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return i==-1&&o==-1&&c==-1?l:a==-1&&n==-1&&s==-1?f:l+"T"+f}var Og=function(){var e={};e.version="1.2.0";function r(){for(var T=0,H=new Array(256),P=0;P!=256;++P)T=P,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,H[P]=T;return typeof Int32Array<"u"?new Int32Array(H):H}var t=r();function a(T){var H=0,P=0,q=0,V=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(q=0;q!=256;++q)V[q]=T[q];for(q=0;q!=256;++q)for(P=T[q],H=256+q;H<4096;H+=256)P=V[H]=P>>>8^T[P&255];var L=[];for(q=1;q!=16;++q)L[q-1]=typeof Int32Array<"u"?V.subarray(q*256,q*256+256):V.slice(q*256,q*256+256);return L}var n=a(t),s=n[0],i=n[1],o=n[2],c=n[3],l=n[4],f=n[5],u=n[6],d=n[7],h=n[8],g=n[9],p=n[10],m=n[11],_=n[12],b=n[13],v=n[14];function C(T,H){for(var P=H^-1,q=0,V=T.length;q<V;)P=P>>>8^t[(P^T.charCodeAt(q++))&255];return~P}function R(T,H){for(var P=H^-1,q=T.length-15,V=0;V<q;)P=v[T[V++]^P&255]^b[T[V++]^P>>8&255]^_[T[V++]^P>>16&255]^m[T[V++]^P>>>24]^p[T[V++]]^g[T[V++]]^h[T[V++]]^d[T[V++]]^u[T[V++]]^f[T[V++]]^l[T[V++]]^c[T[V++]]^o[T[V++]]^i[T[V++]]^s[T[V++]]^t[T[V++]];for(q+=15;V<q;)P=P>>>8^t[(P^T[V++])&255];return~P}function I(T,H){for(var P=H^-1,q=0,V=T.length,L=0,J=0;q<V;)L=T.charCodeAt(q++),L<128?P=P>>>8^t[(P^L)&255]:L<2048?(P=P>>>8^t[(P^(192|L>>6&31))&255],P=P>>>8^t[(P^(128|L&63))&255]):L>=55296&&L<57344?(L=(L&1023)+64,J=T.charCodeAt(q++)&1023,P=P>>>8^t[(P^(240|L>>8&7))&255],P=P>>>8^t[(P^(128|L>>2&63))&255],P=P>>>8^t[(P^(128|J>>6&15|(L&3)<<4))&255],P=P>>>8^t[(P^(128|J&63))&255]):(P=P>>>8^t[(P^(224|L>>12&15))&255],P=P>>>8^t[(P^(128|L>>6&63))&255],P=P>>>8^t[(P^(128|L&63))&255]);return~P}return e.table=t,e.bstr=C,e.buf=R,e.str=I,e}(),Ee=function(){var r={};r.version="1.2.1";function t(x,E){for(var w=x.split("/"),y=E.split("/"),k=0,S=0,M=Math.min(w.length,y.length);k<M;++k){if(S=w[k].length-y[k].length)return S;if(w[k]!=y[k])return w[k]<y[k]?-1:1}return w.length-y.length}function a(x){if(x.charAt(x.length-1)=="/")return x.slice(0,-1).indexOf("/")===-1?x:a(x.slice(0,-1));var E=x.lastIndexOf("/");return E===-1?x:x.slice(0,E+1)}function n(x){if(x.charAt(x.length-1)=="/")return n(x.slice(0,-1));var E=x.lastIndexOf("/");return E===-1?x:x.slice(E+1)}function s(x,E){typeof E=="string"&&(E=new Date(E));var w=E.getHours();w=w<<6|E.getMinutes(),w=w<<5|E.getSeconds()>>>1,x.write_shift(2,w);var y=E.getFullYear()-1980;y=y<<4|E.getMonth()+1,y=y<<5|E.getDate(),x.write_shift(2,y)}function i(x){var E=x.read_shift(2)&65535,w=x.read_shift(2)&65535,y=new Date,k=w&31;w>>>=5;var S=w&15;w>>>=4,y.setMilliseconds(0),y.setFullYear(w+1980),y.setMonth(S-1),y.setDate(k);var M=E&31;E>>>=5;var G=E&63;return E>>>=6,y.setHours(E),y.setMinutes(G),y.setSeconds(M<<1),y}function o(x){st(x,0);for(var E={},w=0;x.l<=x.length-4;){var y=x.read_shift(2),k=x.read_shift(2),S=x.l+k,M={};switch(y){case 21589:w=x.read_shift(1),w&1&&(M.mtime=x.read_shift(4)),k>5&&(w&2&&(M.atime=x.read_shift(4)),w&4&&(M.ctime=x.read_shift(4))),M.mtime&&(M.mt=new Date(M.mtime*1e3));break}x.l=S,E[y]=M}return E}var c;function l(){return c||(c={})}function f(x,E){if(x[0]==80&&x[1]==75)return lo(x,E);if((x[0]|32)==109&&(x[1]|32)==105)return Kf(x,E);if(x.length<512)throw new Error("CFB file size "+x.length+" < 512");var w=3,y=512,k=0,S=0,M=0,G=0,B=0,N=[],j=x.slice(0,512);st(j,0);var X=u(j);switch(w=X[0],w){case 3:y=512;break;case 4:y=4096;break;case 0:if(X[1]==0)return lo(x,E);default:throw new Error("Major Version: Expected 3 or 4 saw "+w)}y!==512&&(j=x.slice(0,y),st(j,28));var ee=x.slice(0,y);d(j,w);var ie=j.read_shift(4,"i");if(w===3&&ie!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ie);j.l+=4,M=j.read_shift(4,"i"),j.l+=4,j.chk("00100000","Mini Stream Cutoff Size: "),G=j.read_shift(4,"i"),k=j.read_shift(4,"i"),B=j.read_shift(4,"i"),S=j.read_shift(4,"i");for(var Q=-1,ne=0;ne<109&&(Q=j.read_shift(4,"i"),!(Q<0));++ne)N[ne]=Q;var ge=h(x,y);m(B,S,ge,y,N);var Me=b(ge,M,N,y);Me[M].name="!Directory",k>0&&G!==J&&(Me[G].name="!MiniFAT"),Me[N[0]].name="!FAT",Me.fat_addrs=N,Me.ssz=y;var Ne={},ct=[],Ma=[],Na=[];v(M,Me,ge,ct,k,Ne,Ma,G),g(Ma,Na,ct),ct.shift();var $a={FileIndex:Ma,FullPaths:Na};return E&&E.raw&&($a.raw={header:ee,sectors:ge}),$a}function u(x){if(x[x.l]==80&&x[x.l+1]==75)return[0,0];x.chk(le,"Header Signature: "),x.l+=16;var E=x.read_shift(2,"u");return[x.read_shift(2,"u"),E]}function d(x,E){var w=9;switch(x.l+=2,w=x.read_shift(2)){case 9:if(E!=3)throw new Error("Sector Shift: Expected 9 saw "+w);break;case 12:if(E!=4)throw new Error("Sector Shift: Expected 12 saw "+w);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+w)}x.chk("0600","Mini Sector Shift: "),x.chk("000000000000","Reserved: ")}function h(x,E){for(var w=Math.ceil(x.length/E)-1,y=[],k=1;k<w;++k)y[k-1]=x.slice(k*E,(k+1)*E);return y[w-1]=x.slice(w*E),y}function g(x,E,w){for(var y=0,k=0,S=0,M=0,G=0,B=w.length,N=[],j=[];y<B;++y)N[y]=j[y]=y,E[y]=w[y];for(;G<j.length;++G)y=j[G],k=x[y].L,S=x[y].R,M=x[y].C,N[y]===y&&(k!==-1&&N[k]!==k&&(N[y]=N[k]),S!==-1&&N[S]!==S&&(N[y]=N[S])),M!==-1&&(N[M]=y),k!==-1&&y!=N[y]&&(N[k]=N[y],j.lastIndexOf(k)<G&&j.push(k)),S!==-1&&y!=N[y]&&(N[S]=N[y],j.lastIndexOf(S)<G&&j.push(S));for(y=1;y<B;++y)N[y]===y&&(S!==-1&&N[S]!==S?N[y]=N[S]:k!==-1&&N[k]!==k&&(N[y]=N[k]));for(y=1;y<B;++y)if(x[y].type!==0){if(G=y,G!=N[G])do G=N[G],E[y]=E[G]+"/"+E[y];while(G!==0&&N[G]!==-1&&G!=N[G]);N[y]=-1}for(E[0]+="/",y=1;y<B;++y)x[y].type!==2&&(E[y]+="/")}function p(x,E,w){for(var y=x.start,k=x.size,S=[],M=y;w&&k>0&&M>=0;)S.push(E.slice(M*L,M*L+L)),k-=L,M=Kr(w,M*4);return S.length===0?Je(0):Ir(S).slice(0,x.size)}function m(x,E,w,y,k){var S=J;if(x===J){if(E!==0)throw new Error("DIFAT chain shorter than expected")}else if(x!==-1){var M=w[x],G=(y>>>2)-1;if(!M)return;for(var B=0;B<G&&(S=Kr(M,B*4))!==J;++B)k.push(S);m(Kr(M,y-4),E-1,w,y,k)}}function _(x,E,w,y,k){var S=[],M=[];k||(k=[]);var G=y-1,B=0,N=0;for(B=E;B>=0;){k[B]=!0,S[S.length]=B,M.push(x[B]);var j=w[Math.floor(B*4/y)];if(N=B*4&G,y<4+N)throw new Error("FAT boundary crossed: "+B+" 4 "+y);if(!x[j])break;B=Kr(x[j],N)}return{nodes:S,data:Yo([M])}}function b(x,E,w,y){var k=x.length,S=[],M=[],G=[],B=[],N=y-1,j=0,X=0,ee=0,ie=0;for(j=0;j<k;++j)if(G=[],ee=j+E,ee>=k&&(ee-=k),!M[ee]){B=[];var Q=[];for(X=ee;X>=0;){Q[X]=!0,M[X]=!0,G[G.length]=X,B.push(x[X]);var ne=w[Math.floor(X*4/y)];if(ie=X*4&N,y<4+ie)throw new Error("FAT boundary crossed: "+X+" 4 "+y);if(!x[ne]||(X=Kr(x[ne],ie),Q[X]))break}S[ee]={nodes:G,data:Yo([B])}}return S}function v(x,E,w,y,k,S,M,G){for(var B=0,N=y.length?2:0,j=E[x].data,X=0,ee=0,ie;X<j.length;X+=128){var Q=j.slice(X,X+128);st(Q,64),ee=Q.read_shift(2),ie=Li(Q,0,ee-N),y.push(ie);var ne={name:ie,type:Q.read_shift(1),color:Q.read_shift(1),L:Q.read_shift(4,"i"),R:Q.read_shift(4,"i"),C:Q.read_shift(4,"i"),clsid:Q.read_shift(16),state:Q.read_shift(4,"i"),start:0,size:0},ge=Q.read_shift(2)+Q.read_shift(2)+Q.read_shift(2)+Q.read_shift(2);ge!==0&&(ne.ct=C(Q,Q.l-8));var Me=Q.read_shift(2)+Q.read_shift(2)+Q.read_shift(2)+Q.read_shift(2);Me!==0&&(ne.mt=C(Q,Q.l-8)),ne.start=Q.read_shift(4,"i"),ne.size=Q.read_shift(4,"i"),ne.size<0&&ne.start<0&&(ne.size=ne.type=0,ne.start=J,ne.name=""),ne.type===5?(B=ne.start,k>0&&B!==J&&(E[B].name="!StreamData")):ne.size>=4096?(ne.storage="fat",E[ne.start]===void 0&&(E[ne.start]=_(w,ne.start,E.fat_addrs,E.ssz)),E[ne.start].name=ne.name,ne.content=E[ne.start].data.slice(0,ne.size)):(ne.storage="minifat",ne.size<0?ne.size=0:B!==J&&ne.start!==J&&E[B]&&(ne.content=p(ne,E[B].data,(E[G]||{}).data))),ne.content&&st(ne.content,0),S[ie]=ne,M.push(ne)}}function C(x,E){return new Date((Dt(x,E+4)/1e7*Math.pow(2,32)+Dt(x,E)/1e7-11644473600)*1e3)}function R(x,E){return l(),f(c.readFileSync(x),E)}function I(x,E){var w=E&&E.type;switch(w||_e&&Buffer.isBuffer(x)&&(w="buffer"),w||"base64"){case"file":return R(x,E);case"base64":return f(Qt(Nt(x)),E);case"binary":return f(Qt(x),E)}return f(x,E)}function T(x,E){var w=E||{},y=w.root||"Root Entry";if(x.FullPaths||(x.FullPaths=[]),x.FileIndex||(x.FileIndex=[]),x.FullPaths.length!==x.FileIndex.length)throw new Error("inconsistent CFB structure");x.FullPaths.length===0&&(x.FullPaths[0]=y+"/",x.FileIndex[0]={name:y,type:5}),w.CLSID&&(x.FileIndex[0].clsid=w.CLSID),H(x)}function H(x){var E="Sh33tJ5";if(!Ee.find(x,"/"+E)){var w=Je(4);w[0]=55,w[1]=w[3]=50,w[2]=54,x.FileIndex.push({name:E,type:2,content:w,size:4,L:69,R:69,C:69}),x.FullPaths.push(x.FullPaths[0]+E),P(x)}}function P(x,E){T(x);for(var w=!1,y=!1,k=x.FullPaths.length-1;k>=0;--k){var S=x.FileIndex[k];switch(S.type){case 0:y?w=!0:(x.FileIndex.pop(),x.FullPaths.pop());break;case 1:case 2:case 5:y=!0,isNaN(S.R*S.L*S.C)&&(w=!0),S.R>-1&&S.L>-1&&S.R==S.L&&(w=!0);break;default:w=!0;break}}if(!(!w&&!E)){var M=new Date(1987,1,19),G=0,B=Object.create?Object.create(null):{},N=[];for(k=0;k<x.FullPaths.length;++k)B[x.FullPaths[k]]=!0,x.FileIndex[k].type!==0&&N.push([x.FullPaths[k],x.FileIndex[k]]);for(k=0;k<N.length;++k){var j=a(N[k][0]);y=B[j],y||(N.push([j,{name:n(j).replace("/",""),type:1,clsid:ce,ct:M,mt:M,content:null}]),B[j]=!0)}for(N.sort(function(ie,Q){return t(ie[0],Q[0])}),x.FullPaths=[],x.FileIndex=[],k=0;k<N.length;++k)x.FullPaths[k]=N[k][0],x.FileIndex[k]=N[k][1];for(k=0;k<N.length;++k){var X=x.FileIndex[k],ee=x.FullPaths[k];if(X.name=n(ee).replace("/",""),X.L=X.R=X.C=-(X.color=1),X.size=X.content?X.content.length:0,X.start=0,X.clsid=X.clsid||ce,k===0)X.C=N.length>1?1:-1,X.size=0,X.type=5;else if(ee.slice(-1)=="/"){for(G=k+1;G<N.length&&a(x.FullPaths[G])!=ee;++G);for(X.C=G>=N.length?-1:G,G=k+1;G<N.length&&a(x.FullPaths[G])!=a(ee);++G);X.R=G>=N.length?-1:G,X.type=1}else a(x.FullPaths[k+1]||"")==a(ee)&&(X.R=k+1),X.type=2}}}function q(x,E){var w=E||{};if(w.fileType=="mad")return Xf(x,w);switch(P(x),w.fileType){case"zip":return Hf(x,w)}var y=function(ie){for(var Q=0,ne=0,ge=0;ge<ie.FileIndex.length;++ge){var Me=ie.FileIndex[ge];if(Me.content){var Ne=Me.content.length;Ne>0&&(Ne<4096?Q+=Ne+63>>6:ne+=Ne+511>>9)}}for(var ct=ie.FullPaths.length+3>>2,Ma=Q+7>>3,Na=Q+127>>7,$a=Ma+ne+ct+Na,Wr=$a+127>>7,_s=Wr<=109?0:Math.ceil((Wr-109)/127);$a+Wr+_s+127>>7>Wr;)_s=++Wr<=109?0:Math.ceil((Wr-109)/127);var dr=[1,_s,Wr,Na,ct,ne,Q,0];return ie.FileIndex[0].size=Q<<6,dr[7]=(ie.FileIndex[0].start=dr[0]+dr[1]+dr[2]+dr[3]+dr[4]+dr[5])+(dr[6]+7>>3),dr}(x),k=Je(y[7]<<9),S=0,M=0;{for(S=0;S<8;++S)k.write_shift(1,re[S]);for(S=0;S<8;++S)k.write_shift(2,0);for(k.write_shift(2,62),k.write_shift(2,3),k.write_shift(2,65534),k.write_shift(2,9),k.write_shift(2,6),S=0;S<3;++S)k.write_shift(2,0);for(k.write_shift(4,0),k.write_shift(4,y[2]),k.write_shift(4,y[0]+y[1]+y[2]+y[3]-1),k.write_shift(4,0),k.write_shift(4,4096),k.write_shift(4,y[3]?y[0]+y[1]+y[2]-1:J),k.write_shift(4,y[3]),k.write_shift(-4,y[1]?y[0]-1:J),k.write_shift(4,y[1]),S=0;S<109;++S)k.write_shift(-4,S<y[2]?y[1]+S:-1)}if(y[1])for(M=0;M<y[1];++M){for(;S<236+M*127;++S)k.write_shift(-4,S<y[2]?y[1]+S:-1);k.write_shift(-4,M===y[1]-1?J:M+1)}var G=function(ie){for(M+=ie;S<M-1;++S)k.write_shift(-4,S+1);ie&&(++S,k.write_shift(-4,J))};for(M=S=0,M+=y[1];S<M;++S)k.write_shift(-4,oe.DIFSECT);for(M+=y[2];S<M;++S)k.write_shift(-4,oe.FATSECT);G(y[3]),G(y[4]);for(var B=0,N=0,j=x.FileIndex[0];B<x.FileIndex.length;++B)j=x.FileIndex[B],j.content&&(N=j.content.length,!(N<4096)&&(j.start=M,G(N+511>>9)));for(G(y[6]+7>>3);k.l&511;)k.write_shift(-4,oe.ENDOFCHAIN);for(M=S=0,B=0;B<x.FileIndex.length;++B)j=x.FileIndex[B],j.content&&(N=j.content.length,!(!N||N>=4096)&&(j.start=M,G(N+63>>6)));for(;k.l&511;)k.write_shift(-4,oe.ENDOFCHAIN);for(S=0;S<y[4]<<2;++S){var X=x.FullPaths[S];if(!X||X.length===0){for(B=0;B<17;++B)k.write_shift(4,0);for(B=0;B<3;++B)k.write_shift(4,-1);for(B=0;B<12;++B)k.write_shift(4,0);continue}j=x.FileIndex[S],S===0&&(j.start=j.size?j.start-1:J);var ee=S===0&&w.root||j.name;if(N=2*(ee.length+1),k.write_shift(64,ee,"utf16le"),k.write_shift(2,N),k.write_shift(1,j.type),k.write_shift(1,j.color),k.write_shift(-4,j.L),k.write_shift(-4,j.R),k.write_shift(-4,j.C),j.clsid)k.write_shift(16,j.clsid,"hex");else for(B=0;B<4;++B)k.write_shift(4,0);k.write_shift(4,j.state||0),k.write_shift(4,0),k.write_shift(4,0),k.write_shift(4,0),k.write_shift(4,0),k.write_shift(4,j.start),k.write_shift(4,j.size),k.write_shift(4,0)}for(S=1;S<x.FileIndex.length;++S)if(j=x.FileIndex[S],j.size>=4096)if(k.l=j.start+1<<9,_e&&Buffer.isBuffer(j.content))j.content.copy(k,k.l,0,j.size),k.l+=j.size+511&-512;else{for(B=0;B<j.size;++B)k.write_shift(1,j.content[B]);for(;B&511;++B)k.write_shift(1,0)}for(S=1;S<x.FileIndex.length;++S)if(j=x.FileIndex[S],j.size>0&&j.size<4096)if(_e&&Buffer.isBuffer(j.content))j.content.copy(k,k.l,0,j.size),k.l+=j.size+63&-64;else{for(B=0;B<j.size;++B)k.write_shift(1,j.content[B]);for(;B&63;++B)k.write_shift(1,0)}if(_e)k.l=k.length;else for(;k.l<k.length;)k.write_shift(1,0);return k}function V(x,E){var w=x.FullPaths.map(function(B){return B.toUpperCase()}),y=w.map(function(B){var N=B.split("/");return N[N.length-(B.slice(-1)=="/"?2:1)]}),k=!1;E.charCodeAt(0)===47?(k=!0,E=w[0].slice(0,-1)+E):k=E.indexOf("/")!==-1;var S=E.toUpperCase(),M=k===!0?w.indexOf(S):y.indexOf(S);if(M!==-1)return x.FileIndex[M];var G=!S.match(Wa);for(S=S.replace(St,""),G&&(S=S.replace(Wa,"!")),M=0;M<w.length;++M)if((G?w[M].replace(Wa,"!"):w[M]).replace(St,"")==S||(G?y[M].replace(Wa,"!"):y[M]).replace(St,"")==S)return x.FileIndex[M];return null}var L=64,J=-2,le="d0cf11e0a1b11ae1",re=[208,207,17,224,161,177,26,225],ce="00000000000000000000000000000000",oe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:J,FREESECT:-1,HEADER_SIGNATURE:le,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ce,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Re(x,E,w){l();var y=q(x,w);c.writeFileSync(E,y)}function W(x){for(var E=new Array(x.length),w=0;w<x.length;++w)E[w]=String.fromCharCode(x[w]);return E.join("")}function ue(x,E){var w=q(x,E);switch(E&&E.type||"buffer"){case"file":return l(),c.writeFileSync(E.filename,w),w;case"binary":return typeof w=="string"?w:W(w);case"base64":return Do(typeof w=="string"?w:W(w));case"buffer":if(_e)return Buffer.isBuffer(w)?w:sa(w);case"array":return typeof w=="string"?Qt(w):w}return w}var de;function A(x){try{var E=x.InflateRaw,w=new E;if(w._processChunk(new Uint8Array([3,0]),w._finishFlushFlag),w.bytesRead)de=x;else throw new Error("zlib does not expose bytesRead")}catch(y){console.error("cannot use native zlib: "+(y.message||y))}}function U(x,E){if(!de)return oo(x,E);var w=de.InflateRaw,y=new w,k=y._processChunk(x.slice(x.l),y._finishFlushFlag);return x.l+=y.bytesRead,k}function O(x){return de?de.deflateRawSync(x):xe(x)}var D=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],z=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],te=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function se(x){var E=(x<<1|x<<11)&139536|(x<<5|x<<15)&558144;return(E>>16|E>>8|E)&255}for(var Z=typeof Uint8Array<"u",Y=Z?new Uint8Array(256):[],Te=0;Te<256;++Te)Y[Te]=se(Te);function F(x,E){var w=Y[x&255];return E<=8?w>>>8-E:(w=w<<8|Y[x>>8&255],E<=16?w>>>16-E:(w=w<<8|Y[x>>16&255],w>>>24-E))}function We(x,E){var w=E&7,y=E>>>3;return(x[y]|(w<=6?0:x[y+1]<<8))>>>w&3}function Ae(x,E){var w=E&7,y=E>>>3;return(x[y]|(w<=5?0:x[y+1]<<8))>>>w&7}function Pe(x,E){var w=E&7,y=E>>>3;return(x[y]|(w<=4?0:x[y+1]<<8))>>>w&15}function we(x,E){var w=E&7,y=E>>>3;return(x[y]|(w<=3?0:x[y+1]<<8))>>>w&31}function ae(x,E){var w=E&7,y=E>>>3;return(x[y]|(w<=1?0:x[y+1]<<8))>>>w&127}function Ve(x,E,w){var y=E&7,k=E>>>3,S=(1<<w)-1,M=x[k]>>>y;return w<8-y||(M|=x[k+1]<<8-y,w<16-y)||(M|=x[k+2]<<16-y,w<24-y)||(M|=x[k+3]<<24-y),M&S}function $t(x,E,w){var y=E&7,k=E>>>3;return y<=5?x[k]|=(w&7)<<y:(x[k]|=w<<y&255,x[k+1]=(w&7)>>8-y),E+3}function rr(x,E,w){var y=E&7,k=E>>>3;return w=(w&1)<<y,x[k]|=w,E+1}function fr(x,E,w){var y=E&7,k=E>>>3;return w<<=y,x[k]|=w&255,w>>>=8,x[k+1]=w,E+8}function La(x,E,w){var y=E&7,k=E>>>3;return w<<=y,x[k]|=w&255,w>>>=8,x[k+1]=w&255,x[k+2]=w>>>8,E+16}function kr(x,E){var w=x.length,y=2*w>E?2*w:E+5,k=0;if(w>=E)return x;if(_e){var S=Oo(y);if(x.copy)x.copy(S);else for(;k<x.length;++k)S[k]=x[k];return S}else if(Z){var M=new Uint8Array(y);if(M.set)M.set(x);else for(;k<w;++k)M[k]=x[k];return M}return x.length=y,x}function Pt(x){for(var E=new Array(x),w=0;w<x;++w)E[w]=0;return E}function ur(x,E,w){var y=1,k=0,S=0,M=0,G=0,B=x.length,N=Z?new Uint16Array(32):Pt(32);for(S=0;S<32;++S)N[S]=0;for(S=B;S<w;++S)x[S]=0;B=x.length;var j=Z?new Uint16Array(B):Pt(B);for(S=0;S<B;++S)N[k=x[S]]++,y<k&&(y=k),j[S]=0;for(N[0]=0,S=1;S<=y;++S)N[S+16]=G=G+N[S-1]<<1;for(S=0;S<B;++S)G=x[S],G!=0&&(j[S]=N[G+16]++);var X=0;for(S=0;S<B;++S)if(X=x[S],X!=0)for(G=F(j[S],y)>>y-X,M=(1<<y+4-X)-1;M>=0;--M)E[G|M<<X]=X&15|S<<4;return y}var Tr=Z?new Uint16Array(512):Pt(512),Ba=Z?new Uint16Array(32):Pt(32);if(!Z){for(var wt=0;wt<512;++wt)Tr[wt]=0;for(wt=0;wt<32;++wt)Ba[wt]=0}(function(){for(var x=[],E=0;E<32;E++)x.push(5);ur(x,Ba,32);var w=[];for(E=0;E<=143;E++)w.push(8);for(;E<=255;E++)w.push(9);for(;E<=279;E++)w.push(7);for(;E<=287;E++)w.push(8);ur(w,Tr,288)})();var ar=function(){for(var E=Z?new Uint8Array(32768):[],w=0,y=0;w<te.length-1;++w)for(;y<te[w+1];++y)E[y]=w;for(;y<32768;++y)E[y]=29;var k=Z?new Uint8Array(259):[];for(w=0,y=0;w<z.length-1;++w)for(;y<z[w+1];++y)k[y]=w;function S(G,B){for(var N=0;N<G.length;){var j=Math.min(65535,G.length-N),X=N+j==G.length;for(B.write_shift(1,+X),B.write_shift(2,j),B.write_shift(2,~j&65535);j-- >0;)B[B.l++]=G[N++]}return B.l}function M(G,B){for(var N=0,j=0,X=Z?new Uint16Array(32768):[];j<G.length;){var ee=Math.min(65535,G.length-j);if(ee<10){for(N=$t(B,N,+(j+ee==G.length)),N&7&&(N+=8-(N&7)),B.l=N/8|0,B.write_shift(2,ee),B.write_shift(2,~ee&65535);ee-- >0;)B[B.l++]=G[j++];N=B.l*8;continue}N=$t(B,N,+(j+ee==G.length)+2);for(var ie=0;ee-- >0;){var Q=G[j];ie=(ie<<5^Q)&32767;var ne=-1,ge=0;if((ne=X[ie])&&(ne|=j&-32768,ne>j&&(ne-=32768),ne<j))for(;G[ne+ge]==G[j+ge]&&ge<250;)++ge;if(ge>2){Q=k[ge],Q<=22?N=fr(B,N,Y[Q+1]>>1)-1:(fr(B,N,3),N+=5,fr(B,N,Y[Q-23]>>5),N+=3);var Me=Q<8?0:Q-4>>2;Me>0&&(La(B,N,ge-z[Q]),N+=Me),Q=E[j-ne],N=fr(B,N,Y[Q]>>3),N-=3;var Ne=Q<4?0:Q-2>>1;Ne>0&&(La(B,N,j-ne-te[Q]),N+=Ne);for(var ct=0;ct<ge;++ct)X[ie]=j&32767,ie=(ie<<5^G[j])&32767,++j;ee-=ge-1}else Q<=143?Q=Q+48:N=rr(B,N,1),N=fr(B,N,Y[Q]),X[ie]=j&32767,++j}N=fr(B,N,0)-1}return B.l=(N+7)/8|0,B.l}return function(B,N){return B.length<8?S(B,N):M(B,N)}}();function xe(x){var E=Je(50+Math.floor(x.length*1.1)),w=ar(x,E);return E.slice(0,w)}var Ge=Z?new Uint16Array(32768):Pt(32768),Ut=Z?new Uint16Array(32768):Pt(32768),Ye=Z?new Uint16Array(128):Pt(128),Hr=1,io=1;function $f(x,E){var w=we(x,E)+257;E+=5;var y=we(x,E)+1;E+=5;var k=Pe(x,E)+4;E+=4;for(var S=0,M=Z?new Uint8Array(19):Pt(19),G=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],B=1,N=Z?new Uint8Array(8):Pt(8),j=Z?new Uint8Array(8):Pt(8),X=M.length,ee=0;ee<k;++ee)M[D[ee]]=S=Ae(x,E),B<S&&(B=S),N[S]++,E+=3;var ie=0;for(N[0]=0,ee=1;ee<=B;++ee)j[ee]=ie=ie+N[ee-1]<<1;for(ee=0;ee<X;++ee)(ie=M[ee])!=0&&(G[ee]=j[ie]++);var Q=0;for(ee=0;ee<X;++ee)if(Q=M[ee],Q!=0){ie=Y[G[ee]]>>8-Q;for(var ne=(1<<7-Q)-1;ne>=0;--ne)Ye[ie|ne<<Q]=Q&7|ee<<3}var ge=[];for(B=1;ge.length<w+y;)switch(ie=Ye[ae(x,E)],E+=ie&7,ie>>>=3){case 16:for(S=3+We(x,E),E+=2,ie=ge[ge.length-1];S-- >0;)ge.push(ie);break;case 17:for(S=3+Ae(x,E),E+=3;S-- >0;)ge.push(0);break;case 18:for(S=11+ae(x,E),E+=7;S-- >0;)ge.push(0);break;default:ge.push(ie),B<ie&&(B=ie);break}var Me=ge.slice(0,w),Ne=ge.slice(w);for(ee=w;ee<286;++ee)Me[ee]=0;for(ee=y;ee<30;++ee)Ne[ee]=0;return Hr=ur(Me,Ge,286),io=ur(Ne,Ut,30),E}function Uf(x,E){if(x[0]==3&&!(x[1]&3))return[Mr(E),2];for(var w=0,y=0,k=Oo(E||1<<18),S=0,M=k.length>>>0,G=0,B=0;!(y&1);){if(y=Ae(x,w),w+=3,y>>>1)y>>1==1?(G=9,B=5):(w=$f(x,w),G=Hr,B=io);else{w&7&&(w+=8-(w&7));var N=x[w>>>3]|x[(w>>>3)+1]<<8;if(w+=32,N>0)for(!E&&M<S+N&&(k=kr(k,S+N),M=k.length);N-- >0;)k[S++]=x[w>>>3],w+=8;continue}for(;;){!E&&M<S+32767&&(k=kr(k,S+32767),M=k.length);var j=Ve(x,w,G),X=y>>>1==1?Tr[j]:Ge[j];if(w+=X&15,X>>>=4,!(X>>>8&255))k[S++]=X;else{if(X==256)break;X-=257;var ee=X<8?0:X-4>>2;ee>5&&(ee=0);var ie=S+z[X];ee>0&&(ie+=Ve(x,w,ee),w+=ee),j=Ve(x,w,B),X=y>>>1==1?Ba[j]:Ut[j],w+=X&15,X>>>=4;var Q=X<4?0:X-2>>1,ne=te[X];for(Q>0&&(ne+=Ve(x,w,Q),w+=Q),!E&&M<ie&&(k=kr(k,ie+100),M=k.length);S<ie;)k[S]=k[S-ne],++S}}}return E?[k,w+7>>>3]:[k.slice(0,S),w+7>>>3]}function oo(x,E){var w=x.slice(x.l||0),y=Uf(w,E);return x.l+=y[1],y[0]}function co(x,E){if(x)typeof console<"u"&&console.error(E);else throw new Error(E)}function lo(x,E){var w=x;st(w,0);var y=[],k=[],S={FileIndex:y,FullPaths:k};T(S,{root:E.root});for(var M=w.length-4;(w[M]!=80||w[M+1]!=75||w[M+2]!=5||w[M+3]!=6)&&M>=0;)--M;w.l=M+4,w.l+=4;var G=w.read_shift(2);w.l+=6;var B=w.read_shift(4);for(w.l=B,M=0;M<G;++M){w.l+=20;var N=w.read_shift(4),j=w.read_shift(4),X=w.read_shift(2),ee=w.read_shift(2),ie=w.read_shift(2);w.l+=8;var Q=w.read_shift(4),ne=o(w.slice(w.l+X,w.l+X+ee));w.l+=X+ee+ie;var ge=w.l;w.l=Q+4,jf(w,N,j,S,ne),w.l=ge}return S}function jf(x,E,w,y,k){x.l+=2;var S=x.read_shift(2),M=x.read_shift(2),G=i(x);if(S&8257)throw new Error("Unsupported ZIP encryption");for(var B=x.read_shift(4),N=x.read_shift(4),j=x.read_shift(4),X=x.read_shift(2),ee=x.read_shift(2),ie="",Q=0;Q<X;++Q)ie+=String.fromCharCode(x[x.l++]);if(ee){var ne=o(x.slice(x.l,x.l+ee));(ne[21589]||{}).mt&&(G=ne[21589].mt),((k||{})[21589]||{}).mt&&(G=k[21589].mt)}x.l+=ee;var ge=x.slice(x.l,x.l+N);switch(M){case 8:ge=U(x,j);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+M)}var Me=!1;S&8&&(B=x.read_shift(4),B==134695760&&(B=x.read_shift(4),Me=!0),N=x.read_shift(4),j=x.read_shift(4)),N!=E&&co(Me,"Bad compressed size: "+E+" != "+N),j!=w&&co(Me,"Bad uncompressed size: "+w+" != "+j),ys(y,ie,ge,{unsafe:!0,mt:G})}function Hf(x,E){var w=E||{},y=[],k=[],S=Je(1),M=w.compression?8:0,G=0,B=0,N=0,j=0,X=0,ee=x.FullPaths[0],ie=ee,Q=x.FileIndex[0],ne=[],ge=0;for(B=1;B<x.FullPaths.length;++B)if(ie=x.FullPaths[B].slice(ee.length),Q=x.FileIndex[B],!(!Q.size||!Q.content||ie=="Sh33tJ5")){var Me=j,Ne=Je(ie.length);for(N=0;N<ie.length;++N)Ne.write_shift(1,ie.charCodeAt(N)&127);Ne=Ne.slice(0,Ne.l),ne[X]=Og.buf(Q.content,0);var ct=Q.content;M==8&&(ct=O(ct)),S=Je(30),S.write_shift(4,67324752),S.write_shift(2,20),S.write_shift(2,G),S.write_shift(2,M),Q.mt?s(S,Q.mt):S.write_shift(4,0),S.write_shift(-4,ne[X]),S.write_shift(4,ct.length),S.write_shift(4,Q.content.length),S.write_shift(2,Ne.length),S.write_shift(2,0),j+=S.length,y.push(S),j+=Ne.length,y.push(Ne),j+=ct.length,y.push(ct),S=Je(46),S.write_shift(4,33639248),S.write_shift(2,0),S.write_shift(2,20),S.write_shift(2,G),S.write_shift(2,M),S.write_shift(4,0),S.write_shift(-4,ne[X]),S.write_shift(4,ct.length),S.write_shift(4,Q.content.length),S.write_shift(2,Ne.length),S.write_shift(2,0),S.write_shift(2,0),S.write_shift(2,0),S.write_shift(2,0),S.write_shift(4,0),S.write_shift(4,Me),ge+=S.l,k.push(S),ge+=Ne.length,k.push(Ne),++X}return S=Je(22),S.write_shift(4,101010256),S.write_shift(2,0),S.write_shift(2,0),S.write_shift(2,X),S.write_shift(2,X),S.write_shift(4,ge),S.write_shift(4,j),S.write_shift(2,0),Ir([Ir(y),Ir(k),S])}var bn={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Wf(x,E){if(x.ctype)return x.ctype;var w=x.name||"",y=w.match(/\.([^\.]+)$/);return y&&bn[y[1]]||E&&(y=(w=E).match(/[\.\\]([^\.\\])+$/),y&&bn[y[1]])?bn[y[1]]:"application/octet-stream"}function Vf(x){for(var E=Do(x),w=[],y=0;y<E.length;y+=76)w.push(E.slice(y,y+76));return w.join(`\r
`)+`\r
`}function Gf(x){var E=x.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(N){var j=N.charCodeAt(0).toString(16).toUpperCase();return"="+(j.length==1?"0"+j:j)});E=E.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),E.charAt(0)==`
`&&(E="=0D"+E.slice(1)),E=E.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var w=[],y=E.split(`\r
`),k=0;k<y.length;++k){var S=y[k];if(S.length==0){w.push("");continue}for(var M=0;M<S.length;){var G=76,B=S.slice(M,M+G);B.charAt(G-1)=="="?G--:B.charAt(G-2)=="="?G-=2:B.charAt(G-3)=="="&&(G-=3),B=S.slice(M,M+G),M+=G,M<S.length&&(B+="="),w.push(B)}}return w.join(`\r
`)}function qf(x){for(var E=[],w=0;w<x.length;++w){for(var y=x[w];w<=x.length&&y.charAt(y.length-1)=="=";)y=y.slice(0,y.length-1)+x[++w];E.push(y)}for(var k=0;k<E.length;++k)E[k]=E[k].replace(/[=][0-9A-Fa-f]{2}/g,function(S){return String.fromCharCode(parseInt(S.slice(1),16))});return Qt(E.join(`\r
`))}function zf(x,E,w){for(var y="",k="",S="",M,G=0;G<10;++G){var B=E[G];if(!B||B.match(/^\s*$/))break;var N=B.match(/^(.*?):\s*([^\s].*)$/);if(N)switch(N[1].toLowerCase()){case"content-location":y=N[2].trim();break;case"content-type":S=N[2].trim();break;case"content-transfer-encoding":k=N[2].trim();break}}switch(++G,k.toLowerCase()){case"base64":M=Qt(Nt(E.slice(G).join("")));break;case"quoted-printable":M=qf(E.slice(G));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+k)}var j=ys(x,y.slice(w.length),M,{unsafe:!0});S&&(j.ctype=S)}function Kf(x,E){if(W(x.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var w=E&&E.root||"",y=(_e&&Buffer.isBuffer(x)?x.toString("binary"):W(x)).split(`\r
`),k=0,S="";for(k=0;k<y.length;++k)if(S=y[k],!!/^Content-Location:/i.test(S)&&(S=S.slice(S.indexOf("file")),w||(w=S.slice(0,S.lastIndexOf("/")+1)),S.slice(0,w.length)!=w))for(;w.length>0&&(w=w.slice(0,w.length-1),w=w.slice(0,w.lastIndexOf("/")+1),S.slice(0,w.length)!=w););var M=(y[1]||"").match(/boundary="(.*?)"/);if(!M)throw new Error("MAD cannot find boundary");var G="--"+(M[1]||""),B=[],N=[],j={FileIndex:B,FullPaths:N};T(j);var X,ee=0;for(k=0;k<y.length;++k){var ie=y[k];ie!==G&&ie!==G+"--"||(ee++&&zf(j,y.slice(X,k),w),X=k)}return j}function Xf(x,E){var w=E||{},y=w.boundary||"SheetJS";y="------="+y;for(var k=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+y.slice(2)+'"',"","",""],S=x.FullPaths[0],M=S,G=x.FileIndex[0],B=1;B<x.FullPaths.length;++B)if(M=x.FullPaths[B].slice(S.length),G=x.FileIndex[B],!(!G.size||!G.content||M=="Sh33tJ5")){M=M.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ge){return"_x"+ge.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ge){return"_u"+ge.charCodeAt(0).toString(16)+"_"});for(var N=G.content,j=_e&&Buffer.isBuffer(N)?N.toString("binary"):W(N),X=0,ee=Math.min(1024,j.length),ie=0,Q=0;Q<=ee;++Q)(ie=j.charCodeAt(Q))>=32&&ie<128&&++X;var ne=X>=ee*4/5;k.push(y),k.push("Content-Location: "+(w.root||"file:///C:/SheetJS/")+M),k.push("Content-Transfer-Encoding: "+(ne?"quoted-printable":"base64")),k.push("Content-Type: "+Wf(G,M)),k.push(""),k.push(ne?Gf(j):Vf(j))}return k.push(y+`--\r
`),k.join(`\r
`)}function Yf(x){var E={};return T(E,x),E}function ys(x,E,w,y){var k=y&&y.unsafe;k||T(x);var S=!k&&Ee.find(x,E);if(!S){var M=x.FullPaths[0];E.slice(0,M.length)==M?M=E:(M.slice(-1)!="/"&&(M+="/"),M=(M+E).replace("//","/")),S={name:n(E),type:2},x.FileIndex.push(S),x.FullPaths.push(M),k||Ee.utils.cfb_gc(x)}return S.content=w,S.size=w?w.length:0,y&&(y.CLSID&&(S.clsid=y.CLSID),y.mt&&(S.mt=y.mt),y.ct&&(S.ct=y.ct)),S}function Jf(x,E){T(x);var w=Ee.find(x,E);if(w){for(var y=0;y<x.FileIndex.length;++y)if(x.FileIndex[y]==w)return x.FileIndex.splice(y,1),x.FullPaths.splice(y,1),!0}return!1}function Qf(x,E,w){T(x);var y=Ee.find(x,E);if(y){for(var k=0;k<x.FileIndex.length;++k)if(x.FileIndex[k]==y)return x.FileIndex[k].name=n(w),x.FullPaths[k]=w,!0}return!1}function Zf(x){P(x,!0)}return r.find=V,r.read=I,r.parse=f,r.write=ue,r.writeFile=Re,r.utils={cfb_new:Yf,cfb_add:ys,cfb_del:Jf,cfb_mov:Qf,cfb_gc:Zf,ReadShift:Ya,CheckField:_0,prep_blob:st,bconcat:Ir,use_zlib:A,_deflateRaw:xe,_inflateRaw:oo,consts:oe},r}();function Rg(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var r=File(e);r.open("r"),r.encoding="binary";var t=r.read();return r.close(),t}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+e)}function or(e){for(var r=Object.keys(e),t=[],a=0;a<r.length;++a)Object.prototype.hasOwnProperty.call(e,r[a])&&t.push(r[a]);return t}function Pi(e){for(var r=[],t=or(e),a=0;a!==t.length;++a)r[e[t[a]]]=t[a];return r}var Xn=new Date(1899,11,30,0,0,0);function At(e,r){var t=e.getTime(),a=Xn.getTime()+(e.getTimezoneOffset()-Xn.getTimezoneOffset())*6e4;return(t-a)/(24*60*60*1e3)}var e0=new Date,Lg=Xn.getTime()+(e0.getTimezoneOffset()-Xn.getTimezoneOffset())*6e4,jo=e0.getTimezoneOffset();function gs(e){var r=new Date;return r.setTime(e*24*60*60*1e3+Lg),r.getTimezoneOffset()!==jo&&r.setTime(r.getTime()+(r.getTimezoneOffset()-jo)*6e4),r}function Bg(e){var r=0,t=0,a=!1,n=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=n.length;++s)if(n[s]){switch(t=1,s>3&&(a=!0),n[s].slice(n[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[s].slice(n[s].length-1));case"D":t*=24;case"H":t*=60;case"M":if(a)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}r+=t*parseInt(n[s],10)}return r}var Ho=new Date("2017-02-19T19:06:09.000Z"),t0=isNaN(Ho.getFullYear())?new Date("2/19/17"):Ho,Mg=t0.getFullYear()==2017;function nt(e,r){var t=new Date(e);if(Mg)return r>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):r<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if(t0.getFullYear()==1917&&!isNaN(t.getFullYear())){var a=t.getFullYear();return e.indexOf(""+a)>-1||t.setFullYear(t.getFullYear()+100),t}var n=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function ta(e,r){if(_e&&Buffer.isBuffer(e)){if(r){if(e[0]==255&&e[1]==254)return Ga(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Ga(jl(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(r){if(e[0]==255&&e[1]==254)return Ga(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Ga(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(s){return t[s]||s})}catch{}for(var a=[],n=0;n!=e.length;++n)a.push(String.fromCharCode(e[n]));return a.join("")}function it(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=it(e[t]));return r}function je(e,r){for(var t="";t.length<r;)t+=e;return t}function tr(e){var r=Number(e);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(e))return r;var t=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(r=Number(a))||(a=a.replace(/[(](.*)[)]/,function(n,s){return t=-t,s}),!isNaN(r=Number(a)))?r/t:r}var Ng=["january","february","march","april","may","june","july","august","september","october","november","december"];function Sa(e){var r=new Date(e),t=new Date(NaN),a=r.getYear(),n=r.getMonth(),s=r.getDate();if(isNaN(s))return t;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&Ng.indexOf(i)==-1)return t}else if(i.match(/[a-z]/))return t;return a<0||a>8099?t:(n>0||s>1)&&a!=101?r:e.match(/[^-0-9:,\/\\]/)?t:r}var $g=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(t,a,n){if(e||typeof a=="string")return t.split(a);for(var s=t.split(a),i=[s[0]],o=1;o<s.length;++o)i.push(n),i.push(s[o]);return i}}();function r0(e){return e?e.content&&e.type?ta(e.content,!0):e.data?Ha(e.data):e.asNodeBuffer&&_e?Ha(e.asNodeBuffer().toString("binary")):e.asBinary?Ha(e.asBinary()):e._data&&e._data.getContent?Ha(ta(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function a0(e){if(!e)return null;if(e.data)return Io(e.data);if(e.asNodeBuffer&&_e)return e.asNodeBuffer();if(e._data&&e._data.getContent){var r=e._data.getContent();return typeof r=="string"?Io(r):Array.prototype.slice.call(r)}return e.content&&e.type?e.content:null}function Ug(e){return e&&e.name.slice(-4)===".bin"?a0(e):r0(e)}function Wt(e,r){for(var t=e.FullPaths||or(e.files),a=r.toLowerCase().replace(/[\/]/g,"\\"),n=a.replace(/\\/g,"/"),s=0;s<t.length;++s){var i=t[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==i||n==i)return e.files?e.files[t[s]]:e.FileIndex[s]}return null}function Di(e,r){var t=Wt(e,r);if(t==null)throw new Error("Cannot find file "+r+" in zip");return t}function Ke(e,r,t){if(!t)return Ug(Di(e,r));if(!r)return null;try{return Ke(e,r)}catch{return null}}function Rt(e,r,t){if(!t)return r0(Di(e,r));if(!r)return null;try{return Rt(e,r)}catch{return null}}function jg(e,r,t){return a0(Di(e,r))}function Wo(e){for(var r=e.FullPaths||or(e.files),t=[],a=0;a<r.length;++a)r[a].slice(-1)!="/"&&t.push(r[a].replace(/^Root Entry[\/]/,""));return t.sort()}function Hg(e,r,t){if(e.FullPaths){if(typeof t=="string"){var a;return _e?a=sa(t):a=og(t),Ee.utils.cfb_add(e,r,a)}Ee.utils.cfb_add(e,r,t)}else e.file(r,t)}function n0(e,r){switch(r.type){case"base64":return Ee.read(e,{type:"base64"});case"binary":return Ee.read(e,{type:"binary"});case"buffer":case"array":return Ee.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+r.type)}function Va(e,r){if(e.charAt(0)=="/")return e.slice(1);var t=r.split("/");r.slice(-1)!="/"&&t.pop();for(var a=e.split("/");a.length!==0;){var n=a.shift();n===".."?t.pop():n!=="."&&t.push(n)}return t.join("/")}var s0=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Wg=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Vo=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,Vg=/<[^>]*>/g,vt=s0.match(Vo)?Vo:Vg,Gg=/<\w*:/,qg=/<(\/?)\w+:/;function fe(e,r,t){for(var a={},n=0,s=0;n!==e.length&&!((s=e.charCodeAt(n))===32||s===10||s===13);++n);if(r||(a[0]=e.slice(0,n)),n===e.length)return a;var i=e.match(Wg),o=0,c="",l=0,f="",u="",d=1;if(i)for(l=0;l!=i.length;++l){for(u=i[l],s=0;s!=u.length&&u.charCodeAt(s)!==61;++s);for(f=u.slice(0,s).trim();u.charCodeAt(s+1)==32;)++s;for(d=(n=u.charCodeAt(s+1))==34||n==39?1:0,c=u.slice(s+1+d,u.length-d),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),a[f]=c,a[f.toLowerCase()]=c;else{var h=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(a[h]&&f.slice(o-3,o)=="ext")continue;a[h]=c,a[h.toLowerCase()]=c}}return a}function cr(e){return e.replace(qg,"<$1")}var i0={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},zg=Pi(i0),Se=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,r=/_x([\da-fA-F]{4})_/ig;return function t(a){var n=a+"",s=n.indexOf("<![CDATA[");if(s==-1)return n.replace(e,function(o,c){return i0[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(r,function(o,c){return String.fromCharCode(parseInt(c,16))});var i=n.indexOf("]]>");return t(n.slice(0,s))+n.slice(s+9,i)+t(n.slice(i+3))}}(),Kg=/[&<>'"]/g,Xg=/[\u0000-\u001f]/g;function Oi(e){var r=e+"";return r.replace(Kg,function(t){return zg[t]}).replace(/\n/g,"<br/>").replace(Xg,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}var Go=function(){var e=/&#(\d+);/g;function r(t,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(e,r)}}();function Le(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Is(e){for(var r="",t=0,a=0,n=0,s=0,i=0,o=0;t<e.length;){if(a=e.charCodeAt(t++),a<128){r+=String.fromCharCode(a);continue}if(n=e.charCodeAt(t++),a>191&&a<224){i=(a&31)<<6,i|=n&63,r+=String.fromCharCode(i);continue}if(s=e.charCodeAt(t++),a<240){r+=String.fromCharCode((a&15)<<12|(n&63)<<6|s&63);continue}i=e.charCodeAt(t++),o=((a&7)<<18|(n&63)<<12|(s&63)<<6|i&63)-65536,r+=String.fromCharCode(55296+(o>>>10&1023)),r+=String.fromCharCode(56320+(o&1023))}return r}function qo(e){var r=Mr(2*e.length),t,a,n=1,s=0,i=0,o;for(a=0;a<e.length;a+=n)n=1,(o=e.charCodeAt(a))<128?t=o:o<224?(t=(o&31)*64+(e.charCodeAt(a+1)&63),n=2):o<240?(t=(o&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),n=3):(n=4,t=(o&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),t-=65536,i=55296+(t>>>10&1023),t=56320+(t&1023)),i!==0&&(r[s++]=i&255,r[s++]=i>>>8,i=0),r[s++]=t%256,r[s++]=t>>>8;return r.slice(0,s).toString("ucs2")}function zo(e){return sa(e,"binary").toString("utf8")}var Bn="foo bar bazâð£",Oe=_e&&(zo(Bn)==Is(Bn)&&zo||qo(Bn)==Is(Bn)&&qo)||Is,Ga=_e?function(e){return sa(e,"utf8").toString("binary")}:function(e){for(var r=[],t=0,a=0,n=0;t<e.length;)switch(a=e.charCodeAt(t++),!0){case a<128:r.push(String.fromCharCode(a));break;case a<2048:r.push(String.fromCharCode(192+(a>>6))),r.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,n=e.charCodeAt(t++)-56320+(a<<10),r.push(String.fromCharCode(240+(n>>18&7))),r.push(String.fromCharCode(144+(n>>12&63))),r.push(String.fromCharCode(128+(n>>6&63))),r.push(String.fromCharCode(128+(n&63)));break;default:r.push(String.fromCharCode(224+(a>>12))),r.push(String.fromCharCode(128+(a>>6&63))),r.push(String.fromCharCode(128+(a&63)))}return r.join("")},fn=function(){var e={};return function(t,a){var n=t+"|"+(a||"");return e[n]?e[n]:e[n]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",a||"")}}(),o0=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(t){for(var a=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<e.length;++n)a=a.replace(e[n][0],e[n][1]);return a}}(),Yg=function(){var e={};return function(t){return e[t]!==void 0?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),Jg=/<\/?(?:vt:)?variant>/g,Qg=/<(?:vt:)([^>]*)>([\s\S]*)</;function Ko(e,r){var t=fe(e),a=e.match(Yg(t.baseType))||[],n=[];if(a.length!=t.size){if(r.WTF)throw new Error("unexpected vector length "+a.length+" != "+t.size);return n}return a.forEach(function(s){var i=s.replace(Jg,"").match(Qg);i&&n.push({v:Oe(i[2]),t:i[1]})}),n}var Zg=/(^\s|\s$|\n)/;function ep(e){return or(e).map(function(r){return" "+r+'="'+e[r]+'"'}).join("")}function tp(e,r,t){return"<"+e+(t!=null?ep(t):"")+(r!=null?(r.match(Zg)?' xml:space="preserve"':"")+">"+r+"</"+e:"/")+">"}function Ri(e){if(_e&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Oe(ia(Fi(e)));throw new Error("Bad input format: expected Buffer or string")}var un=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,rp={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},ap=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function np(e,r){for(var t=1-2*(e[r+7]>>>7),a=((e[r+7]&127)<<4)+(e[r+6]>>>4&15),n=e[r+6]&15,s=5;s>=0;--s)n=n*256+e[r+s];return a==2047?n==0?t*(1/0):NaN:(a==0?a=-1022:(a-=1023,n+=Math.pow(2,52)),t*Math.pow(2,a-52)*n)}function sp(e,r,t){var a=(r<0||1/r==-1/0?1:0)<<7,n=0,s=0,i=a?-r:r;isFinite(i)?i==0?n=s=0:(n=Math.floor(Math.log(i)/Math.LN2),s=i*Math.pow(2,52-n),n<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?n=-1022:(s-=Math.pow(2,52),n+=1023)):(n=2047,s=isNaN(r)?26985:0);for(var o=0;o<=5;++o,s/=256)e[t+o]=s&255;e[t+6]=(n&15)<<4|s&15,e[t+7]=n>>4|a}var Xo=function(e){for(var r=[],t=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var n=0,s=e[0][a].length;n<s;n+=t)r.push.apply(r,e[0][a].slice(n,n+t));return r},Yo=_e?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(r){return Buffer.isBuffer(r)?r:sa(r)})):Xo(e)}:Xo,Jo=function(e,r,t){for(var a=[],n=r;n<t;n+=2)a.push(String.fromCharCode(pr(e,n)));return a.join("").replace(St,"")},Li=_e?function(e,r,t){return Buffer.isBuffer(e)?e.toString("utf16le",r,t).replace(St,""):Jo(e,r,t)}:Jo,Qo=function(e,r,t){for(var a=[],n=r;n<r+t;++n)a.push(("0"+e[n].toString(16)).slice(-2));return a.join("")},c0=_e?function(e,r,t){return Buffer.isBuffer(e)?e.toString("hex",r,r+t):Qo(e,r,t)}:Qo,Zo=function(e,r,t){for(var a=[],n=r;n<t;n++)a.push(String.fromCharCode(xa(e,n)));return a.join("")},yn=_e?function(r,t,a){return Buffer.isBuffer(r)?r.toString("utf8",t,a):Zo(r,t,a)}:Zo,l0=function(e,r){var t=Dt(e,r);return t>0?yn(e,r+4,r+4+t-1):""},f0=l0,u0=function(e,r){var t=Dt(e,r);return t>0?yn(e,r+4,r+4+t-1):""},d0=u0,h0=function(e,r){var t=2*Dt(e,r);return t>0?yn(e,r+4,r+4+t-1):""},g0=h0,p0=function(r,t){var a=Dt(r,t);return a>0?Li(r,t+4,t+4+a):""},m0=p0,x0=function(e,r){var t=Dt(e,r);return t>0?yn(e,r+4,r+4+t):""},v0=x0,w0=function(e,r){return np(e,r)},Yn=w0,y0=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};_e&&(f0=function(r,t){if(!Buffer.isBuffer(r))return l0(r,t);var a=r.readUInt32LE(t);return a>0?r.toString("utf8",t+4,t+4+a-1):""},d0=function(r,t){if(!Buffer.isBuffer(r))return u0(r,t);var a=r.readUInt32LE(t);return a>0?r.toString("utf8",t+4,t+4+a-1):""},g0=function(r,t){if(!Buffer.isBuffer(r))return h0(r,t);var a=2*r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+a-1)},m0=function(r,t){if(!Buffer.isBuffer(r))return p0(r,t);var a=r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+a)},v0=function(r,t){if(!Buffer.isBuffer(r))return x0(r,t);var a=r.readUInt32LE(t);return r.toString("utf8",t+4,t+4+a)},Yn=function(r,t){return Buffer.isBuffer(r)?r.readDoubleLE(t):w0(r,t)},y0=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});var xa=function(e,r){return e[r]},pr=function(e,r){return e[r+1]*256+e[r]},ip=function(e,r){var t=e[r+1]*256+e[r];return t<32768?t:(65535-t+1)*-1},Dt=function(e,r){return e[r+3]*(1<<24)+(e[r+2]<<16)+(e[r+1]<<8)+e[r]},Kr=function(e,r){return e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]},op=function(e,r){return e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]};function Ya(e,r){var t="",a,n,s=[],i,o,c,l;switch(r){case"dbcs":if(l=this.l,_e&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)t+=String.fromCharCode(pr(this,l)),l+=2;e*=2;break;case"utf8":t=yn(this,this.l,this.l+e);break;case"utf16le":e*=2,t=Li(this,this.l,this.l+e);break;case"wstr":return Ya.call(this,e,"dbcs");case"lpstr-ansi":t=f0(this,this.l),e=4+Dt(this,this.l);break;case"lpstr-cp":t=d0(this,this.l),e=4+Dt(this,this.l);break;case"lpwstr":t=g0(this,this.l),e=4+2*Dt(this,this.l);break;case"lpp4":e=4+Dt(this,this.l),t=m0(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Dt(this,this.l),t=v0(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(i=xa(this,this.l+e++))!==0;)s.push(Ln(i));t=s.join("");break;case"_wstr":for(e=0,t="";(i=pr(this,this.l+e))!==0;)s.push(Ln(i)),e+=2;e+=2,t=s.join("");break;case"dbcs-cont":for(t="",l=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return i=xa(this,l),this.l=l+1,o=Ya.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Ln(pr(this,l))),l+=2}t=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(t="",l=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return i=xa(this,l),this.l=l+1,o=Ya.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Ln(xa(this,l))),l+=1}t=s.join("");break;default:switch(e){case 1:return a=xa(this,this.l),this.l++,a;case 2:return a=(r==="i"?ip:pr)(this,this.l),this.l+=2,a;case 4:case-4:return r==="i"||!(this[this.l+3]&128)?(a=(e>0?Kr:op)(this,this.l),this.l+=4,a):(n=Dt(this,this.l),this.l+=4,n);case 8:case-8:if(r==="f")return e==8?n=Yn(this,this.l):n=Yn([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:t=c0(this,this.l,e);break}}return this.l+=e,t}var cp=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24&255},lp=function(e,r,t){e[t]=r&255,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255},fp=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255};function up(e,r,t){var a=0,n=0;if(t==="dbcs"){for(n=0;n!=r.length;++n)fp(this,r.charCodeAt(n),this.l+2*n);a=2*r.length}else if(t==="sbcs"){for(r=r.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=r.length;++n)this[this.l+n]=r.charCodeAt(n)&255;a=r.length}else if(t==="hex"){for(;n<e;++n)this[this.l++]=parseInt(r.slice(2*n,2*n+2),16)||0;return this}else if(t==="utf16le"){var s=Math.min(this.l+e,this.length);for(n=0;n<Math.min(r.length,e);++n){var i=r.charCodeAt(n);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=r&255;break;case 2:a=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:a=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:a=4,cp(this,r,this.l);break;case 8:if(a=8,t==="f"){sp(this,r,this.l);break}case 16:break;case-4:a=4,lp(this,r,this.l);break}return this.l+=a,this}function _0(e,r){var t=c0(this,this.l,e.length>>1);if(t!==e)throw new Error(r+"Expected "+e+" saw "+t);this.l+=e.length>>1}function st(e,r){e.l=r,e.read_shift=Ya,e.chk=_0,e.write_shift=up}function xt(e,r){e.l+=r}function Je(e){var r=Mr(e);return st(r,0),r}function Er(e,r,t){if(e){var a,n,s;st(e,e.l||0);for(var i=e.length,o=0,c=0;e.l<i;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var l=rs[o]||rs[65535];for(a=e.read_shift(1),s=a&127,n=1;n<4&&a&128;++n)s+=((a=e.read_shift(1))&127)<<7*n;c=e.l+s;var f=l.f&&l.f(e,s,t);if(e.l=c,r(f,l,o))return}}}function Ks(){var e=[],r=_e?256:2048,t=function(l){var f=Je(l);return st(f,0),f},a=t(r),n=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},s=function(l){return a&&l<a.length-a.l?a:(n(),a=t(Math.max(l+1,r)))},i=function(){return n(),Ir(e)},o=function(l){n(),a=l,a.l==null&&(a.l=a.length),s(r)};return{next:s,push:o,end:i,_bufs:e}}function Ja(e,r,t){var a=it(e);if(r.s?(a.cRel&&(a.c+=r.s.c),a.rRel&&(a.r+=r.s.r)):(a.cRel&&(a.c+=r.c),a.rRel&&(a.r+=r.r)),!t||t.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function ec(e,r,t){var a=it(e);return a.s=Ja(a.s,r.s,t),a.e=Ja(a.e,r.s,t),a}function Qa(e,r){if(e.cRel&&e.c<0)for(e=it(e);e.c<0;)e.c+=r>8?16384:256;if(e.rRel&&e.r<0)for(e=it(e);e.r<0;)e.r+=r>8?1048576:r>5?65536:16384;var t=he(e);return!e.cRel&&e.cRel!=null&&(t=gp(t)),!e.rRel&&e.rRel!=null&&(t=dp(t)),t}function Ps(e,r){return e.s.r==0&&!e.s.rRel&&e.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Ze(e.s.c)+":"+(e.e.cRel?"":"$")+Ze(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(r.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+ot(e.s.r)+":"+(e.e.rRel?"":"$")+ot(e.e.r):Qa(e.s,r.biff)+":"+Qa(e.e,r.biff)}function Bi(e){return parseInt(hp(e),10)-1}function ot(e){return""+(e+1)}function dp(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function hp(e){return e.replace(/\$(\d+)$/,"$1")}function Mi(e){for(var r=pp(e),t=0,a=0;a!==r.length;++a)t=26*t+r.charCodeAt(a)-64;return t-1}function Ze(e){if(e<0)throw new Error("invalid column "+e);var r="";for(++e;e;e=Math.floor((e-1)/26))r=String.fromCharCode((e-1)%26+65)+r;return r}function gp(e){return e.replace(/^([A-Z])/,"$$$1")}function pp(e){return e.replace(/^\$([A-Z])/,"$1")}function mp(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Tt(e){for(var r=0,t=0,a=0;a<e.length;++a){var n=e.charCodeAt(a);n>=48&&n<=57?r=10*r+(n-48):n>=65&&n<=90&&(t=26*t+(n-64))}return{c:t-1,r:r-1}}function he(e){for(var r=e.c+1,t="";r;r=(r-1)/26|0)t=String.fromCharCode((r-1)%26+65)+t;return t+(e.r+1)}function Pa(e){var r=e.indexOf(":");return r==-1?{s:Tt(e),e:Tt(e)}:{s:Tt(e.slice(0,r)),e:Tt(e.slice(r+1))}}function ke(e,r){return typeof r>"u"||typeof r=="number"?ke(e.s,e.e):(typeof e!="string"&&(e=he(e)),typeof r!="string"&&(r=he(r)),e==r?e:e+":"+r)}function He(e){var r={s:{c:0,r:0},e:{c:0,r:0}},t=0,a=0,n=0,s=e.length;for(t=0;a<s&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)t=26*t+n;for(r.s.c=--t,t=0;a<s&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)t=10*t+n;if(r.s.r=--t,a===s||n!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++a,t=0;a!=s&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)t=26*t+n;for(r.e.c=--t,t=0;a!=s&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)t=10*t+n;return r.e.r=--t,r}function tc(e,r){var t=e.t=="d"&&r instanceof Date;if(e.z!=null)try{return e.w=qt(e.z,t?At(r):r)}catch{}try{return e.w=qt((e.XF||{}).numFmtId||(t?14:0),t?At(r):r)}catch{return""+r}}function wr(e,r,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?la[e.v]||e.v:r==null?tc(e,e.v):tc(e,r))}function jr(e,r){var t=r&&r.sheet?r.sheet:"Sheet1",a={};return a[t]=e,{SheetNames:[t],Sheets:a}}function E0(e,r,t){var a=t||{},n=e?Array.isArray(e):a.dense,s=e||(n?[]:{}),i=0,o=0;if(s&&a.origin!=null){if(typeof a.origin=="number")i=a.origin;else{var c=typeof a.origin=="string"?Tt(a.origin):a.origin;i=c.r,o=c.c}s["!ref"]||(s["!ref"]="A1:A1")}var l={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var f=He(s["!ref"]);l.s.c=f.s.c,l.s.r=f.s.r,l.e.c=Math.max(l.e.c,f.e.c),l.e.r=Math.max(l.e.r,f.e.r),i==-1&&(l.e.r=i=f.e.r+1)}for(var u=0;u!=r.length;++u)if(r[u]){if(!Array.isArray(r[u]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=r[u].length;++d)if(!(typeof r[u][d]>"u")){var h={v:r[u][d]},g=i+u,p=o+d;if(l.s.r>g&&(l.s.r=g),l.s.c>p&&(l.s.c=p),l.e.r<g&&(l.e.r=g),l.e.c<p&&(l.e.c=p),r[u][d]&&typeof r[u][d]=="object"&&!Array.isArray(r[u][d])&&!(r[u][d]instanceof Date))h=r[u][d];else if(Array.isArray(h.v)&&(h.f=r[u][d][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(a.nullError)h.t="e",h.v=0;else if(a.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=a.dateNF||me[14],a.cellDates?(h.t="d",h.w=qt(h.z,At(h.v))):(h.t="n",h.v=At(h.v),h.w=qt(h.z,h.v))):h.t="s";if(n)s[g]||(s[g]=[]),s[g][p]&&s[g][p].z&&(h.z=s[g][p].z),s[g][p]=h;else{var m=he({c:p,r:g});s[m]&&s[m].z&&(h.z=s[m].z),s[m]=h}}}return l.s.c<1e7&&(s["!ref"]=ke(l)),s}function Da(e,r){return E0(null,e,r)}function xp(e){return e.read_shift(4,"i")}function mt(e){var r=e.read_shift(4);return r===0?"":e.read_shift(r,"dbcs")}function vp(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Ni(e,r){var t=e.l,a=e.read_shift(1),n=mt(e),s=[],i={t:n,h:n};if(a&1){for(var o=e.read_shift(4),c=0;c!=o;++c)s.push(vp(e));i.r=s}else i.r=[{ich:0,ifnt:0}];return e.l=t+r,i}var wp=Ni;function zt(e){var r=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:r,iStyleRef:t}}function oa(e){var r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:r}}var yp=mt;function $i(e){var r=e.read_shift(4);return r===0||r===4294967295?"":e.read_shift(r,"dbcs")}var _p=mt,Xs=$i;function Ui(e){var r=e.slice(e.l,e.l+4),t=r[0]&1,a=r[0]&2;e.l+=4;var n=a===0?Yn([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):Kr(r,0)>>2;return t?n/100:n}function k0(e){var r={s:{},e:{}};return r.s.r=e.read_shift(4),r.e.r=e.read_shift(4),r.s.c=e.read_shift(4),r.e.c=e.read_shift(4),r}var ca=k0;function dt(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Ep(e){var r={},t=e.read_shift(1),a=t>>>1,n=e.read_shift(1),s=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,a){case 0:r.auto=1;break;case 1:r.index=n;var l=Jr[n];l&&(r.rgb=hn(l));break;case 2:r.rgb=hn([i,o,c]);break;case 3:r.theme=n;break}return s!=0&&(r.tint=s>0?s/32767:s/32768),r}function kp(e){var r=e.read_shift(1);e.l++;var t={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return t}function T0(e,r){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=e.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return t[e.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return e.l-=4,e.read_shift(0,r==1?"lpstr":"lpwstr")}function Tp(e){return T0(e,1)}function Sp(e){return T0(e,2)}var ji=2,Ft=3,Mn=11,rc=12,Jn=19,Nn=64,Ap=65,bp=71,Fp=4108,Cp=4126,rt=80,S0=81,Ip=[rt,S0],Pp={1:{n:"CodePage",t:ji},2:{n:"Category",t:rt},3:{n:"PresentationFormat",t:rt},4:{n:"ByteCount",t:Ft},5:{n:"LineCount",t:Ft},6:{n:"ParagraphCount",t:Ft},7:{n:"SlideCount",t:Ft},8:{n:"NoteCount",t:Ft},9:{n:"HiddenCount",t:Ft},10:{n:"MultimediaClipCount",t:Ft},11:{n:"ScaleCrop",t:Mn},12:{n:"HeadingPairs",t:Fp},13:{n:"TitlesOfParts",t:Cp},14:{n:"Manager",t:rt},15:{n:"Company",t:rt},16:{n:"LinksUpToDate",t:Mn},17:{n:"CharacterCount",t:Ft},19:{n:"SharedDoc",t:Mn},22:{n:"HyperlinksChanged",t:Mn},23:{n:"AppVersion",t:Ft,p:"version"},24:{n:"DigSig",t:Ap},26:{n:"ContentType",t:rt},27:{n:"ContentStatus",t:rt},28:{n:"Language",t:rt},29:{n:"Version",t:rt},255:{},2147483648:{n:"Locale",t:Jn},2147483651:{n:"Behavior",t:Jn},1919054434:{}},Dp={1:{n:"CodePage",t:ji},2:{n:"Title",t:rt},3:{n:"Subject",t:rt},4:{n:"Author",t:rt},5:{n:"Keywords",t:rt},6:{n:"Comments",t:rt},7:{n:"Template",t:rt},8:{n:"LastAuthor",t:rt},9:{n:"RevNumber",t:rt},10:{n:"EditTime",t:Nn},11:{n:"LastPrinted",t:Nn},12:{n:"CreatedDate",t:Nn},13:{n:"ModifiedDate",t:Nn},14:{n:"PageCount",t:Ft},15:{n:"WordCount",t:Ft},16:{n:"CharCount",t:Ft},17:{n:"Thumbnail",t:bp},18:{n:"Application",t:rt},19:{n:"DocSecurity",t:Ft},255:{},2147483648:{n:"Locale",t:Jn},2147483651:{n:"Behavior",t:Jn},1919054434:{}},ac={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Op=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Rp(e){return e.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var Lp=Rp([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Jr=it(Lp),la={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},A0={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},nc={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function Bp(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Mp(e){var r=Bp();if(!e||!e.match)return r;var t={};if((e.match(vt)||[]).forEach(function(a){var n=fe(a);switch(n[0].replace(Gg,"<")){case"<?xml":break;case"<Types":r.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[n.Extension]=n.ContentType;break;case"<Override":r[nc[n.ContentType]]!==void 0&&r[nc[n.ContentType]].push(n.PartName);break}}),r.xmlns!==rp.CT)throw new Error("Unknown Namespace: "+r.xmlns);return r.calcchain=r.calcchains.length>0?r.calcchains[0]:"",r.sst=r.strs.length>0?r.strs[0]:"",r.style=r.styles.length>0?r.styles[0]:"",r.defaults=t,delete r.calcchains,r}var va={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Ys(e){var r=e.lastIndexOf("/");return e.slice(0,r+1)+"_rels/"+e.slice(r+1)+".rels"}function Za(e,r){var t={"!id":{}};if(!e)return t;r.charAt(0)!=="/"&&(r="/"+r);var a={};return(e.match(vt)||[]).forEach(function(n){var s=fe(n);if(s[0]==="<Relationship"){var i={};i.Type=s.Type,i.Target=s.Target,i.Id=s.Id,s.TargetMode&&(i.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:Va(s.Target,r);t[o]=i,a[s.Id]=i}}),t["!id"]=a,t}var Np="application/vnd.oasis.opendocument.spreadsheet";function $p(e,r){for(var t=Ri(e),a,n;a=un.exec(t);)switch(a[3]){case"manifest":break;case"file-entry":if(n=fe(a[0],!1),n.path=="/"&&n.type!==Np)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(r&&r.WTF)throw a}}var en=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],Up=function(){for(var e=new Array(en.length),r=0;r<en.length;++r){var t=en[r],a="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);e[r]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return e}();function b0(e){var r={};e=Oe(e);for(var t=0;t<en.length;++t){var a=en[t],n=e.match(Up[t]);n!=null&&n.length>0&&(r[a[1]]=Se(n[1])),a[2]==="date"&&r[a[1]]&&(r[a[1]]=nt(r[a[1]]))}return r}var jp=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function F0(e,r,t,a){var n=[];if(typeof e=="string")n=Ko(e,a);else for(var s=0;s<e.length;++s)n=n.concat(e[s].map(function(f){return{v:f}}));var i=typeof r=="string"?Ko(r,a).map(function(f){return f.v}):r,o=0,c=0;if(i.length>0)for(var l=0;l!==n.length;l+=2){switch(c=+n[l+1].v,n[l].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":t.Worksheets=c,t.SheetNames=i.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":t.NamedRanges=c,t.DefinedNames=i.slice(o,o+c);break;case"Charts":case"Diagramme":t.Chartsheets=c,t.ChartNames=i.slice(o,o+c);break}o+=c}}function Hp(e,r,t){var a={};return r||(r={}),e=Oe(e),jp.forEach(function(n){var s=(e.match(fn(n[0]))||[])[1];switch(n[2]){case"string":s&&(r[n[1]]=Se(s));break;case"bool":r[n[1]]=s==="true";break;case"raw":var i=e.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));i&&i.length>0&&(a[n[1]]=i[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&F0(a.HeadingPairs,a.TitlesOfParts,r,t),r}var Wp=/<[^>]+>[^<]*/g;function Vp(e,r){var t={},a="",n=e.match(Wp);if(n)for(var s=0;s!=n.length;++s){var i=n[s],o=fe(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":a=Se(o.name);break;case"</property>":a=null;break;default:if(i.indexOf("<vt:")===0){var c=i.split(">"),l=c[0].slice(4),f=c[1];switch(l){case"lpstr":case"bstr":case"lpwstr":t[a]=Se(f);break;case"bool":t[a]=Le(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[a]=parseInt(f,10);break;case"r4":case"r8":case"decimal":t[a]=parseFloat(f);break;case"filetime":case"date":t[a]=nt(f);break;case"cy":case"error":t[a]=Se(f);break;default:if(l.slice(-1)=="/")break;r.WTF&&typeof console<"u"&&console.warn("Unexpected",i,l,c)}}else if(i.slice(0,2)!=="</"){if(r.WTF)throw new Error(i)}}}return t}var Gp={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Ds;function qp(e,r,t){Ds||(Ds=Pi(Gp)),r=Ds[r]||r,e[r]=t}function Hi(e){var r=e.read_shift(4),t=e.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+r/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function C0(e,r,t){var a=e.l,n=e.read_shift(0,"lpstr-cp");if(t)for(;e.l-a&3;)++e.l;return n}function I0(e,r,t){var a=e.read_shift(0,"lpwstr");return a}function P0(e,r,t){return r===31?I0(e):C0(e,r,t)}function Js(e,r,t){return P0(e,r,t===!1?0:4)}function zp(e,r){if(!r)throw new Error("VtUnalignedString must have positive length");return P0(e,r,0)}function Kp(e){for(var r=e.read_shift(4),t=[],a=0;a!=r;++a){var n=e.l;t[a]=e.read_shift(0,"lpwstr").replace(St,""),e.l-n&2&&(e.l+=2)}return t}function Xp(e){for(var r=e.read_shift(4),t=[],a=0;a!=r;++a)t[a]=e.read_shift(0,"lpstr-cp").replace(St,"");return t}function Yp(e){var r=e.l,t=Qn(e,S0);e[e.l]==0&&e[e.l+1]==0&&e.l-r&2&&(e.l+=2);var a=Qn(e,Ft);return[t,a]}function Jp(e){for(var r=e.read_shift(4),t=[],a=0;a<r/2;++a)t.push(Yp(e));return t}function sc(e,r){for(var t=e.read_shift(4),a={},n=0;n!=t;++n){var s=e.read_shift(4),i=e.read_shift(4);a[s]=e.read_shift(i,r===1200?"utf16le":"utf8").replace(St,"").replace(Wa,"!"),r===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),a}function D0(e){var r=e.read_shift(4),t=e.slice(e.l,e.l+r);return e.l+=r,(r&3)>0&&(e.l+=4-(r&3)&3),t}function Qp(e){var r={};return r.Size=e.read_shift(4),e.l+=r.Size+3-(r.Size-1)%4,r}function Qn(e,r,t){var a=e.read_shift(2),n,s=t||{};if(e.l+=2,r!==rc&&a!==r&&Ip.indexOf(r)===-1&&!((r&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+r+" saw "+a);switch(r===rc?a:r){case 2:return n=e.read_shift(2,"i"),s.raw||(e.l+=2),n;case 3:return n=e.read_shift(4,"i"),n;case 11:return e.read_shift(4)!==0;case 19:return n=e.read_shift(4),n;case 30:return C0(e,a,4).replace(St,"");case 31:return I0(e);case 64:return Hi(e);case 65:return D0(e);case 71:return Qp(e);case 80:return Js(e,a,!s.raw).replace(St,"");case 81:return zp(e,a).replace(St,"");case 4108:return Jp(e);case 4126:case 4127:return a==4127?Kp(e):Xp(e);default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+a)}}function ic(e,r){var t=e.l,a=e.read_shift(4),n=e.read_shift(4),s=[],i=0,o=0,c=-1,l={};for(i=0;i!=n;++i){var f=e.read_shift(4),u=e.read_shift(4);s[i]=[f,u+t]}s.sort(function(b,v){return b[1]-v[1]});var d={};for(i=0;i!=n;++i){if(e.l!==s[i][1]){var h=!0;if(i>0&&r)switch(r[s[i-1][0]].t){case 2:e.l+2===s[i][1]&&(e.l+=2,h=!1);break;case 80:e.l<=s[i][1]&&(e.l=s[i][1],h=!1);break;case 4108:e.l<=s[i][1]&&(e.l=s[i][1],h=!1);break}if((!r||i==0)&&e.l<=s[i][1]&&(h=!1,e.l=s[i][1]),h)throw new Error("Read Error: Expected address "+s[i][1]+" at "+e.l+" :"+i)}if(r){var g=r[s[i][0]];if(d[g.n]=Qn(e,g.t,{raw:!0}),g.p==="version"&&(d[g.n]=String(d[g.n]>>16)+"."+("0000"+String(d[g.n]&65535)).slice(-4)),g.n=="CodePage")switch(d[g.n]){case 0:d[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Zt(o=d[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[g.n])}}else if(s[i][0]===1){if(o=d.CodePage=Qn(e,ji),Zt(o),c!==-1){var p=e.l;e.l=s[c][1],l=sc(e,o),e.l=p}}else if(s[i][0]===0){if(o===0){c=i,e.l=s[i+1][1];continue}l=sc(e,o)}else{var m=l[s[i][0]],_;switch(e[e.l]){case 65:e.l+=4,_=D0(e);break;case 30:e.l+=4,_=Js(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,_=Js(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,_=e.read_shift(4,"i");break;case 19:e.l+=4,_=e.read_shift(4);break;case 5:e.l+=4,_=e.read_shift(8,"f");break;case 11:e.l+=4,_=qe(e,4);break;case 64:e.l+=4,_=nt(Hi(e));break;default:throw new Error("unparsed value: "+e[e.l])}d[m]=_}}return e.l=t+a,d}function oc(e,r,t){var a=e.content;if(!a)return{};st(a,0);var n,s,i,o,c=0;a.chk("feff","Byte Order: "),a.read_shift(2);var l=a.read_shift(4),f=a.read_shift(16);if(f!==Ee.utils.consts.HEADER_CLSID&&f!==t)throw new Error("Bad PropertySet CLSID "+f);if(n=a.read_shift(4),n!==1&&n!==2)throw new Error("Unrecognized #Sets: "+n);if(s=a.read_shift(16),o=a.read_shift(4),n===1&&o!==a.l)throw new Error("Length mismatch: "+o+" !== "+a.l);n===2&&(i=a.read_shift(16),c=a.read_shift(4));var u=ic(a,r),d={SystemIdentifier:l};for(var h in u)d[h]=u[h];if(d.FMTID=s,n===1)return d;if(c-a.l==2&&(a.l+=2),a.l!==c)throw new Error("Length mismatch 2: "+a.l+" !== "+c);var g;try{g=ic(a,null)}catch{}for(h in g)d[h]=g[h];return d.FMTID=[s,i],d}function Sr(e,r){return e.read_shift(r),null}function Zp(e,r,t){for(var a=[],n=e.l+r;e.l<n;)a.push(t(e,n-e.l));if(n!==e.l)throw new Error("Slurp error");return a}function qe(e,r){return e.read_shift(r)===1}function Xe(e){return e.read_shift(2,"u")}function O0(e,r){return Zp(e,r,Xe)}function e1(e){var r=e.read_shift(1),t=e.read_shift(1);return t===1?r:r===1}function _n(e,r,t){var a=e.read_shift(t&&t.biff>=12?2:1),n="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var s=e.read_shift(1);s&&(n="dbcs-cont")}else t.biff==12&&(n="wstr");t.biff>=2&&t.biff<=5&&(n="cpstr");var i=a?e.read_shift(a,n):"";return i}function t1(e){var r=e.read_shift(2),t=e.read_shift(1),a=t&4,n=t&8,s=1+(t&1),i=0,o,c={};n&&(i=e.read_shift(2)),a&&(o=e.read_shift(4));var l=s==2?"dbcs-cont":"sbcs-cont",f=r===0?"":e.read_shift(r,l);return n&&(e.l+=4*i),a&&(e.l+=o),c.t=f,n||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function ra(e,r,t){var a;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(r,"cpstr");if(t.biff>=12)return e.read_shift(r,"dbcs-cont")}var n=e.read_shift(1);return n===0?a=e.read_shift(r,"sbcs-cont"):a=e.read_shift(r,"dbcs-cont"),a}function En(e,r,t){var a=e.read_shift(t&&t.biff==2?1:2);return a===0?(e.l++,""):ra(e,a,t)}function fa(e,r,t){if(t.biff>5)return En(e,r,t);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function r1(e){var r=e.read_shift(1);e.l++;var t=e.read_shift(2);return e.l+=2,[r,t]}function a1(e){var r=e.read_shift(4),t=e.l,a=!1;r>24&&(e.l+=r-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),e.l=t);var n=e.read_shift((a?r-24:r)>>1,"utf16le").replace(St,"");return a&&(e.l+=24),n}function n1(e){for(var r=e.read_shift(2),t="";r-- >0;)t+="../";var a=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var n=e.read_shift(4);if(n===0)return t+a.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(s>>1,"utf16le").replace(St,"");return t+i}function s1(e,r){var t=e.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return a1(e);case"0303000000000000c000000000000046":return n1(e);default:throw new Error("Unsupported Moniker "+t)}}function $n(e){var r=e.read_shift(4),t=r>0?e.read_shift(r,"utf16le").replace(St,""):"";return t}function i1(e,r){var t=e.l+r,a=e.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var n=e.read_shift(2);e.l+=2;var s,i,o,c,l="",f,u;n&16&&(s=$n(e,t-e.l)),n&128&&(i=$n(e,t-e.l)),(n&257)===257&&(o=$n(e,t-e.l)),(n&257)===1&&(c=s1(e,t-e.l)),n&8&&(l=$n(e,t-e.l)),n&32&&(f=e.read_shift(16)),n&64&&(u=Hi(e)),e.l=t;var d=i||o||c||"";d&&l&&(d+="#"+l),d||(d="#"+l),n&2&&d.charAt(0)=="/"&&d.charAt(1)!="/"&&(d="file://"+d);var h={Target:d};return f&&(h.guid=f),u&&(h.time=u),s&&(h.Tooltip=s),h}function R0(e){var r=e.read_shift(1),t=e.read_shift(1),a=e.read_shift(1),n=e.read_shift(1);return[r,t,a,n]}function L0(e,r){var t=R0(e);return t[3]=0,t}function lr(e){var r=e.read_shift(2),t=e.read_shift(2),a=e.read_shift(2);return{r,c:t,ixfe:a}}function o1(e){var r=e.read_shift(2),t=e.read_shift(2);return e.l+=8,{type:r,flags:t}}function c1(e,r,t){return r===0?"":fa(e,r,t)}function l1(e,r,t){var a=t.biff>8?4:2,n=e.read_shift(a),s=e.read_shift(a,"i"),i=e.read_shift(a,"i");return[n,s,i]}function B0(e){var r=e.read_shift(2),t=Ui(e);return[r,t]}function f1(e,r,t){e.l+=4,r-=4;var a=e.l+r,n=_n(e,r,t),s=e.read_shift(2);if(a-=e.l,s!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+s);return e.l+=s,n}function ps(e){var r=e.read_shift(2),t=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2);return{s:{c:a,r},e:{c:n,r:t}}}function M0(e){var r=e.read_shift(2),t=e.read_shift(2),a=e.read_shift(1),n=e.read_shift(1);return{s:{c:a,r},e:{c:n,r:t}}}var u1=M0;function N0(e){e.l+=4;var r=e.read_shift(2),t=e.read_shift(2),a=e.read_shift(2);return e.l+=12,[t,r,a]}function d1(e){var r={};return e.l+=4,e.l+=16,r.fSharedNote=e.read_shift(2),e.l+=4,r}function h1(e){var r={};return e.l+=4,e.cf=e.read_shift(2),r}function lt(e){e.l+=2,e.l+=e.read_shift(2)}var g1={0:lt,4:lt,5:lt,6:lt,7:h1,8:lt,9:lt,10:lt,11:lt,12:lt,13:d1,14:lt,15:lt,16:lt,17:lt,18:lt,19:lt,20:lt,21:N0};function p1(e,r){for(var t=e.l+r,a=[];e.l<t;){var n=e.read_shift(2);e.l-=2;try{a.push(g1[n](e,t-e.l))}catch{return e.l=t,a}}return e.l!=t&&(e.l=t),a}function Un(e,r){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=e.read_shift(2),r-=2,r>=2&&(t.dt=e.read_shift(2),e.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(r>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return e.read_shift(r),t}function m1(e,r){return r===0||e.read_shift(2),1200}function x1(e,r,t){if(t.enc)return e.l+=r,"";var a=e.l,n=fa(e,0,t);return e.read_shift(r+a-e.l),n}function v1(e,r,t){var a=t&&t.biff==8||r==2?e.read_shift(2):(e.l+=r,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function w1(e,r,t){var a=e.read_shift(4),n=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var i=_n(e,0,t);return i.length===0&&(i="Sheet1"),{pos:a,hs:n,dt:s,name:i}}function y1(e,r){for(var t=e.l+r,a=e.read_shift(4),n=e.read_shift(4),s=[],i=0;i!=n&&e.l<t;++i)s.push(t1(e));return s.Count=a,s.Unique=n,s}function _1(e,r){var t={};return t.dsst=e.read_shift(2),e.l+=r-2,t}function E1(e){var r={};r.r=e.read_shift(2),r.c=e.read_shift(2),r.cnt=e.read_shift(2)-r.c;var t=e.read_shift(2);e.l+=4;var a=e.read_shift(1);return e.l+=3,a&7&&(r.level=a&7),a&32&&(r.hidden=!0),a&64&&(r.hpt=t/20),r}function k1(e){var r=o1(e);if(r.type!=2211)throw new Error("Invalid Future Record "+r.type);var t=e.read_shift(4);return t!==0}function T1(e){return e.read_shift(2),e.read_shift(4)}function cc(e,r,t){var a=0;t&&t.biff==2||(a=e.read_shift(2));var n=e.read_shift(2);t&&t.biff==2&&(a=1-(n>>15),n&=32767);var s={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[s,n]}function S1(e){var r=e.read_shift(2),t=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),l=e.read_shift(2);return{Pos:[r,t],Dim:[a,n],Flags:s,CurTab:i,FirstTab:o,Selected:c,TabRatio:l}}function A1(e,r,t){if(t&&t.biff>=2&&t.biff<5)return{};var a=e.read_shift(2);return{RTL:a&64}}function b1(){}function F1(e,r,t){var a={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return a.name=_n(e,0,t),a}function C1(e){var r=lr(e);return r.isst=e.read_shift(4),r}function I1(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var a=e.l+r,n=lr(e);t.biff==2&&e.l++;var s=En(e,a-e.l,t);return n.val=s,n}function P1(e,r,t){var a=e.read_shift(2),n=fa(e,0,t);return[a,n]}var D1=fa;function lc(e,r,t){var a=e.l+r,n=t.biff==8||!t.biff?4:2,s=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(2),c=e.read_shift(2);return e.l=a,{s:{r:s,c:o},e:{r:i,c}}}function O1(e){var r=e.read_shift(2),t=e.read_shift(2),a=B0(e);return{r,c:t,ixfe:a[0],rknum:a[1]}}function R1(e,r){for(var t=e.l+r-2,a=e.read_shift(2),n=e.read_shift(2),s=[];e.l<t;)s.push(B0(e));if(e.l!==t)throw new Error("MulRK read error");var i=e.read_shift(2);if(s.length!=i-n+1)throw new Error("MulRK length mismatch");return{r:a,c:n,C:i,rkrec:s}}function L1(e,r){for(var t=e.l+r-2,a=e.read_shift(2),n=e.read_shift(2),s=[];e.l<t;)s.push(e.read_shift(2));if(e.l!==t)throw new Error("MulBlank read error");var i=e.read_shift(2);if(s.length!=i-n+1)throw new Error("MulBlank length mismatch");return{r:a,c:n,C:i,ixfe:s}}function B1(e,r,t,a){var n={},s=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(2);return n.patternType=Op[o>>26],a.cellStyles&&(n.alc=s&7,n.fWrap=s>>3&1,n.alcV=s>>4&7,n.fJustLast=s>>7&1,n.trot=s>>8&255,n.cIndent=s>>16&15,n.fShrinkToFit=s>>20&1,n.iReadOrder=s>>22&2,n.fAtrNum=s>>26&1,n.fAtrFnt=s>>27&1,n.fAtrAlc=s>>28&1,n.fAtrBdr=s>>29&1,n.fAtrPat=s>>30&1,n.fAtrProt=s>>31&1,n.dgLeft=i&15,n.dgRight=i>>4&15,n.dgTop=i>>8&15,n.dgBottom=i>>12&15,n.icvLeft=i>>16&127,n.icvRight=i>>23&127,n.grbitDiag=i>>30&3,n.icvTop=o&127,n.icvBottom=o>>7&127,n.icvDiag=o>>14&127,n.dgDiag=o>>21&15,n.icvFore=c&127,n.icvBack=c>>7&127,n.fsxButton=c>>14&1),n}function M1(e,r,t){var a={};return a.ifnt=e.read_shift(2),a.numFmtId=e.read_shift(2),a.flags=e.read_shift(2),a.fStyle=a.flags>>2&1,r-=6,a.data=B1(e,r,a.fStyle,t),a}function N1(e){e.l+=4;var r=[e.read_shift(2),e.read_shift(2)];if(r[0]!==0&&r[0]--,r[1]!==0&&r[1]--,r[0]>7||r[1]>7)throw new Error("Bad Gutters: "+r.join("|"));return r}function fc(e,r,t){var a=lr(e);(t.biff==2||r==9)&&++e.l;var n=e1(e);return a.val=n,a.t=n===!0||n===!1?"b":"e",a}function $1(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var a=lr(e),n=dt(e);return a.val=n,a}var uc=c1;function U1(e,r,t){var a=e.l+r,n=e.read_shift(2),s=e.read_shift(2);if(t.sbcch=s,s==1025||s==14849)return[s,n];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var i=ra(e,s),o=[];a>e.l;)o.push(En(e));return[s,n,i,o]}function dc(e,r,t){var a=e.read_shift(2),n,s={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return t.sbcch===14849&&(n=f1(e,r-2,t)),s.body=n||e.read_shift(r-2),typeof n=="string"&&(s.Name=n),s}var j1=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function hc(e,r,t){var a=e.l+r,n=e.read_shift(2),s=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(t&&t.biff==2?1:2),c=0;(!t||t.biff>=5)&&(t.biff!=5&&(e.l+=2),c=e.read_shift(2),t.biff==5&&(e.l+=2),e.l+=4);var l=ra(e,i,t);n&32&&(l=j1[l.charCodeAt(0)]);var f=a-e.l;t&&t.biff==2&&--f;var u=a==e.l||o===0||!(f>0)?[]:Ew(e,f,t,o);return{chKey:s,Name:l,itab:c,rgce:u}}function $0(e,r,t){if(t.biff<8)return H1(e,r,t);for(var a=[],n=e.l+r,s=e.read_shift(t.biff>8?4:2);s--!==0;)a.push(l1(e,t.biff>8?12:6,t));if(e.l!=n)throw new Error("Bad ExternSheet: "+e.l+" != "+n);return a}function H1(e,r,t){e[e.l+1]==3&&e[e.l]++;var a=_n(e,r,t);return a.charCodeAt(0)==3?a.slice(1):a}function W1(e,r,t){if(t.biff<8){e.l+=r;return}var a=e.read_shift(2),n=e.read_shift(2),s=ra(e,a,t),i=ra(e,n,t);return[s,i]}function V1(e,r,t){var a=M0(e);e.l++;var n=e.read_shift(1);return r-=8,[kw(e,r,t),n,a]}function gc(e,r,t){var a=u1(e);switch(t.biff){case 2:e.l++,r-=7;break;case 3:case 4:e.l+=2,r-=8;break;default:e.l+=6,r-=12}return[a,yw(e,r,t)]}function G1(e){var r=e.read_shift(4)!==0,t=e.read_shift(4)!==0,a=e.read_shift(4);return[r,t,a]}function q1(e,r,t){if(!(t.biff<8)){var a=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=fa(e,0,t);return t.biff<8&&e.read_shift(1),[{r:a,c:n},o,i,s]}}function z1(e,r,t){return q1(e,r,t)}function K1(e,r){for(var t=[],a=e.read_shift(2);a--;)t.push(ps(e));return t}function X1(e,r,t){if(t&&t.biff<8)return J1(e,r,t);var a=N0(e),n=p1(e,r-22,a[1]);return{cmo:a,ft:n}}var Y1={8:function(e,r){var t=e.l+r;e.l+=10;var a=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var n=e.read_shift(1);return e.l+=n,e.l=t,{fmt:a}}};function J1(e,r,t){e.l+=4;var a=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,r-=36;var i=[];return i.push((Y1[a]||xt)(e,r,t)),{cmo:[n,a,s],ft:i}}function Q1(e,r,t){var a=e.l,n="";try{e.l+=4;var s=(t.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:i=r1(e,6,t);var o=e.read_shift(2);e.read_shift(2),Xe(e,2);var c=e.read_shift(2);e.l+=c;for(var l=1;l<e.lens.length-1;++l){if(e.l-a!=e.lens[l])throw new Error("TxO: bad continue record");var f=e[e.l],u=ra(e,e.lens[l+1]-e.lens[l]-1);if(n+=u,n.length>=(f?o:2*o))break}if(n.length!==o&&n.length!==o*2)throw new Error("cchText: "+o+" != "+n.length);return e.l=a+r,{t:n}}catch{return e.l=a+r,{t:n}}}function Z1(e,r){var t=ps(e);e.l+=16;var a=i1(e,r-24);return[t,a]}function em(e,r){e.read_shift(2);var t=ps(e),a=e.read_shift((r-10)/2,"dbcs-cont");return a=a.replace(St,""),[t,a]}function tm(e){var r=[0,0],t;return t=e.read_shift(2),r[0]=ac[t]||t,t=e.read_shift(2),r[1]=ac[t]||t,r}function rm(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(L0(e));return t}function am(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(L0(e));return t}function nm(e){e.l+=2;var r={cxfs:0,crc:0};return r.cxfs=e.read_shift(2),r.crc=e.read_shift(4),r}function U0(e,r,t){if(!t.cellStyles)return xt(e,r);var a=t&&t.biff>=12?4:2,n=e.read_shift(a),s=e.read_shift(a),i=e.read_shift(a),o=e.read_shift(a),c=e.read_shift(2);a==2&&(e.l+=2);var l={s:n,e:s,w:i,ixfe:o,flags:c};return(t.biff>=5||!t.biff)&&(l.level=c>>8&7),l}function sm(e,r){var t={};return r<32||(e.l+=16,t.header=dt(e),t.footer=dt(e),e.l+=2),t}function im(e,r,t){var a={area:!1};if(t.biff!=5)return e.l+=r,a;var n=e.read_shift(1);return e.l+=3,n&16&&(a.area=!0),a}var om=lr,cm=O0,lm=En;function fm(e){var r=e.read_shift(2),t=e.read_shift(2),a=e.read_shift(4),n={fmt:r,env:t,len:a,data:e.slice(e.l,e.l+a)};return e.l+=a,n}function um(e,r,t){t.biffguess&&t.biff==5&&(t.biff=2);var a=lr(e);++e.l;var n=fa(e,r-7,t);return a.t="str",a.val=n,a}function dm(e){var r=lr(e);++e.l;var t=dt(e);return r.t="n",r.val=t,r}function hm(e){var r=lr(e);++e.l;var t=e.read_shift(2);return r.t="n",r.val=t,r}function gm(e){var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,"sbcs-cont")}function pm(e,r){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=r-13}function mm(e,r,t){var a=e.l+r,n=lr(e),s=e.read_shift(2),i=ra(e,s,t);return e.l=a,n.t="str",n.val=i,n}var xm=[2,3,48,49,131,139,140,245],pc=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=Pi({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(o,c){var l=[],f=Mr(1);switch(c.type){case"base64":f=Qt(Nt(o));break;case"binary":f=Qt(o);break;case"buffer":case"array":f=o;break}st(f,0);var u=f.read_shift(1),d=!!(u&136),h=!1,g=!1;switch(u){case 2:break;case 3:break;case 48:h=!0,d=!0;break;case 49:h=!0,d=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+u.toString(16))}var p=0,m=521;u==2&&(p=f.read_shift(2)),f.l+=3,u!=2&&(p=f.read_shift(4)),p>1048576&&(p=1e6),u!=2&&(m=f.read_shift(2));var _=f.read_shift(2),b=c.codepage||1252;u!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(b=e[f[f.l]]),f.l+=1,f.l+=2),g&&(f.l+=36);for(var v=[],C={},R=Math.min(f.length,u==2?521:m-10-(h?264:0)),I=g?32:11;f.l<R&&f[f.l]!=13;)switch(C={},C.name=cn.utils.decode(b,f.slice(f.l,f.l+I)).replace(/[\u0000\r\n].*$/g,""),f.l+=I,C.type=String.fromCharCode(f.read_shift(1)),u!=2&&!g&&(C.offset=f.read_shift(4)),C.len=f.read_shift(1),u==2&&(C.offset=f.read_shift(2)),C.dec=f.read_shift(1),C.name.length&&v.push(C),u!=2&&(f.l+=g?13:14),C.type){case"B":(!h||C.len!=8)&&c.WTF&&console.log("Skipping "+C.name+":"+C.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+C.name+":"+C.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+C.type)}if(f[f.l]!==13&&(f.l=m-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=m;var T=0,H=0;for(l[0]=[],H=0;H!=v.length;++H)l[0][H]=v[H].name;for(;p-- >0;){if(f[f.l]===42){f.l+=_;continue}for(++f.l,l[++T]=[],H=0,H=0;H!=v.length;++H){var P=f.slice(f.l,f.l+v[H].len);f.l+=v[H].len,st(P,0);var q=cn.utils.decode(b,P);switch(v[H].type){case"C":q.trim().length&&(l[T][H]=q.replace(/\s+$/,""));break;case"D":q.length===8?l[T][H]=new Date(+q.slice(0,4),+q.slice(4,6)-1,+q.slice(6,8)):l[T][H]=q;break;case"F":l[T][H]=parseFloat(q.trim());break;case"+":case"I":l[T][H]=g?P.read_shift(-4,"i")^2147483648:P.read_shift(4,"i");break;case"L":switch(q.trim().toUpperCase()){case"Y":case"T":l[T][H]=!0;break;case"N":case"F":l[T][H]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+q+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+u.toString(16));l[T][H]="##MEMO##"+(g?parseInt(q.trim(),10):P.read_shift(4));break;case"N":q=q.replace(/\u0000/g,"").trim(),q&&q!="."&&(l[T][H]=+q||0);break;case"@":l[T][H]=new Date(P.read_shift(-8,"f")-621356832e5);break;case"T":l[T][H]=new Date((P.read_shift(4)-2440588)*864e5+P.read_shift(4));break;case"Y":l[T][H]=P.read_shift(4,"i")/1e4+P.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":l[T][H]=-P.read_shift(-8,"f");break;case"B":if(h&&v[H].len==8){l[T][H]=P.read_shift(8,"f");break}case"G":case"P":P.l+=v[H].len;break;case"0":if(v[H].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+v[H].type)}}}if(u!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return c&&c.sheetRows&&(l=l.slice(0,c.sheetRows)),c.DBF=v,l}function a(o,c){var l=c||{};l.dateNF||(l.dateNF="yyyymmdd");var f=Da(t(o,l),l);return f["!cols"]=l.DBF.map(function(u){return{wch:u.len,DBF:u}}),delete l.DBF,f}function n(o,c){try{return jr(a(o,c),c)}catch(l){if(c&&c.WTF)throw l}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,c){var l=c||{};if(+l.codepage>=0&&Zt(+l.codepage),l.type=="string")throw new Error("Cannot write DBF to JS string");var f=Ks(),u=ni(o,{header:1,raw:!0,cellDates:!0}),d=u[0],h=u.slice(1),g=o["!cols"]||[],p=0,m=0,_=0,b=1;for(p=0;p<d.length;++p){if(((g[p]||{}).DBF||{}).name){d[p]=g[p].DBF.name,++_;continue}if(d[p]!=null){if(++_,typeof d[p]=="number"&&(d[p]=d[p].toString(10)),typeof d[p]!="string")throw new Error("DBF Invalid column name "+d[p]+" |"+typeof d[p]+"|");if(d.indexOf(d[p])!==p){for(m=0;m<1024;++m)if(d.indexOf(d[p]+"_"+m)==-1){d[p]+="_"+m;break}}}}var v=He(o["!ref"]),C=[],R=[],I=[];for(p=0;p<=v.e.c-v.s.c;++p){var T="",H="",P=0,q=[];for(m=0;m<h.length;++m)h[m][p]!=null&&q.push(h[m][p]);if(q.length==0||d[p]==null){C[p]="?";continue}for(m=0;m<q.length;++m){switch(typeof q[m]){case"number":H="B";break;case"string":H="C";break;case"boolean":H="L";break;case"object":H=q[m]instanceof Date?"D":"C";break;default:H="C"}P=Math.max(P,String(q[m]).length),T=T&&T!=H?"C":H}P>250&&(P=250),H=((g[p]||{}).DBF||{}).type,H=="C"&&g[p].DBF.len>P&&(P=g[p].DBF.len),T=="B"&&H=="N"&&(T="N",I[p]=g[p].DBF.dec,P=g[p].DBF.len),R[p]=T=="C"||H=="N"?P:s[T]||0,b+=R[p],C[p]=T}var V=f.next(32);for(V.write_shift(4,318902576),V.write_shift(4,h.length),V.write_shift(2,296+32*_),V.write_shift(2,b),p=0;p<4;++p)V.write_shift(4,0);for(V.write_shift(4,0|(+r[$l]||3)<<8),p=0,m=0;p<d.length;++p)if(d[p]!=null){var L=f.next(32),J=(d[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);L.write_shift(1,J,"sbcs"),L.write_shift(1,C[p]=="?"?"C":C[p],"sbcs"),L.write_shift(4,m),L.write_shift(1,R[p]||s[C[p]]||0),L.write_shift(1,I[p]||0),L.write_shift(1,2),L.write_shift(4,0),L.write_shift(1,0),L.write_shift(4,0),L.write_shift(4,0),m+=R[p]||s[C[p]]||0}var le=f.next(264);for(le.write_shift(4,13),p=0;p<65;++p)le.write_shift(4,0);for(p=0;p<h.length;++p){var re=f.next(b);for(re.write_shift(1,0),m=0;m<d.length;++m)if(d[m]!=null)switch(C[m]){case"L":re.write_shift(1,h[p][m]==null?63:h[p][m]?84:70);break;case"B":re.write_shift(8,h[p][m]||0,"f");break;case"N":var ce="0";for(typeof h[p][m]=="number"&&(ce=h[p][m].toFixed(I[m]||0)),_=0;_<R[m]-ce.length;++_)re.write_shift(1,32);re.write_shift(1,ce,"sbcs");break;case"D":h[p][m]?(re.write_shift(4,("0000"+h[p][m].getFullYear()).slice(-4),"sbcs"),re.write_shift(2,("00"+(h[p][m].getMonth()+1)).slice(-2),"sbcs"),re.write_shift(2,("00"+h[p][m].getDate()).slice(-2),"sbcs")):re.write_shift(8,"00000000","sbcs");break;case"C":var oe=String(h[p][m]!=null?h[p][m]:"").slice(0,R[m]);for(re.write_shift(1,oe,"sbcs"),_=0;_<R[m]-oe.length;++_)re.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:n,to_sheet:a,from_sheet:i}}(),vm=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+or(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(d,h){var g=e[h];return typeof g=="number"?Po(g):g},a=function(d,h,g){var p=h.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return p==59?d:Po(p)};e["|"]=254;function n(d,h){switch(h.type){case"base64":return s(Nt(d),h);case"binary":return s(d,h);case"buffer":return s(_e&&Buffer.isBuffer(d)?d.toString("binary"):ia(d),h);case"array":return s(ta(d),h)}throw new Error("Unrecognized type "+h.type)}function s(d,h){var g=d.split(/[\n\r]+/),p=-1,m=-1,_=0,b=0,v=[],C=[],R=null,I={},T=[],H=[],P=[],q=0,V;for(+h.codepage>=0&&Zt(+h.codepage);_!==g.length;++_){q=0;var L=g[_].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(r,t),J=L.replace(/;;/g,"\0").split(";").map(function(D){return D.replace(/\u0000/g,";")}),le=J[0],re;if(L.length>0)switch(le){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":J[1].charAt(0)=="P"&&C.push(L.slice(3).replace(/;;/g,";"));break;case"C":var ce=!1,oe=!1,Re=!1,W=!1,ue=-1,de=-1;for(b=1;b<J.length;++b)switch(J[b].charAt(0)){case"A":break;case"X":m=parseInt(J[b].slice(1))-1,oe=!0;break;case"Y":for(p=parseInt(J[b].slice(1))-1,oe||(m=0),V=v.length;V<=p;++V)v[V]=[];break;case"K":re=J[b].slice(1),re.charAt(0)==='"'?re=re.slice(1,re.length-1):re==="TRUE"?re=!0:re==="FALSE"?re=!1:isNaN(tr(re))?isNaN(Sa(re).getDate())||(re=nt(re)):(re=tr(re),R!==null&&Ia(R)&&(re=gs(re))),ce=!0;break;case"E":W=!0;var A=_a(J[b].slice(1),{r:p,c:m});v[p][m]=[v[p][m],A];break;case"S":Re=!0,v[p][m]=[v[p][m],"S5S"];break;case"G":break;case"R":ue=parseInt(J[b].slice(1))-1;break;case"C":de=parseInt(J[b].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+L)}if(ce&&(v[p][m]&&v[p][m].length==2?v[p][m][0]=re:v[p][m]=re,R=null),Re){if(W)throw new Error("SYLK shared formula cannot have own formula");var U=ue>-1&&v[ue][de];if(!U||!U[1])throw new Error("SYLK shared formula cannot find base");v[p][m][1]=Y0(U[1],{r:p-ue,c:m-de})}break;case"F":var O=0;for(b=1;b<J.length;++b)switch(J[b].charAt(0)){case"X":m=parseInt(J[b].slice(1))-1,++O;break;case"Y":for(p=parseInt(J[b].slice(1))-1,V=v.length;V<=p;++V)v[V]=[];break;case"M":q=parseInt(J[b].slice(1))/20;break;case"F":break;case"G":break;case"P":R=C[parseInt(J[b].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(P=J[b].slice(1).split(" "),V=parseInt(P[0],10);V<=parseInt(P[1],10);++V)q=parseInt(P[2],10),H[V-1]=q===0?{hidden:!0}:{wch:q},Aa(H[V-1]);break;case"C":m=parseInt(J[b].slice(1))-1,H[m]||(H[m]={});break;case"R":p=parseInt(J[b].slice(1))-1,T[p]||(T[p]={}),q>0?(T[p].hpt=q,T[p].hpx=gn(q)):q===0&&(T[p].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+L)}O<1&&(R=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+L)}}return T.length>0&&(I["!rows"]=T),H.length>0&&(I["!cols"]=H),h&&h.sheetRows&&(v=v.slice(0,h.sheetRows)),[v,I]}function i(d,h){var g=n(d,h),p=g[0],m=g[1],_=Da(p,h);return or(m).forEach(function(b){_[b]=m[b]}),_}function o(d,h){return jr(i(d,h),h)}function c(d,h,g,p){var m="C;Y"+(g+1)+";X"+(p+1)+";K";switch(d.t){case"n":m+=d.v||0,d.f&&!d.F&&(m+=";E"+nv(d.f,{r:g,c:p}));break;case"b":m+=d.v?"TRUE":"FALSE";break;case"e":m+=d.w||d.v;break;case"d":m+='"'+(d.w||d.v)+'"';break;case"s":m+='"'+d.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return m}function l(d,h){h.forEach(function(g,p){var m="F;W"+(p+1)+" "+(p+1)+" ";g.hidden?m+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=es(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=ts(g.wpx)),typeof g.wch=="number"&&(m+=Math.round(g.wch))),m.charAt(m.length-1)!=" "&&d.push(m)})}function f(d,h){h.forEach(function(g,p){var m="F;";g.hidden?m+="M0;":g.hpt?m+="M"+20*g.hpt+";":g.hpx&&(m+="M"+20*z0(g.hpx)+";"),m.length>2&&d.push(m+"R"+(p+1))})}function u(d,h){var g=["ID;PWXL;N;E"],p=[],m=He(d["!ref"]),_,b=Array.isArray(d),v=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),d["!cols"]&&l(g,d["!cols"]),d["!rows"]&&f(g,d["!rows"]),g.push("B;Y"+(m.e.r-m.s.r+1)+";X"+(m.e.c-m.s.c+1)+";D"+[m.s.c,m.s.r,m.e.c,m.e.r].join(" "));for(var C=m.s.r;C<=m.e.r;++C)for(var R=m.s.c;R<=m.e.c;++R){var I=he({r:C,c:R});_=b?(d[C]||[])[R]:d[I],!(!_||_.v==null&&(!_.f||_.F))&&p.push(c(_,d,C,R))}return g.join(v)+v+p.join(v)+v+"E"+v}return{to_workbook:o,to_sheet:i,from_sheet:u}}(),wm=function(){function e(s,i){switch(i.type){case"base64":return r(Nt(s),i);case"binary":return r(s,i);case"buffer":return r(_e&&Buffer.isBuffer(s)?s.toString("binary"):ia(s),i);case"array":return r(ta(s),i)}throw new Error("Unrecognized type "+i.type)}function r(s,i){for(var o=s.split(`
`),c=-1,l=-1,f=0,u=[];f!==o.length;++f){if(o[f].trim()==="BOT"){u[++c]=[],l=0;continue}if(!(c<0)){var d=o[f].trim().split(","),h=d[0],g=d[1];++f;for(var p=o[f]||"";(p.match(/["]/g)||[]).length&1&&f<o.length-1;)p+=`
`+o[++f];switch(p=p.trim(),+h){case-1:if(p==="BOT"){u[++c]=[],l=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?u[c][l]=!0:p==="FALSE"?u[c][l]=!1:isNaN(tr(g))?isNaN(Sa(g).getDate())?u[c][l]=g:u[c][l]=nt(g):u[c][l]=tr(g),++l;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),u[c][l++]=p!==""?p:null;break}if(p==="EOD")break}}return i&&i.sheetRows&&(u=u.slice(0,i.sheetRows)),u}function t(s,i){return Da(e(s,i),i)}function a(s,i){return jr(t(s,i),i)}var n=function(){var s=function(c,l,f,u,d){c.push(l),c.push(f+","+u),c.push('"'+d.replace(/"/g,'""')+'"')},i=function(c,l,f,u){c.push(l+","+f),c.push(l==1?'"'+u.replace(/"/g,'""')+'"':u)};return function(c){var l=[],f=He(c["!ref"]),u,d=Array.isArray(c);s(l,"TABLE",0,1,"sheetjs"),s(l,"VECTORS",0,f.e.r-f.s.r+1,""),s(l,"TUPLES",0,f.e.c-f.s.c+1,""),s(l,"DATA",0,0,"");for(var h=f.s.r;h<=f.e.r;++h){i(l,-1,0,"BOT");for(var g=f.s.c;g<=f.e.c;++g){var p=he({r:h,c:g});if(u=d?(c[h]||[])[g]:c[p],!u){i(l,1,0,"");continue}switch(u.t){case"n":var m=u.w;!m&&u.v!=null&&(m=u.v),m==null?u.f&&!u.F?i(l,1,0,"="+u.f):i(l,1,0,""):i(l,0,m,"V");break;case"b":i(l,0,u.v?1:0,u.v?"TRUE":"FALSE");break;case"s":i(l,1,0,isNaN(u.v)?u.v:'="'+u.v+'"');break;case"d":u.w||(u.w=qt(u.z||me[14],At(nt(u.v)))),i(l,0,u.w,"V");break;default:i(l,1,0,"")}}}i(l,-1,0,"EOD");var _=`\r
`,b=l.join(_);return b}}();return{to_workbook:a,to_sheet:t,from_sheet:n}}(),ym=function(){function e(u){return u.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(u){return u.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(u,d){for(var h=u.split(`
`),g=-1,p=-1,m=0,_=[];m!==h.length;++m){var b=h[m].trim().split(":");if(b[0]==="cell"){var v=Tt(b[1]);if(_.length<=v.r)for(g=_.length;g<=v.r;++g)_[g]||(_[g]=[]);switch(g=v.r,p=v.c,b[2]){case"t":_[g][p]=e(b[3]);break;case"v":_[g][p]=+b[3];break;case"vtf":var C=b[b.length-1];case"vtc":switch(b[3]){case"nl":_[g][p]=!!+b[4];break;default:_[g][p]=+b[4];break}b[2]=="vtf"&&(_[g][p]=[_[g][p],C])}}}return d&&d.sheetRows&&(_=_.slice(0,d.sheetRows)),_}function a(u,d){return Da(t(u,d),d)}function n(u,d){return jr(a(u,d),d)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function l(u){if(!u||!u["!ref"])return"";for(var d=[],h=[],g,p="",m=Pa(u["!ref"]),_=Array.isArray(u),b=m.s.r;b<=m.e.r;++b)for(var v=m.s.c;v<=m.e.c;++v)if(p=he({r:b,c:v}),g=_?(u[b]||[])[v]:u[p],!(!g||g.v==null||g.t==="z")){switch(h=["cell",p,"t"],g.t){case"s":case"str":h.push(r(g.v));break;case"n":g.f?(h[2]="vtf",h[3]="n",h[4]=g.v,h[5]=r(g.f)):(h[2]="v",h[3]=g.v);break;case"b":h[2]="vt"+(g.f?"f":"c"),h[3]="nl",h[4]=g.v?"1":"0",h[5]=r(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var C=At(nt(g.v));h[2]="vtc",h[3]="nd",h[4]=""+C,h[5]=g.w||qt(g.z||me[14],C);break;case"e":continue}d.push(h.join(":"))}return d.push("sheet:c:"+(m.e.c-m.s.c+1)+":r:"+(m.e.r-m.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join(`
`)}function f(u){return[s,i,o,i,l(u),c].join(`
`)}return{to_workbook:n,to_sheet:a,from_sheet:f}}(),dn=function(){function e(f,u,d,h,g){g.raw?u[d][h]=f:f===""||(f==="TRUE"?u[d][h]=!0:f==="FALSE"?u[d][h]=!1:isNaN(tr(f))?isNaN(Sa(f).getDate())?u[d][h]=f:u[d][h]=nt(f):u[d][h]=tr(f))}function r(f,u){var d=u||{},h=[];if(!f||f.length===0)return h;for(var g=f.split(/[\r\n]/),p=g.length-1;p>=0&&g[p].length===0;)--p;for(var m=10,_=0,b=0;b<=p;++b)_=g[b].indexOf(" "),_==-1?_=g[b].length:_++,m=Math.max(m,_);for(b=0;b<=p;++b){h[b]=[];var v=0;for(e(g[b].slice(0,m).trim(),h,b,v,d),v=1;v<=(g[b].length-m)/10+1;++v)e(g[b].slice(m+(v-1)*10,m+v*10).trim(),h,b,v,d)}return d.sheetRows&&(h=h.slice(0,d.sheetRows)),h}var t={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function n(f){for(var u={},d=!1,h=0,g=0;h<f.length;++h)(g=f.charCodeAt(h))==34?d=!d:!d&&g in t&&(u[g]=(u[g]||0)+1);g=[];for(h in u)Object.prototype.hasOwnProperty.call(u,h)&&g.push([u[h],h]);if(!g.length){u=a;for(h in u)Object.prototype.hasOwnProperty.call(u,h)&&g.push([u[h],h])}return g.sort(function(p,m){return p[0]-m[0]||a[p[1]]-a[m[1]]}),t[g.pop()[1]]||44}function s(f,u){var d=u||{},h="",g=d.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(h=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(h=f.charAt(4),f=f.slice(6)):h=n(f.slice(0,1024)):d&&d.FS?h=d.FS:h=n(f.slice(0,1024));var m=0,_=0,b=0,v=0,C=0,R=h.charCodeAt(0),I=!1,T=0,H=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var P=d.dateNF!=null?Pg(d.dateNF):null;function q(){var V=f.slice(v,C),L={};if(V.charAt(0)=='"'&&V.charAt(V.length-1)=='"'&&(V=V.slice(1,-1).replace(/""/g,'"')),V.length===0)L.t="z";else if(d.raw)L.t="s",L.v=V;else if(V.trim().length===0)L.t="s",L.v=V;else if(V.charCodeAt(0)==61)V.charCodeAt(1)==34&&V.charCodeAt(V.length-1)==34?(L.t="s",L.v=V.slice(2,-1).replace(/""/g,'"')):iv(V)?(L.t="n",L.f=V.slice(1)):(L.t="s",L.v=V);else if(V=="TRUE")L.t="b",L.v=!0;else if(V=="FALSE")L.t="b",L.v=!1;else if(!isNaN(b=tr(V)))L.t="n",d.cellText!==!1&&(L.w=V),L.v=b;else if(!isNaN(Sa(V).getDate())||P&&V.match(P)){L.z=d.dateNF||me[14];var J=0;P&&V.match(P)&&(V=Dg(V,d.dateNF,V.match(P)||[]),J=1),d.cellDates?(L.t="d",L.v=nt(V,J)):(L.t="n",L.v=At(nt(V,J))),d.cellText!==!1&&(L.w=qt(L.z,L.v instanceof Date?At(L.v):L.v)),d.cellNF||delete L.z}else L.t="s",L.v=V;if(L.t=="z"||(d.dense?(g[m]||(g[m]=[]),g[m][_]=L):g[he({c:_,r:m})]=L),v=C+1,H=f.charCodeAt(v),p.e.c<_&&(p.e.c=_),p.e.r<m&&(p.e.r=m),T==R)++_;else if(_=0,++m,d.sheetRows&&d.sheetRows<=m)return!0}e:for(;C<f.length;++C)switch(T=f.charCodeAt(C)){case 34:H===34&&(I=!I);break;case R:case 10:case 13:if(!I&&q())break e;break}return C-v>0&&q(),g["!ref"]=ke(p),g}function i(f,u){return!(u&&u.PRN)||u.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?s(f,u):Da(r(f,u),u)}function o(f,u){var d="",h=u.type=="string"?[0,0,0,0]:Yi(f,u);switch(u.type){case"base64":d=Nt(f);break;case"binary":d=f;break;case"buffer":u.codepage==65001?d=f.toString("utf8"):u.codepage&&typeof cn<"u"||(d=_e&&Buffer.isBuffer(f)?f.toString("binary"):ia(f));break;case"array":d=ta(f);break;case"string":d=f;break;default:throw new Error("Unrecognized type "+u.type)}return h[0]==239&&h[1]==187&&h[2]==191?d=Oe(d.slice(3)):u.type!="string"&&u.type!="buffer"&&u.codepage==65001?d=Oe(d):u.type=="binary"&&typeof cn<"u",d.slice(0,19)=="socialcalc:version:"?ym.to_sheet(u.type=="string"?d:Oe(d),u):i(d,u)}function c(f,u){return jr(o(f,u),u)}function l(f){for(var u=[],d=He(f["!ref"]),h,g=Array.isArray(f),p=d.s.r;p<=d.e.r;++p){for(var m=[],_=d.s.c;_<=d.e.c;++_){var b=he({r:p,c:_});if(h=g?(f[p]||[])[_]:f[b],!h||h.v==null){m.push("          ");continue}for(var v=(h.w||(wr(h),h.w)||"").slice(0,10);v.length<10;)v+=" ";m.push(v+(_===0?" ":""))}u.push(m.join(""))}return u.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:l}}();function _m(e,r){var t=r||{},a=!!t.WTF;t.WTF=!0;try{var n=vm.to_workbook(e,t);return t.WTF=a,n}catch(s){if(t.WTF=a,!s.message.match(/SYLK bad record ID/)&&a)throw s;return dn.to_workbook(e,r)}}var tn=function(){function e(A,U,O){if(A){st(A,A.l||0);for(var D=O.Enum||ue;A.l<A.length;){var z=A.read_shift(2),te=D[z]||D[65535],se=A.read_shift(2),Z=A.l+se,Y=te.f&&te.f(A,se,O);if(A.l=Z,U(Y,te,z))return}}}function r(A,U){switch(U.type){case"base64":return t(Qt(Nt(A)),U);case"binary":return t(Qt(A),U);case"buffer":case"array":return t(A,U)}throw"Unsupported type "+U.type}function t(A,U){if(!A)return A;var O=U||{},D=O.dense?[]:{},z="Sheet1",te="",se=0,Z={},Y=[],Te=[],F={s:{r:0,c:0},e:{r:0,c:0}},We=O.sheetRows||0;if(A[2]==0&&(A[3]==8||A[3]==9)&&A.length>=16&&A[14]==5&&A[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(A[2]==2)O.Enum=ue,e(A,function(ae,Ve,$t){switch($t){case 0:O.vers=ae,ae>=4096&&(O.qpro=!0);break;case 6:F=ae;break;case 204:ae&&(te=ae);break;case 222:te=ae;break;case 15:case 51:O.qpro||(ae[1].v=ae[1].v.slice(1));case 13:case 14:case 16:$t==14&&(ae[2]&112)==112&&(ae[2]&15)>1&&(ae[2]&15)<15&&(ae[1].z=O.dateNF||me[14],O.cellDates&&(ae[1].t="d",ae[1].v=gs(ae[1].v))),O.qpro&&ae[3]>se&&(D["!ref"]=ke(F),Z[z]=D,Y.push(z),D=O.dense?[]:{},F={s:{r:0,c:0},e:{r:0,c:0}},se=ae[3],z=te||"Sheet"+(se+1),te="");var rr=O.dense?(D[ae[0].r]||[])[ae[0].c]:D[he(ae[0])];if(rr){rr.t=ae[1].t,rr.v=ae[1].v,ae[1].z!=null&&(rr.z=ae[1].z),ae[1].f!=null&&(rr.f=ae[1].f);break}O.dense?(D[ae[0].r]||(D[ae[0].r]=[]),D[ae[0].r][ae[0].c]=ae[1]):D[he(ae[0])]=ae[1];break}},O);else if(A[2]==26||A[2]==14)O.Enum=de,A[2]==14&&(O.qpro=!0,A.l=0),e(A,function(ae,Ve,$t){switch($t){case 204:z=ae;break;case 22:ae[1].v=ae[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ae[3]>se&&(D["!ref"]=ke(F),Z[z]=D,Y.push(z),D=O.dense?[]:{},F={s:{r:0,c:0},e:{r:0,c:0}},se=ae[3],z="Sheet"+(se+1)),We>0&&ae[0].r>=We)break;O.dense?(D[ae[0].r]||(D[ae[0].r]=[]),D[ae[0].r][ae[0].c]=ae[1]):D[he(ae[0])]=ae[1],F.e.c<ae[0].c&&(F.e.c=ae[0].c),F.e.r<ae[0].r&&(F.e.r=ae[0].r);break;case 27:ae[14e3]&&(Te[ae[14e3][0]]=ae[14e3][1]);break;case 1537:Te[ae[0]]=ae[1],ae[0]==se&&(z=ae[1]);break}},O);else throw new Error("Unrecognized LOTUS BOF "+A[2]);if(D["!ref"]=ke(F),Z[te||z]=D,Y.push(te||z),!Te.length)return{SheetNames:Y,Sheets:Z};for(var Ae={},Pe=[],we=0;we<Te.length;++we)Z[Y[we]]?(Pe.push(Te[we]||Y[we]),Ae[Te[we]]=Z[Te[we]]||Z[Y[we]]):(Pe.push(Te[we]),Ae[Te[we]]={"!ref":"A1"});return{SheetNames:Pe,Sheets:Ae}}function a(A,U){var O=U||{};if(+O.codepage>=0&&Zt(+O.codepage),O.type=="string")throw new Error("Cannot write WK1 to JS string");var D=Ks(),z=He(A["!ref"]),te=Array.isArray(A),se=[];Xt(D,0,s(1030)),Xt(D,6,c(z));for(var Z=Math.min(z.e.r,8191),Y=z.s.r;Y<=Z;++Y)for(var Te=ot(Y),F=z.s.c;F<=z.e.c;++F){Y===z.s.r&&(se[F]=Ze(F));var We=se[F]+Te,Ae=te?(A[Y]||[])[F]:A[We];if(!(!Ae||Ae.t=="z"))if(Ae.t=="n")(Ae.v|0)==Ae.v&&Ae.v>=-32768&&Ae.v<=32767?Xt(D,13,h(Y,F,Ae.v)):Xt(D,14,p(Y,F,Ae.v));else{var Pe=wr(Ae);Xt(D,15,u(Y,F,Pe.slice(0,239)))}}return Xt(D,1),D.end()}function n(A,U){var O=U||{};if(+O.codepage>=0&&Zt(+O.codepage),O.type=="string")throw new Error("Cannot write WK3 to JS string");var D=Ks();Xt(D,0,i(A));for(var z=0,te=0;z<A.SheetNames.length;++z)(A.Sheets[A.SheetNames[z]]||{})["!ref"]&&Xt(D,27,W(A.SheetNames[z],te++));var se=0;for(z=0;z<A.SheetNames.length;++z){var Z=A.Sheets[A.SheetNames[z]];if(!(!Z||!Z["!ref"])){for(var Y=He(Z["!ref"]),Te=Array.isArray(Z),F=[],We=Math.min(Y.e.r,8191),Ae=Y.s.r;Ae<=We;++Ae)for(var Pe=ot(Ae),we=Y.s.c;we<=Y.e.c;++we){Ae===Y.s.r&&(F[we]=Ze(we));var ae=F[we]+Pe,Ve=Te?(Z[Ae]||[])[we]:Z[ae];if(!(!Ve||Ve.t=="z"))if(Ve.t=="n")Xt(D,23,q(Ae,we,se,Ve.v));else{var $t=wr(Ve);Xt(D,22,T(Ae,we,se,$t.slice(0,239)))}}++se}}return Xt(D,1),D.end()}function s(A){var U=Je(2);return U.write_shift(2,A),U}function i(A){var U=Je(26);U.write_shift(2,4096),U.write_shift(2,4),U.write_shift(4,0);for(var O=0,D=0,z=0,te=0;te<A.SheetNames.length;++te){var se=A.SheetNames[te],Z=A.Sheets[se];if(!(!Z||!Z["!ref"])){++z;var Y=Pa(Z["!ref"]);O<Y.e.r&&(O=Y.e.r),D<Y.e.c&&(D=Y.e.c)}}return O>8191&&(O=8191),U.write_shift(2,O),U.write_shift(1,z),U.write_shift(1,D),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(1,1),U.write_shift(1,2),U.write_shift(4,0),U.write_shift(4,0),U}function o(A,U,O){var D={s:{c:0,r:0},e:{c:0,r:0}};return U==8&&O.qpro?(D.s.c=A.read_shift(1),A.l++,D.s.r=A.read_shift(2),D.e.c=A.read_shift(1),A.l++,D.e.r=A.read_shift(2),D):(D.s.c=A.read_shift(2),D.s.r=A.read_shift(2),U==12&&O.qpro&&(A.l+=2),D.e.c=A.read_shift(2),D.e.r=A.read_shift(2),U==12&&O.qpro&&(A.l+=2),D.s.c==65535&&(D.s.c=D.e.c=D.s.r=D.e.r=0),D)}function c(A){var U=Je(8);return U.write_shift(2,A.s.c),U.write_shift(2,A.s.r),U.write_shift(2,A.e.c),U.write_shift(2,A.e.r),U}function l(A,U,O){var D=[{c:0,r:0},{t:"n",v:0},0,0];return O.qpro&&O.vers!=20768?(D[0].c=A.read_shift(1),D[3]=A.read_shift(1),D[0].r=A.read_shift(2),A.l+=2):(D[2]=A.read_shift(1),D[0].c=A.read_shift(2),D[0].r=A.read_shift(2)),D}function f(A,U,O){var D=A.l+U,z=l(A,U,O);if(z[1].t="s",O.vers==20768){A.l++;var te=A.read_shift(1);return z[1].v=A.read_shift(te,"utf8"),z}return O.qpro&&A.l++,z[1].v=A.read_shift(D-A.l,"cstr"),z}function u(A,U,O){var D=Je(7+O.length);D.write_shift(1,255),D.write_shift(2,U),D.write_shift(2,A),D.write_shift(1,39);for(var z=0;z<D.length;++z){var te=O.charCodeAt(z);D.write_shift(1,te>=128?95:te)}return D.write_shift(1,0),D}function d(A,U,O){var D=l(A,U,O);return D[1].v=A.read_shift(2,"i"),D}function h(A,U,O){var D=Je(7);return D.write_shift(1,255),D.write_shift(2,U),D.write_shift(2,A),D.write_shift(2,O,"i"),D}function g(A,U,O){var D=l(A,U,O);return D[1].v=A.read_shift(8,"f"),D}function p(A,U,O){var D=Je(13);return D.write_shift(1,255),D.write_shift(2,U),D.write_shift(2,A),D.write_shift(8,O,"f"),D}function m(A,U,O){var D=A.l+U,z=l(A,U,O);if(z[1].v=A.read_shift(8,"f"),O.qpro)A.l=D;else{var te=A.read_shift(2);C(A.slice(A.l,A.l+te),z),A.l+=te}return z}function _(A,U,O){var D=U&32768;return U&=-32769,U=(D?A:0)+(U>=8192?U-16384:U),(D?"":"$")+(O?Ze(U):ot(U))}var b={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},v=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function C(A,U){st(A,0);for(var O=[],D=0,z="",te="",se="",Z="";A.l<A.length;){var Y=A[A.l++];switch(Y){case 0:O.push(A.read_shift(8,"f"));break;case 1:te=_(U[0].c,A.read_shift(2),!0),z=_(U[0].r,A.read_shift(2),!1),O.push(te+z);break;case 2:{var Te=_(U[0].c,A.read_shift(2),!0),F=_(U[0].r,A.read_shift(2),!1);te=_(U[0].c,A.read_shift(2),!0),z=_(U[0].r,A.read_shift(2),!1),O.push(Te+F+":"+te+z)}break;case 3:if(A.l<A.length){console.error("WK1 premature formula end");return}break;case 4:O.push("("+O.pop()+")");break;case 5:O.push(A.read_shift(2));break;case 6:{for(var We="";Y=A[A.l++];)We+=String.fromCharCode(Y);O.push('"'+We.replace(/"/g,'""')+'"')}break;case 8:O.push("-"+O.pop());break;case 23:O.push("+"+O.pop());break;case 22:O.push("NOT("+O.pop()+")");break;case 20:case 21:Z=O.pop(),se=O.pop(),O.push(["AND","OR"][Y-20]+"("+se+","+Z+")");break;default:if(Y<32&&v[Y])Z=O.pop(),se=O.pop(),O.push(se+v[Y]+Z);else if(b[Y]){if(D=b[Y][1],D==69&&(D=A[A.l++]),D>O.length){console.error("WK1 bad formula parse 0x"+Y.toString(16)+":|"+O.join("|")+"|");return}var Ae=O.slice(-D);O.length-=D,O.push(b[Y][0]+"("+Ae.join(",")+")")}else return Y<=7?console.error("WK1 invalid opcode "+Y.toString(16)):Y<=24?console.error("WK1 unsupported op "+Y.toString(16)):Y<=30?console.error("WK1 invalid opcode "+Y.toString(16)):Y<=115?console.error("WK1 unsupported function opcode "+Y.toString(16)):console.error("WK1 unrecognized opcode "+Y.toString(16))}}O.length==1?U[1].f=""+O[0]:console.error("WK1 bad formula parse |"+O.join("|")+"|")}function R(A){var U=[{c:0,r:0},{t:"n",v:0},0];return U[0].r=A.read_shift(2),U[3]=A[A.l++],U[0].c=A[A.l++],U}function I(A,U){var O=R(A);return O[1].t="s",O[1].v=A.read_shift(U-4,"cstr"),O}function T(A,U,O,D){var z=Je(6+D.length);z.write_shift(2,A),z.write_shift(1,O),z.write_shift(1,U),z.write_shift(1,39);for(var te=0;te<D.length;++te){var se=D.charCodeAt(te);z.write_shift(1,se>=128?95:se)}return z.write_shift(1,0),z}function H(A,U){var O=R(A);O[1].v=A.read_shift(2);var D=O[1].v>>1;if(O[1].v&1)switch(D&7){case 0:D=(D>>3)*5e3;break;case 1:D=(D>>3)*500;break;case 2:D=(D>>3)/20;break;case 3:D=(D>>3)/200;break;case 4:D=(D>>3)/2e3;break;case 5:D=(D>>3)/2e4;break;case 6:D=(D>>3)/16;break;case 7:D=(D>>3)/64;break}return O[1].v=D,O}function P(A,U){var O=R(A),D=A.read_shift(4),z=A.read_shift(4),te=A.read_shift(2);if(te==65535)return D===0&&z===3221225472?(O[1].t="e",O[1].v=15):D===0&&z===3489660928?(O[1].t="e",O[1].v=42):O[1].v=0,O;var se=te&32768;return te=(te&32767)-16446,O[1].v=(1-se*2)*(z*Math.pow(2,te+32)+D*Math.pow(2,te)),O}function q(A,U,O,D){var z=Je(14);if(z.write_shift(2,A),z.write_shift(1,O),z.write_shift(1,U),D==0)return z.write_shift(4,0),z.write_shift(4,0),z.write_shift(2,65535),z;var te=0,se=0,Z=0,Y=0;return D<0&&(te=1,D=-D),se=Math.log2(D)|0,D/=Math.pow(2,se-31),Y=D>>>0,Y&2147483648||(D/=2,++se,Y=D>>>0),D-=Y,Y|=2147483648,Y>>>=0,D*=Math.pow(2,32),Z=D>>>0,z.write_shift(4,Z),z.write_shift(4,Y),se+=16383+(te?32768:0),z.write_shift(2,se),z}function V(A,U){var O=P(A);return A.l+=U-14,O}function L(A,U){var O=R(A),D=A.read_shift(4);return O[1].v=D>>6,O}function J(A,U){var O=R(A),D=A.read_shift(8,"f");return O[1].v=D,O}function le(A,U){var O=J(A);return A.l+=U-10,O}function re(A,U){return A[A.l+U-1]==0?A.read_shift(U,"cstr"):""}function ce(A,U){var O=A[A.l++];O>U-1&&(O=U-1);for(var D="";D.length<O;)D+=String.fromCharCode(A[A.l++]);return D}function oe(A,U,O){if(!(!O.qpro||U<21)){var D=A.read_shift(1);A.l+=17,A.l+=1,A.l+=2;var z=A.read_shift(U-21,"cstr");return[D,z]}}function Re(A,U){for(var O={},D=A.l+U;A.l<D;){var z=A.read_shift(2);if(z==14e3){for(O[z]=[0,""],O[z][0]=A.read_shift(2);A[A.l];)O[z][1]+=String.fromCharCode(A[A.l]),A.l++;A.l++}}return O}function W(A,U){var O=Je(5+A.length);O.write_shift(2,14e3),O.write_shift(2,U);for(var D=0;D<A.length;++D){var z=A.charCodeAt(D);O[O.l++]=z>127?95:z}return O[O.l++]=0,O}var ue={0:{n:"BOF",f:Xe},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:g},15:{n:"LABEL",f},16:{n:"FORMULA",f:m},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:re},222:{n:"SHEETNAMELP",f:ce},65535:{n:""}},de={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:I},23:{n:"NUMBER17",f:P},24:{n:"NUMBER18",f:H},25:{n:"FORMULA19",f:V},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Re},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:L},38:{n:"??"},39:{n:"NUMBER27",f:J},40:{n:"FORMULA28",f:le},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:re},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:oe},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:n,to_workbook:r}}();function Em(e){var r={},t=e.match(vt),a=0,n=!1;if(t)for(;a!=t.length;++a){var s=fe(t[a]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":r.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;r.cp=Ai[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":r.outline=1;break;case"</outline>":break;case"<rFont":r.name=s.val;break;case"<sz":r.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":r.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":r.uval="double";break;case"singleAccounting":r.uval="single-accounting";break;case"doubleAccounting":r.uval="double-accounting";break}case"<u>":case"<u/>":r.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":r.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":r.i=1;break;case"</i>":break;case"<color":s.rgb&&(r.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":r.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":r.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(s[0].charCodeAt(1)!==47&&!n)throw new Error("Unrecognized rich format "+s[0])}}return r}var km=function(){var e=fn("t"),r=fn("rPr");function t(s){var i=s.match(e);if(!i)return{t:"s",v:""};var o={t:"s",v:Se(i[1])},c=s.match(r);return c&&(o.s=Em(c[1])),o}var a=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(i){return i.replace(a,"").split(n).map(t).filter(function(o){return o.v})}}(),Tm=function(){var r=/(\r\n|\n)/g;function t(n,s,i){var o=[];n.u&&o.push("text-decoration: underline;"),n.uval&&o.push("text-underline-style:"+n.uval+";"),n.sz&&o.push("font-size:"+n.sz+"pt;"),n.outline&&o.push("text-effect: outline;"),n.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),n.b&&(s.push("<b>"),i.push("</b>")),n.i&&(s.push("<i>"),i.push("</i>")),n.strike&&(s.push("<s>"),i.push("</s>"));var c=n.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(s.push("<"+c+">"),i.push("</"+c+">")),i.push("</span>"),n}function a(n){var s=[[],n.v,[]];return n.v?(n.s&&t(n.s,s[0],s[2]),s[0].join("")+s[1].replace(r,"<br/>")+s[2].join("")):""}return function(s){return s.map(a).join("")}}(),Sm=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Am=/<(?:\w+:)?r>/,bm=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Wi(e,r){var t=r?r.cellHTML:!0,a={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=Se(Oe(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=Oe(e),t&&(a.h=Oi(a.t))):e.match(Am)&&(a.r=Oe(e),a.t=Se(Oe((e.replace(bm,"").match(Sm)||[]).join("").replace(vt,""))),t&&(a.h=Tm(km(a.r)))),a):{t:""}}var Fm=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Cm=/<(?:\w+:)?(?:si|sstItem)>/g,Im=/<\/(?:\w+:)?(?:si|sstItem)>/;function Pm(e,r){var t=[],a="";if(!e)return t;var n=e.match(Fm);if(n){a=n[2].replace(Cm,"").split(Im);for(var s=0;s!=a.length;++s){var i=Wi(a[s].trim(),r);i!=null&&(t[t.length]=i)}n=fe(n[1]),t.Count=n.count,t.Unique=n.uniqueCount}return t}function Dm(e){return[e.read_shift(4),e.read_shift(4)]}function Om(e,r){var t=[],a=!1;return Er(e,function(s,i,o){switch(o){case 159:t.Count=s[0],t.Unique=s[1];break;case 19:t.push(s);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(i.T,!a||r.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),t}function j0(e){for(var r=[],t=e.split(""),a=0;a<t.length;++a)r[a]=t[a].charCodeAt(0);return r}function vr(e,r){var t={};return t.Major=e.read_shift(2),t.Minor=e.read_shift(2),r>=4&&(e.l+=r-4),t}function Rm(e){var r={};return r.id=e.read_shift(0,"lpp4"),r.R=vr(e,4),r.U=vr(e,4),r.W=vr(e,4),r}function Lm(e){for(var r=e.read_shift(4),t=e.l+r-4,a={},n=e.read_shift(4),s=[];n-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(a.name=e.read_shift(0,"lpp4"),a.comps=s,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return a}function Bm(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(Lm(e));return r}function Mm(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(e.read_shift(0,"lpp4"));return r}function Nm(e){var r={};return e.read_shift(4),e.l+=4,r.id=e.read_shift(0,"lpp4"),r.name=e.read_shift(0,"lpp4"),r.R=vr(e,4),r.U=vr(e,4),r.W=vr(e,4),r}function $m(e){var r=Nm(e);if(r.ename=e.read_shift(0,"8lpp4"),r.blksz=e.read_shift(4),r.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return r}function H0(e,r){var t=e.l+r,a={};a.Flags=e.read_shift(4)&63,e.l+=4,a.AlgID=e.read_shift(4);var n=!1;switch(a.AlgID){case 26126:case 26127:case 26128:n=a.Flags==36;break;case 26625:n=a.Flags==4;break;case 0:n=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=e.read_shift(4),a.KeySize=e.read_shift(4),a.ProviderType=e.read_shift(4),e.l+=8,a.CSPName=e.read_shift(t-e.l>>1,"utf16le"),e.l=t,a}function W0(e,r){var t={},a=e.l+r;return e.l+=4,t.Salt=e.slice(e.l,e.l+16),e.l+=16,t.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),t.VerifierHash=e.slice(e.l,a),e.l=a,t}function Um(e){var r=vr(e);switch(r.Minor){case 2:return[r.Minor,jm(e)];case 3:return[r.Minor,Hm()];case 4:return[r.Minor,Wm(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+r.Minor)}function jm(e){var r=e.read_shift(4);if((r&63)!=36)throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4),a=H0(e,t),n=W0(e,e.length-e.l);return{t:"Std",h:a,v:n}}function Hm(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Wm(e){var r=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var t=e.read_shift(e.length-e.l,"utf8"),a={};return t.replace(vt,function(s){var i=fe(s);switch(cr(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":r.forEach(function(o){a[o]=i[o]});break;case"<dataIntegrity":a.encryptedHmacKey=i.encryptedHmacKey,a.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(i);break;default:throw i[0]}}),a}function Vm(e,r){var t={},a=t.EncryptionVersionInfo=vr(e,4);if(r-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);t.Flags=e.read_shift(4),r-=4;var n=e.read_shift(4);return r-=4,t.EncryptionHeader=H0(e,n),r-=n,t.EncryptionVerifier=W0(e,r),t}function Gm(e){var r={},t=r.EncryptionVersionInfo=vr(e,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return r.Salt=e.read_shift(16),r.EncryptedVerifier=e.read_shift(16),r.EncryptedVerifierHash=e.read_shift(16),r}function qm(e){var r=0,t,a=j0(e),n=a.length+1,s,i,o,c,l;for(t=Mr(n),t[0]=a.length,s=1;s!=n;++s)t[s]=a[s-1];for(s=n-1;s>=0;--s)i=t[s],o=r&16384?1:0,c=r<<1&32767,l=o|c,r=l^i;return r^52811}var V0=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],r=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(i){return(i/2|i*128)&255},n=function(i,o){return a(i^o)},s=function(i){for(var o=r[i.length-1],c=104,l=i.length-1;l>=0;--l)for(var f=i[l],u=0;u!=7;++u)f&64&&(o^=t[c]),f*=2,--c;return o};return function(i){for(var o=j0(i),c=s(o),l=o.length,f=Mr(16),u=0;u!=16;++u)f[u]=0;var d,h,g;for((l&1)===1&&(d=c>>8,f[l]=n(e[0],d),--l,d=c&255,h=o[o.length-1],f[l]=n(h,d));l>0;)--l,d=c>>8,f[l]=n(o[l],d),--l,d=c&255,f[l]=n(o[l],d);for(l=15,g=15-o.length;g>0;)d=c>>8,f[l]=n(e[g],d),--l,--g,d=c&255,f[l]=n(o[l],d),--l,--g;return f}}(),zm=function(e,r,t,a,n){n||(n=r),a||(a=V0(e));var s,i;for(s=0;s!=r.length;++s)i=r[s],i^=a[t],i=(i>>5|i<<3)&255,n[s]=i,++t;return[n,t,a]},Km=function(e){var r=0,t=V0(e);return function(a){var n=zm("",a,r,t);return r=n[1],n[0]}};function Xm(e,r,t,a){var n={key:Xe(e),verificationBytes:Xe(e)};return t.password&&(n.verifier=qm(t.password)),a.valid=n.verificationBytes===n.verifier,a.valid&&(a.insitu=Km(t.password)),n}function Ym(e,r,t){var a=t||{};return a.Info=e.read_shift(2),e.l-=2,a.Info===1?a.Data=Gm(e):a.Data=Vm(e,r),a}function Jm(e,r,t){var a={Type:t.biff>=8?e.read_shift(2):0};return a.Type?Ym(e,r-2,a):Xm(e,t.biff>=8?r:r-2,t,a),a}var Qm=function(){function e(n,s){switch(s.type){case"base64":return r(Nt(n),s);case"binary":return r(n,s);case"buffer":return r(_e&&Buffer.isBuffer(n)?n.toString("binary"):ia(n),s);case"array":return r(ta(n),s)}throw new Error("Unrecognized type "+s.type)}function r(n,s){var i=s||{},o=i.dense?[]:{},c=n.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var l={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(f,u){Array.isArray(o)&&(o[u]=[]);for(var d=/\\\w+\b/g,h=0,g,p=-1;g=d.exec(f);){switch(g[0]){case"\\cell":var m=f.slice(h,d.lastIndex-g[0].length);if(m[0]==" "&&(m=m.slice(1)),++p,m.length){var _={v:m,t:"s"};Array.isArray(o)?o[u][p]=_:o[he({r:u,c:p})]=_}break}h=d.lastIndex}p>l.e.c&&(l.e.c=p)}),o["!ref"]=ke(l),o}function t(n,s){return jr(e(n,s),s)}function a(n){for(var s=["{\\rtf1\\ansi"],i=He(n["!ref"]),o,c=Array.isArray(n),l=i.s.r;l<=i.e.r;++l){s.push("\\trowd\\trautofit1");for(var f=i.s.c;f<=i.e.c;++f)s.push("\\cellx"+(f+1));for(s.push("\\pard\\intbl"),f=i.s.c;f<=i.e.c;++f){var u=he({r:l,c:f});o=c?(n[l]||[])[f]:n[u],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(wr(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:t,to_sheet:e,from_sheet:a}}();function Zm(e){var r=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)]}function hn(e){for(var r=0,t=1;r!=3;++r)t=t*256+(e[r]>255?255:e[r]<0?0:e[r]);return t.toString(16).toUpperCase().slice(1)}function ex(e){var r=e[0]/255,t=e[1]/255,a=e[2]/255,n=Math.max(r,t,a),s=Math.min(r,t,a),i=n-s;if(i===0)return[0,0,r];var o=0,c=0,l=n+s;switch(c=i/(l>1?2-l:l),n){case r:o=((t-a)/i+6)%6;break;case t:o=(a-r)/i+2;break;case a:o=(r-t)/i+4;break}return[o/6,c,l/2]}function tx(e){var r=e[0],t=e[1],a=e[2],n=t*2*(a<.5?a:1-a),s=a-n/2,i=[s,s,s],o=6*r,c;if(t!==0)switch(o|0){case 0:case 6:c=n*o,i[0]+=n,i[1]+=c;break;case 1:c=n*(2-o),i[0]+=c,i[1]+=n;break;case 2:c=n*(o-2),i[1]+=n,i[2]+=c;break;case 3:c=n*(4-o),i[1]+=c,i[2]+=n;break;case 4:c=n*(o-4),i[2]+=n,i[0]+=c;break;case 5:c=n*(6-o),i[2]+=c,i[0]+=n;break}for(var l=0;l!=3;++l)i[l]=Math.round(i[l]*255);return i}function Zn(e,r){if(r===0)return e;var t=ex(Zm(e));return r<0?t[2]=t[2]*(1+r):t[2]=1-(1-t[2])*(1-r),hn(tx(t))}var G0=6,rx=15,ax=1,Et=G0;function es(e){return Math.floor((e+Math.round(128/Et)/256)*Et)}function ts(e){return Math.floor((e-5)/Et*100+.5)/100}function Qs(e){return Math.round((e*Et+5)/Et*256)/256}function Os(e){return Qs(ts(es(e)))}function Vi(e){var r=Math.abs(e-Os(e)),t=Et;if(r>.005)for(Et=ax;Et<rx;++Et)Math.abs(e-Os(e))<=r&&(r=Math.abs(e-Os(e)),t=Et);Et=t}function Aa(e){e.width?(e.wpx=es(e.width),e.wch=ts(e.wpx),e.MDW=Et):e.wpx?(e.wch=ts(e.wpx),e.width=Qs(e.wch),e.MDW=Et):typeof e.wch=="number"&&(e.width=Qs(e.wch),e.wpx=es(e.width),e.MDW=Et),e.customWidth&&delete e.customWidth}var nx=96,q0=nx;function z0(e){return e*96/q0}function gn(e){return e*q0/96}var sx={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function ix(e,r,t,a){r.Borders=[];var n={},s=!1;(e[0].match(vt)||[]).forEach(function(i){var o=fe(i);switch(cr(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":n={},o.diagonalUp&&(n.diagonalUp=Le(o.diagonalUp)),o.diagonalDown&&(n.diagonalDown=Le(o.diagonalDown)),r.Borders.push(n);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function ox(e,r,t,a){r.Fills=[];var n={},s=!1;(e[0].match(vt)||[]).forEach(function(i){var o=fe(i);switch(cr(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":n={},r.Fills.push(n);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":r.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":o.patternType&&(n.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":n.bgColor||(n.bgColor={}),o.indexed&&(n.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(n.bgColor.theme=parseInt(o.theme,10)),o.tint&&(n.bgColor.tint=parseFloat(o.tint)),o.rgb&&(n.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":n.fgColor||(n.fgColor={}),o.theme&&(n.fgColor.theme=parseInt(o.theme,10)),o.tint&&(n.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(n.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function cx(e,r,t,a){r.Fonts=[];var n={},s=!1;(e[0].match(vt)||[]).forEach(function(i){var o=fe(i);switch(cr(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":r.Fonts.push(n),n={};break;case"<name":o.val&&(n.name=Oe(o.val));break;case"<name/>":case"</name>":break;case"<b":n.bold=o.val?Le(o.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=o.val?Le(o.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(o.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34;break}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=o.val?Le(o.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=o.val?Le(o.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=o.val?Le(o.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=o.val?Le(o.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=o.val?Le(o.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":o.val&&(n.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(n.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(n.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(n.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=Ai[parseInt(o.val,10)];break;case"<color":if(n.color||(n.color={}),o.auto&&(n.color.auto=Le(o.auto)),o.rgb)n.color.rgb=o.rgb.slice(-6);else if(o.indexed){n.color.index=parseInt(o.indexed,10);var c=Jr[n.color.index];n.color.index==81&&(c=Jr[1]),c||(c=Jr[1]),n.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(n.color.theme=parseInt(o.theme,10),o.tint&&(n.color.tint=parseFloat(o.tint)),o.theme&&t.themeElements&&t.themeElements.clrScheme&&(n.color.rgb=Zn(t.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function lx(e,r,t){r.NumberFmt=[];for(var a=or(me),n=0;n<a.length;++n)r.NumberFmt[a[n]]=me[a[n]];var s=e[0].match(vt);if(s)for(n=0;n<s.length;++n){var i=fe(s[n]);switch(cr(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Se(Oe(i.formatCode)),c=parseInt(i.numFmtId,10);if(r.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&r.NumberFmt[c]!=null;--c);r.NumberFmt[c]=o}Yr(o,c)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}var jn=["numFmtId","fillId","fontId","borderId","xfId"],Hn=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function fx(e,r,t){r.CellXf=[];var a,n=!1;(e[0].match(vt)||[]).forEach(function(s){var i=fe(s),o=0;switch(cr(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=i,delete a[0],o=0;o<jn.length;++o)a[jn[o]]&&(a[jn[o]]=parseInt(a[jn[o]],10));for(o=0;o<Hn.length;++o)a[Hn[o]]&&(a[Hn[o]]=Le(a[Hn[o]]));if(r.NumberFmt&&a.numFmtId>392){for(o=392;o>60;--o)if(r.NumberFmt[a.numFmtId]==r.NumberFmt[o]){a.numFmtId=o;break}}r.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};i.vertical&&(c.vertical=i.vertical),i.horizontal&&(c.horizontal=i.horizontal),i.textRotation!=null&&(c.textRotation=i.textRotation),i.indent&&(c.indent=i.indent),i.wrapText&&(c.wrapText=Le(i.wrapText)),a.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(t&&t.WTF&&!n)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}var ux=function(){var r=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,l){var f={};if(!o)return f;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var u;return(u=o.match(r))&&lx(u,f,l),(u=o.match(n))&&cx(u,f,c,l),(u=o.match(a))&&ox(u,f,c,l),(u=o.match(s))&&ix(u,f,c,l),(u=o.match(t))&&fx(u,f,l),f}}();function dx(e,r){var t=e.read_shift(2),a=mt(e);return[t,a]}function hx(e,r,t){var a={};a.sz=e.read_shift(2)/20;var n=kp(e);n.fItalic&&(a.italic=1),n.fCondense&&(a.condense=1),n.fExtend&&(a.extend=1),n.fShadow&&(a.shadow=1),n.fOutline&&(a.outline=1),n.fStrikeout&&(a.strike=1);var s=e.read_shift(2);switch(s===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(a.underline=i);var o=e.read_shift(1);o>0&&(a.family=o);var c=e.read_shift(1);switch(c>0&&(a.charset=c),e.l++,a.color=Ep(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=mt(e),a}var gx=xt;function px(e,r){var t=e.l+r,a=e.read_shift(2),n=e.read_shift(2);return e.l=t,{ixfe:a,numFmtId:n}}var mx=xt;function xx(e,r,t){var a={};a.NumberFmt=[];for(var n in me)a.NumberFmt[n]=me[n];a.CellXf=[],a.Fonts=[];var s=[],i=!1;return Er(e,function(c,l,f){switch(f){case 44:a.NumberFmt[c[0]]=c[1],Yr(c[1],c[0]);break;case 43:a.Fonts.push(c),c.color.theme!=null&&r&&r.themeElements&&r.themeElements.clrScheme&&(c.color.rgb=Zn(r.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&a.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:s.push(f),i=!0;break;case 38:s.pop(),i=!1;break;default:if(l.T>0)s.push(f);else if(l.T<0)s.pop();else if(!i||t.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),a}var vx=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function wx(e,r,t){r.themeElements.clrScheme=[];var a={};(e[0].match(vt)||[]).forEach(function(n){var s=fe(n);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=s.val;break;case"<a:sysClr":a.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(r.themeElements.clrScheme[vx.indexOf(s[0])]=a,a={}):a.name=s[0].slice(3,s[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function yx(){}function _x(){}var Ex=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,kx=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Tx=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Sx(e,r,t){r.themeElements={};var a;[["clrScheme",Ex,wx],["fontScheme",kx,yx],["fmtScheme",Tx,_x]].forEach(function(n){if(!(a=e.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](a,r,t)})}var Ax=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function K0(e,r){(!e||e.length===0)&&(e=bx());var t,a={};if(!(t=e.match(Ax)))throw new Error("themeElements not found in theme");return Sx(t[0],a,r),a.raw=e,a}function bx(e,r){var t=[s0];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function Fx(e,r,t){var a=e.l+r,n=e.read_shift(4);if(n!==124226){if(!t.cellStyles){e.l=a;return}var s=e.slice(e.l);e.l=a;var i;try{i=n0(s,{type:"array"})}catch{return}var o=Rt(i,"theme/theme/theme1.xml",!0);if(o)return K0(o,t)}}function Cx(e){return e.read_shift(4)}function Ix(e){var r={};switch(r.xclrType=e.read_shift(2),r.nTintShade=e.read_shift(2),r.xclrType){case 0:e.l+=4;break;case 1:r.xclrValue=Px(e,4);break;case 2:r.xclrValue=R0(e);break;case 3:r.xclrValue=Cx(e);break;case 4:e.l+=4;break}return e.l+=8,r}function Px(e,r){return xt(e,r)}function Dx(e,r){return xt(e,r)}function Ox(e){var r=e.read_shift(2),t=e.read_shift(2)-4,a=[r];switch(r){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=Ix(e);break;case 6:a[1]=Dx(e,t);break;case 14:case 15:a[1]=e.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+r+" "+t)}return a}function Rx(e,r){var t=e.l+r;e.l+=2;var a=e.read_shift(2);e.l+=2;for(var n=e.read_shift(2),s=[];n-- >0;)s.push(Ox(e,t-e.l));return{ixfe:a,ext:s}}function Lx(e,r){r.forEach(function(t){switch(t[0]){}})}function Bx(e,r){return{flags:e.read_shift(4),version:e.read_shift(4),name:mt(e)}}function Mx(e){for(var r=[],t=e.read_shift(4);t-- >0;)r.push([e.read_shift(4),e.read_shift(4)]);return r}function Nx(e){return e.l+=4,e.read_shift(4)!=0}function $x(e,r,t){var a={Types:[],Cell:[],Value:[]},n=t||{},s=[],i=!1,o=2;return Er(e,function(c,l,f){switch(f){case 335:a.Types.push({name:c.name});break;case 51:c.forEach(function(u){o==1?a.Cell.push({type:a.Types[u[0]-1].name,index:u[1]}):o==0&&a.Value.push({type:a.Types[u[0]-1].name,index:u[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:s.push(f),i=!0;break;case 36:s.pop(),i=!1;break;default:if(!l.T){if(!i||n.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),a}function Ux(e,r,t){var a={Types:[],Cell:[],Value:[]};if(!e)return a;var n=!1,s=2,i;return e.replace(vt,function(o){var c=fe(o);switch(cr(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var l=0;l<a.Types.length;++l)a.Types[l].name==c.name&&(i=a.Types[l]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?a.Cell.push({type:a.Types[c.t-1].name,index:+c.v}):s==0&&a.Value.push({type:a.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+c.i);break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),a}function jx(e){var r=[];if(!e)return r;var t=1;return(e.match(vt)||[]).forEach(function(a){var n=fe(a);switch(n[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?t=n.i:n.i=t,r.push(n);break}}),r}function Hx(e){var r={};r.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),r.r=he(t);var a=e.read_shift(1);return a&2&&(r.l="1"),a&8&&(r.a="1"),r}function Wx(e,r,t){var a=[];return Er(e,function(s,i,o){switch(o){case 63:a.push(s);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),a}function Vx(e,r,t,a){if(!e)return e;var n=a||{},s=!1;Er(e,function(o,c,l){switch(l){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!c.T){if(!s||n.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}},n)}function Gx(e,r){if(!e)return"??";var t=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return r["!id"][t].Target}function mc(e,r,t,a){var n=Array.isArray(e),s;r.forEach(function(i){var o=Tt(i.ref);if(n?(e[o.r]||(e[o.r]=[]),s=e[o.r][o.c]):s=e[i.ref],!s){s={t:"z"},n?e[o.r][o.c]=s:e[i.ref]=s;var c=He(e["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var l=ke(c);l!==e["!ref"]&&(e["!ref"]=l)}s.c||(s.c=[]);var f={a:i.author,t:i.t,r:i.r,T:t};i.h&&(f.h=i.h);for(var u=s.c.length-1;u>=0;--u){if(!t&&s.c[u].T)return;t&&!s.c[u].T&&s.c.splice(u,1)}if(t&&a){for(u=0;u<a.length;++u)if(f.a==a[u].id){f.a=a[u].name||f.a;break}}s.c.push(f)})}function qx(e,r){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],a=[],n=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&t.push(o[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=fe(o[0]),l={author:c.authorId&&t[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},f=Tt(c.ref);if(!(r.sheetRows&&r.sheetRows<=f.r)){var u=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),d=!!u&&!!u[1]&&Wi(u[1])||{r:"",t:"",h:""};l.r=d.r,d.r=="<t></t>"&&(d.t=d.h=""),l.t=(d.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.cellHTML&&(l.h=d.h),a.push(l)}}}}),a}function zx(e,r){var t=[],a=!1,n={},s=0;return e.replace(vt,function(o,c){var l=fe(o);switch(cr(l[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":n={author:l.personId,guid:l.id,ref:l.ref,T:1};break;case"</threadedComment>":n.t!=null&&t.push(n);break;case"<text>":case"<text":s=c+o.length;break;case"</text>":n.t=e.slice(s,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&r.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return o}),t}function Kx(e,r){var t=[],a=!1;return e.replace(vt,function(s){var i=fe(s);switch(cr(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&r.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return s}),t}function Xx(e){var r={};r.iauthor=e.read_shift(4);var t=ca(e);return r.rfx=t.s,r.ref=he(t.s),e.l+=16,r}var Yx=mt;function Jx(e,r){var t=[],a=[],n={},s=!1;return Er(e,function(o,c,l){switch(l){case 632:a.push(o);break;case 635:n=o;break;case 637:n.t=o.t,n.h=o.h,n.r=o.r;break;case 636:if(n.author=a[n.iauthor],delete n.iauthor,r.sheetRows&&n.rfx&&r.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,t.push(n);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!s||r.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}}),t}var Qx="application/vnd.ms-office.vbaProject";function Zx(e){var r=Ee.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(t,a){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var n=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ee.utils.cfb_add(r,n,e.FileIndex[a].content)}}),Ee.write(r)}function ev(){return{"!type":"dialog"}}function tv(){return{"!type":"dialog"}}function rv(){return{"!type":"macro"}}function av(){return{"!type":"macro"}}var _a=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function t(a,n,s,i){var o=!1,c=!1;s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var l=s.length>0?parseInt(s,10)|0:0,f=i.length>0?parseInt(i,10)|0:0;return o?f+=r.c:--f,c?l+=r.r:--l,n+(o?"":"$")+Ze(f)+(c?"":"$")+ot(l)}return function(n,s){return r=s,n.replace(e,t)}}(),X0=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,nv=function(){return function(r,t){return r.replace(X0,function(a,n,s,i,o,c){var l=Mi(i)-(s?0:t.c),f=Bi(c)-(o?0:t.r),u=f==0?"":o?f+1:"["+f+"]",d=l==0?"":s?l+1:"["+l+"]";return n+"R"+u+"C"+d})}}();function Y0(e,r){return e.replace(X0,function(t,a,n,s,i,o){return a+(n=="$"?n+s:Ze(Mi(s)+r.c))+(i=="$"?i+o:ot(Bi(o)+r.r))})}function sv(e,r,t){var a=Pa(r),n=a.s,s=Tt(t),i={r:s.r-n.r,c:s.c-n.c};return Y0(e,i)}function iv(e){return e.length!=1}function xc(e){return e.replace(/_xlfn\./g,"")}function ze(e){e.l+=1}function Nr(e,r){var t=e.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function J0(e,r,t){var a=2;if(t){if(t.biff>=2&&t.biff<=5)return Q0(e);t.biff==12&&(a=4)}var n=e.read_shift(a),s=e.read_shift(a),i=Nr(e),o=Nr(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function Q0(e){var r=Nr(e),t=Nr(e),a=e.read_shift(1),n=e.read_shift(1);return{s:{r:r[0],c:a,cRel:r[1],rRel:r[2]},e:{r:t[0],c:n,cRel:t[1],rRel:t[2]}}}function ov(e,r,t){if(t.biff<8)return Q0(e);var a=e.read_shift(t.biff==12?4:2),n=e.read_shift(t.biff==12?4:2),s=Nr(e),i=Nr(e);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:n,c:i[0],cRel:i[1],rRel:i[2]}}}function Z0(e,r,t){if(t&&t.biff>=2&&t.biff<=5)return cv(e);var a=e.read_shift(t&&t.biff==12?4:2),n=Nr(e);return{r:a,c:n[0],cRel:n[1],rRel:n[2]}}function cv(e){var r=Nr(e),t=e.read_shift(1);return{r:r[0],c:t,cRel:r[1],rRel:r[2]}}function lv(e){var r=e.read_shift(2),t=e.read_shift(2);return{r,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function fv(e,r,t){var a=t&&t.biff?t.biff:8;if(a>=2&&a<=5)return uv(e);var n=e.read_shift(a>=12?4:2),s=e.read_shift(2),i=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;n>524287;)n-=1048576;if(i==1)for(;s>8191;)s=s-16384;return{r:n,c:s,cRel:i,rRel:o}}function uv(e){var r=e.read_shift(2),t=e.read_shift(1),a=(r&32768)>>15,n=(r&16384)>>14;return r&=16383,a==1&&r>=8192&&(r=r-16384),n==1&&t>=128&&(t=t-256),{r,c:t,cRel:n,rRel:a}}function dv(e,r,t){var a=(e[e.l++]&96)>>5,n=J0(e,t.biff>=2&&t.biff<=5?6:8,t);return[a,n]}function hv(e,r,t){var a=(e[e.l++]&96)>>5,n=e.read_shift(2,"i"),s=8;if(t)switch(t.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var i=J0(e,s,t);return[a,n,i]}function gv(e,r,t){var a=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[a]}function pv(e,r,t){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),s=8;if(t)switch(t.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[a,n]}function mv(e,r,t){var a=(e[e.l++]&96)>>5,n=ov(e,r-1,t);return[a,n]}function xv(e,r,t){var a=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[a]}function vc(e){var r=e[e.l+1]&1,t=1;return e.l+=4,[r,t]}function vv(e,r,t){e.l+=2;for(var a=e.read_shift(t&&t.biff==2?1:2),n=[],s=0;s<=a;++s)n.push(e.read_shift(t&&t.biff==2?1:2));return n}function wv(e,r,t){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(t&&t.biff==2?1:2)]}function yv(e,r,t){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(t&&t.biff==2?1:2)]}function _v(e){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(2)]}function Ev(e,r,t){var a=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[a]}function ef(e){var r=e.read_shift(1),t=e.read_shift(1);return[r,t]}function kv(e){return e.read_shift(2),ef(e)}function Tv(e){return e.read_shift(2),ef(e)}function Sv(e,r,t){var a=(e[e.l]&96)>>5;e.l+=1;var n=Z0(e,0,t);return[a,n]}function Av(e,r,t){var a=(e[e.l]&96)>>5;e.l+=1;var n=fv(e,0,t);return[a,n]}function bv(e,r,t){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var s=Z0(e,0,t);return[a,n,s]}function Fv(e,r,t){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(t&&t.biff<=3?1:2);return[Cw[n],af[n],a]}function Cv(e,r,t){var a=e[e.l++],n=e.read_shift(1),s=t&&t.biff<=3?[a==88?-1:0,e.read_shift(1)]:Iv(e);return[n,(s[0]===0?af:Fw)[s[1]]]}function Iv(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Pv(e,r,t){e.l+=t&&t.biff==2?3:4}function Dv(e,r,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),n=e.read_shift(t&&t.biff==2?1:2);return[a,n]}function Ov(e){return e.l++,la[e.read_shift(1)]}function Rv(e){return e.l++,e.read_shift(2)}function Lv(e){return e.l++,e.read_shift(1)!==0}function Bv(e){return e.l++,dt(e)}function Mv(e,r,t){return e.l++,_n(e,r-1,t)}function Nv(e,r){var t=[e.read_shift(1)];if(r==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=qe(e,1)?"TRUE":"FALSE",r!=12&&(e.l+=7);break;case 37:case 16:t[1]=la[e[e.l]],e.l+=r==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=dt(e);break;case 2:t[1]=fa(e,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function $v(e,r,t){for(var a=e.read_shift(t.biff==12?4:2),n=[],s=0;s!=a;++s)n.push((t.biff==12?ca:ps)(e));return n}function Uv(e,r,t){var a=0,n=0;t.biff==12?(a=e.read_shift(4),n=e.read_shift(4)):(n=1+e.read_shift(1),a=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--a,--n==0&&(n=256));for(var s=0,i=[];s!=a&&(i[s]=[]);++s)for(var o=0;o!=n;++o)i[s][o]=Nv(e,t.biff);return i}function jv(e,r,t){var a=e.read_shift(1)>>>5&3,n=!t||t.biff>=8?4:2,s=e.read_shift(n);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,s]}function Hv(e,r,t){if(t.biff==5)return Wv(e);var a=e.read_shift(1)>>>5&3,n=e.read_shift(2),s=e.read_shift(4);return[a,n,s]}function Wv(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[r,t,a]}function Vv(e,r,t){var a=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var n=e.read_shift(t&&t.biff==2?1:2);return[a,n]}function Gv(e,r,t){var a=e.read_shift(1)>>>5&3,n=e.read_shift(t&&t.biff==2?1:2);return[a,n]}function qv(e,r,t){var a=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[a]}function zv(e,r,t){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),s=4;if(t)switch(t.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[a,n]}var Kv=xt,Xv=xt,Yv=xt;function kn(e,r,t){return e.l+=2,[lv(e)]}function Gi(e){return e.l+=6,[]}var Jv=kn,Qv=Gi,Zv=Gi,ew=kn;function tf(e){return e.l+=2,[Xe(e),e.read_shift(2)&1]}var tw=kn,rw=tf,aw=Gi,nw=kn,sw=kn,iw=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function ow(e){e.l+=2;var r=e.read_shift(2),t=e.read_shift(2),a=e.read_shift(4),n=e.read_shift(2),s=e.read_shift(2),i=iw[t>>2&31];return{ixti:r,coltype:t&3,rt:i,idx:a,c:n,C:s}}function cw(e){return e.l+=2,[e.read_shift(4)]}function lw(e,r,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function fw(e,r,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function uw(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function dw(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function hw(e){return e.l+=4,[0,0]}var wc={1:{n:"PtgExp",f:Dv},2:{n:"PtgTbl",f:Yv},3:{n:"PtgAdd",f:ze},4:{n:"PtgSub",f:ze},5:{n:"PtgMul",f:ze},6:{n:"PtgDiv",f:ze},7:{n:"PtgPower",f:ze},8:{n:"PtgConcat",f:ze},9:{n:"PtgLt",f:ze},10:{n:"PtgLe",f:ze},11:{n:"PtgEq",f:ze},12:{n:"PtgGe",f:ze},13:{n:"PtgGt",f:ze},14:{n:"PtgNe",f:ze},15:{n:"PtgIsect",f:ze},16:{n:"PtgUnion",f:ze},17:{n:"PtgRange",f:ze},18:{n:"PtgUplus",f:ze},19:{n:"PtgUminus",f:ze},20:{n:"PtgPercent",f:ze},21:{n:"PtgParen",f:ze},22:{n:"PtgMissArg",f:ze},23:{n:"PtgStr",f:Mv},26:{n:"PtgSheet",f:lw},27:{n:"PtgEndSheet",f:fw},28:{n:"PtgErr",f:Ov},29:{n:"PtgBool",f:Lv},30:{n:"PtgInt",f:Rv},31:{n:"PtgNum",f:Bv},32:{n:"PtgArray",f:xv},33:{n:"PtgFunc",f:Fv},34:{n:"PtgFuncVar",f:Cv},35:{n:"PtgName",f:jv},36:{n:"PtgRef",f:Sv},37:{n:"PtgArea",f:dv},38:{n:"PtgMemArea",f:Vv},39:{n:"PtgMemErr",f:Kv},40:{n:"PtgMemNoMem",f:Xv},41:{n:"PtgMemFunc",f:Gv},42:{n:"PtgRefErr",f:qv},43:{n:"PtgAreaErr",f:gv},44:{n:"PtgRefN",f:Av},45:{n:"PtgAreaN",f:mv},46:{n:"PtgMemAreaN",f:uw},47:{n:"PtgMemNoMemN",f:dw},57:{n:"PtgNameX",f:Hv},58:{n:"PtgRef3d",f:bv},59:{n:"PtgArea3d",f:hv},60:{n:"PtgRefErr3d",f:zv},61:{n:"PtgAreaErr3d",f:pv},255:{}},gw={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},pw={1:{n:"PtgElfLel",f:tf},2:{n:"PtgElfRw",f:nw},3:{n:"PtgElfCol",f:Jv},6:{n:"PtgElfRwV",f:sw},7:{n:"PtgElfColV",f:ew},10:{n:"PtgElfRadical",f:tw},11:{n:"PtgElfRadicalS",f:aw},13:{n:"PtgElfColS",f:Qv},15:{n:"PtgElfColSV",f:Zv},16:{n:"PtgElfRadicalLel",f:rw},25:{n:"PtgList",f:ow},29:{n:"PtgSxName",f:cw},255:{}},mw={0:{n:"PtgAttrNoop",f:hw},1:{n:"PtgAttrSemi",f:Ev},2:{n:"PtgAttrIf",f:yv},4:{n:"PtgAttrChoose",f:vv},8:{n:"PtgAttrGoto",f:wv},16:{n:"PtgAttrSum",f:Pv},32:{n:"PtgAttrBaxcel",f:vc},33:{n:"PtgAttrBaxcel",f:vc},64:{n:"PtgAttrSpace",f:kv},65:{n:"PtgAttrSpaceSemi",f:Tv},128:{n:"PtgAttrIfError",f:_v},255:{}};function Tn(e,r,t,a){if(a.biff<8)return xt(e,r);for(var n=e.l+r,s=[],i=0;i!==t.length;++i)switch(t[i][0]){case"PtgArray":t[i][1]=Uv(e,0,a),s.push(t[i][1]);break;case"PtgMemArea":t[i][2]=$v(e,t[i][1],a),s.push(t[i][2]);break;case"PtgExp":a&&a.biff==12&&(t[i][1][1]=e.read_shift(4),s.push(t[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[i][0]}return r=n-e.l,r!==0&&s.push(xt(e,r)),s}function Sn(e,r,t){for(var a=e.l+r,n,s,i=[];a!=e.l;)r=a-e.l,s=e[e.l],n=wc[s]||wc[gw[s]],(s===24||s===25)&&(n=(s===24?pw:mw)[e[e.l+1]]),!n||!n.f?xt(e,r):i.push([n.n,n.f(e,r,t)]);return i}function xw(e){for(var r=[],t=0;t<e.length;++t){for(var a=e[t],n=[],s=0;s<a.length;++s){var i=a[s];if(i)switch(i[0]){case 2:n.push('"'+i[1].replace(/"/g,'""')+'"');break;default:n.push(i[1])}else n.push("")}r.push(n.join(","))}return r.join(";")}var vw={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function ww(e,r){if(!e&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function rf(e,r,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[r]))return e.SheetNames[r];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[r];if(t.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":e.XTI[r-1];if(!a)return"SH33TJSERR1";var n="";if(t.biff>8)switch(e[a[0]][0]){case 357:return n=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[a[0]][0];case 355:default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return n=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[a[0]][0][3]?(n=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?n:n+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function yc(e,r,t){var a=rf(e,r,t);return a=="#REF"?a:ww(a,t)}function ut(e,r,t,a,n){var s=n&&n.biff||8,i={s:{c:0,r:0}},o=[],c,l,f,u=0,d=0,h,g="";if(!e[0]||!e[0][0])return"";for(var p=-1,m="",_=0,b=e[0].length;_<b;++_){var v=e[0][_];switch(v[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),l=o.pop(),p>=0){switch(e[0][p][1][0]){case 0:m=je(" ",e[0][p][1][1]);break;case 1:m=je("\r",e[0][p][1][1]);break;default:if(m="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}l=l+m,p=-1}o.push(l+vw[v[0]]+c);break;case"PtgIsect":c=o.pop(),l=o.pop(),o.push(l+" "+c);break;case"PtgUnion":c=o.pop(),l=o.pop(),o.push(l+","+c);break;case"PtgRange":c=o.pop(),l=o.pop(),o.push(l+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=Ja(v[1][1],i,n),o.push(Qa(f,s));break;case"PtgRefN":f=t?Ja(v[1][1],t,n):v[1][1],o.push(Qa(f,s));break;case"PtgRef3d":u=v[1][1],f=Ja(v[1][2],i,n),g=yc(a,u,n),o.push(g+"!"+Qa(f,s));break;case"PtgFunc":case"PtgFuncVar":var C=v[1][0],R=v[1][1];C||(C=0),C&=127;var I=C==0?[]:o.slice(-C);o.length-=C,R==="User"&&(R=I.shift()),o.push(R+"("+I.join(",")+")");break;case"PtgBool":o.push(v[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(v[1]);break;case"PtgNum":o.push(String(v[1]));break;case"PtgStr":o.push('"'+v[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(v[1]);break;case"PtgAreaN":h=ec(v[1][1],t?{s:t}:i,n),o.push(Ps(h,n));break;case"PtgArea":h=ec(v[1][1],i,n),o.push(Ps(h,n));break;case"PtgArea3d":u=v[1][1],h=v[1][2],g=yc(a,u,n),o.push(g+"!"+Ps(h,n));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=v[1][2];var T=(a.names||[])[d-1]||(a[0]||[])[d],H=T?T.Name:"SH33TJSNAME"+String(d);H&&H.slice(0,6)=="_xlfn."&&!n.xlfn&&(H=H.slice(6)),o.push(H);break;case"PtgNameX":var P=v[1][1];d=v[1][2];var q;if(n.biff<=5)P<0&&(P=-P),a[P]&&(q=a[P][d]);else{var V="";if(((a[P]||[])[0]||[])[0]==14849||(((a[P]||[])[0]||[])[0]==1025?a[P][d]&&a[P][d].itab>0&&(V=a.SheetNames[a[P][d].itab-1]+"!"):V=a.SheetNames[d-1]+"!"),a[P]&&a[P][d])V+=a[P][d].Name;else if(a[0]&&a[0][d])V+=a[0][d].Name;else{var L=(rf(a,P,n)||"").split(";;");L[d-1]?V=L[d-1]:V+="SH33TJSERRX"}o.push(V);break}q||(q={Name:"SH33TJSERRY"}),o.push(q.Name);break;case"PtgParen":var J="(",le=")";if(p>=0){switch(m="",e[0][p][1][0]){case 2:J=je(" ",e[0][p][1][1])+J;break;case 3:J=je("\r",e[0][p][1][1])+J;break;case 4:le=je(" ",e[0][p][1][1])+le;break;case 5:le=je("\r",e[0][p][1][1])+le;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}o.push(J+o.pop()+le);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:v[1][1],r:v[1][0]};var re={c:t.c,r:t.r};if(a.sharedf[he(f)]){var ce=a.sharedf[he(f)];o.push(ut(ce,i,re,a,n))}else{var oe=!1;for(c=0;c!=a.arrayf.length;++c)if(l=a.arrayf[c],!(f.c<l[0].s.c||f.c>l[0].e.c)&&!(f.r<l[0].s.r||f.r>l[0].e.r)){o.push(ut(l[1],i,re,a,n)),oe=!0;break}oe||o.push(v[1])}break;case"PtgArray":o.push("{"+xw(v[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=_;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+v[1].idx+"[#"+v[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(v));default:throw new Error("Unrecognized Formula Token: "+String(v))}var Re=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&p>=0&&Re.indexOf(e[0][_][0])==-1){v=e[0][p];var W=!0;switch(v[1][0]){case 4:W=!1;case 0:m=je(" ",v[1][1]);break;case 5:W=!1;case 1:m=je("\r",v[1][1]);break;default:if(m="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+v[1][0])}o.push((W?m:"")+o.pop()+(W?"":m)),p=-1}}if(o.length>1&&n.WTF)throw new Error("bad formula stack");return o[0]}function yw(e,r,t){var a=e.l+r,n=t.biff==2?1:2,s,i=e.read_shift(n);if(i==65535)return[[],xt(e,r-2)];var o=Sn(e,i,t);return r!==i+n&&(s=Tn(e,r-i-n,o,t)),e.l=a,[o,s]}function _w(e,r,t){var a=e.l+r,n=t.biff==2?1:2,s,i=e.read_shift(n);if(i==65535)return[[],xt(e,r-2)];var o=Sn(e,i,t);return r!==i+n&&(s=Tn(e,r-i-n,o,t)),e.l=a,[o,s]}function Ew(e,r,t,a){var n=e.l+r,s=Sn(e,a,t),i;return n!==e.l&&(i=Tn(e,n-e.l,s,t)),[s,i]}function kw(e,r,t){var a=e.l+r,n,s=e.read_shift(2),i=Sn(e,s,t);return s==65535?[[],xt(e,r-2)]:(r!==s+2&&(n=Tn(e,a-s-2,i,t)),[i,n])}function Tw(e){var r;if(pr(e,e.l+6)!==65535)return[dt(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return r=e[e.l+2]===1,e.l+=8,[r,"b"];case 2:return r=e[e.l+2],e.l+=8,[r,"e"];case 3:return e.l+=8,["","s"]}return[]}function Rs(e,r,t){var a=e.l+r,n=lr(e);t.biff==2&&++e.l;var s=Tw(e),i=e.read_shift(1);t.biff!=2&&(e.read_shift(1),t.biff>=5&&e.read_shift(4));var o=_w(e,a-e.l,t);return{cell:n,val:s[0],formula:o,shared:i>>3&1,tt:s[1]}}function ms(e,r,t){var a=e.read_shift(4),n=Sn(e,a,t),s=e.read_shift(4),i=s>0?Tn(e,s,n,t):null;return[n,i]}var Sw=ms,xs=ms,Aw=ms,bw=ms,Fw={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},af={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Cw={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function _c(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(r,t){return t.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Ls(e){var r=e.split(":"),t=r[0].split(".")[0];return[t,r[0].split(".")[1]+(r.length>1?":"+(r[1].split(".")[1]||r[1].split(".")[0]):"")]}var rn={},Ea={};function an(e,r){if(e){var t=[.7,.7,.75,.75,.3,.3];r=="xlml"&&(t=[1,1,1,1,.5,.5]),e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function nf(e,r,t,a,n,s){try{a.cellNF&&(e.z=me[r])}catch(o){if(a.WTF)throw o}if(!(e.t==="z"&&!a.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=nt(e.v)),(!a||a.cellText!==!1)&&e.t!=="z")try{if(me[r]==null&&Yr(Ig[r]||"General",r),e.t==="e")e.w=e.w||la[e.v];else if(r===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ln(e.v);else if(e.t==="d"){var i=At(e.v);(i|0)===i?e.w=i.toString(10):e.w=ln(i)}else{if(e.v===void 0)return"";e.w=ea(e.v,Ea)}else e.t==="d"?e.w=qt(r,At(e.v),Ea):e.w=qt(r,e.v,Ea)}catch(o){if(a.WTF)throw o}if(a.cellStyles&&t!=null)try{e.s=s.Fills[t],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Zn(n.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF&&(e.s.fgColor.raw_rgb=n.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Zn(n.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF&&(e.s.bgColor.raw_rgb=n.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(a.WTF&&s.Fills)throw o}}}function Iw(e,r){var t=He(r);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(e["!ref"]=ke(t))}var Pw=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Dw=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Ow=/<(?:\w:)?hyperlink [^>]*>/mg,Rw=/"(\w*:\w*)"/,Lw=/<(?:\w:)?col\b[^>]*[\/]?>/g,Bw=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Mw=/<(?:\w:)?pageMargins[^>]*\/>/g,sf=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Nw=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,$w=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Uw(e,r,t,a,n,s,i){if(!e)return e;a||(a={"!id":{}});var o=r.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},l="",f="",u=e.match(Dw);u?(l=e.slice(0,u.index),f=e.slice(u.index+u[0].length)):l=f=e;var d=l.match(sf);d?qi(d[0],o,n,t):(d=l.match(Nw))&&jw(d[0],d[1]||"",o,n,t);var h=(l.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var g=l.slice(h,h+50).match(Rw);g&&Iw(o,g[1])}var p=l.match($w);p&&p[1]&&zw(p[1],n);var m=[];if(r.cellStyles){var _=l.match(Lw);_&&Vw(m,_)}u&&Kw(u[1],o,r,c,s,i);var b=f.match(Bw);b&&(o["!autofilter"]=Gw(b[0]));var v=[],C=f.match(Pw);if(C)for(h=0;h!=C.length;++h)v[h]=He(C[h].slice(C[h].indexOf('"')+1));var R=f.match(Ow);R&&Hw(o,R,a);var I=f.match(Mw);if(I&&(o["!margins"]=Ww(fe(I[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=ke(c)),r.sheetRows>0&&o["!ref"]){var T=He(o["!ref"]);r.sheetRows<=+T.e.r&&(T.e.r=r.sheetRows-1,T.e.r>c.e.r&&(T.e.r=c.e.r),T.e.r<T.s.r&&(T.s.r=T.e.r),T.e.c>c.e.c&&(T.e.c=c.e.c),T.e.c<T.s.c&&(T.s.c=T.e.c),o["!fullref"]=o["!ref"],o["!ref"]=ke(T))}return m.length>0&&(o["!cols"]=m),v.length>0&&(o["!merges"]=v),o}function qi(e,r,t,a){var n=fe(e);t.Sheets[a]||(t.Sheets[a]={}),n.codeName&&(t.Sheets[a].CodeName=Se(Oe(n.codeName)))}function jw(e,r,t,a,n){qi(e.slice(0,e.indexOf(">")),t,a,n)}function Hw(e,r,t){for(var a=Array.isArray(e),n=0;n!=r.length;++n){var s=fe(Oe(r[n]),!0);if(!s.ref)return;var i=((t||{})["!id"]||[])[s.id];i?(s.Target=i.Target,s.location&&(s.Target+="#"+Se(s.location))):(s.Target="#"+Se(s.location),i={Target:s.Target,TargetMode:"Internal"}),s.Rel=i,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=He(s.ref),c=o.s.r;c<=o.e.r;++c)for(var l=o.s.c;l<=o.e.c;++l){var f=he({c:l,r:c});a?(e[c]||(e[c]=[]),e[c][l]||(e[c][l]={t:"z",v:void 0}),e[c][l].l=s):(e[f]||(e[f]={t:"z",v:void 0}),e[f].l=s)}}}function Ww(e){var r={};return["left","right","top","bottom","header","footer"].forEach(function(t){e[t]&&(r[t]=parseFloat(e[t]))}),r}function Vw(e,r){for(var t=!1,a=0;a!=r.length;++a){var n=fe(r[a],!0);n.hidden&&(n.hidden=Le(n.hidden));var s=parseInt(n.min,10)-1,i=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!t&&n.width&&(t=!0,Vi(n.width)),Aa(n);s<=i;)e[s++]=it(n)}}function Gw(e){var r={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return r}var qw=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function zw(e,r){r.Views||(r.Views=[{}]),(e.match(qw)||[]).forEach(function(t,a){var n=fe(t);r.Views[a]||(r.Views[a]={}),+n.zoomScale&&(r.Views[a].zoom=+n.zoomScale),Le(n.rightToLeft)&&(r.Views[a].RTL=!0)})}var Kw=function(){var e=/<(?:\w+:)?c[ \/>]/,r=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,s=fn("v"),i=fn("f");return function(c,l,f,u,d,h){for(var g=0,p="",m=[],_=[],b=0,v=0,C=0,R="",I,T,H=0,P=0,q,V,L=0,J=0,le=Array.isArray(h.CellXf),re,ce=[],oe=[],Re=Array.isArray(l),W=[],ue={},de=!1,A=!!f.sheetStubs,U=c.split(r),O=0,D=U.length;O!=D;++O){p=U[O].trim();var z=p.length;if(z!==0){var te=0;e:for(g=0;g<z;++g)switch(p[g]){case">":if(p[g-1]!="/"){++g;break e}if(f&&f.cellStyles){if(T=fe(p.slice(te,g),!0),H=T.r!=null?parseInt(T.r,10):H+1,P=-1,f.sheetRows&&f.sheetRows<H)continue;ue={},de=!1,T.ht&&(de=!0,ue.hpt=parseFloat(T.ht),ue.hpx=gn(ue.hpt)),T.hidden=="1"&&(de=!0,ue.hidden=!0),T.outlineLevel!=null&&(de=!0,ue.level=+T.outlineLevel),de&&(W[H-1]=ue)}break;case"<":te=g;break}if(te>=g)break;if(T=fe(p.slice(te,g),!0),H=T.r!=null?parseInt(T.r,10):H+1,P=-1,!(f.sheetRows&&f.sheetRows<H)){u.s.r>H-1&&(u.s.r=H-1),u.e.r<H-1&&(u.e.r=H-1),f&&f.cellStyles&&(ue={},de=!1,T.ht&&(de=!0,ue.hpt=parseFloat(T.ht),ue.hpx=gn(ue.hpt)),T.hidden=="1"&&(de=!0,ue.hidden=!0),T.outlineLevel!=null&&(de=!0,ue.level=+T.outlineLevel),de&&(W[H-1]=ue)),m=p.slice(g).split(e);for(var se=0;se!=m.length&&m[se].trim().charAt(0)=="<";++se);for(m=m.slice(se),g=0;g!=m.length;++g)if(p=m[g].trim(),p.length!==0){if(_=p.match(t),b=g,v=0,C=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,_!=null&&_.length===2){for(b=0,R=_[1],v=0;v!=R.length&&!((C=R.charCodeAt(v)-64)<1||C>26);++v)b=26*b+C;--b,P=b}else++P;for(v=0;v!=p.length&&p.charCodeAt(v)!==62;++v);if(++v,T=fe(p.slice(0,v),!0),T.r||(T.r=he({r:H-1,c:P})),R=p.slice(v),I={t:""},(_=R.match(s))!=null&&_[1]!==""&&(I.v=Se(_[1])),f.cellFormula){if((_=R.match(i))!=null&&_[1]!==""){if(I.f=Se(Oe(_[1])).replace(/\r\n/g,`
`),f.xlfn||(I.f=xc(I.f)),_[0].indexOf('t="array"')>-1)I.F=(R.match(n)||[])[1],I.F.indexOf(":")>-1&&ce.push([He(I.F),I.F]);else if(_[0].indexOf('t="shared"')>-1){V=fe(_[0]);var Z=Se(Oe(_[1]));f.xlfn||(Z=xc(Z)),oe[parseInt(V.si,10)]=[V,Z,T.r]}}else(_=R.match(/<f[^>]*\/>/))&&(V=fe(_[0]),oe[V.si]&&(I.f=sv(oe[V.si][1],oe[V.si][2],T.r)));var Y=Tt(T.r);for(v=0;v<ce.length;++v)Y.r>=ce[v][0].s.r&&Y.r<=ce[v][0].e.r&&Y.c>=ce[v][0].s.c&&Y.c<=ce[v][0].e.c&&(I.F=ce[v][1])}if(T.t==null&&I.v===void 0)if(I.f||I.F)I.v=0,I.t="n";else if(A)I.t="z";else continue;else I.t=T.t||"n";switch(u.s.c>P&&(u.s.c=P),u.e.c<P&&(u.e.c=P),I.t){case"n":if(I.v==""||I.v==null){if(!A)continue;I.t="z"}else I.v=parseFloat(I.v);break;case"s":if(typeof I.v>"u"){if(!A)continue;I.t="z"}else q=rn[parseInt(I.v,10)],I.v=q.t,I.r=q.r,f.cellHTML&&(I.h=q.h);break;case"str":I.t="s",I.v=I.v!=null?Oe(I.v):"",f.cellHTML&&(I.h=Oi(I.v));break;case"inlineStr":_=R.match(a),I.t="s",_!=null&&(q=Wi(_[1]))?(I.v=q.t,f.cellHTML&&(I.h=q.h)):I.v="";break;case"b":I.v=Le(I.v);break;case"d":f.cellDates?I.v=nt(I.v,1):(I.v=At(nt(I.v,1)),I.t="n");break;case"e":(!f||f.cellText!==!1)&&(I.w=I.v),I.v=A0[I.v];break}if(L=J=0,re=null,le&&T.s!==void 0&&(re=h.CellXf[T.s],re!=null&&(re.numFmtId!=null&&(L=re.numFmtId),f.cellStyles&&re.fillId!=null&&(J=re.fillId))),nf(I,L,J,f,d,h),f.cellDates&&le&&I.t=="n"&&Ia(me[L])&&(I.t="d",I.v=gs(I.v)),T.cm&&f.xlmeta){var Te=(f.xlmeta.Cell||[])[+T.cm-1];Te&&Te.type=="XLDAPR"&&(I.D=!0)}if(Re){var F=Tt(T.r);l[F.r]||(l[F.r]=[]),l[F.r][F.c]=I}else l[T.r]=I}}}}W.length>0&&(l["!rows"]=W)}}();function Xw(e,r){var t={},a=e.l+r;t.r=e.read_shift(4),e.l+=4;var n=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=a,s&7&&(t.level=s&7),s&16&&(t.hidden=!0),s&32&&(t.hpt=n/20),t}var Yw=ca;function Jw(){}function Qw(e,r){var t={},a=e[e.l];return++e.l,t.above=!(a&64),t.left=!(a&128),e.l+=18,t.name=yp(e),t}function Zw(e){var r=zt(e);return[r]}function ey(e){var r=oa(e);return[r]}function ty(e){var r=zt(e),t=e.read_shift(1);return[r,t,"b"]}function ry(e){var r=oa(e),t=e.read_shift(1);return[r,t,"b"]}function ay(e){var r=zt(e),t=e.read_shift(1);return[r,t,"e"]}function ny(e){var r=oa(e),t=e.read_shift(1);return[r,t,"e"]}function sy(e){var r=zt(e),t=e.read_shift(4);return[r,t,"s"]}function iy(e){var r=oa(e),t=e.read_shift(4);return[r,t,"s"]}function oy(e){var r=zt(e),t=dt(e);return[r,t,"n"]}function of(e){var r=oa(e),t=dt(e);return[r,t,"n"]}function cy(e){var r=zt(e),t=Ui(e);return[r,t,"n"]}function ly(e){var r=oa(e),t=Ui(e);return[r,t,"n"]}function fy(e){var r=zt(e),t=Ni(e);return[r,t,"is"]}function uy(e){var r=zt(e),t=mt(e);return[r,t,"str"]}function dy(e){var r=oa(e),t=mt(e);return[r,t,"str"]}function hy(e,r,t){var a=e.l+r,n=zt(e);n.r=t["!row"];var s=e.read_shift(1),i=[n,s,"b"];if(t.cellFormula){e.l+=2;var o=xs(e,a-e.l,t);i[3]=ut(o,null,n,t.supbooks,t)}else e.l=a;return i}function gy(e,r,t){var a=e.l+r,n=zt(e);n.r=t["!row"];var s=e.read_shift(1),i=[n,s,"e"];if(t.cellFormula){e.l+=2;var o=xs(e,a-e.l,t);i[3]=ut(o,null,n,t.supbooks,t)}else e.l=a;return i}function py(e,r,t){var a=e.l+r,n=zt(e);n.r=t["!row"];var s=dt(e),i=[n,s,"n"];if(t.cellFormula){e.l+=2;var o=xs(e,a-e.l,t);i[3]=ut(o,null,n,t.supbooks,t)}else e.l=a;return i}function my(e,r,t){var a=e.l+r,n=zt(e);n.r=t["!row"];var s=mt(e),i=[n,s,"str"];if(t.cellFormula){e.l+=2;var o=xs(e,a-e.l,t);i[3]=ut(o,null,n,t.supbooks,t)}else e.l=a;return i}var xy=ca;function vy(e,r){var t=e.l+r,a=ca(e),n=$i(e),s=mt(e),i=mt(e),o=mt(e);e.l=t;var c={rfx:a,relId:n,loc:s,display:o};return i&&(c.Tooltip=i),c}function wy(){}function yy(e,r,t){var a=e.l+r,n=k0(e),s=e.read_shift(1),i=[n];if(i[2]=s,t.cellFormula){var o=Sw(e,a-e.l,t);i[1]=o}else e.l=a;return i}function _y(e,r,t){var a=e.l+r,n=ca(e),s=[n];if(t.cellFormula){var i=bw(e,a-e.l,t);s[1]=i,e.l=a}else e.l=a;return s}var Ey=["left","right","top","bottom","header","footer"];function ky(e){var r={};return Ey.forEach(function(t){r[t]=dt(e)}),r}function Ty(e){var r=e.read_shift(2);return e.l+=28,{RTL:r&32}}function Sy(){}function Ay(){}function by(e,r,t,a,n,s,i){if(!e)return e;var o=r||{};a||(a={"!id":{}});var c=o.dense?[]:{},l,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},u=!1,d=!1,h,g,p,m,_,b,v,C,R,I=[];o.biff=12,o["!row"]=0;var T=0,H=!1,P=[],q={},V=o.supbooks||n.supbooks||[[]];if(V.sharedf=q,V.arrayf=P,V.SheetNames=n.SheetNames||n.Sheets.map(function(Re){return Re.name}),!o.supbooks&&(o.supbooks=V,n.Names))for(var L=0;L<n.Names.length;++L)V[0][L+1]=n.Names[L];var J=[],le=[],re=!1;rs[16]={n:"BrtShortReal",f:of};var ce;if(Er(e,function(W,ue,de){if(!d)switch(de){case 148:l=W;break;case 0:h=W,o.sheetRows&&o.sheetRows<=h.r&&(d=!0),C=ot(m=h.r),o["!row"]=h.r,(W.hidden||W.hpt||W.level!=null)&&(W.hpt&&(W.hpx=gn(W.hpt)),le[W.r]=W);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:W[2]},W[2]){case"n":g.v=W[1];break;case"s":v=rn[W[1]],g.v=v.t,g.r=v.r;break;case"b":g.v=!!W[1];break;case"e":g.v=W[1],o.cellText!==!1&&(g.w=la[g.v]);break;case"str":g.t="s",g.v=W[1];break;case"is":g.t="s",g.v=W[1].t;break}if((p=i.CellXf[W[0].iStyleRef])&&nf(g,p.numFmtId,null,o,s,i),_=W[0].c==-1?_+1:W[0].c,o.dense?(c[m]||(c[m]=[]),c[m][_]=g):c[Ze(_)+C]=g,o.cellFormula){for(H=!1,T=0;T<P.length;++T){var A=P[T];h.r>=A[0].s.r&&h.r<=A[0].e.r&&_>=A[0].s.c&&_<=A[0].e.c&&(g.F=ke(A[0]),H=!0)}!H&&W.length>3&&(g.f=W[3])}if(f.s.r>h.r&&(f.s.r=h.r),f.s.c>_&&(f.s.c=_),f.e.r<h.r&&(f.e.r=h.r),f.e.c<_&&(f.e.c=_),o.cellDates&&p&&g.t=="n"&&Ia(me[p.numFmtId])){var U=Xr(g.v);U&&(g.t="d",g.v=new Date(U.y,U.m-1,U.d,U.H,U.M,U.S,U.u))}ce&&(ce.type=="XLDAPR"&&(g.D=!0),ce=void 0);break;case 1:case 12:if(!o.sheetStubs||u)break;g={t:"z",v:void 0},_=W[0].c==-1?_+1:W[0].c,o.dense?(c[m]||(c[m]=[]),c[m][_]=g):c[Ze(_)+C]=g,f.s.r>h.r&&(f.s.r=h.r),f.s.c>_&&(f.s.c=_),f.e.r<h.r&&(f.e.r=h.r),f.e.c<_&&(f.e.c=_),ce&&(ce.type=="XLDAPR"&&(g.D=!0),ce=void 0);break;case 176:I.push(W);break;case 49:ce=((o.xlmeta||{}).Cell||[])[W-1];break;case 494:var O=a["!id"][W.relId];for(O?(W.Target=O.Target,W.loc&&(W.Target+="#"+W.loc),W.Rel=O):W.relId==""&&(W.Target="#"+W.loc),m=W.rfx.s.r;m<=W.rfx.e.r;++m)for(_=W.rfx.s.c;_<=W.rfx.e.c;++_)o.dense?(c[m]||(c[m]=[]),c[m][_]||(c[m][_]={t:"z",v:void 0}),c[m][_].l=W):(b=he({c:_,r:m}),c[b]||(c[b]={t:"z",v:void 0}),c[b].l=W);break;case 426:if(!o.cellFormula)break;P.push(W),R=o.dense?c[m][_]:c[Ze(_)+C],R.f=ut(W[1],f,{r:h.r,c:_},V,o),R.F=ke(W[0]);break;case 427:if(!o.cellFormula)break;q[he(W[0].s)]=W[1],R=o.dense?c[m][_]:c[Ze(_)+C],R.f=ut(W[1],f,{r:h.r,c:_},V,o);break;case 60:if(!o.cellStyles)break;for(;W.e>=W.s;)J[W.e--]={width:W.w/256,hidden:!!(W.flags&1),level:W.level},re||(re=!0,Vi(W.w/256)),Aa(J[W.e+1]);break;case 161:c["!autofilter"]={ref:ke(W)};break;case 476:c["!margins"]=W;break;case 147:n.Sheets[t]||(n.Sheets[t]={}),W.name&&(n.Sheets[t].CodeName=W.name),(W.above||W.left)&&(c["!outline"]={above:W.above,left:W.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),W.RTL&&(n.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:u=!0;break;case 36:u=!1;break;case 37:u=!0;break;case 38:u=!1;break;default:if(!ue.T){if(!u||o.WTF)throw new Error("Unexpected record 0x"+de.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(f.s.r<2e6||l&&(l.e.r>0||l.e.c>0||l.s.r>0||l.s.c>0))&&(c["!ref"]=ke(l||f)),o.sheetRows&&c["!ref"]){var oe=He(c["!ref"]);o.sheetRows<=+oe.e.r&&(oe.e.r=o.sheetRows-1,oe.e.r>f.e.r&&(oe.e.r=f.e.r),oe.e.r<oe.s.r&&(oe.s.r=oe.e.r),oe.e.c>f.e.c&&(oe.e.c=f.e.c),oe.e.c<oe.s.c&&(oe.s.c=oe.e.c),c["!fullref"]=c["!ref"],c["!ref"]=ke(oe))}return I.length>0&&(c["!merges"]=I),J.length>0&&(c["!cols"]=J),le.length>0&&(c["!rows"]=le),c}function Fy(e){var r=[],t=e.match(/^<c:numCache>/),a;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var i=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(r[+i[1]]=t?+i[2]:i[2])});var n=Se((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){a=s.replace(/<.*?>/g,"")}),[r,n,a]}function Cy(e,r,t,a,n,s){var i=s||{"!type":"chart"};if(!e)return s;var o=0,c=0,l="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(u){var d=Fy(u);f.s.r=f.s.c=0,f.e.c=o,l=Ze(o),d[0].forEach(function(h,g){i[l+ot(g)]={t:"n",v:h,z:d[1]},c=g}),f.e.r<c&&(f.e.r=c),++o}),o>0&&(i["!ref"]=ke(f)),i}function Iy(e,r,t,a,n){if(!e)return e;a||(a={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i,o=e.match(sf);return o&&qi(o[0],s,n,t),(i=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=i[1]),a["!id"][s["!rel"]]&&(s["!drawel"]=a["!id"][s["!rel"]]),s}function Py(e,r){e.l+=10;var t=mt(e);return{name:t}}function Dy(e,r,t,a,n){if(!e)return e;a||(a={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i=!1;return Er(e,function(c,l,f){switch(f){case 550:s["!rel"]=c;break;case 651:n.Sheets[t]||(n.Sheets[t]={}),c.name&&(n.Sheets[t].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(l.T>0)){if(!(l.T<0)){if(!i||r.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},r),a["!id"][s["!rel"]]&&(s["!drawel"]=a["!id"][s["!rel"]]),s}var cf=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Oy=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Ry=[],Ly=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Ec(e,r){for(var t=0;t!=e.length;++t)for(var a=e[t],n=0;n!=r.length;++n){var s=r[n];if(a[s[0]]==null)a[s[0]]=s[1];else switch(s[2]){case"bool":typeof a[s[0]]=="string"&&(a[s[0]]=Le(a[s[0]]));break;case"int":typeof a[s[0]]=="string"&&(a[s[0]]=parseInt(a[s[0]],10));break}}}function kc(e,r){for(var t=0;t!=r.length;++t){var a=r[t];if(e[a[0]]==null)e[a[0]]=a[1];else switch(a[2]){case"bool":typeof e[a[0]]=="string"&&(e[a[0]]=Le(e[a[0]]));break;case"int":typeof e[a[0]]=="string"&&(e[a[0]]=parseInt(e[a[0]],10));break}}}function lf(e){kc(e.WBProps,cf),kc(e.CalcPr,Ly),Ec(e.WBView,Oy),Ec(e.Sheets,Ry),Ea.date1904=Le(e.WBProps.date1904)}var By="][*?/\\".split("");function My(e,r){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return By.forEach(function(a){if(e.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}var Ny=/<\w+:workbook/;function $y(e,r){if(!e)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,n="xmlns",s={},i=0;if(e.replace(vt,function(c,l){var f=fe(c);switch(cr(f[0])){case"<?xml":break;case"<workbook":c.match(Ny)&&(n="xmlns"+c.match(/<(\w+):/)[1]),t.xmlns=f[n];break;case"</workbook>":break;case"<fileVersion":delete f[0],t.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":cf.forEach(function(u){if(f[u[0]]!=null)switch(u[2]){case"bool":t.WBProps[u[0]]=Le(f[u[0]]);break;case"int":t.WBProps[u[0]]=parseInt(f[u[0]],10);break;default:t.WBProps[u[0]]=f[u[0]]}}),f.codeName&&(t.WBProps.CodeName=Oe(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],t.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=Se(Oe(f.name)),delete f[0],t.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":s={},s.Name=Oe(f.name),f.comment&&(s.Comment=f.comment),f.localSheetId&&(s.Sheet=+f.localSheetId),Le(f.hidden||"0")&&(s.Hidden=!0),i=l+c.length;break;case"</definedName>":s.Ref=Se(Oe(e.slice(i,l))),t.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete f[0],t.CalcPr=f;break;case"<calcPr/>":delete f[0],t.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&r.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return c}),ap.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return lf(t),t}function Uy(e,r){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=Xs(e),t.name=mt(e),t}function jy(e,r){var t={},a=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var n=r>8?mt(e):"";return n.length>0&&(t.CodeName=n),t.autoCompressPictures=!!(a&65536),t.backupFile=!!(a&64),t.checkCompatibility=!!(a&4096),t.date1904=!!(a&1),t.filterPrivacy=!!(a&8),t.hidePivotFieldList=!!(a&1024),t.promptedSolutions=!!(a&16),t.publishItems=!!(a&2048),t.refreshAllConnections=!!(a&262144),t.saveExternalLinkValues=!!(a&128),t.showBorderUnselectedTables=!!(a&4),t.showInkAnnotation=!!(a&32),t.showObjects=["all","placeholders","none"][a>>13&3],t.showPivotChartFilter=!!(a&32768),t.updateLinks=["userSet","never","always"][a>>8&3],t}function Hy(e,r){var t={};return e.read_shift(4),t.ArchID=e.read_shift(4),e.l+=r-8,t}function Wy(e,r,t){var a=e.l+r;e.l+=4,e.l+=1;var n=e.read_shift(4),s=_p(e),i=Aw(e,0,t),o=$i(e);e.l=a;var c={Name:s,Ptg:i};return n<268435455&&(c.Sheet=n),o&&(c.Comment=o),c}function Vy(e,r){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],n=!1;r||(r={}),r.biff=12;var s=[],i=[[]];return i.SheetNames=[],i.XTI=[],rs[16]={n:"BrtFRTArchID$",f:Hy},Er(e,function(c,l,f){switch(f){case 156:i.SheetNames.push(c.name),t.Sheets.push(c);break;case 153:t.WBProps=c;break;case 39:c.Sheet!=null&&(r.SID=c.Sheet),c.Ref=ut(c.Ptg,null,null,i,r),delete r.SID,delete c.Ptg,s.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([f,c]):i[0]=[f,c],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(c),i.XTI=i.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(f),n=!0;break;case 36:a.pop(),n=!1;break;case 37:a.push(f),n=!0;break;case 38:a.pop(),n=!1;break;case 16:break;default:if(!l.T){if(!n||r.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},r),lf(t),t.Names=s,t.supbooks=i,t}function Gy(e,r,t){return r.slice(-4)===".bin"?Vy(e,t):$y(e,t)}function qy(e,r,t,a,n,s,i,o){return r.slice(-4)===".bin"?by(e,a,t,n,s,i,o):Uw(e,a,t,n,s,i,o)}function zy(e,r,t,a,n,s,i,o){return r.slice(-4)===".bin"?Dy(e,a,t,n,s):Iy(e,a,t,n,s)}function Ky(e,r,t,a,n,s,i,o){return r.slice(-4)===".bin"?rv():av()}function Xy(e,r,t,a,n,s,i,o){return r.slice(-4)===".bin"?ev():tv()}function Yy(e,r,t,a){return r.slice(-4)===".bin"?xx(e,t,a):ux(e,t,a)}function Jy(e,r,t){return K0(e,t)}function Qy(e,r,t){return r.slice(-4)===".bin"?Om(e,t):Pm(e,t)}function Zy(e,r,t){return r.slice(-4)===".bin"?Jx(e,t):qx(e,t)}function e_(e,r,t){return r.slice(-4)===".bin"?Wx(e):jx(e)}function t_(e,r,t,a){return t.slice(-4)===".bin"?Vx(e,r,t,a):void 0}function r_(e,r,t){return r.slice(-4)===".bin"?$x(e,r,t):Ux(e,r,t)}var ff=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,uf=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Kt(e,r){var t=e.split(/\s+/),a=[];if(a[0]=t[0],t.length===1)return a;var n=e.match(ff),s,i,o,c;if(n)for(c=0;c!=n.length;++c)s=n[c].match(uf),(i=s[1].indexOf(":"))===-1?a[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(i+1),a[o]=s[2].slice(1,s[2].length-1));return a}function a_(e){var r=e.split(/\s+/),t={};if(r.length===1)return t;var a=e.match(ff),n,s,i,o;if(a)for(o=0;o!=a.length;++o)n=a[o].match(uf),(s=n[1].indexOf(":"))===-1?t[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?i="xmlns"+n[1].slice(6):i=n[1].slice(s+1),t[i]=n[2].slice(1,n[2].length-1));return t}var nn;function n_(e,r){var t=nn[e]||Se(e);return t==="General"?ea(r):qt(t,r)}function s_(e,r,t,a){var n=a;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=Le(a);break;case"i2":case"int":n=parseInt(a,10);break;case"r4":case"float":n=parseFloat(a);break;case"date":case"dateTime.tz":n=nt(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}e[Se(r)]=n}function i_(e,r,t){if(e.t!=="z"){if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||la[e.v]:r==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ln(e.v):e.w=ea(e.v):e.w=n_(r||"General",e.v)}catch(s){if(t.WTF)throw s}try{var a=nn[r]||r||"General";if(t.cellNF&&(e.z=a),t.cellDates&&e.t=="n"&&Ia(a)){var n=Xr(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(s){if(t.WTF)throw s}}}function o_(e,r,t){if(t.cellStyles&&r.Interior){var a=r.Interior;a.Pattern&&(a.patternType=sx[a.Pattern]||a.Pattern)}e[r.ID]=r}function c_(e,r,t,a,n,s,i,o,c,l){var f="General",u=a.StyleID,d={};l=l||{};var h=[],g=0;for(u===void 0&&o&&(u=o.StyleID),u===void 0&&i&&(u=i.StyleID);s[u]!==void 0&&(s[u].nf&&(f=s[u].nf),s[u].Interior&&h.push(s[u].Interior),!!s[u].Parent);)u=s[u].Parent;switch(t.Type){case"Boolean":a.t="b",a.v=Le(e);break;case"String":a.t="s",a.r=Go(Se(e)),a.v=e.indexOf("<")>-1?Se(r||e).replace(/<.*?>/g,""):a.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),a.v=(nt(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),a.v!==a.v?a.v=Se(e):a.v<60&&(a.v=a.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+e),a.t||(a.t="n");break;case"Error":a.t="e",a.v=A0[e],l.cellText!==!1&&(a.w=e);break;default:e==""&&r==""?a.t="z":(a.t="s",a.v=Go(r||e));break}if(i_(a,f,l),l.cellFormula!==!1)if(a.Formula){var p=Se(a.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),a.f=_a(p,n),delete a.Formula,a.ArrayRange=="RC"?a.F=_a("RC:RC",n):a.ArrayRange&&(a.F=_a(a.ArrayRange,n),c.push([He(a.F),a.F]))}else for(g=0;g<c.length;++g)n.r>=c[g][0].s.r&&n.r<=c[g][0].e.r&&n.c>=c[g][0].s.c&&n.c<=c[g][0].e.c&&(a.F=c[g][1]);l.cellStyles&&(h.forEach(function(m){!d.patternType&&m.patternType&&(d.patternType=m.patternType)}),a.s=d),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function l_(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Bs(e,r){var t=r||{};Ql();var a=Ha(Ri(e));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(a=Oe(a));var n=a.slice(0,1024).toLowerCase(),s=!1;if(n=n.replace(/".*?"/g,""),(n.indexOf(">")&1023)>Math.min(n.indexOf(",")&1023,n.indexOf(";")&1023)){var i=it(t);return i.type="string",dn.to_workbook(a,i)}if(n.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ve){n.indexOf("<"+Ve)>=0&&(s=!0)}),s)return v_(a,t);nn={"General Number":"General","General Date":me[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":me[15],"Short Date":me[14],"Long Time":me[19],"Medium Time":me[18],"Short Time":me[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:me[2],Standard:me[4],Percent:me[10],Scientific:me[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],l,f={},u=[],d=t.dense?[]:{},h="",g={},p={},m=Kt('<Data ss:Type="String">'),_=0,b=0,v=0,C={s:{r:2e6,c:2e6},e:{r:0,c:0}},R={},I={},T="",H=0,P=[],q={},V={},L=0,J=[],le=[],re={},ce=[],oe,Re=!1,W=[],ue=[],de={},A=0,U=0,O={Sheets:[],WBProps:{date1904:!1}},D={};un.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var z="";o=un.exec(a);)switch(o[3]=(z=o[3]).toLowerCase()){case"data":if(z=="data"){if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?c_(a.slice(_,o.index),T,m,c[c.length-1][0]=="comment"?re:g,{c:b,r:v},R,ce[b],p,W,t):(T="",m=Kt(o[0]),_=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(le.length>0&&(g.c=le),(!t.sheetRows||t.sheetRows>v)&&g.v!==void 0&&(t.dense?(d[v]||(d[v]=[]),d[v][b]=g):d[Ze(b)+ot(v)]=g),g.HRef&&(g.l={Target:Se(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(A=b+(parseInt(g.MergeAcross,10)|0),U=v+(parseInt(g.MergeDown,10)|0),P.push({s:{c:b,r:v},e:{c:A,r:U}})),!t.sheetStubs)g.MergeAcross?b=A+1:++b;else if(g.MergeAcross||g.MergeDown){for(var te=b;te<=A;++te)for(var se=v;se<=U;++se)(te>b||se>v)&&(t.dense?(d[se]||(d[se]=[]),d[se][te]={t:"z"}):d[Ze(te)+ot(se)]={t:"z"});b=A+1}else++b;else g=a_(o[0]),g.Index&&(b=+g.Index-1),b<C.s.c&&(C.s.c=b),b>C.e.c&&(C.e.c=b),o[0].slice(-2)==="/>"&&++b,le=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(v<C.s.r&&(C.s.r=v),v>C.e.r&&(C.e.r=v),o[0].slice(-2)==="/>"&&(p=Kt(o[0]),p.Index&&(v=+p.Index-1)),b=0,++v):(p=Kt(o[0]),p.Index&&(v=+p.Index-1),de={},(p.AutoFitHeight=="0"||p.Height)&&(de.hpx=parseInt(p.Height,10),de.hpt=z0(de.hpx),ue[v]=de),p.Hidden=="1"&&(de.hidden=!0,ue[v]=de));break;case"worksheet":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"));u.push(h),C.s.r<=C.e.r&&C.s.c<=C.e.c&&(d["!ref"]=ke(C),t.sheetRows&&t.sheetRows<=C.e.r&&(d["!fullref"]=d["!ref"],C.e.r=t.sheetRows-1,d["!ref"]=ke(C))),P.length&&(d["!merges"]=P),ce.length>0&&(d["!cols"]=ce),ue.length>0&&(d["!rows"]=ue),f[h]=d}else C={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=b=0,c.push([o[3],!1]),l=Kt(o[0]),h=Se(l.Name),d=t.dense?[]:{},P=[],W=[],ue=[],D={name:h,Hidden:0},O.Sheets.push(D);break;case"table":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),ce=[],Re=!1}break;case"style":o[1]==="/"?o_(R,I,t):I=Kt(o[0]);break;case"numberformat":I.nf=Se(Kt(o[0]).Format||"General"),nn[I.nf]&&(I.nf=nn[I.nf]);for(var Z=0;Z!=392&&me[Z]!=I.nf;++Z);if(Z==392){for(Z=57;Z!=392;++Z)if(me[Z]==null){Yr(I.nf,Z);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(oe=Kt(o[0]),oe.Hidden&&(oe.hidden=!0,delete oe.Hidden),oe.Width&&(oe.wpx=parseInt(oe.Width,10)),!Re&&oe.wpx>10){Re=!0,Et=G0;for(var Y=0;Y<ce.length;++Y)ce[Y]&&Aa(ce[Y])}Re&&Aa(oe),ce[oe.Index-1||ce.length]=oe;for(var Te=0;Te<+oe.Span;++Te)ce[ce.length]=it(oe);break;case"namedrange":if(o[1]==="/")break;O.Names||(O.Names=[]);var F=fe(o[0]),We={Name:F.Name,Ref:_a(F.RefersTo.slice(1),{r:0,c:0})};O.Sheets.length>0&&(We.Sheet=O.Sheets.length-1),O.Names.push(We);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?T+=a.slice(H,o.index):H=o.index+o[0].length;break;case"interior":if(!t.cellStyles)break;I.Interior=Kt(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?qp(q,z,a.slice(L,o.index)):L=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"));l_(re),le.push(re)}else c.push([o[3],!1]),l=Kt(o[0]),re={a:l.Author};break;case"autofilter":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Ae=Kt(o[0]);d["!autofilter"]={ref:_a(Ae.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return Cc(a,t);var Pe=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Pe=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Pe=!1}break;case"excelworkbook":switch(o[3]){case"date1904":O.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Pe=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Pe=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(a.slice(L,o.index)){case"SheetHidden":D.Hidden=1;break;case"SheetVeryHidden":D.Hidden=2;break}else L=o.index+o[0].length;break;case"header":d["!margins"]||an(d["!margins"]={},"xlml"),isNaN(+fe(o[0]).Margin)||(d["!margins"].header=+fe(o[0]).Margin);break;case"footer":d["!margins"]||an(d["!margins"]={},"xlml"),isNaN(+fe(o[0]).Margin)||(d["!margins"].footer=+fe(o[0]).Margin);break;case"pagemargins":var we=fe(o[0]);d["!margins"]||an(d["!margins"]={},"xlml"),isNaN(+we.Top)||(d["!margins"].top=+we.Top),isNaN(+we.Left)||(d["!margins"].left=+we.Left),isNaN(+we.Right)||(d["!margins"].right=+we.Right),isNaN(+we.Bottom)||(d["!margins"].bottom=+we.Bottom);break;case"displayrighttoleft":O.Views||(O.Views=[]),O.Views[0]||(O.Views[0]={}),O.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Pe=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Pe=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Pe=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Pe=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Pe=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Pe=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Pe=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Pe=!1}break;case"smarttags":break;default:Pe=!1;break}if(Pe||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?s_(V,z,J,a.slice(L,o.index)):(J=o,L=o.index+o[0].length);break}if(t.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var ae={};return!t.bookSheets&&!t.bookProps&&(ae.Sheets=f),ae.SheetNames=u,ae.Workbook=O,ae.SSF=it(me),ae.Props=q,ae.Custprops=V,ae}function Zs(e,r){switch(Xi(r=r||{}),r.type||"base64"){case"base64":return Bs(Nt(e),r);case"binary":case"buffer":case"file":return Bs(e,r);case"array":return Bs(ia(e),r)}}function f_(e){var r={},t=e.content;if(t.l=28,r.AnsiUserType=t.read_shift(0,"lpstr-ansi"),r.AnsiClipboardFormat=Tp(t),t.length-t.l<=4)return r;var a=t.read_shift(4);if(a==0||a>40||(t.l-=4,r.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(a=t.read_shift(4),a!==1907505652)||(r.UnicodeClipboardFormat=Sp(t),a=t.read_shift(4),a==0||a>40))return r;t.l-=4,r.Reserved2=t.read_shift(0,"lpwstr")}var u_=[60,1084,2066,2165,2175];function d_(e,r,t,a,n){var s=a,i=[],o=t.slice(t.l,t.l+s);if(n&&n.enc&&n.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:n.enc.insitu(o)}i.push(o),t.l+=s;for(var c=pr(t,t.l),l=ei[c],f=0;l!=null&&u_.indexOf(c)>-1;)s=pr(t,t.l+2),f=t.l+4,c==2066?f+=4:(c==2165||c==2175)&&(f+=12),o=t.slice(f,t.l+4+s),i.push(o),t.l+=4+s,l=ei[c=pr(t,t.l)];var u=Ir(i);st(u,0);var d=0;u.lens=[];for(var h=0;h<i.length;++h)u.lens.push(d),d+=i[h].length;if(u.length<a)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+u.length+" < "+a;return r.f(u,u.length,n)}function nr(e,r,t){if(e.t!=="z"&&e.XF){var a=0;try{a=e.z||e.XF.numFmtId||0,r.cellNF&&(e.z=me[a])}catch(s){if(r.WTF)throw s}if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||la[e.v]:a===0||a=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ln(e.v):e.w=ea(e.v):e.w=qt(a,e.v,{date1904:!!t,dateNF:r&&r.dateNF})}catch(s){if(r.WTF)throw s}if(r.cellDates&&a&&e.t=="n"&&Ia(me[a]||String(a))){var n=Xr(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function Wn(e,r,t){return{v:e,ixfe:r,t}}function h_(e,r){var t={opts:{}},a={},n=r.dense?[]:{},s={},i={},o=null,c=[],l="",f={},u,d="",h,g,p,m,_={},b=[],v,C,R=[],I=[],T={Sheets:[],WBProps:{date1904:!1},Views:[{}]},H={},P=function(xe){return xe<8?Jr[xe]:xe<64&&I[xe-8]||Jr[xe]},q=function(xe,Ge,Ut){var Ye=Ge.XF.data;if(!(!Ye||!Ye.patternType||!Ut||!Ut.cellStyles)){Ge.s={},Ge.s.patternType=Ye.patternType;var Hr;(Hr=hn(P(Ye.icvFore)))&&(Ge.s.fgColor={rgb:Hr}),(Hr=hn(P(Ye.icvBack)))&&(Ge.s.bgColor={rgb:Hr})}},V=function(xe,Ge,Ut){if(!(de>1)&&!(Ut.sheetRows&&xe.r>=Ut.sheetRows)){if(Ut.cellStyles&&Ge.XF&&Ge.XF.data&&q(xe,Ge,Ut),delete Ge.ixfe,delete Ge.XF,u=xe,d=he(xe),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),xe.r<i.s.r&&(i.s.r=xe.r),xe.c<i.s.c&&(i.s.c=xe.c),xe.r+1>i.e.r&&(i.e.r=xe.r+1),xe.c+1>i.e.c&&(i.e.c=xe.c+1),Ut.cellFormula&&Ge.f){for(var Ye=0;Ye<b.length;++Ye)if(!(b[Ye][0].s.c>xe.c||b[Ye][0].s.r>xe.r)&&!(b[Ye][0].e.c<xe.c||b[Ye][0].e.r<xe.r)){Ge.F=ke(b[Ye][0]),(b[Ye][0].s.c!=xe.c||b[Ye][0].s.r!=xe.r)&&delete Ge.f,Ge.f&&(Ge.f=""+ut(b[Ye][1],i,xe,W,L));break}}Ut.dense?(n[xe.r]||(n[xe.r]=[]),n[xe.r][xe.c]=Ge):n[d]=Ge}},L={enc:!1,sbcch:0,snames:[],sharedf:_,arrayf:b,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!r&&!!r.cellStyles,WTF:!!r&&!!r.wtf};r.password&&(L.password=r.password);var J,le=[],re=[],ce=[],oe=[],Re=!1,W=[];W.SheetNames=L.snames,W.sharedf=L.sharedf,W.arrayf=L.arrayf,W.names=[],W.XTI=[];var ue=0,de=0,A=0,U=[],O=[],D;L.codepage=1200,Zt(1200);for(var z=!1;e.l<e.length-1;){var te=e.l,se=e.read_shift(2);if(se===0&&ue===10)break;var Z=e.l===e.length?0:e.read_shift(2),Y=ei[se];if(Y&&Y.f){if(r.bookSheets&&ue===133&&se!==133)break;if(ue=se,Y.r===2||Y.r==12){var Te=e.read_shift(2);if(Z-=2,!L.enc&&Te!==se&&((Te&255)<<8|Te>>8)!==se)throw new Error("rt mismatch: "+Te+"!="+se);Y.r==12&&(e.l+=10,Z-=10)}var F={};if(se===10?F=Y.f(e,Z,L):F=d_(se,Y,e,Z,L),de==0&&[9,521,1033,2057].indexOf(ue)===-1)continue;switch(se){case 34:t.opts.Date1904=T.WBProps.date1904=F;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(L.enc||(e.l=0),L.enc=F,!r.password)throw new Error("File is password-protected");if(F.valid==null)throw new Error("Encryption scheme unsupported");if(!F.valid)throw new Error("Password is incorrect");break;case 92:L.lastuser=F;break;case 66:var We=Number(F);switch(We){case 21010:We=1200;break;case 32768:We=1e4;break;case 32769:We=1252;break}Zt(L.codepage=We),z=!0;break;case 317:L.rrtabid=F;break;case 25:L.winlocked=F;break;case 439:t.opts.RefreshAll=F;break;case 12:t.opts.CalcCount=F;break;case 16:t.opts.CalcDelta=F;break;case 17:t.opts.CalcIter=F;break;case 13:t.opts.CalcMode=F;break;case 14:t.opts.CalcPrecision=F;break;case 95:t.opts.CalcSaveRecalc=F;break;case 15:L.CalcRefMode=F;break;case 2211:t.opts.FullCalc=F;break;case 129:F.fDialog&&(n["!type"]="dialog"),F.fBelow||((n["!outline"]||(n["!outline"]={})).above=!0),F.fRight||((n["!outline"]||(n["!outline"]={})).left=!0);break;case 224:R.push(F);break;case 430:W.push([F]),W[W.length-1].XTI=[];break;case 35:case 547:W[W.length-1].push(F);break;case 24:case 536:D={Name:F.Name,Ref:ut(F.rgce,i,null,W,L)},F.itab>0&&(D.Sheet=F.itab-1),W.names.push(D),W[0]||(W[0]=[],W[0].XTI=[]),W[W.length-1].push(F),F.Name=="_xlnm._FilterDatabase"&&F.itab>0&&F.rgce&&F.rgce[0]&&F.rgce[0][0]&&F.rgce[0][0][0]=="PtgArea3d"&&(O[F.itab-1]={ref:ke(F.rgce[0][0][1][2])});break;case 22:L.ExternCount=F;break;case 23:W.length==0&&(W[0]=[],W[0].XTI=[]),W[W.length-1].XTI=W[W.length-1].XTI.concat(F),W.XTI=W.XTI.concat(F);break;case 2196:if(L.biff<8)break;D!=null&&(D.Comment=F[1]);break;case 18:n["!protect"]=F;break;case 19:F!==0&&L.WTF&&console.error("Password verifier: "+F);break;case 133:s[F.pos]=F,L.snames.push(F.name);break;case 10:{if(--de)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,n["!ref"]=ke(i),r.sheetRows&&r.sheetRows<=i.e.r){var Ae=i.e.r;i.e.r=r.sheetRows-1,n["!fullref"]=n["!ref"],n["!ref"]=ke(i),i.e.r=Ae}i.e.r++,i.e.c++}le.length>0&&(n["!merges"]=le),re.length>0&&(n["!objects"]=re),ce.length>0&&(n["!cols"]=ce),oe.length>0&&(n["!rows"]=oe),T.Sheets.push(H)}l===""?f=n:a[l]=n,n=r.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(L.biff===8&&(L.biff={9:2,521:3,1033:4}[se]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[F.BIFFVer]||8),L.biffguess=F.BIFFVer==0,F.BIFFVer==0&&F.dt==4096&&(L.biff=5,z=!0,Zt(L.codepage=28591)),L.biff==8&&F.BIFFVer==0&&F.dt==16&&(L.biff=2),de++)break;if(n=r.dense?[]:{},L.biff<8&&!z&&(z=!0,Zt(L.codepage=r.codepage||1252)),L.biff<5||F.BIFFVer==0&&F.dt==4096){l===""&&(l="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var Pe={pos:e.l-Z,name:l};s[Pe.pos]=Pe,L.snames.push(l)}else l=(s[te]||{name:""}).name;F.dt==32&&(n["!type"]="chart"),F.dt==64&&(n["!type"]="macro"),le=[],re=[],L.arrayf=b=[],ce=[],oe=[],Re=!1,H={Hidden:(s[te]||{hs:0}).hs,name:l}}break;case 515:case 3:case 2:n["!type"]=="chart"&&(r.dense?(n[F.r]||[])[F.c]:n[he({c:F.c,r:F.r})])&&++F.c,v={ixfe:F.ixfe,XF:R[F.ixfe]||{},v:F.val,t:"n"},A>0&&(v.z=U[v.ixfe>>8&63]),nr(v,r,t.opts.Date1904),V({c:F.c,r:F.r},v,r);break;case 5:case 517:v={ixfe:F.ixfe,XF:R[F.ixfe],v:F.val,t:F.t},A>0&&(v.z=U[v.ixfe>>8&63]),nr(v,r,t.opts.Date1904),V({c:F.c,r:F.r},v,r);break;case 638:v={ixfe:F.ixfe,XF:R[F.ixfe],v:F.rknum,t:"n"},A>0&&(v.z=U[v.ixfe>>8&63]),nr(v,r,t.opts.Date1904),V({c:F.c,r:F.r},v,r);break;case 189:for(var we=F.c;we<=F.C;++we){var ae=F.rkrec[we-F.c][0];v={ixfe:ae,XF:R[ae],v:F.rkrec[we-F.c][1],t:"n"},A>0&&(v.z=U[v.ixfe>>8&63]),nr(v,r,t.opts.Date1904),V({c:we,r:F.r},v,r)}break;case 6:case 518:case 1030:{if(F.val=="String"){o=F;break}if(v=Wn(F.val,F.cell.ixfe,F.tt),v.XF=R[v.ixfe],r.cellFormula){var Ve=F.formula;if(Ve&&Ve[0]&&Ve[0][0]&&Ve[0][0][0]=="PtgExp"){var $t=Ve[0][0][1][0],rr=Ve[0][0][1][1],fr=he({r:$t,c:rr});_[fr]?v.f=""+ut(F.formula,i,F.cell,W,L):v.F=((r.dense?(n[$t]||[])[rr]:n[fr])||{}).F}else v.f=""+ut(F.formula,i,F.cell,W,L)}A>0&&(v.z=U[v.ixfe>>8&63]),nr(v,r,t.opts.Date1904),V(F.cell,v,r),o=F}break;case 7:case 519:if(o)o.val=F,v=Wn(F,o.cell.ixfe,"s"),v.XF=R[v.ixfe],r.cellFormula&&(v.f=""+ut(o.formula,i,o.cell,W,L)),A>0&&(v.z=U[v.ixfe>>8&63]),nr(v,r,t.opts.Date1904),V(o.cell,v,r),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{b.push(F);var La=he(F[0].s);if(h=r.dense?(n[F[0].s.r]||[])[F[0].s.c]:n[La],r.cellFormula&&h){if(!o||!La||!h)break;h.f=""+ut(F[1],i,F[0],W,L),h.F=ke(F[0])}}break;case 1212:{if(!r.cellFormula)break;if(d){if(!o)break;_[he(o.cell)]=F[0],h=r.dense?(n[o.cell.r]||[])[o.cell.c]:n[he(o.cell)],(h||{}).f=""+ut(F[0],i,u,W,L)}}break;case 253:v=Wn(c[F.isst].t,F.ixfe,"s"),c[F.isst].h&&(v.h=c[F.isst].h),v.XF=R[v.ixfe],A>0&&(v.z=U[v.ixfe>>8&63]),nr(v,r,t.opts.Date1904),V({c:F.c,r:F.r},v,r);break;case 513:r.sheetStubs&&(v={ixfe:F.ixfe,XF:R[F.ixfe],t:"z"},A>0&&(v.z=U[v.ixfe>>8&63]),nr(v,r,t.opts.Date1904),V({c:F.c,r:F.r},v,r));break;case 190:if(r.sheetStubs)for(var kr=F.c;kr<=F.C;++kr){var Pt=F.ixfe[kr-F.c];v={ixfe:Pt,XF:R[Pt],t:"z"},A>0&&(v.z=U[v.ixfe>>8&63]),nr(v,r,t.opts.Date1904),V({c:kr,r:F.r},v,r)}break;case 214:case 516:case 4:v=Wn(F.val,F.ixfe,"s"),v.XF=R[v.ixfe],A>0&&(v.z=U[v.ixfe>>8&63]),nr(v,r,t.opts.Date1904),V({c:F.c,r:F.r},v,r);break;case 0:case 512:de===1&&(i=F);break;case 252:c=F;break;case 1054:if(L.biff==4){U[A++]=F[1];for(var ur=0;ur<A+163&&me[ur]!=F[1];++ur);ur>=163&&Yr(F[1],A+163)}else Yr(F[1],F[0]);break;case 30:{U[A++]=F;for(var Tr=0;Tr<A+163&&me[Tr]!=F;++Tr);Tr>=163&&Yr(F,A+163)}break;case 229:le=le.concat(F);break;case 93:re[F.cmo[0]]=L.lastobj=F;break;case 438:L.lastobj.TxO=F;break;case 127:L.lastobj.ImData=F;break;case 440:for(m=F[0].s.r;m<=F[0].e.r;++m)for(p=F[0].s.c;p<=F[0].e.c;++p)h=r.dense?(n[m]||[])[p]:n[he({c:p,r:m})],h&&(h.l=F[1]);break;case 2048:for(m=F[0].s.r;m<=F[0].e.r;++m)for(p=F[0].s.c;p<=F[0].e.c;++p)h=r.dense?(n[m]||[])[p]:n[he({c:p,r:m})],h&&h.l&&(h.l.Tooltip=F[1]);break;case 28:{if(L.biff<=5&&L.biff>=2)break;h=r.dense?(n[F[0].r]||[])[F[0].c]:n[he(F[0])];var Ba=re[F[2]];h||(r.dense?(n[F[0].r]||(n[F[0].r]=[]),h=n[F[0].r][F[0].c]={t:"z"}):h=n[he(F[0])]={t:"z"},i.e.r=Math.max(i.e.r,F[0].r),i.s.r=Math.min(i.s.r,F[0].r),i.e.c=Math.max(i.e.c,F[0].c),i.s.c=Math.min(i.s.c,F[0].c)),h.c||(h.c=[]),g={a:F[1],t:Ba.TxO.t},h.c.push(g)}break;case 2173:Lx(R[F.ixfe],F.ext);break;case 125:{if(!L.cellStyles)break;for(;F.e>=F.s;)ce[F.e--]={width:F.w/256,level:F.level||0,hidden:!!(F.flags&1)},Re||(Re=!0,Vi(F.w/256)),Aa(ce[F.e+1])}break;case 520:{var wt={};F.level!=null&&(oe[F.r]=wt,wt.level=F.level),F.hidden&&(oe[F.r]=wt,wt.hidden=!0),F.hpt&&(oe[F.r]=wt,wt.hpt=F.hpt,wt.hpx=gn(F.hpt))}break;case 38:case 39:case 40:case 41:n["!margins"]||an(n["!margins"]={}),n["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[se]]=F;break;case 161:n["!margins"]||an(n["!margins"]={}),n["!margins"].header=F.header,n["!margins"].footer=F.footer;break;case 574:F.RTL&&(T.Views[0].RTL=!0);break;case 146:I=F;break;case 2198:J=F;break;case 140:C=F;break;case 442:l?H.CodeName=F||H.name:T.WBProps.CodeName=F||"ThisWorkbook";break}}else Y||console.error("Missing Info for XLS Record 0x"+se.toString(16)),e.l+=Z}return t.SheetNames=or(s).sort(function(ar,xe){return Number(ar)-Number(xe)}).map(function(ar){return s[ar].name}),r.bookSheets||(t.Sheets=a),!t.SheetNames.length&&f["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=f)):t.Preamble=f,t.Sheets&&O.forEach(function(ar,xe){t.Sheets[t.SheetNames[xe]]["!autofilter"]=ar}),t.Strings=c,t.SSF=it(me),L.enc&&(t.Encryption=L.enc),J&&(t.Themes=J),t.Metadata={},C!==void 0&&(t.Metadata.Country=C),W.names.length>0&&(T.Names=W.names),t.Workbook=T,t}var Tc={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function g_(e,r,t){var a=Ee.find(e,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var n=oc(a,Pp,Tc.DSI);for(var s in n)r[s]=n[s]}catch(l){if(t.WTF)throw l}var i=Ee.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=oc(i,Dp,Tc.SI);for(var c in o)r[c]==null&&(r[c]=o[c])}catch(l){if(t.WTF)throw l}r.HeadingPairs&&r.TitlesOfParts&&(F0(r.HeadingPairs,r.TitlesOfParts,r,t),delete r.HeadingPairs,delete r.TitlesOfParts)}function df(e,r){r||(r={}),Xi(r),Ul(),r.codepage&&bi(r.codepage);var t,a;if(e.FullPaths){if(Ee.find(e,"/encryption"))throw new Error("File is password-protected");t=Ee.find(e,"!CompObj"),a=Ee.find(e,"/Workbook")||Ee.find(e,"/Book")}else{switch(r.type){case"base64":e=Qt(Nt(e));break;case"binary":e=Qt(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}st(e,0),a={content:e}}var n,s;if(t&&f_(t),r.bookProps&&!r.bookSheets)n={};else{var i=_e?"buffer":"array";if(a&&a.content)n=h_(a.content,r);else if((s=Ee.find(e,"PerfectOffice_MAIN"))&&s.content)n=tn.to_workbook(s.content,(r.type=i,r));else if((s=Ee.find(e,"NativeContent_MAIN"))&&s.content)n=tn.to_workbook(s.content,(r.type=i,r));else throw(s=Ee.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");r.bookVBA&&e.FullPaths&&Ee.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=Zx(e))}var o={};return e.FullPaths&&g_(e,o,r),n.Props=n.Custprops=o,r.bookFiles&&(n.cfb=e),n}var rs={0:{f:Xw},1:{f:Zw},2:{f:cy},3:{f:ay},4:{f:ty},5:{f:oy},6:{f:uy},7:{f:sy},8:{f:my},9:{f:py},10:{f:hy},11:{f:gy},12:{f:ey},13:{f:ly},14:{f:ny},15:{f:ry},16:{f:of},17:{f:dy},18:{f:iy},19:{f:Ni},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Wy},40:{},42:{},43:{f:hx},44:{f:dx},45:{f:gx},46:{f:mx},47:{f:px},48:{},49:{f:xp},50:{},51:{f:Mx},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:U0},62:{f:fy},63:{f:Hx},64:{f:Sy},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:xt,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Ty},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Qw},148:{f:Yw,p:16},151:{f:wy},152:{},153:{f:jy},154:{},155:{},156:{f:Uy},157:{},158:{},159:{T:1,f:Dm},160:{T:-1},161:{T:1,f:ca},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:xy},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Bx},336:{T:-1},337:{f:Nx,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Xs},357:{},358:{},359:{},360:{T:1},361:{},362:{f:$0},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:yy},427:{f:_y},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:ky},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Jw},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:vy},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Xs},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Yx},633:{T:1},634:{T:-1},635:{T:1,f:Xx},636:{T:-1},637:{f:wp},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Py},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Ay},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},ei={6:{f:Rs},10:{f:Sr},12:{f:Xe},13:{f:Xe},14:{f:qe},15:{f:qe},16:{f:dt},17:{f:qe},18:{f:qe},19:{f:Xe},20:{f:uc},21:{f:uc},23:{f:$0},24:{f:hc},25:{f:qe},26:{},27:{},28:{f:z1},29:{},34:{f:qe},35:{f:dc},38:{f:dt},39:{f:dt},40:{f:dt},41:{f:dt},42:{f:qe},43:{f:qe},47:{f:Jm},49:{f:F1},51:{f:Xe},60:{},61:{f:S1},64:{f:qe},65:{f:b1},66:{f:Xe},77:{},80:{},81:{},82:{},85:{f:Xe},89:{},90:{},91:{},92:{f:x1},93:{f:X1},94:{},95:{f:qe},96:{},97:{},99:{f:qe},125:{f:U0},128:{f:N1},129:{f:v1},130:{f:Xe},131:{f:qe},132:{f:qe},133:{f:w1},134:{},140:{f:tm},141:{f:Xe},144:{},146:{f:am},151:{},152:{},153:{},154:{},155:{},156:{f:Xe},157:{},158:{},160:{f:cm},161:{f:sm},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:R1},190:{f:L1},193:{f:Sr},197:{},198:{},199:{},200:{},201:{},202:{f:qe},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Xe},220:{},221:{f:qe},222:{},224:{f:M1},225:{f:m1},226:{f:Sr},227:{},229:{f:K1},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:y1},253:{f:C1},255:{f:_1},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:O0},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:qe},353:{f:Sr},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:U1},431:{f:qe},432:{},433:{},434:{},437:{},438:{f:Q1},439:{f:qe},440:{f:Z1},441:{},442:{f:En},443:{},444:{f:Xe},445:{},446:{},448:{f:Sr},449:{f:T1,r:2},450:{f:Sr},512:{f:lc},513:{f:om},515:{f:$1},516:{f:I1},517:{f:fc},519:{f:lm},520:{f:E1},523:{},545:{f:gc},549:{f:cc},566:{},574:{f:A1},638:{f:O1},659:{},1048:{},1054:{f:P1},1084:{},1212:{f:V1},2048:{f:em},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Un},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Sr},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:nm,r:12},2173:{f:Rx,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:qe,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:W1,r:12},2197:{},2198:{f:Fx,r:12},2199:{},2200:{},2201:{},2202:{f:G1,r:12},2203:{f:Sr},2204:{},2205:{},2206:{},2207:{},2211:{f:k1},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Xe},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:im},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:rm},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:lc},1:{},2:{f:hm},3:{f:dm},4:{f:um},5:{f:fc},7:{f:gm},8:{},9:{f:Un},11:{},22:{f:Xe},30:{f:D1},31:{},32:{},33:{f:gc},36:{},37:{f:cc},50:{f:pm},62:{},52:{},67:{},68:{f:Xe},69:{},86:{},126:{},127:{f:fm},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:mm},223:{},234:{},354:{},421:{},518:{f:Rs},521:{f:Un},536:{f:hc},547:{f:dc},561:{},579:{},1030:{f:Rs},1033:{f:Un},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Xt(e,r,t,a){var n=r;if(!isNaN(n)){var s=(t||[]).length||0,i=e.next(4);i.write_shift(2,n),i.write_shift(2,s),s>0&&y0(t)&&e.push(t)}}function Sc(e,r){var t=r||{},a=t.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var n=e.match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),i=n.index,o=s&&s.index||e.length,c=$g(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),l=-1,f=0,u=0,d=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(i=0;i<c.length;++i){var p=c[i].trim(),m=p.slice(0,3).toLowerCase();if(m=="<tr"){if(++l,t.sheetRows&&t.sheetRows<=l){--l;break}f=0;continue}if(!(m!="<td"&&m!="<th")){var _=p.split(/<\/t[dh]>/i);for(o=0;o<_.length;++o){var b=_[o].trim();if(b.match(/<t[dh]/i)){for(var v=b,C=0;v.charAt(0)=="<"&&(C=v.indexOf(">"))>-1;)v=v.slice(C+1);for(var R=0;R<g.length;++R){var I=g[R];I.s.c==f&&I.s.r<l&&l<=I.e.r&&(f=I.e.c+1,R=-1)}var T=fe(b.slice(0,b.indexOf(">")));d=T.colspan?+T.colspan:1,((u=+T.rowspan)>1||d>1)&&g.push({s:{r:l,c:f},e:{r:l+(u||1)-1,c:f+d-1}});var H=T.t||T["data-t"]||"";if(!v.length){f+=d;continue}if(v=o0(v),h.s.r>l&&(h.s.r=l),h.e.r<l&&(h.e.r=l),h.s.c>f&&(h.s.c=f),h.e.c<f&&(h.e.c=f),!v.length){f+=d;continue}var P={t:"s",v};t.raw||!v.trim().length||H=="s"||(v==="TRUE"?P={t:"b",v:!0}:v==="FALSE"?P={t:"b",v:!1}:isNaN(tr(v))?isNaN(Sa(v).getDate())||(P={t:"d",v:nt(v)},t.cellDates||(P={t:"n",v:At(P.v)}),P.z=t.dateNF||me[14]):P={t:"n",v:tr(v)}),t.dense?(a[l]||(a[l]=[]),a[l][f]=P):a[he({r:l,c:f})]=P,f+=d}}}}return a["!ref"]=ke(h),g.length&&(a["!merges"]=g),a}function p_(e,r,t,a){for(var n=e["!merges"]||[],s=[],i=r.s.c;i<=r.e.c;++i){for(var o=0,c=0,l=0;l<n.length;++l)if(!(n[l].s.r>t||n[l].s.c>i)&&!(n[l].e.r<t||n[l].e.c<i)){if(n[l].s.r<t||n[l].s.c<i){o=-1;break}o=n[l].e.r-n[l].s.r+1,c=n[l].e.c-n[l].s.c+1;break}if(!(o<0)){var f=he({r:t,c:i}),u=a.dense?(e[t]||[])[i]:e[f],d=u&&u.v!=null&&(u.h||Oi(u.w||(wr(u),u.w)||""))||"",h={};o>1&&(h.rowspan=o),c>1&&(h.colspan=c),a.editable?d='<span contenteditable="true">'+d+"</span>":u&&(h["data-t"]=u&&u.t||"z",u.v!=null&&(h["data-v"]=u.v),u.z!=null&&(h["data-z"]=u.z),u.l&&(u.l.Target||"#").charAt(0)!="#"&&(d='<a href="'+u.l.Target+'">'+d+"</a>")),h.id=(a.id||"sjs")+"-"+f,s.push(tp("td",d,h))}}var g="<tr>";return g+s.join("")+"</tr>"}var m_='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',x_="</body></html>";function v_(e,r){var t=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return jr(Sc(t[0],r),r);var a=Ji();return t.forEach(function(n,s){Qi(a,Sc(n,r),"Sheet"+(s+1))}),a}function w_(e,r,t){var a=[];return a.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function y_(e,r){var t=r||{},a=t.header!=null?t.header:m_,n=t.footer!=null?t.footer:x_,s=[a],i=Pa(e["!ref"]);t.dense=Array.isArray(e),s.push(w_(e,i,t));for(var o=i.s.r;o<=i.e.r;++o)s.push(p_(e,i,o,t));return s.push("</table>"+n),s.join("")}function hf(e,r,t){var a=t||{},n=0,s=0;if(a.origin!=null)if(typeof a.origin=="number")n=a.origin;else{var i=typeof a.origin=="string"?Tt(a.origin):a.origin;n=i.r,s=i.c}var o=r.getElementsByTagName("tr"),c=Math.min(a.sheetRows||1e7,o.length),l={s:{r:0,c:0},e:{r:n,c:s}};if(e["!ref"]){var f=Pa(e["!ref"]);l.s.r=Math.min(l.s.r,f.s.r),l.s.c=Math.min(l.s.c,f.s.c),l.e.r=Math.max(l.e.r,f.e.r),l.e.c=Math.max(l.e.c,f.e.c),n==-1&&(l.e.r=n=f.e.r+1)}var u=[],d=0,h=e["!rows"]||(e["!rows"]=[]),g=0,p=0,m=0,_=0,b=0,v=0;for(e["!cols"]||(e["!cols"]=[]);g<o.length&&p<c;++g){var C=o[g];if(Ac(C)){if(a.display)continue;h[p]={hidden:!0}}var R=C.children;for(m=_=0;m<R.length;++m){var I=R[m];if(!(a.display&&Ac(I))){var T=I.hasAttribute("data-v")?I.getAttribute("data-v"):I.hasAttribute("v")?I.getAttribute("v"):o0(I.innerHTML),H=I.getAttribute("data-z")||I.getAttribute("z");for(d=0;d<u.length;++d){var P=u[d];P.s.c==_+s&&P.s.r<p+n&&p+n<=P.e.r&&(_=P.e.c+1-s,d=-1)}v=+I.getAttribute("colspan")||1,((b=+I.getAttribute("rowspan")||1)>1||v>1)&&u.push({s:{r:p+n,c:_+s},e:{r:p+n+(b||1)-1,c:_+s+(v||1)-1}});var q={t:"s",v:T},V=I.getAttribute("data-t")||I.getAttribute("t")||"";T!=null&&(T.length==0?q.t=V||"z":a.raw||T.trim().length==0||V=="s"||(T==="TRUE"?q={t:"b",v:!0}:T==="FALSE"?q={t:"b",v:!1}:isNaN(tr(T))?isNaN(Sa(T).getDate())||(q={t:"d",v:nt(T)},a.cellDates||(q={t:"n",v:At(q.v)}),q.z=a.dateNF||me[14]):q={t:"n",v:tr(T)})),q.z===void 0&&H!=null&&(q.z=H);var L="",J=I.getElementsByTagName("A");if(J&&J.length)for(var le=0;le<J.length&&!(J[le].hasAttribute("href")&&(L=J[le].getAttribute("href"),L.charAt(0)!="#"));++le);L&&L.charAt(0)!="#"&&(q.l={Target:L}),a.dense?(e[p+n]||(e[p+n]=[]),e[p+n][_+s]=q):e[he({c:_+s,r:p+n})]=q,l.e.c<_+s&&(l.e.c=_+s),_+=v}}++p}return u.length&&(e["!merges"]=(e["!merges"]||[]).concat(u)),l.e.r=Math.max(l.e.r,p-1+n),e["!ref"]=ke(l),p>=c&&(e["!fullref"]=ke((l.e.r=o.length-g+p-1+n,l))),e}function gf(e,r){var t=r||{},a=t.dense?[]:{};return hf(a,e,r)}function __(e,r){return jr(gf(e,r),r)}function Ac(e){var r="",t=E_(e);return t&&(r=t(e).getPropertyValue("display")),r||(r=e.style&&e.style.display),r==="none"}function E_(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function k_(e){var r=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,n){return Array(parseInt(n,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=Se(r.replace(/<[^>]*>/g,""));return[t]}var bc={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function pf(e,r){var t=r||{},a=Ri(e),n=[],s,i,o={name:""},c="",l=0,f,u,d={},h=[],g=t.dense?[]:{},p,m,_={value:""},b="",v=0,C=[],R=-1,I=-1,T={s:{r:1e6,c:1e7},e:{r:0,c:0}},H=0,P={},q=[],V={},L=0,J=0,le=[],re=1,ce=1,oe=[],Re={Names:[]},W={},ue=["",""],de=[],A={},U="",O=0,D=!1,z=!1,te=0;for(un.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=un.exec(a);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"工作表":p[1]==="/"?(T.e.c>=T.s.c&&T.e.r>=T.s.r?g["!ref"]=ke(T):g["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=T.e.r&&(g["!fullref"]=g["!ref"],T.e.r=t.sheetRows-1,g["!ref"]=ke(T)),q.length&&(g["!merges"]=q),le.length&&(g["!rows"]=le),f.name=f.名称||f.name,typeof JSON<"u"&&JSON.stringify(f),h.push(f.name),d[f.name]=g,z=!1):p[0].charAt(p[0].length-2)!=="/"&&(f=fe(p[0],!1),R=I=-1,T.s.r=T.s.c=1e7,T.e.r=T.e.c=0,g=t.dense?[]:{},q=[],le=[],z=!0);break;case"table-row-group":p[1]==="/"?--H:++H;break;case"table-row":case"行":if(p[1]==="/"){R+=re,re=1;break}if(u=fe(p[0],!1),u.行号?R=u.行号-1:R==-1&&(R=0),re=+u["number-rows-repeated"]||1,re<10)for(te=0;te<re;++te)H>0&&(le[R+te]={level:H});I=-1;break;case"covered-table-cell":p[1]!=="/"&&++I,t.sheetStubs&&(t.dense?(g[R]||(g[R]=[]),g[R][I]={t:"z"}):g[he({r:R,c:I})]={t:"z"}),b="",C=[];break;case"table-cell":case"数据":if(p[0].charAt(p[0].length-2)==="/")++I,_=fe(p[0],!1),ce=parseInt(_["number-columns-repeated"]||"1",10),m={t:"z",v:null},_.formula&&t.cellFormula!=!1&&(m.f=_c(Se(_.formula))),(_.数据类型||_["value-type"])=="string"&&(m.t="s",m.v=Se(_["string-value"]||""),t.dense?(g[R]||(g[R]=[]),g[R][I]=m):g[he({r:R,c:I})]=m),I+=ce-1;else if(p[1]!=="/"){++I,b="",v=0,C=[],ce=1;var se=re?R+re-1:R;if(I>T.e.c&&(T.e.c=I),I<T.s.c&&(T.s.c=I),R<T.s.r&&(T.s.r=R),se>T.e.r&&(T.e.r=se),_=fe(p[0],!1),de=[],A={},m={t:_.数据类型||_["value-type"],v:null},t.cellFormula)if(_.formula&&(_.formula=Se(_.formula)),_["number-matrix-columns-spanned"]&&_["number-matrix-rows-spanned"]&&(L=parseInt(_["number-matrix-rows-spanned"],10)||0,J=parseInt(_["number-matrix-columns-spanned"],10)||0,V={s:{r:R,c:I},e:{r:R+L-1,c:I+J-1}},m.F=ke(V),oe.push([V,m.F])),_.formula)m.f=_c(_.formula);else for(te=0;te<oe.length;++te)R>=oe[te][0].s.r&&R<=oe[te][0].e.r&&I>=oe[te][0].s.c&&I<=oe[te][0].e.c&&(m.F=oe[te][1]);switch((_["number-columns-spanned"]||_["number-rows-spanned"])&&(L=parseInt(_["number-rows-spanned"],10)||0,J=parseInt(_["number-columns-spanned"],10)||0,V={s:{r:R,c:I},e:{r:R+L-1,c:I+J-1}},q.push(V)),_["number-columns-repeated"]&&(ce=parseInt(_["number-columns-repeated"],10)),m.t){case"boolean":m.t="b",m.v=Le(_["boolean-value"]);break;case"float":m.t="n",m.v=parseFloat(_.value);break;case"percentage":m.t="n",m.v=parseFloat(_.value);break;case"currency":m.t="n",m.v=parseFloat(_.value);break;case"date":m.t="d",m.v=nt(_["date-value"]),t.cellDates||(m.t="n",m.v=At(m.v)),m.z="m/d/yy";break;case"time":m.t="n",m.v=Bg(_["time-value"])/86400,t.cellDates&&(m.t="d",m.v=gs(m.v)),m.z="HH:MM:SS";break;case"number":m.t="n",m.v=parseFloat(_.数据数值);break;default:if(m.t==="string"||m.t==="text"||!m.t)m.t="s",_["string-value"]!=null&&(b=Se(_["string-value"]),C=[]);else throw new Error("Unsupported value type "+m.t)}}else{if(D=!1,m.t==="s"&&(m.v=b||"",C.length&&(m.R=C),D=v==0),W.Target&&(m.l=W),de.length>0&&(m.c=de,de=[]),b&&t.cellText!==!1&&(m.w=b),D&&(m.t="z",delete m.v),(!D||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=R))for(var Z=0;Z<re;++Z){if(ce=parseInt(_["number-columns-repeated"]||"1",10),t.dense)for(g[R+Z]||(g[R+Z]=[]),g[R+Z][I]=Z==0?m:it(m);--ce>0;)g[R+Z][I+ce]=it(m);else for(g[he({r:R+Z,c:I})]=m;--ce>0;)g[he({r:R+Z,c:I+ce})]=it(m);T.e.c<=I&&(T.e.c=I)}ce=parseInt(_["number-columns-repeated"]||"1",10),I+=ce-1,ce=0,m={},b="",C=[]}W={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((s=n.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&n.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((s=n.pop())[0]!==p[3])throw"Bad state: "+s;A.t=b,C.length&&(A.R=C),A.a=U,de.push(A)}else p[0].charAt(p[0].length-2)!=="/"&&n.push([p[3],!1]);U="",O=0,b="",v=0,C=[];break;case"creator":p[1]==="/"?U=a.slice(O,p.index):O=p.index+p[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((s=n.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&n.push([p[3],!1]);b="",v=0,C=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(P[o.name]=c,(s=n.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&(c="",o=fe(p[0],!1),n.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(n[n.length-1][0]){case"time-style":case"date-style":i=fe(p[0],!1),c+=bc[p[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(n[n.length-1][0]){case"time-style":case"date-style":i=fe(p[0],!1),c+=bc[p[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(n[n.length-1][0]){case"number-style":case"date-style":case"time-style":c+=a.slice(l,p.index);break}else l=p.index+p[0].length;break;case"named-range":i=fe(p[0],!1),ue=Ls(i["cell-range-address"]);var Y={Name:i.name,Ref:ue[0]+"!"+ue[1]};z&&(Y.Sheet=h.length),Re.Names.push(Y);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(n[n.length-1][0])>-1)break;if(p[1]==="/"&&(!_||!_["string-value"])){var Te=k_(a.slice(v,p.index));b=(b.length>0?b+`
`:"")+Te[0]}else fe(p[0],!1),v=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{ue=Ls(fe(p[0])["target-range-address"]),d[ue[0]]["!autofilter"]={ref:ue[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(W=fe(p[0],!1),!W.href)break;W.Target=Se(W.href),delete W.href,W.Target.charAt(0)=="#"&&W.Target.indexOf(".")>-1?(ue=Ls(W.Target.slice(1)),W.Target="#"+ue[0]+"!"+ue[1]):W.Target.match(/^\.\.[\\\/]/)&&(W.Target=W.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(t.WTF)throw new Error(p)}}var F={Sheets:d,SheetNames:h,Workbook:Re};return t.bookSheets&&delete F.Sheets,F}function Fc(e,r){r=r||{},Wt(e,"META-INF/manifest.xml")&&$p(Ke(e,"META-INF/manifest.xml"),r);var t=Rt(e,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var a=pf(Oe(t),r);return Wt(e,"meta.xml")&&(a.Props=b0(Ke(e,"meta.xml"))),a}function Cc(e,r){return pf(e,r)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function zi(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function ti(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Oe(ia(e))}function ri(e){var r=e.reduce(function(n,s){return n+s.length},0),t=new Uint8Array(r),a=0;return e.forEach(function(n){t.set(n,a),a+=n.length}),t}function Ic(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function T_(e,r){for(var t=(e[r+15]&127)<<7|e[r+14]>>1,a=e[r+14]&1,n=r+13;n>=r;--n)a=a*256+e[n];return(e[r+15]&128?-a:a)*Math.pow(10,t-6176)}function pn(e,r){var t=r?r[0]:0,a=e[t]&127;e:if(e[t++]>=128&&(a|=(e[t]&127)<<7,e[t++]<128||(a|=(e[t]&127)<<14,e[t++]<128)||(a|=(e[t]&127)<<21,e[t++]<128)||(a+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(a+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(a+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return r&&(r[0]=t),a}function et(e){var r=0,t=e[r]&127;e:if(e[r++]>=128){if(t|=(e[r]&127)<<7,e[r++]<128||(t|=(e[r]&127)<<14,e[r++]<128)||(t|=(e[r]&127)<<21,e[r++]<128))break e;t|=(e[r]&127)<<28}return t}function gt(e){for(var r=[],t=[0];t[0]<e.length;){var a=t[0],n=pn(e,t),s=n&7;n=Math.floor(n/8);var i=0,o;if(n==0)break;switch(s){case 0:{for(var c=t[0];e[t[0]++]>=128;);o=e.slice(c,t[0])}break;case 5:i=4,o=e.slice(t[0],t[0]+i),t[0]+=i;break;case 1:i=8,o=e.slice(t[0],t[0]+i),t[0]+=i;break;case 2:i=pn(e,t),o=e.slice(t[0],t[0]+i),t[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(n," at offset ").concat(a))}var l={data:o,type:s};r[n]==null?r[n]=[l]:r[n].push(l)}return r}function Ki(e,r){return(e==null?void 0:e.map(function(t){return r(t.data)}))||[]}function S_(e){for(var r,t=[],a=[0];a[0]<e.length;){var n=pn(e,a),s=gt(e.slice(a[0],a[0]+n));a[0]+=n;var i={id:et(s[1][0].data),messages:[]};s[2].forEach(function(o){var c=gt(o.data),l=et(c[3][0].data);i.messages.push({meta:c,data:e.slice(a[0],a[0]+l)}),a[0]+=l}),(r=s[3])!=null&&r[0]&&(i.merge=et(s[3][0].data)>>>0>0),t.push(i)}return t}function A_(e,r){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],a=pn(r,t),n=[];t[0]<r.length;){var s=r[t[0]]&3;if(s==0){var i=r[t[0]++]>>2;if(i<60)++i;else{var o=i-59;i=r[t[0]],o>1&&(i|=r[t[0]+1]<<8),o>2&&(i|=r[t[0]+2]<<16),o>3&&(i|=r[t[0]+3]<<24),i>>>=0,i++,t[0]+=o}n.push(r.slice(t[0],t[0]+i)),t[0]+=i;continue}else{var c=0,l=0;if(s==1?(l=(r[t[0]]>>2&7)+4,c=(r[t[0]++]&224)<<3,c|=r[t[0]++]):(l=(r[t[0]++]>>2)+1,s==2?(c=r[t[0]]|r[t[0]+1]<<8,t[0]+=2):(c=(r[t[0]]|r[t[0]+1]<<8|r[t[0]+2]<<16|r[t[0]+3]<<24)>>>0,t[0]+=4)),n=[ri(n)],c==0)throw new Error("Invalid offset 0");if(c>n[0].length)throw new Error("Invalid offset beyond length");if(l>=c)for(n.push(n[0].slice(-c)),l-=c;l>=n[n.length-1].length;)n.push(n[n.length-1]),l-=n[n.length-1].length;n.push(n[0].slice(-c,-c+l))}}var f=ri(n);if(f.length!=a)throw new Error("Unexpected length: ".concat(f.length," != ").concat(a));return f}function b_(e){for(var r=[],t=0;t<e.length;){var a=e[t++],n=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,r.push(A_(a,e.slice(t,t+n))),t+=n}if(t!==e.length)throw new Error("data is not a valid framed stream!");return ri(r)}function F_(e,r,t,a){var n=zi(e),s=n.getUint32(4,!0),i=(a>1?12:8)+Ic(s&(a>1?3470:398))*4,o=-1,c=-1,l=NaN,f=new Date(2001,0,1);s&512&&(o=n.getUint32(i,!0),i+=4),i+=Ic(s&(a>1?12288:4096))*4,s&16&&(c=n.getUint32(i,!0),i+=4),s&32&&(l=n.getFloat64(i,!0),i+=8),s&64&&(f.setTime(f.getTime()+n.getFloat64(i,!0)*1e3),i+=8);var u;switch(e[2]){case 0:break;case 2:u={t:"n",v:l};break;case 3:u={t:"s",v:r[c]};break;case 5:u={t:"d",v:f};break;case 6:u={t:"b",v:l>0};break;case 7:u={t:"n",v:l/86400};break;case 8:u={t:"e",v:0};break;case 9:if(o>-1)u={t:"s",v:t[o]};else if(c>-1)u={t:"s",v:r[c]};else if(!isNaN(l))u={t:"n",v:l};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return u}function C_(e,r,t){var a=zi(e),n=a.getUint32(8,!0),s=12,i=-1,o=-1,c=NaN,l=NaN,f=new Date(2001,0,1);n&1&&(c=T_(e,s),s+=16),n&2&&(l=a.getFloat64(s,!0),s+=8),n&4&&(f.setTime(f.getTime()+a.getFloat64(s,!0)*1e3),s+=8),n&8&&(o=a.getUint32(s,!0),s+=4),n&16&&(i=a.getUint32(s,!0),s+=4);var u;switch(e[1]){case 0:break;case 2:u={t:"n",v:c};break;case 3:u={t:"s",v:r[o]};break;case 5:u={t:"d",v:f};break;case 6:u={t:"b",v:l>0};break;case 7:u={t:"n",v:l/86400};break;case 8:u={t:"e",v:0};break;case 9:if(i>-1)u={t:"s",v:t[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)));break;case 10:u={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)))}return u}function I_(e,r,t){switch(e[0]){case 0:case 1:case 2:case 3:return F_(e,r,t,e[0]);case 5:return C_(e,r,t);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Rr(e){var r=gt(e);return pn(r[1][0].data)}function Pc(e,r){var t=gt(r.data),a=et(t[1][0].data),n=t[3],s=[];return(n||[]).forEach(function(i){var o=gt(i.data),c=et(o[1][0].data)>>>0;switch(a){case 1:s[c]=ti(o[3][0].data);break;case 8:{var l=e[Rr(o[9][0].data)][0],f=gt(l.data),u=e[Rr(f[1][0].data)][0],d=et(u.meta[1][0].data);if(d!=2001)throw new Error("2000 unexpected reference to ".concat(d));var h=gt(u.data);s[c]=h[3].map(function(g){return ti(g.data)}).join("")}break}}),s}function P_(e,r){var t,a,n,s,i,o,c,l,f,u,d,h,g,p,m=gt(e),_=et(m[1][0].data)>>>0,b=et(m[2][0].data)>>>0,v=((a=(t=m[8])==null?void 0:t[0])==null?void 0:a.data)&&et(m[8][0].data)>0||!1,C,R;if((s=(n=m[7])==null?void 0:n[0])!=null&&s.data&&r!=0)C=(o=(i=m[7])==null?void 0:i[0])==null?void 0:o.data,R=(l=(c=m[6])==null?void 0:c[0])==null?void 0:l.data;else if((u=(f=m[4])==null?void 0:f[0])!=null&&u.data&&r!=1)C=(h=(d=m[4])==null?void 0:d[0])==null?void 0:h.data,R=(p=(g=m[3])==null?void 0:g[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(r," cell storage");for(var I=v?4:1,T=zi(C),H=[],P=0;P<C.length/2;++P){var q=T.getUint16(P*2,!0);q<65535&&H.push([P,q])}if(H.length!=b)throw"Expected ".concat(b," cells, found ").concat(H.length);var V=[];for(P=0;P<H.length-1;++P)V[H[P][0]]=R.subarray(H[P][1]*I,H[P+1][1]*I);return H.length>=1&&(V[H[H.length-1][0]]=R.subarray(H[H.length-1][1]*I)),{R:_,cells:V}}function D_(e,r){var t,a=gt(r.data),n=(t=a==null?void 0:a[7])!=null&&t[0]?et(a[7][0].data)>>>0>0?1:0:-1,s=Ki(a[5],function(i){return P_(i,n)});return{nrows:et(a[4][0].data)>>>0,data:s.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(c,l){if(i[o.R][l])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(l));i[o.R][l]=c}),i},[])}}function O_(e,r,t){var a,n=gt(r.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(et(n[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(s.e.c=(et(n[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));t["!ref"]=ke(s);var i=gt(n[4][0].data),o=Pc(e,e[Rr(i[4][0].data)][0]),c=(a=i[17])!=null&&a[0]?Pc(e,e[Rr(i[17][0].data)][0]):[],l=gt(i[3][0].data),f=0;l[1].forEach(function(u){var d=gt(u.data),h=e[Rr(d[2][0].data)][0],g=et(h.meta[1][0].data);if(g!=6002)throw new Error("6001 unexpected reference to ".concat(g));var p=D_(e,h);p.data.forEach(function(m,_){m.forEach(function(b,v){var C=he({r:f+_,c:v}),R=I_(b,o,c);R&&(t[C]=R)})}),f+=p.nrows})}function R_(e,r){var t=gt(r.data),a={"!ref":"A1"},n=e[Rr(t[2][0].data)],s=et(n[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return O_(e,n[0],a),a}function L_(e,r){var t,a=gt(r.data),n={name:(t=a[1])!=null&&t[0]?ti(a[1][0].data):"",sheets:[]},s=Ki(a[2],Rr);return s.forEach(function(i){e[i].forEach(function(o){var c=et(o.meta[1][0].data);c==6e3&&n.sheets.push(R_(e,o))})}),n}function B_(e,r){var t=Ji(),a=gt(r.data),n=Ki(a[1],Rr);if(n.forEach(function(s){e[s].forEach(function(i){var o=et(i.meta[1][0].data);if(o==2){var c=L_(e,i);c.sheets.forEach(function(l,f){Qi(t,l,f==0?c.name:c.name+"_"+f,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function Ms(e){var r,t,a,n,s={},i=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var l;try{l=b_(c.content)}catch(u){return console.log("?? "+c.content.length+" "+(u.message||u))}var f;try{f=S_(l)}catch(u){return console.log("## "+(u.message||u))}f.forEach(function(u){s[u.id]=u.messages,i.push(u.id)})}}),!i.length)throw new Error("File has no messages");var o=((n=(a=(t=(r=s==null?void 0:s[1])==null?void 0:r[0])==null?void 0:t.meta)==null?void 0:a[1])==null?void 0:n[0].data)&&et(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||i.forEach(function(c){s[c].forEach(function(l){var f=et(l.meta[1][0].data)>>>0;if(f==1)if(!o)o=l;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return B_(s,o)}function M_(e){return function(t){for(var a=0;a!=e.length;++a){var n=e[a];t[n[0]]===void 0&&(t[n[0]]=n[1]),n[2]==="n"&&(t[n[0]]=Number(t[n[0]]))}}}function Xi(e){M_([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function N_(e){return va.WS.indexOf(e)>-1?"sheet":e==va.CS?"chart":e==va.DS?"dialog":e==va.MS?"macro":e&&e.length?e:"sheet"}function $_(e,r){if(!e)return 0;try{e=r.map(function(a){return a.id||(a.id=a.strRelID),[a.name,e["!id"][a.id].Target,N_(e["!id"][a.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function U_(e,r,t,a,n,s,i,o,c,l,f,u){try{s[a]=Za(Rt(e,t,!0),r);var d=Ke(e,r),h;switch(o){case"sheet":h=qy(d,r,n,c,s[a],l,f,u);break;case"chart":if(h=zy(d,r,n,c,s[a],l,f,u),!h||!h["!drawel"])break;var g=Va(h["!drawel"].Target,r),p=Ys(g),m=Gx(Rt(e,g,!0),Za(Rt(e,p,!0),g)),_=Va(m,g),b=Ys(_);h=Cy(Rt(e,_,!0),_,c,Za(Rt(e,b,!0),_),l,h);break;case"macro":h=Ky(d,r,n,c,s[a],l,f,u);break;case"dialog":h=Xy(d,r,n,c,s[a],l,f,u);break;default:throw new Error("Unrecognized sheet type "+o)}i[a]=h;var v=[];s&&s[a]&&or(s[a]).forEach(function(C){var R="";if(s[a][C].Type==va.CMNT){R=Va(s[a][C].Target,r);var I=Zy(Ke(e,R,!0),R,c);if(!I||!I.length)return;mc(h,I,!1)}s[a][C].Type==va.TCMNT&&(R=Va(s[a][C].Target,r),v=v.concat(zx(Ke(e,R,!0),c)))}),v&&v.length&&mc(h,v,!0,c.people||[])}catch(C){if(c.WTF)throw C}}function jt(e){return e.charAt(0)=="/"?e.slice(1):e}function j_(e,r){if(Ql(),r=r||{},Xi(r),Wt(e,"META-INF/manifest.xml")||Wt(e,"objectdata.xml"))return Fc(e,r);if(Wt(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Ms<"u"){if(e.FileIndex)return Ms(e);var t=Ee.utils.cfb_new();return Wo(e).forEach(function(le){Hg(t,le,jg(e,le))}),Ms(t)}throw new Error("Unsupported NUMBERS file")}if(!Wt(e,"[Content_Types].xml"))throw Wt(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Wt(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=Wo(e),n=Mp(Rt(e,"[Content_Types].xml")),s=!1,i,o;if(n.workbooks.length===0&&(o="xl/workbook.xml",Ke(e,o,!0)&&n.workbooks.push(o)),n.workbooks.length===0){if(o="xl/workbook.bin",!Ke(e,o,!0))throw new Error("Could not find workbook");n.workbooks.push(o),s=!0}n.workbooks[0].slice(-3)=="bin"&&(s=!0);var c={},l={};if(!r.bookSheets&&!r.bookProps){if(rn=[],n.sst)try{rn=Qy(Ke(e,jt(n.sst)),n.sst,r)}catch(le){if(r.WTF)throw le}r.cellStyles&&n.themes.length&&(c=Jy(Rt(e,n.themes[0].replace(/^\//,""),!0)||"",n.themes[0],r)),n.style&&(l=Yy(Ke(e,jt(n.style)),n.style,c,r))}n.links.map(function(le){try{var re=Za(Rt(e,Ys(jt(le))),le);return t_(Ke(e,jt(le)),re,le,r)}catch{}});var f=Gy(Ke(e,jt(n.workbooks[0])),n.workbooks[0],r),u={},d="";n.coreprops.length&&(d=Ke(e,jt(n.coreprops[0]),!0),d&&(u=b0(d)),n.extprops.length!==0&&(d=Ke(e,jt(n.extprops[0]),!0),d&&Hp(d,u,r)));var h={};(!r.bookSheets||r.bookProps)&&n.custprops.length!==0&&(d=Rt(e,jt(n.custprops[0]),!0),d&&(h=Vp(d,r)));var g={};if((r.bookSheets||r.bookProps)&&(f.Sheets?i=f.Sheets.map(function(re){return re.name}):u.Worksheets&&u.SheetNames.length>0&&(i=u.SheetNames),r.bookProps&&(g.Props=u,g.Custprops=h),r.bookSheets&&typeof i<"u"&&(g.SheetNames=i),r.bookSheets?g.SheetNames:r.bookProps))return g;i={};var p={};r.bookDeps&&n.calcchain&&(p=e_(Ke(e,jt(n.calcchain)),n.calcchain));var m=0,_={},b,v;{var C=f.Sheets;u.Worksheets=C.length,u.SheetNames=[];for(var R=0;R!=C.length;++R)u.SheetNames[R]=C[R].name}var I=s?"bin":"xml",T=n.workbooks[0].lastIndexOf("/"),H=(n.workbooks[0].slice(0,T+1)+"_rels/"+n.workbooks[0].slice(T+1)+".rels").replace(/^\//,"");Wt(e,H)||(H="xl/_rels/workbook."+I+".rels");var P=Za(Rt(e,H,!0),H.replace(/_rels.*/,"s5s"));(n.metadata||[]).length>=1&&(r.xlmeta=r_(Ke(e,jt(n.metadata[0])),n.metadata[0],r)),(n.people||[]).length>=1&&(r.people=Kx(Ke(e,jt(n.people[0])),r)),P&&(P=$_(P,f.Sheets));var q=Ke(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(m=0;m!=u.Worksheets;++m){var V="sheet";if(P&&P[m]?(b="xl/"+P[m][1].replace(/[\/]?xl\//,""),Wt(e,b)||(b=P[m][1]),Wt(e,b)||(b=H.replace(/_rels\/.*$/,"")+P[m][1]),V=P[m][2]):(b="xl/worksheets/sheet"+(m+1-q)+"."+I,b=b.replace(/sheet0\./,"sheet.")),v=b.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),r&&r.sheets!=null)switch(typeof r.sheets){case"number":if(m!=r.sheets)continue e;break;case"string":if(u.SheetNames[m].toLowerCase()!=r.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(r.sheets)){for(var L=!1,J=0;J!=r.sheets.length;++J)typeof r.sheets[J]=="number"&&r.sheets[J]==m&&(L=1),typeof r.sheets[J]=="string"&&r.sheets[J].toLowerCase()==u.SheetNames[m].toLowerCase()&&(L=1);if(!L)continue e}}U_(e,b,v,u.SheetNames[m],m,_,i,V,r,f,c,l)}return g={Directory:n,Workbook:f,Props:u,Custprops:h,Deps:p,Sheets:i,SheetNames:u.SheetNames,Strings:rn,Styles:l,Themes:c,SSF:it(me)},r&&r.bookFiles&&(e.files?(g.keys=a,g.files=e.files):(g.keys=[],g.files={},e.FullPaths.forEach(function(le,re){le=le.replace(/^Root Entry[\/]/,""),g.keys.push(le),g.files[le]=e.FileIndex[re]}))),r&&r.bookVBA&&(n.vba.length>0?g.vbaraw=Ke(e,jt(n.vba[0]),!0):n.defaults&&n.defaults.bin===Qx&&(g.vbaraw=Ke(e,"xl/vbaProject.bin",!0))),g}function H_(e,r){var t=r||{},a="Workbook",n=Ee.find(e,a);try{if(a="/!DataSpaces/Version",n=Ee.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(Rm(n.content),a="/!DataSpaces/DataSpaceMap",n=Ee.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var s=Bm(n.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",n=Ee.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var i=Mm(n.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",n=Ee.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);$m(n.content)}catch{}if(a="/EncryptionInfo",n=Ee.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var o=Um(n.content);if(a="/EncryptedPackage",n=Ee.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],n.content,t.password||"",t);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],n.content,t.password||"",t);throw new Error("File is password-protected")}function Yi(e,r){var t="";switch((r||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=Nt(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function W_(e,r){return Ee.find(e,"EncryptedPackage")?H_(e,r):df(e,r)}function V_(e,r){var t,a=e,n=r||{};return n.type||(n.type=_e&&Buffer.isBuffer(e)?"buffer":"base64"),t=n0(a,n),j_(t,n)}function mf(e,r){var t=0;e:for(;t<e.length;)switch(e.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return Zs(e.slice(t),r);default:break e}return dn.to_workbook(e,r)}function G_(e,r){var t="",a=Yi(e,r);switch(r.type){case"base64":t=Nt(e);break;case"binary":t=e;break;case"buffer":t=e.toString("binary");break;case"array":t=ta(e);break;default:throw new Error("Unrecognized type "+r.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(t=Oe(t)),r.type="binary",mf(t,r)}function q_(e,r){var t=e;return r.type=="base64"&&(t=Nt(t)),t=cn.utils.decode(1200,t.slice(2),"str"),r.type="binary",mf(t,r)}function z_(e){return e.match(/[^\x00-\x7F]/)?Ga(e):e}function Ns(e,r,t,a){return a?(t.type="string",dn.to_workbook(e,t)):dn.to_workbook(r,t)}function ai(e,r){Ul();var t=r||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return ai(new Uint8Array(e),(t=it(t),t.type="array",t));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var a=e,n=[0,0,0,0],s=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),Ea={},t.dateNF&&(Ea.dateNF=t.dateNF),t.type||(t.type=_e&&Buffer.isBuffer(e)?"buffer":"base64"),t.type=="file"&&(t.type=_e?"buffer":"binary",a=Rg(e),typeof Uint8Array<"u"&&!_e&&(t.type="array")),t.type=="string"&&(s=!0,t.type="binary",t.codepage=65001,a=z_(e)),t.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return t=it(t),t.type="array",ai(Fi(a),t)}switch((n=Yi(a,t))[0]){case 208:if(n[1]===207&&n[2]===17&&n[3]===224&&n[4]===161&&n[5]===177&&n[6]===26&&n[7]===225)return W_(Ee.read(a,t),t);break;case 9:if(n[1]<=8)return df(a,t);break;case 60:return Zs(a,t);case 73:if(n[1]===73&&n[2]===42&&n[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(n[1]===68)return _m(a,t);break;case 84:if(n[1]===65&&n[2]===66&&n[3]===76)return wm.to_workbook(a,t);break;case 80:return n[1]===75&&n[2]<9&&n[3]<9?V_(a,t):Ns(e,a,t,s);case 239:return n[3]===60?Zs(a,t):Ns(e,a,t,s);case 255:if(n[1]===254)return q_(a,t);if(n[1]===0&&n[2]===2&&n[3]===0)return tn.to_workbook(a,t);break;case 0:if(n[1]===0&&(n[2]>=2&&n[3]===0||n[2]===0&&(n[3]===8||n[3]===9)))return tn.to_workbook(a,t);break;case 3:case 131:case 139:case 140:return pc.to_workbook(a,t);case 123:if(n[1]===92&&n[2]===114&&n[3]===116)return Qm.to_workbook(a,t);break;case 10:case 13:case 32:return G_(a,t);case 137:if(n[1]===80&&n[2]===78&&n[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return xm.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?pc.to_workbook(a,t):Ns(e,a,t,s)}function K_(e,r,t,a,n,s,i,o){var c=ot(t),l=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),u=!0,d=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:t,enumerable:!1})}catch{d.__rowNum__=t}else d.__rowNum__=t;if(!i||e[t])for(var h=r.s.c;h<=r.e.c;++h){var g=i?e[t][h]:e[a[h]+c];if(g===void 0||g.t===void 0){if(l===void 0)continue;s[h]!=null&&(d[s[h]]=l);continue}var p=g.v;switch(g.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(s[h]!=null){if(p==null)if(g.t=="e"&&p===null)d[s[h]]=null;else if(l!==void 0)d[s[h]]=l;else if(f&&p===null)d[s[h]]=null;else continue;else d[s[h]]=f&&(g.t!=="n"||g.t==="n"&&o.rawNumbers!==!1)?p:wr(g,p,o);p!=null&&(u=!1)}}return{row:d,isempty:u}}function ni(e,r){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},a=0,n=1,s=[],i=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},l=r||{},f=l.range!=null?l.range:e["!ref"];switch(l.header===1?a=1:l.header==="A"?a=2:Array.isArray(l.header)?a=3:l.header==null&&(a=0),typeof f){case"string":c=He(f);break;case"number":c=He(e["!ref"]),c.s.r=f;break;default:c=f}a>0&&(n=0);var u=ot(c.s.r),d=[],h=[],g=0,p=0,m=Array.isArray(e),_=c.s.r,b=0,v={};m&&!e[_]&&(e[_]=[]);var C=l.skipHidden&&e["!cols"]||[],R=l.skipHidden&&e["!rows"]||[];for(b=c.s.c;b<=c.e.c;++b)if(!(C[b]||{}).hidden)switch(d[b]=Ze(b),t=m?e[_][b]:e[d[b]+u],a){case 1:s[b]=b-c.s.c;break;case 2:s[b]=d[b];break;case 3:s[b]=l.header[b-c.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),o=i=wr(t,null,l),p=v[i]||0,!p)v[i]=1;else{do o=i+"_"+p++;while(v[o]);v[i]=p,v[o]=1}s[b]=o}for(_=c.s.r+n;_<=c.e.r;++_)if(!(R[_]||{}).hidden){var I=K_(e,c,_,d,a,s,m,l);(I.isempty===!1||(a===1?l.blankrows!==!1:l.blankrows))&&(h[g++]=I.row)}return h.length=g,h}var Dc=/"/g;function X_(e,r,t,a,n,s,i,o){for(var c=!0,l=[],f="",u=ot(t),d=r.s.c;d<=r.e.c;++d)if(a[d]){var h=o.dense?(e[t]||[])[d]:e[a[d]+u];if(h==null)f="";else if(h.v!=null){c=!1,f=""+(o.rawNumbers&&h.t=="n"?h.v:wr(h,null,o));for(var g=0,p=0;g!==f.length;++g)if((p=f.charCodeAt(g))===n||p===s||p===34||o.forceQuotes){f='"'+f.replace(Dc,'""')+'"';break}f=="ID"&&(f='"ID"')}else h.f!=null&&!h.F?(c=!1,f="="+h.f,f.indexOf(",")>=0&&(f='"'+f.replace(Dc,'""')+'"')):f="";l.push(f)}return o.blankrows===!1&&c?null:l.join(i)}function xf(e,r){var t=[],a=r??{};if(e==null||e["!ref"]==null)return"";var n=He(e["!ref"]),s=a.FS!==void 0?a.FS:",",i=s.charCodeAt(0),o=a.RS!==void 0?a.RS:`
`,c=o.charCodeAt(0),l=new RegExp((s=="|"?"\\|":s)+"+$"),f="",u=[];a.dense=Array.isArray(e);for(var d=a.skipHidden&&e["!cols"]||[],h=a.skipHidden&&e["!rows"]||[],g=n.s.c;g<=n.e.c;++g)(d[g]||{}).hidden||(u[g]=Ze(g));for(var p=0,m=n.s.r;m<=n.e.r;++m)(h[m]||{}).hidden||(f=X_(e,n,m,u,i,c,s,a),f!=null&&(a.strip&&(f=f.replace(l,"")),(f||a.blankrows!==!1)&&t.push((p++?o:"")+f)));return delete a.dense,t.join("")}function Y_(e,r){r||(r={}),r.FS="	",r.RS=`
`;var t=xf(e,r);return t}function J_(e){var r="",t,a="";if(e==null||e["!ref"]==null)return[];var n=He(e["!ref"]),s="",i=[],o,c=[],l=Array.isArray(e);for(o=n.s.c;o<=n.e.c;++o)i[o]=Ze(o);for(var f=n.s.r;f<=n.e.r;++f)for(s=ot(f),o=n.s.c;o<=n.e.c;++o)if(r=i[o]+s,t=l?(e[f]||[])[o]:e[r],a="",t!==void 0){if(t.F!=null){if(r=t.F,!t.f)continue;a=t.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(t.f!=null)a=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)a=""+t.v;else if(t.t=="b")a=t.v?"TRUE":"FALSE";else if(t.w!==void 0)a="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?a="'"+t.v:a=""+t.v}}c[c.length]=r+"="+a}return c}function vf(e,r,t){var a=t||{},n=+!a.skipHeader,s=e||{},i=0,o=0;if(s&&a.origin!=null)if(typeof a.origin=="number")i=a.origin;else{var c=typeof a.origin=="string"?Tt(a.origin):a.origin;i=c.r,o=c.c}var l,f={s:{c:0,r:0},e:{c:o,r:i+r.length-1+n}};if(s["!ref"]){var u=He(s["!ref"]);f.e.c=Math.max(f.e.c,u.e.c),f.e.r=Math.max(f.e.r,u.e.r),i==-1&&(i=u.e.r+1,f.e.r=i+r.length-1+n)}else i==-1&&(i=0,f.e.r=r.length-1+n);var d=a.header||[],h=0;r.forEach(function(p,m){or(p).forEach(function(_){(h=d.indexOf(_))==-1&&(d[h=d.length]=_);var b=p[_],v="z",C="",R=he({c:o+h,r:i+m+n});l=mn(s,R),b&&typeof b=="object"&&!(b instanceof Date)?s[R]=b:(typeof b=="number"?v="n":typeof b=="boolean"?v="b":typeof b=="string"?v="s":b instanceof Date?(v="d",a.cellDates||(v="n",b=At(b)),C=a.dateNF||me[14]):b===null&&a.nullError&&(v="e",b=0),l?(l.t=v,l.v=b,delete l.w,delete l.R,C&&(l.z=C)):s[R]=l={t:v,v:b},C&&(l.z=C))})}),f.e.c=Math.max(f.e.c,o+d.length-1);var g=ot(i);if(n)for(h=0;h<d.length;++h)s[Ze(h+o)+g]={t:"s",v:d[h]};return s["!ref"]=ke(f),s}function Q_(e,r){return vf(null,e,r)}function mn(e,r,t){if(typeof r=="string"){if(Array.isArray(e)){var a=Tt(r);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[r]||(e[r]={t:"z"})}return typeof r!="number"?mn(e,he(r)):mn(e,he({r,c:t||0}))}function Z_(e,r){if(typeof r=="number"){if(r>=0&&e.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var t=e.SheetNames.indexOf(r);if(t>-1)return t;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function Ji(){return{SheetNames:[],Sheets:{}}}function Qi(e,r,t,a){var n=1;if(!t)for(;n<=65535&&e.SheetNames.indexOf(t="Sheet"+n)!=-1;++n,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(t)>=0){var s=t.match(/(^.*?)(\d+)$/);n=s&&+s[2]||0;var i=s&&s[1]||t;for(++n;n<=65535&&e.SheetNames.indexOf(t=i+n)!=-1;++n);}if(My(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=r,t}function eE(e,r,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=Z_(e,r);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[a].Hidden=t}function tE(e,r){return e.z=r,e}function wf(e,r,t){return r?(e.l={Target:r},t&&(e.l.Tooltip=t)):delete e.l,e}function rE(e,r,t){return wf(e,"#"+r,t)}function aE(e,r,t){e.c||(e.c=[]),e.c.push({t:r,a:t||"SheetJS"})}function nE(e,r,t,a){for(var n=typeof r!="string"?r:He(r),s=typeof r=="string"?r:ke(r),i=n.s.r;i<=n.e.r;++i)for(var o=n.s.c;o<=n.e.c;++o){var c=mn(e,i,o);c.t="n",c.F=s,delete c.v,i==n.s.r&&o==n.s.c&&(c.f=t,a&&(c.D=!0))}return e}var sE={encode_col:Ze,encode_row:ot,encode_cell:he,encode_range:ke,decode_col:Mi,decode_row:Bi,split_cell:mp,decode_cell:Tt,decode_range:Pa,format_cell:wr,sheet_add_aoa:E0,sheet_add_json:vf,sheet_add_dom:hf,aoa_to_sheet:Da,json_to_sheet:Q_,table_to_sheet:gf,table_to_book:__,sheet_to_csv:xf,sheet_to_txt:Y_,sheet_to_json:ni,sheet_to_html:y_,sheet_to_formulae:J_,sheet_to_row_object_array:ni,sheet_get_cell:mn,book_new:Ji,book_append_sheet:Qi,book_set_sheet_visibility:eE,cell_set_number_format:tE,cell_set_hyperlink:wf,cell_set_internal_link:rE,cell_add_comment:aE,sheet_set_array_formula:nE,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};let Ce=[],kt={};const Zi=Ce;async function yf(){await vs(),iE(),yE(),Ra(),Pf()}async function _f(){console.log("🔄 Reloading meals..."),await vs()}function iE(){const e=document.getElementById("mealFileInput");e&&e.addEventListener("change",oE),document.addEventListener("click",r=>{r.target.closest(".add-to-plan-container")||document.querySelectorAll(".meal-plan-dropdown").forEach(a=>{a.style.display="none"})})}window.showMealUploadModal=function(){const e=document.getElementById("mealUploadModal");e&&(e.style.display="block")};window.closeMealUploadModal=function(){const e=document.getElementById("mealUploadModal");e&&(e.style.display="none")};async function oE(e){var a;const t=(a=e.target.files)==null?void 0:a[0];t&&(console.log("📁 Meal file selected:",t.name),ve(`File selected: ${t.name}`,"info"),await cE(t))}async function cE(e){if(!e.name.match(/\.(xlsx|xls)$/i)){ve("Please select a valid Excel file (.xlsx or .xls)","error");return}try{if(ve("📊 Processing meal Excel file...","info"),!K){ve("Database not available.","error");return}const{data:{user:r}}=await K.auth.getUser();if(!r){ve("Please log in first.","error");return}await uE(r.id);const t=await fE(e);if(console.log(`📊 Parsed ${t.length} meals from Excel file`),t.length===0){ve("No valid meals found in the Excel file.","error");return}await dE(t,r.id),Ce=t,localStorage.setItem("nutrivalor_meals",JSON.stringify(t)),Oa(t);const a=document.getElementById("mealUploadModal");a&&(a.style.display="none"),ve(`✅ Successfully loaded ${t.length} meals! They will persist after refresh.`,"success"),SE()}catch(r){console.error("❌ Error uploading meal file:",r),ve("Error uploading meal file. Please try again.","error")}}function lE(e){const r=[];let t=null,a="";for(let n=0;n<e.length;n++){const s=e[n];if(!s||s.every(g=>!g)||s[0]==="Meal #"||s[1]==="Meal Name")continue;const i=(s[0]||"").toString().trim(),o=(s[1]||"").toString().trim(),c=(s[2]||"").toString().trim(),l=parseFloat(s[3])||0,f=(s[4]||"").toString().trim(),u=(s[5]||"").toString().trim(),d=0,h=0;if(n%10===0&&console.log(`📋 Row ${n}:`,s.slice(0,6)),o&&!i&&!c&&l===0&&d===0&&h===0){a=o.toUpperCase(),console.log(`📋 Found meal type: ${a}`);continue}if(i&&i.startsWith("#")&&o){t&&t.ingredients.length>0&&r.push(t);const g=`meal_${o.replace(/[^a-zA-Z0-9]/g,"_").toLowerCase()}_${n}`;t={id:g,number:i,name:o,meal_type:a||"OTHER",ingredients:[],totalCarbs:0,totalFat:0,totalProtein:0,picture:u,startRow:n+1,endRow:n+1,images:[]},console.log(`🆕 Started new meal: ${o} (${a}) with ID: ${g} at row ${n+1}`)}t&&c&&c.toLowerCase()!=="total"&&(t.ingredients.push({name:c,carbs:l,fat:d,protein:h,instructions:f,row:n+1}),t.endRow=n+1),t&&c&&c.toLowerCase()==="total"&&(t.totalCarbs=l,t.endRow=n+1)}return t&&t.ingredients.length>0&&r.push(t),r}async function fE(e){return new Promise((r,t)=>{const a=new FileReader;a.onload=n=>{var s;try{const i=new Uint8Array((s=n.target)==null?void 0:s.result),o=ai(i,{type:"array"}),c=o.SheetNames[0],l=o.Sheets[c],f=sE.sheet_to_json(l,{header:1,raw:!1,defval:""});console.log(`📊 Read ${f.length} rows from Excel sheet`);const u=lE(f);console.log(`✅ Parsed ${u.length} meals from data`),r(u)}catch(i){console.error("❌ Error parsing Excel file:",i),t(i)}},a.onerror=()=>{t(new Error("Failed to read file"))},a.readAsArrayBuffer(e)})}async function uE(e){try{if(!K)throw new Error("Database not available");const{error:r}=await K.from("meals").delete().eq("user_id",e);if(r)throw console.error("❌ Error clearing meals:",r),r;console.log("🗑️ Cleared all existing meals for user")}catch(r){throw console.error("❌ Error in clearAllMealsForUser:",r),r}}async function dE(e,r){try{if(!K)throw new Error("Database not available");const t=e.map(n=>({user_id:r,number:n.number,name:n.name,meal_type:n.meal_type,ingredients:JSON.stringify(n.ingredients),total_carbs:n.totalCarbs,picture:n.picture,start_row:n.startRow,end_row:n.endRow})),{error:a}=await K.from("meals").insert(t);if(a)throw console.error("❌ Error saving meals:",a),a;console.log(`✅ Saved ${e.length} meals to database`)}catch(t){throw console.error("❌ Error in saveMealsToDatabase:",t),t}}async function vs(){try{const e=await Df();Ce.length=0,Ce.push(...e),Oa(Ce)}catch(e){console.error("Error loading meals:",e),Ef()}}function Ef(){const e=document.getElementById("mealGrid"),r=document.getElementById("availableMealsGrid");e&&(e.innerHTML='<p class="no-data">No meals loaded. Please upload your meal Excel file.</p>'),r&&(r.innerHTML='<p class="no-data">No meals loaded. Please upload your meal Excel file.</p>')}function Oa(e,r=!1){var i;if(!e||e.length===0){Ef();return}r||hE(e);const t=document.querySelector(".meal-filters .filter-btn.active"),a=((i=t==null?void 0:t.getAttribute("data-category"))==null?void 0:i.toUpperCase())||"ALL",n=a==="ALL"?e:e.filter(o=>o.meal_type===a),s=document.getElementById("mealGrid");s&&gE(s,n)}function hE(e){const r=document.querySelectorAll(".meal-filters");if(!r.length){console.log("⚠️ No meal filter containers found");return}const t=[...new Set(e.map(s=>s.meal_type).filter(s=>s))],n=["all",...["BREAKFAST","LUNCH","DINNER","SNACKS","SAUCES","OTHER"].filter(s=>t.includes(s))];r.forEach((s,i)=>{s.innerHTML=n.map((o,c)=>`
              <button class="filter-btn ${c===0?"active":""}" onclick="filterMealsByCategory('${o}')" data-category="${o}">
                ${o==="all"?"All":o==="BREAKFAST"?"Breakfast":o==="LUNCH"?"Lunch":o==="DINNER"?"Dinner":o==="SNACKS"?"Snacks":o==="SAUCES"?"Sauces":o}
              </button>
            `).join("")})}function gE(e,r){if(r.length===0){e.innerHTML='<p class="no-data">No meals loaded. Please upload your meal Excel file.</p>';return}const t=["Breakfast","Lunch","Dinner","Snacks","Sauces"],a=[...r].sort((s,i)=>{const o=t.indexOf(s.meal_type),c=t.indexOf(i.meal_type);return o!==-1&&c!==-1?o-c:o!==-1?-1:c!==-1?1:s.meal_type.localeCompare(i.meal_type)});let n="";a.forEach(s=>{n+=pE(s)}),e.innerHTML=n}function pE(e){const r=e.totalCarbs||e.ingredients.reduce((i,o)=>i+(o.carbs||0),0),t=e.totalFat||e.ingredients.reduce((i,o)=>i+(o.fat||0),0),a=e.totalProtein||e.ingredients.reduce((i,o)=>i+(o.protein||0),0);let n=null,s=e.name;if(e.picture)e.picture.startsWith("data:image/")?(n=e.picture,s="Uploaded Image"):e.picture.startsWith("http")?(n=e.picture,s=e.picture.split("/").pop()||e.name):(n=`/images/${e.picture}`,s=e.picture);else{const i=e.name.replace(/[^\w\s]/g,"").trim();n=`/images/${i}.jpg`,s=`${i}.jpg`}return e.name&&e.name.toLowerCase().includes("bacon and eggs"),`
        <div class="meal-card" data-meal-id="${e.id||""}" data-meal-name="${e.name}">
            ${n?`
                <div class="meal-image-container">
                    <img src="${n}" alt="${e.name}" class="meal-image" 
                         onerror="this.style.display='none'; this.nextElementSibling.style.display='block';"
                         onload="this.style.display='block'; this.nextElementSibling.style.display='none';">
                    <div class="meal-image-fallback" style="display: none;">
                        <span class="image-icon">📷</span>
                        <div class="fallback-text">No Image</div>
                    </div>
                    <div class="meal-image-name">${s}</div>
                </div>
            `:`
                <div class="meal-image-container">
                    <div class="meal-image-fallback">
                        <span class="image-icon">📷</span>
                        <div class="fallback-text">No Image</div>
                    </div>
                </div>
            `}
            <div class="meal-header">
                <h4 class="meal-name">${e.name}</h4>
                <div class="meal-creator">Created By: ${e.created_by}</div>
            </div>
            ${e.cooking_instructions?`
                <div class="cooking-instructions">
                    <h5>Cooking Instructions:</h5>
                    <div class="instructions-content">${e.cooking_instructions}</div>
                </div>
            `:""}
            <div class="meal-ingredients">
                ${e.ingredients.map(i=>`
                    <div class="ingredient-item">
                        <span class="ingredient-name">${i.name||i.food_name||"Unknown Ingredient"}</span>
                        <div class="ingredient-nutrition">
                            <span class="ingredient-carbs">${Ot(i.carbs)}g carbs</span>
                            <span class="ingredient-fat">${Ot(i.fat||0)}g fat</span>
                            <span class="ingredient-protein">${Ot(i.protein||0)}g protein</span>
                        </div>
                        ${i.instructions?`<div class="ingredient-instructions">${i.instructions}</div>`:""}
                    </div>
                `).join("")}
            </div>
            <div class="nutrition-info">
                <span>Carbs: ${Ot(r)}g</span>
                <span>Fat: ${Ot(t)}g</span>
                <span>Protein: ${Ot(a)}g</span>
            </div>
            <div class="meal-actions">
                <div class="add-to-plan-container">
                    <button class="secondary-btn add-to-plan-btn" onclick="toggleMealPlanDropdown('${e.id}')">
                        Add to Plan
                    </button>
                    <div class="meal-plan-dropdown" id="dropdown-${e.id}" style="display: none;">
                        <div class="dropdown-content">
                            <div class="dropdown-section">
                                <label>Day:</label>
                                <select class="day-select" id="day-${e.id}">
                                    <option value="Monday">Monday</option>
                                    <option value="Tuesday">Tuesday</option>
                                    <option value="Wednesday">Wednesday</option>
                                    <option value="Thursday">Thursday</option>
                                    <option value="Friday">Friday</option>
                                    <option value="Saturday">Saturday</option>
                                    <option value="Sunday">Sunday</option>
                                </select>
                            </div>
                            <div class="dropdown-section">
                                <label>Meal Time:</label>
                                <select class="meal-time-select" id="mealtime-${e.id}">
                                    <option value="breakfast" ${e.meal_type.toLowerCase()==="breakfast"?"selected":""}>Breakfast</option>
                                    <option value="lunch" ${e.meal_type.toLowerCase()==="lunch"?"selected":""}>Lunch</option>
                                    <option value="dinner" ${e.meal_type.toLowerCase()==="dinner"?"selected":""}>Dinner</option>
                                    <option value="snack" ${e.meal_type.toLowerCase()==="snack"||e.meal_type.toLowerCase()==="snacks"?"selected":""}>Snack</option>
                                </select>
                            </div>
                            <div class="dropdown-actions">
                                <button class="primary-btn" onclick="addMealToWeeklyPlan('${e.id}', '${e.name.replace(/'/g,"\\'")}')">Add</button>
                                <button class="secondary-btn" onclick="hideMealPlanDropdown('${e.id}')">Cancel</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    `}function ve(e,r="info"){window.showMessage?window.showMessage(e,r):console.log(`${r.toUpperCase()}: ${e}`)}function kf(e){const r=Ce.find(s=>s.id===e);if(!r){console.error("Meal not found:",e);return}const t=new Date().toISOString().split("T")[0];kt[t]||(kt[t]={breakfast:[],lunch:[],dinner:[],snack:[]});const a=["breakfast","lunch","dinner","snack"];let n=!1;for(const s of a)if(kt[t][s].length<2){kt[t][s].push(r),n=!0;break}if(!n){ve("Meal plan is full for today","error");return}localStorage.setItem("nutrivalor_meal_plan",JSON.stringify(kt)),ws(),ve(`Added "${r.name}" to meal plan!`,"success")}function ws(){const e=document.getElementById("mealPlanGrid");if(!e)return;if(Object.keys(kt).length===0){const n=localStorage.getItem("nutrivalor_meal_plan");if(n)try{kt=JSON.parse(n),console.log("📅 Loaded daily meal plan from localStorage")}catch(s){console.error("Error loading daily meal plan:",s)}}const r=new Date().toISOString().split("T")[0],t=kt[r]||{breakfast:[],lunch:[],dinner:[],snack:[]},a=["breakfast","lunch","dinner","snack"];e.innerHTML=`
        <div class="meal-plan-day">
            <h3>Today's Meal Plan</h3>
            ${a.map(n=>{const s=t[n]||[],i=s.reduce((o,c)=>o+(c.totalCarbs||0),0);return`
                    <div class="meal-type-plan">
                        <h4>${n.charAt(0).toUpperCase()+n.slice(1)}</h4>
                        <div class="meal-type-totals">
                            <span>Carbs: ${Ot(i)}g</span>
                        </div>
                        <div class="planned-meals">
                            ${s.map(o=>`
                                <div class="planned-meal">
                                    <span>${o.name}</span>
                                    <button onclick="removeMealFromPlan('${o.id}', '${n}')" class="remove-btn">×</button>
                                </div>
                            `).join("")}
                        </div>
                    </div>
                `}).join("")}
        </div>
    `}function Ot(e){if(e==null||e==="")return"0";const r=parseFloat(e);return isNaN(r)?"0":r.toFixed(1)}function Tf(e){if(console.log(`🔍 Filtering meals by category: ${e}`),!Ce||Ce.length===0){console.log("⚠️ No meals available for filtering");const t=document.getElementById("mealGrid"),a=document.getElementById("availableMealsGrid");t&&(t.innerHTML='<p class="no-data">No meals loaded. Please upload your meal Excel file.</p>'),a&&(a.innerHTML='<p class="no-data">No meals loaded. Please upload your meal Excel file.</p>');return}let r;e==="all"||e==="ALL"?r=Ce:r=Ce.filter(t=>t.meal_type.toUpperCase()===e.toUpperCase()),console.log(`📊 Found ${r.length} meals for category: ${e}`),document.querySelectorAll(".meal-filters .filter-btn").forEach(t=>{t.classList.remove("active")}),document.querySelectorAll(`[data-category="${e}"]`).forEach(t=>{t.classList.add("active")}),Oa(r,!0)}let be={};function mE(e){document.querySelectorAll(".meal-plan-dropdown").forEach(t=>{t.id!==`dropdown-${e}`&&(t.style.display="none")});const r=document.getElementById(`dropdown-${e}`);if(r){const t=r.style.display==="block";if(r.style.display=t?"none":"block",r.style.visibility=t?"hidden":"visible",r.style.opacity=t?"0":"1",r.style.pointerEvents=t?"none":"auto",!t){const a=r.closest(".add-to-plan-container");if(a){const n=a.getBoundingClientRect(),i=window.innerHeight-n.bottom;n.top>i||i<200?(r.style.bottom="100%",r.style.top="auto",r.style.marginBottom="5px",r.style.marginTop="0"):(r.style.top="100%",r.style.bottom="auto",r.style.marginTop="5px",r.style.marginBottom="0")}setTimeout(()=>{document.addEventListener("click",function n(s){const i=s.target;!r.contains(i)&&!(i!=null&&i.closest(`#dropdown-${e}`))&&!(i!=null&&i.closest(".add-to-plan-btn"))&&(r.style.display="none",r.style.visibility="hidden",r.style.opacity="0",r.style.pointerEvents="none",document.removeEventListener("click",n))})},10)}}}function si(e){const r=document.getElementById(`dropdown-${e}`);r&&(r.style.display="none",r.style.visibility="hidden",r.style.opacity="0",r.style.pointerEvents="none")}function xE(e,r){console.log(`🔍 addMealToWeeklyPlan called with mealId: "${e}", mealName: "${r}"`),console.log(`📊 Current meals count: ${Ce.length}`),console.log("📋 Available meal IDs:",Ce.map(c=>({id:c.id,name:c.name})));const t=Ce.find(c=>c.id===e);if(!t){console.error(`❌ Meal not found with ID: "${e}"`),console.error("Available meals:",Ce.map(c=>`ID: "${c.id}", Name: "${c.name}"`)),ve(`Meal not found: ${r}`,"error");return}console.log(`✅ Found meal: ${t.name} with ID: ${t.id}`);const a=document.getElementById(`day-${e}`),n=document.getElementById(`mealtime-${e}`);if(!a||!n){console.error(`❌ Dropdown selects not found for meal ID: ${e}`),console.error("daySelect:",a),console.error("mealTimeSelect:",n),ve("Error: Dropdown elements not found","error");return}const s=a.value,i=n.value;console.log(`📅 Selected day: ${s}, meal time: ${i}`),be[s]||(be[s]={breakfast:[],lunch:[],dinner:[],snack:[]}),console.log(`🔍 DUPLICATE CHECK: Looking for meal ID "${e}" in ${s} ${i}`),console.log("🔍 DUPLICATE CHECK: Current meals in that slot:",be[s][i]),console.log("🔍 DUPLICATE CHECK: Meal IDs in that slot:",be[s][i].map(c=>c.id));const o=be[s][i].find(c=>c.id===e);if(o){console.log("❌ DUPLICATE CHECK: Found existing meal:",o),ve(`${r} is already planned for ${s} ${i}`,"error"),si(e);return}console.log("✅ DUPLICATE CHECK: No duplicate found, proceeding to add meal"),be[s][i].push(t),localStorage.setItem("nutrivalor_weekly_meal_plan",JSON.stringify(be)),Ra(),si(e),ve(`Added "${r}" to ${s} ${i}!`,"success"),console.log("✅ Successfully added meal to weekly plan")}function vE(e,r,t){if(be[r]&&be[r][t]){const a=be[r][t].findIndex(n=>n.id===e);a!==-1&&(be[r][t].splice(a,1),localStorage.setItem("nutrivalor_weekly_meal_plan",JSON.stringify(be)),Ra(),ve("Meal removed from weekly plan","success"))}}function Ra(){const e=document.getElementById("weeklyMealPlan");if(!e)return;const r=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],t=["breakfast","lunch","dinner","snack"],a=["Breakfast","Lunch","Dinner","Snack"];let n="";r.forEach(s=>{const i=be[s]||{breakfast:[],lunch:[],dinner:[],snack:[]};let o=0,c=0,l=0,f=!1;n+=`
            <div class="day-plan">
                <div class="day-header">
                    <div class="day-name">${s}</div>
                </div>
                <div class="meal-types">
                    ${t.map((u,d)=>{const h=i[u]||[],g=h.reduce((_,b)=>_+(b.totalCarbs||0),0),p=h.reduce((_,b)=>_+(b.totalFat||0),0),m=h.reduce((_,b)=>_+(b.totalProtein||0),0);return o+=g,c+=p,l+=m,h.length>0&&(f=!0),`
                            <div class="meal-type">
                                <div class="meal-type-label">${a[d]}</div>
                                ${h.map(_=>`
                                    <div class="planned-meal">
                                        <div class="planned-meal-content">
                                            <input 
                                                type="checkbox" 
                                                class="meal-shopping-checkbox" 
                                                id="shopping-${_.id}-${s}-${u}"
                                                title="Add ingredients to Shopping List"
                                                onchange="console.log('📦 CHECKBOX EVENT: Checkbox clicked!', this.id, this.checked); handleMealToShoppingList('${_.id}', '${_.name.replace(/'/g,"\\'")}', this.checked)"
                                            />
                                            <span class="planned-meal-name">${_.name}</span>
                                        </div>
                                        <button class="remove-planned-btn" onclick="removeMealFromWeeklyPlan('${_.id}', '${s}', '${u}')">×</button>
                                    </div>
                                `).join("")}
                                ${h.length===0?'<div class="empty-meal-slot">No meals planned</div>':""}
                                ${h.length>0?`
                                    <div class="meal-time-totals">
                                        <span class="total-carbs">Carbs: ${Ot(g)}g</span>
                                        <span class="total-fat">Fat: ${Ot(p)}g</span>
                                        <span class="total-protein">Protein: ${Ot(m)}g</span>
                                    </div>
                                `:""}
                            </div>
                        `}).join("")}
                    
                    <div class="daily-totals-column">
                        <div class="daily-totals-label">Daily Total</div>
                        ${f?`
                            <div class="daily-totals-values">
                                <span class="daily-total-carbs">Carbs: ${Ot(o)}g</span>
                                <span class="daily-total-fat">Fat: ${Ot(c)}g</span>
                                <span class="daily-total-protein">Protein: ${Ot(l)}g</span>
                            </div>
                        `:'<div class="empty-meal-slot">No meals</div>'}
                    </div>
                </div>
            </div>
        `}),e.innerHTML=n,Sf()}async function Sf(){try{const e=await wE(),r=await eo(),t=new Set(e.map(n=>n.food_id).filter(n=>n!==null)),a=new Set(e.map(n=>n.name.toLowerCase().trim()));Object.keys(be).forEach(n=>{Object.keys(be[n]).forEach(s=>{be[n][s].forEach(i=>{const o=`shopping-${i.id}-${n}-${s}`,c=document.getElementById(o);if(c&&i.ingredients){let l=!1;for(const u of i.ingredients){const d=u.name.trim().toLowerCase(),h=to(d,r);if(h&&t.has(h.id)){l=!0,console.log(`✅ Found ingredient "${u.name}" in shopping list via food match`);break}if(a.has(d)){l=!0,console.log(`✅ Found ingredient "${u.name}" in shopping list as SUNDRIES`);break}}const f=c.checked;c.checked=l,f!==l&&console.log(`🔄 Updated checkbox ${o}: ${f} → ${l}`)}})})})}catch(e){console.error("Error updating meal shopping checkboxes:",e)}}async function wE(){try{const{supabase:e}=await Ue(async()=>{const{supabase:s}=await Promise.resolve().then(()=>sl);return{supabase:s}},void 0);if(!e)throw new Error("Supabase client not available");const{data:{user:r},error:t}=await e.auth.getUser();if(t||!r)throw new Error("User must be authenticated");const{data:a,error:n}=await e.from("shopping_list").select("*").eq("user_id",r.id);if(n)throw n;return a||[]}catch(e){return console.error("Error loading shopping list items:",e),[]}}function yE(){const e=localStorage.getItem("nutrivalor_weekly_meal_plan");if(e)try{be=JSON.parse(e),console.log("✅ Loaded weekly meal plan:",be),Object.keys(be).forEach(r=>{console.log(`📅 ${r}:`,be[r]),Object.keys(be[r]).forEach(t=>{const a=be[r][t];a&&a.length>0&&console.log(`  🕐 ${t}: ${a.length} meals`,a.map(n=>`ID: ${n.id}, Name: ${n.name}`))})}),Ra(),console.log("📅 Loaded weekly meal plan from localStorage")}catch(r){console.error("Error loading weekly meal plan:",r),be={}}else be={}}function _E(){confirm("Are you sure you want to clear all meal plan data? This cannot be undone.")&&(be={},localStorage.removeItem("nutrivalor_weekly_meal_plan"),kt={},localStorage.removeItem("nutrivalor_meal_plan"),Ra(),ws(),ve("All meal plan data has been cleared!","success"),console.log("🗑️ All meal plan data cleared"))}function EE(){console.log("🧹 Clearing all meal data for user switch..."),Ce=[],be={},kt={},localStorage.removeItem("nutrivalor_meals"),localStorage.removeItem("nutrivalor_weekly_meal_plan"),localStorage.removeItem("nutrivalor_meal_plan"),Ra(),ws(),console.log("✅ All meal data cleared for next user")}function Af(){console.log("🗑️ Clearing all meal shopping checkboxes..."),console.log("🔍 Searching for checkboxes with class: .meal-shopping-checkbox");const e=document.querySelectorAll(".meal-shopping-checkbox");console.log(`📊 Found ${e.length} checkboxes total`);let r=0,t=0;e.forEach((a,n)=>{if(a instanceof HTMLInputElement){const s=a.checked;s&&t++,console.log(`🔲 Checkbox ${n+1}: ID="${a.id}", checked=${s}`),s&&(a.checked=!1,r++,console.log(`✅ Unchecked checkbox: ${a.id}`))}}),console.log(`📈 Summary: ${r} unchecked out of ${t} that were checked`),r>0?(ve(`Cleared ${r} "Add to List" selections`,"success"),console.log(`✅ Successfully unchecked ${r} meal shopping checkboxes`)):t===0?(ve("No checkboxes were selected to clear","info"),console.log("ℹ️ No meal shopping checkboxes were checked")):(ve("All checkboxes were already cleared","info"),console.log("ℹ️ All checkboxes were already unchecked"))}window.addMealToPlan=function(e,r){console.log(`🍽️ Adding meal ${r} to plan`),kf(e)};window.toggleMealPlanDropdown=function(e){mE(e)};window.hideMealPlanDropdown=function(e){si(e)};window.addMealToWeeklyPlan=function(e,r){xE(e,r)};window.removeMealFromWeeklyPlan=function(e,r,t){vE(e,r,t)};window.filterMealsByCategory=function(e){Tf(e)};window.clearAllMealPlanData=function(){_E()};window.clearMealShoppingCheckboxes=function(){Af()};window.removeMealFromPlan=function(e,r){const t=new Date().toISOString().split("T")[0];if(kt[t]&&kt[t][r]){const a=kt[t][r].findIndex(n=>n.id===e);a!==-1&&(kt[t][r].splice(a,1),localStorage.setItem("nutrivalor_meal_plan",JSON.stringify(kt)),ws(),ve("Meal removed from plan","success"))}};async function bf(e,r,t){var n;if(console.log(`🛒 handleMealToShoppingList called - mealId: "${e}", mealName: "${r}", isChecked: ${t}`),console.log(`📊 Current meals available: ${Ce.length}`),console.log("🔍 Available meal IDs:",Ce.map(s=>s.id)),!t){ve("Checkbox unchecked - you can check it again to add more ingredients","info"),console.log(`📋 Checkbox unchecked for meal: ${r}. Ready for future additions.`);return}const a=Ce.find(s=>s.id===e);if(!a){console.error(`❌ Meal not found with ID: "${e}"`),console.error("Available meals:",Ce.map(s=>({id:s.id,name:s.name}))),ve("Meal not found","error");return}if(console.log(`✅ Found meal: "${a.name}" with ${((n=a.ingredients)==null?void 0:n.length)||0} ingredients`),!a.ingredients||a.ingredients.length===0){console.warn(`⚠️ No ingredients found in meal: "${a.name}"`),ve("No ingredients found in this meal","error");return}try{ve("Processing ingredients...","info");const s=await kE(a),i=s.matched.length,o=s.unmatched.length;let c=`Added ${i+o} more ingredients to shopping list`;i>0&&(c+=` (${i} matched from Food Tracker`),o>0&&(c+=`, ${o} added to SUNDRIES`),(i>0||o>0)&&(c+=")"),c+=" - quantities increased!",ve(c,"success"),await new Promise(l=>setTimeout(l,500)),console.log("🔄 Reloading food-tracker shopping list from database...");try{typeof window.reloadShoppingListFromDatabase=="function"?(await window.reloadShoppingListFromDatabase(),console.log("✅ Food-tracker shopping list reloaded successfully")):(console.warn("⚠️ Food-tracker shopping list reload function not available, using fallback"),typeof window.updateShoppingListDisplay=="function"&&window.updateShoppingListDisplay(),ve("Ingredients added! Switch to Shopping List tab to see updates.","info"))}catch(l){console.warn("⚠️ Food-tracker shopping list reload failed:",l),ve("Ingredients added! Switch to Shopping List tab to see updates.","info")}}catch(s){console.error("Error adding meal ingredients to shopping list:",s),ve("Error adding ingredients to shopping list","error")}}async function kE(e){console.log(`🔍 Processing ${e.ingredients.length} ingredients from "${e.name}"`);const r=await eo(),t=[],a=[];for(const n of e.ingredients){const s=n.name.trim(),{quantity:i,cleanName:o}=Ff(s);console.log(`🔢 PARSED: "${s}" → quantity: ${i}, cleanName: "${o}"`);const c=to(o,r);if(console.log(`🔍 MATCHING: Searching for "${o}" in ${r.length} foods`),console.log(`🔍 MATCHING: Found match: ${c?`"${c.name}" (ID: ${c.id})`:"None"}`),c)try{console.log(`🔄 CALLING addFoodToShoppingList("${c.id}", ${i})`),await Cf(c.id,i),t.push({ingredient:n,matchedFood:c,quantity:i}),console.log(`✅ Matched "${n.name}" with "${c.name}" (quantity: ${i})`)}catch(l){console.error(`❌ Error adding ${c.name} to shopping list:`,l)}else try{console.log(`🔄 CALLING addIngredientToSundries("${n.name}", ${i})`),await If(n,i),a.push({...n,quantity:i}),console.log(`📝 Added "${n.name}" to SUNDRIES (quantity: ${i})`)}catch(l){console.error(`❌ Error adding ${n.name} to SUNDRIES:`,l)}}return{matched:t,unmatched:a}}async function eo(){try{const{loadFoodsFromDatabase:e}=await Ue(async()=>{const{loadFoodsFromDatabase:t}=await Promise.resolve().then(()=>yr);return{loadFoodsFromDatabase:t}},void 0);return await e()}catch(e){return console.error("❌ LOADING: Error loading foods for matching:",e),[]}}function Ff(e){const r=e.trim(),t=[/^(\d+(?:\.\d+)?)\s+(.+)$/,/^(\d+\/\d+)\s+(.+)$/,/^(\d+\s+\d+\/\d+)\s+(.+)$/,/^(\w+)\s+(.+)$/];for(const a of t){const n=r.match(a);if(n){const s=n[1].toLowerCase();let i=1;if(/^\d+(?:\.\d+)?$/.test(s))i=parseFloat(s);else if(/^\d+\/\d+$/.test(s)){const[l,f]=s.split("/").map(Number);i=l/f}else if(/^\d+\s+\d+\/\d+$/.test(s)){const[l,f]=s.split(" "),[u,d]=f.split("/").map(Number);i=parseInt(l)+u/d}else i={one:1,two:2,three:3,four:4,five:5,six:6,seven:7,eight:8,nine:9,ten:10,a:1,an:1,half:.5,quarter:.25}[s]||1;const o=Math.max(1,Math.round(i)),c=n[2].trim();return{quantity:o,cleanName:c}}}return{quantity:1,cleanName:r}}function to(e,r){if(!r||r.length===0)return console.log("🔍 SEARCH: No foods available for matching"),null;const t=e.toLowerCase().trim();console.log(`🔍 SEARCH: Looking for "${t}" in foods database`);let a=r.find(s=>s.name.toLowerCase().trim()===t);if(a)return console.log(`🎯 SEARCH: Exact match found: "${a.name}"`),a;if(console.log("🔍 SEARCH: No exact match found, trying partial matches..."),a=r.find(s=>{const i=s.name.toLowerCase().trim();return t.includes(i)||i.includes(t)}),a)return console.log(`🎯 SEARCH: Partial match found: "${a.name}"`),a;console.log("🔍 SEARCH: No partial match found, trying word-based matching...");const n=t.split(/\s+/);return a=r.find(s=>{const i=s.name.toLowerCase().trim().split(/\s+/);return n.some(o=>o.length>2&&i.some(c=>c.includes(o)||o.includes(c)))}),a?(console.log(`🎯 SEARCH: Word-based match found: "${a.name}"`),a):(console.log(`❌ SEARCH: No match found for "${t}"`),null)}async function Cf(e,r=1){try{const{addToShoppingList:t}=await Ue(async()=>{const{addToShoppingList:a}=await Promise.resolve().then(()=>yr);return{addToShoppingList:a}},void 0);await t(e,r)}catch(t){throw console.error("Error adding food to shopping list:",t),t}}async function If(e,r=1){try{const{supabase:t}=await Ue(async()=>{const{supabase:i}=await Promise.resolve().then(()=>sl);return{supabase:i}},void 0);if(!t)throw new Error("Supabase client not available");const{data:{user:a},error:n}=await t.auth.getUser();if(n||!a)throw new Error("User must be authenticated");const{error:s}=await t.from("shopping_list").insert([{food_id:null,name:e.name,brand:"SUNDRIES",category:"SUNDRIES",carbs:e.carbs||0,fat:e.fat||0,protein:e.protein||0,quantity:r,user_id:a.id}]);if(s)throw s}catch(t){throw console.error("Error adding ingredient to SUNDRIES:",t),t}}window.handleMealToShoppingList=async function(e,r,t){console.log("🚀🚀🚀 CHECKBOX CLICKED! Global handleMealToShoppingList wrapper called!"),console.log(`📋 Parameters: mealId="${e}", mealName="${r}", isChecked=${t}`),console.log(`📊 Current meals available: ${Ce.length}`);try{await bf(e,r,t),console.log("✅ handleMealToShoppingList completed successfully")}catch(a){console.error("❌ Error in handleMealToShoppingList:",a),ve("Error processing ingredients","error")}};window.testMealShoppingFunction=function(){console.log("🧪 Testing handleMealToShoppingList availability:"),console.log("- Function exists:",typeof window.handleMealToShoppingList),console.log("- Current meals:",Ce.length),console.log("- Meals data:",Ce.map(e=>({id:e.id,name:e.name})))};window.testClearFunction=function(){console.log("🧪 Testing CLEAR button functionality:"),console.log("- clearMealShoppingCheckboxes function exists:",typeof window.clearMealShoppingCheckboxes),console.log("- clearAllMealPlanData function exists:",typeof window.clearAllMealPlanData);const e=document.querySelectorAll(".meal-shopping-checkbox");console.log("- Meal shopping checkboxes found:",e.length),e.length>0?(console.log("- Checkbox details:"),e.forEach((r,t)=>{r instanceof HTMLInputElement&&console.log(`  Checkbox ${t+1}: ID="${r.id}", checked=${r.checked}`)})):console.log("- No checkboxes found. Make sure you have meals added to your weekly plan first."),console.log("🔧 Testing clearMealShoppingCheckboxes() directly..."),Af()};window.forceAddMealIngredients=async function(e){var t;console.log(`🚀 FORCE ADD: Looking for meal "${e}"`);const r=Ce.find(a=>a.name.toLowerCase().includes(e.toLowerCase()));if(r){console.log(`✅ Found meal: ${r.name} (ID: ${r.id})`),console.log(`📋 Forcing addition of ${((t=r.ingredients)==null?void 0:t.length)||0} ingredients to shopping list...`);try{await bf(r.id,r.name,!0),console.log(`✅ FORCE ADD completed for ${r.name}`)}catch(a){console.error("❌ FORCE ADD failed:",a)}}else console.error("❌ Meal not found. Available meals:",Ce.map(a=>a.name)),console.log('💡 Try: forceAddMealIngredients("omelette") or forceAddMealIngredients("thai")')};window.addAllPlannedMealsToShoppingList=async function(){if(console.log("🛒🛒🛒 ADDING ALL PLANNED MEALS TO SHOPPING LIST..."),!be||Object.keys(be).length===0){console.log("❌ No weekly meal plan found"),ve("No meals planned yet","info");return}const e=new Map;Object.keys(be).forEach(n=>{Object.keys(be[n]).forEach(s=>{be[n][s].forEach(i=>{const o=e.get(i.id)||0;e.set(i.id,o+1),console.log(`📅 Found "${i.name}" on ${n} ${s} (count: ${o+1})`)})})}),console.log(`📊 Total unique meals planned: ${e.size}`);let r=0,t=0;for(const[n,s]of e){const i=Ce.find(o=>o.id===n);if(i){console.log(`
🔄 Processing "${i.name}" (appears ${s} times in week)`);try{const o=await TE(i,s);r+=o.matched.length+o.unmatched.length,console.log(`✅ Added ${o.matched.length+o.unmatched.length} ingredients for "${i.name}" x${s}`)}catch(o){console.error(`❌ Error adding meal "${i.name}":`,o),t++}}else console.error(`❌ Meal not found in currentMeals: ${n}`),t++}const a=`Added ${r} ingredients from ${e.size} unique meals to shopping list!`;t>0?ve(`${a} (${t} errors)`,"info"):ve(a,"success");try{typeof window.loadAndDisplayShoppingList=="function"&&await window.loadAndDisplayShoppingList()}catch(n){console.warn("Failed to refresh shopping list display:",n)}console.log("✅ ALL PLANNED MEALS PROCESSING COMPLETED")};async function TE(e,r){console.log(`🔍 Processing ${e.ingredients.length} ingredients from "${e.name}" x${r}`);const t=await eo(),a=[],n=[];for(const s of e.ingredients){const i=s.name.trim(),{quantity:o,cleanName:c}=Ff(i),l=o*r;console.log(`🔢 MULTIPLIED: "${i}" → base: ${o}, multiplier: ${r}, total: ${l}`);const f=to(c,t);if(f)try{await Cf(f.id,l),a.push({ingredient:s,matchedFood:f,quantity:l}),console.log(`✅ Added "${s.name}" x${l} to shopping list`)}catch(u){console.error(`❌ Error adding ${f.name}:`,u)}else try{await If(s,l),n.push({...s,quantity:l}),console.log(`📝 Added "${s.name}" x${l} to SUNDRIES`)}catch(u){console.error(`❌ Error adding ${s.name} to SUNDRIES:`,u)}}return{matched:a,unmatched:n}}window.refreshMealShoppingCheckboxes=async function(){await Sf()};function SE(){const e=new Date,r=e.toLocaleDateString()+" "+e.toLocaleTimeString();localStorage.setItem("lastMealUploadDate",r),Pf()}function Pf(){const e=localStorage.getItem("lastMealUploadDate"),r=document.getElementById("lastMealUpdateInfo"),t=document.getElementById("lastMealUpdateDate");e&&r&&t?(t.textContent=e,r.style.display="block"):r&&(r.style.display="none")}window.testMealCheckbox=async function(e){var t;console.log(`🧪 === TESTING MEAL CHECKBOX: ${e} ===`);const r=Ce.find(a=>a.name.toLowerCase().includes(e.toLowerCase()));if(!r){console.error(`❌ Meal "${e}" not found. Available meals:`,Ce.map(a=>a.name));return}if(console.log(`✅ Found meal: ${r.name} (ID: ${r.id})`),console.log(`📋 Ingredients: ${((t=r.ingredients)==null?void 0:t.length)||0}`),!r.ingredients||r.ingredients.length===0){console.error("❌ This meal has no ingredients to add to shopping list");return}console.log("🥗 Meal ingredients:"),r.ingredients.forEach((a,n)=>{console.log(`  ${n+1}. ${a.name}`)}),console.log(`
🚀 Testing handleMealToShoppingList...`);try{await window.handleMealToShoppingList(r.id,r.name,!0),console.log("✅ Test completed successfully!"),setTimeout(()=>{console.log(`
🔍 Checking shopping list after test...`),typeof window.debugShoppingList=="function"&&window.debugShoppingList()},1e3)}catch(a){console.error("❌ Test failed:",a)}};window.forceRefreshShoppingList=async function(){console.log("🔄 === FORCE REFRESHING FOOD-TRACKER SHOPPING LIST ===");try{typeof window.updateShoppingListDisplay=="function"?(console.log("🔄 Refreshing food-tracker shopping list..."),window.updateShoppingListDisplay(),console.log("✅ Food-tracker shopping list refresh completed")):console.warn("⚠️ Food-tracker shopping list function not available")}catch(e){console.error("❌ Error during food-tracker refresh:",e)}};async function Df(){try{const{data:{user:e}}=await K.auth.getUser();if(!e)return console.error("No user logged in"),[];const{data:r,error:t}=await K.from("meals").select("*").or(`user_id.eq.${e.id},user_id.is.null`).order("name");if(t)return console.error("Error loading meals:",t),[];const a=(r||[]).map(n=>({id:n.id,number:n.number||"",name:n.name,meal_type:n.meal_type||"OTHER",ingredients:typeof n.ingredients=="string"?JSON.parse(n.ingredients||"[]"):n.ingredients||[],totalCarbs:n.total_carbs||0,totalFat:n.total_fat||0,totalProtein:n.total_protein||0,picture:n.picture||"",startRow:n.start_row||0,endRow:n.end_row||0,images:[],user_id:n.user_id,created_by:n.created_by,cooking_instructions:n.cooking_instructions}));return Ce.length=0,Ce.push(...a),a}catch(e){return console.error("Error loading meals:",e),[]}}async function AE(e){const r=Ce.find(l=>l.id===e);if(!r){console.error("Meal not found:",e);return}const t=document.getElementById("editMealForm"),a=document.getElementById("editMealId"),n=document.getElementById("editMealName"),s=document.getElementById("editMealType"),i=document.getElementById("editMealInstructions"),o=document.getElementById("editMealIngredients");if(!t||!a||!n||!s||!i||!o){console.error("Edit form elements not found");return}a.value=r.id||"",n.value=r.name,s.value=r.meal_type,i.value=r.cooking_instructions||"",o.innerHTML="",r.ingredients.forEach((l,f)=>{const u=document.createElement("div");u.className="ingredient-row",u.innerHTML=`
            <select class="ingredient-select" name="ingredient_${f}">
                <option value="${l.food_id}">${l.food_name}</option>
            </select>
            <input type="number" class="ingredient-quantity" name="quantity_${f}" 
                   value="${l.quantity||1}" min="0.1" step="0.1">
            <button type="button" class="remove-ingredient" onclick="removeIngredientRow(this)">Remove</button>
        `,o.appendChild(u)});const c=document.getElementById("editMealModal");c&&(c.style.display="block"),await bE()}async function bE(){try{const{data:e,error:r}=await K.from("foods").select("id, name").order("name");if(r)throw r;document.querySelectorAll(".ingredient-select").forEach(a=>{var i;const n=a.value;let s=`<option value="${n}">${((i=e.find(o=>o.id===n))==null?void 0:i.name)||"Select food"}</option>`;e.forEach(o=>{o.id!==n&&(s+=`<option value="${o.id}">${o.name}</option>`)}),a.innerHTML=s})}catch(e){console.error("Error loading foods for ingredients:",e),ve("Error loading foods for ingredients","error")}}function ro(){const e=document.getElementById("editMealModal");e&&(e.style.display="none")}async function FE(){const e=document.getElementById("editMealId");if(!e||!e.value){ve("No meal selected for deletion","error");return}if(confirm("Are you sure you want to delete this meal?"))try{const{error:t}=await K.from("meals").delete().eq("id",e.value);if(t)throw t;ve("Meal deleted successfully","success"),ro(),await vs()}catch(t){console.error("Error deleting meal:",t),ve("Error deleting meal","error")}}document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("editMealForm");e&&e.addEventListener("submit",async r=>{r.preventDefault();const t=document.getElementById("editMealId").value,a=document.getElementById("editMealName").value,n=document.getElementById("editMealType").value,s=document.getElementById("editMealInstructions").value,i=[];document.querySelectorAll("#editMealIngredients .ingredient-row").forEach((c,l)=>{const f=c.querySelector(".ingredient-select"),u=c.querySelector(".ingredient-quantity");if(f&&u){const d=Qe.find(h=>h.id===f.value);d&&i.push({name:d.name,food_name:d.name,food_id:d.id,carbs:d.carbs*parseFloat(u.value),fat:d.fat*parseFloat(u.value),protein:d.protein*parseFloat(u.value),quantity:parseFloat(u.value),instructions:d.instructions||"",row:l})}});try{const c=i.reduce((h,g)=>h+(g.carbs||0),0),l=i.reduce((h,g)=>h+(g.fat||0),0),f=i.reduce((h,g)=>h+(g.protein||0),0),u={id:t,name:a,meal_type:n,cooking_instructions:s,ingredients:i,totalCarbs:c,totalFat:l,totalProtein:f},{error:d}=await K.from("meals").update(u).eq("id",t);if(d)throw d;ve("Meal updated successfully","success"),ro(),await vs()}catch(c){console.error("Error updating meal:",c),ve("Error updating meal","error")}})});const Of=Object.freeze(Object.defineProperty({__proto__:null,addToMealPlan:kf,allMeals:Zi,cancelMealEdit:ro,clearAllMealData:EE,deleteMealFromEdit:FE,displayMeals:Oa,editMeal:AE,filterMealsByCategory:Tf,initializeMeals:yf,loadMealsFromDatabase:Df,reloadMeals:_f},Symbol.toStringTag,{value:"Module"}));let Lr=[];async function CE(){await xn(),window.addEventListener("shoppingListNeedsRefresh",async e=>{var t;console.log("📡 Received shopping list refresh event from:",(t=e.detail)==null?void 0:t.source);try{await xn(),console.log("✅ Shopping list refreshed via event listener")}catch(a){console.error("❌ Error refreshing shopping list via event:",a)}})}async function xn(){try{Lr=await wi()||[],ii(Lr);try{typeof window.refreshMealShoppingCheckboxes=="function"&&await window.refreshMealShoppingCheckboxes()}catch(r){console.warn("⚠️ Could not refresh meal plan checkboxes:",r)}}catch(e){console.error("❌ Error loading shopping list:",e),Lr=[],ii([])}}function Rf(e){const r={};return e.forEach(t=>{const a=t.brand||"Any",n=t.category||"General",s=`${t.name.toLowerCase().trim()}_${a.toLowerCase().trim()}_${n.toLowerCase().trim()}`;if(console.log(`🔍 Processing item: ${t.name}, Brand: ${a}, Category: ${n}, Key: ${s}`),console.log(`🔍 Item quantity RAW: value="${t.quantity}", type="${typeof t.quantity}", parsed=${parseInt(t.quantity)}`),r[s]){const i=r[s].quantity,o=parseInt(t.quantity)||1;r[s].quantity=(parseInt(i)||1)+o,console.log(`🔄 Consolidated ${t.name}: ${i} + ${o} = ${r[s].quantity} total quantity`)}else{const i=parseInt(t.quantity)||1;r[s]={...t,quantity:i},console.log(`➕ Added new item: ${t.name} with quantity ${i} (original: ${t.quantity}, type: ${typeof t.quantity})`)}}),console.log(`📦 Consolidation complete: ${Object.keys(r).length} unique items`),Object.values(r)}function ii(e){const r=document.getElementById("shoppingItems"),t=document.getElementById("shoppingTotals");if(!r){console.warn("❌ Shopping items container not found");return}if(t&&(t.style.display="none",t.innerHTML=""),!e||e.length===0){r.innerHTML='<p class="empty-state">Your shopping list is empty. Add items from the Food Tracker!</p>',t&&(t.style.display="none");return}console.log("🛒 Processing",e.length,"items for display");const a=Rf(e);console.log("🛒 After consolidation:",a.length,"unique items");const n=a.reduce((o,c)=>{const l=c.category||c.brand||"General";return o[l]||(o[l]=[]),o[l].push(c),o},{});console.log("🛒 Items grouped by category:",Object.keys(n));const s=Object.keys(n).sort((o,c)=>o==="SUNDRIES"?1:c==="SUNDRIES"?-1:o.localeCompare(c));r.innerHTML=s.map(o=>{const c=n[o],l=o==="SUNDRIES";return`
      <div class="shopping-category">
        <h3 class="category-header ${l?"sundries-header":""}">${o}${l?" (From Meal Plans)":""}</h3>
        <div class="category-items">
          ${c.map(f=>`
            <div class="shopping-item" data-id="${f.id}">
              <div class="item-info">
                <h4>${f.name}</h4>
                <div class="quantity-display">Qty: ${f.quantity}</div>
                ${f.brand&&f.brand!=="SUNDRIES"?`<div class="brand-info">Brand: ${f.brand}</div>`:""}
                <div class="nutrition-info">
                  <span>Carbs: ${ka(f.carbs)}g</span>
                  <span>Fat: ${ka(f.fat)}g</span>
                  <span>Protein: ${ka(f.protein)}g</span>
                </div>
                ${l?"":`<div class="category-info">${f.category||"General"}</div>`}
              </div>
              <div class="item-controls">
                <div class="quantity-controls">
                  <button onclick="updateItemQuantity('${f.id}', ${f.quantity-1})" class="qty-btn" ${f.quantity<=1?"disabled":""}>-</button>
                  <span class="quantity">${f.quantity}</span>
                  <button onclick="updateItemQuantity('${f.id}', ${f.quantity+1})" class="qty-btn">+</button>
                </div>
                <button onclick="removeShoppingItem('${f.id}')" class="remove-btn">Remove</button>
              </div>
            </div>
          `).join("")}
        </div>
      </div>
    `}).join("");const i=Lf(a);console.log("🛒 Calculated totals:",i),t&&i.totalItems>0&&(t.style.display="block",t.innerHTML=`
      <div class="totals-header">
        <h3>Shopping List Totals</h3>
        <span class="total-items">${i.totalItems} items</span>
      </div>
      <div class="totals-grid">
        <div class="total-item">
          <span class="label">Total Carbs:</span>
          <span class="value">${i.totalCarbs.toFixed(1)}g</span>
        </div>
        <div class="total-item">
          <span class="label">Total Fat:</span>
          <span class="value">${i.totalFat.toFixed(1)}g</span>
        </div>
        <div class="total-item">
          <span class="label">Total Protein:</span>
          <span class="value">${i.totalProtein.toFixed(1)}g</span>
        </div>
      </div>
    `)}function Lf(e){const r={totalItems:e.reduce((t,a)=>t+a.quantity,0),totalCarbs:0,totalFat:0,totalProtein:0};return e.forEach(t=>{r.totalCarbs+=(parseFloat(t.carbs)||0)*t.quantity,r.totalFat+=(parseFloat(t.fat)||0)*t.quantity,r.totalProtein+=(parseFloat(t.protein)||0)*t.quantity}),r}function ka(e){if(e==null||e==="")return"0";const r=parseFloat(e);return isNaN(r)?"0":r.toFixed(1)}async function Bf(e){try{await wl(e),await xn();try{typeof window.refreshMealShoppingCheckboxes=="function"&&(await window.refreshMealShoppingCheckboxes(),console.log("✅ Meal plan checkboxes refreshed after item removal"))}catch(r){console.warn("⚠️ Could not refresh meal plan checkboxes:",r)}Br("Item removed from shopping list","success")}catch(r){console.error("Error removing item:",r),Br("Error removing item","error")}}async function IE(e,r){if(r<1){await Bf(e);return}try{await yl(e,r),await xn()}catch(t){console.error("Error updating quantity:",t),Br("Error updating quantity","error")}}async function PE(e=!1){console.log("🧹 SHOPPING-LIST: Starting shopping list clear...");try{if(e)console.log("⏭️ Database clear skipped (already done by food-tracker)");else{const{clearShoppingListFromDatabase:r}=await Ue(async()=>{const{clearShoppingListFromDatabase:t}=await Promise.resolve().then(()=>yr);return{clearShoppingListFromDatabase:t}},void 0);await r(),console.log("✅ Database cleared successfully")}Lr=[],console.log("✅ Local shopping list array cleared"),ii([]),console.log("✅ Display updated");try{typeof window.refreshMealShoppingCheckboxes=="function"&&(await window.refreshMealShoppingCheckboxes(),console.log("✅ Meal plan checkboxes refreshed after clearing list"))}catch(r){console.warn("⚠️ Could not refresh meal plan checkboxes:",r)}e||Br("Shopping list cleared","success")}catch(r){console.error("❌ Error clearing shopping list:",r),e||Br("Error clearing shopping list","error")}}function DE(){return Lr}function Br(e,r="success"){let t=document.getElementById("shopping-message");if(!t){t=document.createElement("div"),t.id="shopping-message",t.className="message";const a=document.getElementById("shopping-list")||document.body;a.insertBefore(t,a.firstChild)}t.textContent=e,t.className=`message ${r}`,t.style.display="block",setTimeout(()=>{t&&(t.style.display="none")},3e3)}window.removeShoppingItem=Bf;window.updateItemQuantity=IE;window.loadAndDisplayShoppingList=xn;window.printShoppingList=OE;window.clearAllShoppingItems=PE;window.getCurrentShoppingList=DE;function OE(){if(console.log("🖨️ Printing shopping list..."),!Lr||Lr.length===0){Br("Shopping list is empty - nothing to print!","error");return}const e=window.open("","_blank");if(!e){Br("Unable to open print window. Please check your browser settings.","error");return}const r=RE();e.document.write(`
    <!DOCTYPE html>
    <html>
    <head>
      <title>NutriValor Shopping List</title>
      <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        h1 { color: #333; }
        .category { margin-bottom: 20px; }
        .category h2 { color: #666; border-bottom: 1px solid #ccc; padding-bottom: 5px; }
        .item { margin: 8px 0; padding: 8px 0; border-bottom: 1px dotted #ddd; display: flex; align-items: flex-start; }
        .checkbox { font-size: 24px; font-weight: bold; margin-right: 12px; line-height: 1; color: #333; }
        .item-content { flex: 1; }
        .item-name { font-weight: bold; margin-bottom: 4px; }
        .item-details { font-size: 0.9em; color: #666; }
        .totals { margin-top: 30px; padding: 15px; background: #f5f5f5; border-radius: 5px; }
        @media print { body { margin: 0; } }
      </style>
    </head>
    <body>
      ${r}
    </body>
    </html>
  `),e.document.close(),e.focus(),e.print(),Br("Shopping list opened for printing!","success")}function RE(){const e=Rf(Lr),r=Lf(e),t=new Date().toLocaleDateString(),a=e.reduce((i,o)=>{const c=o.category||o.brand||"General";return i[c]||(i[c]=[]),i[c].push(o),i},{}),n=Object.keys(a).sort((i,o)=>i==="SUNDRIES"?1:o==="SUNDRIES"?-1:i.localeCompare(o));let s=`
    <h1>NutriValor Shopping List</h1>
    <p><strong>Generated:</strong> ${t}</p>
    <p><strong>Total Items:</strong> ${r.totalItems}</p>
  `;return n.forEach(i=>{const o=a[i];s+=`
      <div class="category">
        <h2>${i}${i==="SUNDRIES"?" (From Meal Plans)":""}</h2>
    `,o.forEach(l=>{s+=`
        <div class="item">
          <div class="checkbox">☐</div>
          <div class="item-content">
            <div class="item-name">${l.name} (Qty: ${l.quantity})</div>
            <div class="item-details">
              Carbs: ${ka(l.carbs)}g | 
              Fat: ${ka(l.fat)}g | 
              Protein: ${ka(l.protein)}g
              ${l.brand&&l.brand!=="SUNDRIES"?` | Brand: ${l.brand}`:""}
            </div>
          </div>
        </div>
      `}),s+="</div>"}),s+=`
    <div class="totals">
      <h2>Totals</h2>
      <p><strong>Total Carbs:</strong> ${r.totalCarbs.toFixed(1)}g</p>
      <p><strong>Total Fat:</strong> ${r.totalFat.toFixed(1)}g</p>
      <p><strong>Total Protein:</strong> ${r.totalProtein.toFixed(1)}g</p>
    </div>
  `,s}let Bt=null,Mt=null,$e=[],Qr=null,Zr=null;function LE(){const e=document.getElementById("editFoodModal");if(!e)return;BE();const r=document.getElementById("editFoodForm");r&&(r.style.display="none",r.reset()),e.style.display="block"}function ao(){const e=document.getElementById("editFoodModal");e&&(e.style.display="none"),Bt=null}async function BE(){try{const{data:e,error:r}=await K.from("foods").select("*").order("name");if(r)throw r;const t=document.getElementById("editFoodSelect");if(!t)return;t.innerHTML='<option value="">Choose a food...</option>',e&&e.forEach(a=>{const n=document.createElement("option");n.value=a.id,n.textContent=`${a.name}${a.brand?` (${a.brand})`:""}`,t.appendChild(n)})}catch(e){console.error("Error loading foods:",e),Ie("Error loading foods","error")}}async function ME(e){var t,a,n;const r=document.getElementById("editFoodForm");if(r){if(!e){r.style.display="none";return}try{const{data:s,error:i}=await K.from("foods").select("*").eq("id",e).single();if(i)throw i;if(!s){Ie("Food not found","error");return}Bt=s,Qr=null,document.getElementById("editFoodId").value=s.id,document.getElementById("editFoodName").value=s.name||"",document.getElementById("editFoodBrand").value=s.brand||"",document.getElementById("editFoodCategory").value=s.category||"",document.getElementById("editFoodCarbs").value=((t=s.carbs)==null?void 0:t.toString())||"0",document.getElementById("editFoodFat").value=((a=s.fat)==null?void 0:a.toString())||"0",document.getElementById("editFoodProtein").value=((n=s.protein)==null?void 0:n.toString())||"0",document.getElementById("editFoodInstructions").value=s.instructions||"";const o=document.getElementById("editFoodImagePreview"),c=document.getElementById("editFoodImagePlaceholder"),l=document.getElementById("editFoodImage");l&&(l.value="");const f=s.image_url||s.image||s.picture||null;f&&f.trim()!==""?(o.src=f,o.style.display="block",c.style.display="none"):(o.style.display="none",c.style.display="flex"),r.style.display="block"}catch(s){console.error("Error loading food:",s),Ie("Error loading food","error")}}}async function NE(e){if(e.preventDefault(),!Bt){Ie("No food selected","error");return}try{let r=Bt.image_url;if(Qr){const n=Qr.name.split(".").pop(),s=`food_${Bt.id}_${Date.now()}.${n}`,{error:i}=await K.storage.from("food-images").upload(s,Qr);if(i){console.error("Error uploading image:",i),Ie("Error uploading image","error");return}const{data:o}=K.storage.from("food-images").getPublicUrl(s);r=o.publicUrl}const t={name:document.getElementById("editFoodName").value.trim(),brand:document.getElementById("editFoodBrand").value.trim()||null,category:document.getElementById("editFoodCategory").value,carbs:parseFloat(document.getElementById("editFoodCarbs").value)||0,fat:parseFloat(document.getElementById("editFoodFat").value)||0,protein:parseFloat(document.getElementById("editFoodProtein").value)||0,instructions:document.getElementById("editFoodInstructions").value.trim()||null,image_url:r,updated_at:new Date().toISOString()},{error:a}=await K.from("foods").update(t).eq("id",Bt.id);if(a)throw a;Ie("Food updated successfully!","success"),ao(),await _r(Qe)}catch(r){console.error("Error saving food:",r),Ie("Error saving food","error")}}async function $E(){if(!Bt){Ie("No food selected","error");return}if(confirm(`Are you sure you want to delete "${Bt.name}"? This cannot be undone.`))try{const{error:r}=await K.from("foods").delete().eq("id",Bt.id);if(r)throw r;Ie("Food deleted successfully!","success"),ao(),await _r(Qe)}catch(r){console.error("Error deleting food:",r),Ie("Error deleting food","error")}}function UE(){const e=document.getElementById("editMealModal");if(!e)return;jE();const r=document.getElementById("editMealForm");r&&(r.style.display="none",r.reset()),e.style.display="block"}function no(){const e=document.getElementById("editMealModal");e&&(e.style.display="none"),Mt=null,$e=[]}async function jE(){try{const{data:e,error:r}=await K.from("meals").select("*").order("name");if(r)throw r;const t=document.getElementById("editMealSelect");if(!t)return;t.innerHTML='<option value="">Choose a meal...</option>',e&&e.forEach(a=>{const n=document.createElement("option");n.value=a.id,n.textContent=`${a.name} (${a.meal_type||"Unknown"})`,t.appendChild(n)})}catch(e){console.error("Error loading meals:",e),Ie("Error loading meals","error")}}async function HE(e){const r=document.getElementById("editMealForm");if(r){if(!e){r.style.display="none";return}try{const{data:t,error:a}=await K.from("meals").select("*").eq("id",e).single();if(a)throw a;if(!t){Ie("Meal not found","error");return}Mt=t,Zr=null,document.getElementById("editMealId").value=t.id,document.getElementById("editMealName").value=t.name||"",document.getElementById("editMealType").value=t.meal_type||"",document.getElementById("editMealInstructions").value=t.cooking_instructions||"";const n=document.getElementById("editMealImagePreview"),s=document.getElementById("editMealImagePlaceholder"),i=document.getElementById("editMealImage");i&&(i.value="");const o=t.image_url||t.image||t.picture||null;o&&o.trim()!==""?(n.src=o,n.style.display="block",s.style.display="none"):(n.style.display="none",s.style.display="flex");try{$e=Array.isArray(t.ingredients)?t.ingredients:typeof t.ingredients=="string"?JSON.parse(t.ingredients):[]}catch{$e=[]}An(),r.style.display="block"}catch(t){console.error("Error loading meal:",t),Ie("Error loading meal","error")}}}function An(){const e=document.getElementById("editMealIngredients");e&&(e.innerHTML="",$e.forEach((r,t)=>{const a=document.createElement("div");a.className="ingredient-edit-row",a.innerHTML=`
            <div class="ingredient-edit-fields">
                <!-- Food Selection - Full Width -->
                <div class="field-group">
                    <label><strong>Food Selection:</strong></label>
                    <select onchange="updateIngredientFood(${t}, this.value)" style="min-width: 500px; width: 100%; font-size: 16px; padding: 12px;">
                        <option value="">🔍 Select food item...</option>
                        ${Qe.map(n=>`
                            <option value="${n.id}" ${n.id===r.food_id?"selected":""}>
                                ${n.name}${n.brand?` (${n.brand})`:""} - ${n.category}
                            </option>
                        `).join("")}
                    </select>
                </div>
                
                <!-- Nutrition Fields - Horizontal Layout -->
                <div class="ingredient-nutrients-row">
                    <div class="field-group">
                        <label>Quantity (g):</label>
                        <input type="number" value="${r.quantity||1}" min="0.1" step="0.1" 
                               onchange="updateIngredientQuantity(${t}, this.value)" style="font-size: 16px; padding: 8px;">
                    </div>
                    <div class="field-group">
                        <label>Carbs (g):</label>
                        <input type="number" value="${r.carbs||0}" min="0" step="0.1"
                               onchange="updateIngredientNutrient(${t}, 'carbs', this.value)" style="font-size: 16px; padding: 8px;">
                    </div>
                    <div class="field-group">
                        <label>Fat (g):</label>
                        <input type="number" value="${r.fat||0}" min="0" step="0.1"
                               onchange="updateIngredientNutrient(${t}, 'fat', this.value)" style="font-size: 16px; padding: 8px;">
                    </div>
                    <div class="field-group">
                        <label>Protein (g):</label>
                        <input type="number" value="${r.protein||0}" min="0" step="0.1"
                               onchange="updateIngredientNutrient(${t}, 'protein', this.value)" style="font-size: 16px; padding: 8px;">
                    </div>
                </div>
                
                <!-- Instructions - Full Width and Tall -->
                <div class="field-group ingredient-instructions-field">
                    <label><strong>Cooking Instructions for this ingredient:</strong></label>
                    <textarea onchange="updateIngredientInstructions(${t}, this.value)" 
                              rows="8" 
                              placeholder="Enter specific cooking instructions for this ingredient (e.g., 'Cook bacon until crispy', 'Dice onions finely', 'Season with salt and pepper')..."
                              style="width: 100%; min-height: 220px; font-size: 16px; padding: 15px; line-height: 1.6; font-family: inherit; resize: vertical; border: 2px solid #ddd; border-radius: 8px;">${r.instructions||""}</textarea>
                </div>
                
                <!-- Remove Button -->
                <div class="field-group" style="text-align: right; margin-top: 10px;">
                    <button type="button" class="danger-btn" onclick="removeIngredientFromMeal(${t})" style="font-size: 16px; padding: 10px 20px;">
                        🗑️ Remove Ingredient
                    </button>
                </div>
            </div>
        `,e.appendChild(a)}))}function WE(){const e={food_id:"",food_name:"",quantity:1,carbs:0,fat:0,protein:0,instructions:""};$e.push(e),An()}function VE(e){$e.splice(e,1),An()}function GE(e,r){if(!$e[e])return;const t=Qe.find(a=>a.id===r);if(t){const a=$e[e].quantity||1;$e[e]={...$e[e],food_id:t.id,food_name:t.name,carbs:t.carbs*a,fat:t.fat*a,protein:t.protein*a},An()}}function qE(e,r){if(!$e[e])return;const t=parseFloat(r)||0,a=Qe.find(n=>n.id===$e[e].food_id);a?($e[e]={...$e[e],quantity:t,carbs:a.carbs*t,fat:a.fat*t,protein:a.protein*t},An()):$e[e].quantity=t}function zE(e,r,t){$e[e]&&($e[e][r]=parseFloat(t)||0)}function KE(e,r){$e[e]&&($e[e].instructions=r)}async function XE(e){if(e.preventDefault(),!Mt){Ie("No meal selected","error");return}try{let r=Mt.image_url;if(Zr){const o=Zr.name.split(".").pop(),c=`meal_${Mt.id}_${Date.now()}.${o}`,{error:l}=await K.storage.from("meal-images").upload(c,Zr);if(l){console.error("Error uploading image:",l),Ie("Error uploading image","error");return}const{data:f}=K.storage.from("meal-images").getPublicUrl(c);r=f.publicUrl}const t=$e.reduce((o,c)=>o+(c.carbs||0),0),a=$e.reduce((o,c)=>o+(c.fat||0),0),n=$e.reduce((o,c)=>o+(c.protein||0),0),s={name:document.getElementById("editMealName").value.trim(),meal_type:document.getElementById("editMealType").value,cooking_instructions:document.getElementById("editMealInstructions").value.trim()||null,ingredients:$e,total_carbs:t,total_fat:a,total_protein:n,image_url:r,updated_at:new Date().toISOString()},{error:i}=await K.from("meals").update(s).eq("id",Mt.id);if(i)throw i;Ie("Meal updated successfully!","success"),no(),await Oa(Zi)}catch(r){console.error("Error saving meal:",r),Ie("Error saving meal","error")}}async function YE(){if(!Mt){Ie("No meal selected","error");return}if(confirm(`Are you sure you want to delete "${Mt.name}"? This cannot be undone.`))try{const{error:r}=await K.from("meals").delete().eq("id",Mt.id);if(r)throw r;Ie("Meal deleted successfully!","success"),no(),await Oa(Zi)}catch(r){console.error("Error deleting meal:",r),Ie("Error deleting meal","error")}}function JE(e){if(e.files&&e.files[0]){Qr=e.files[0];const r=new FileReader;r.onload=function(t){var s;const a=document.getElementById("editFoodImagePreview"),n=document.getElementById("editFoodImagePlaceholder");(s=t.target)!=null&&s.result&&(a.src=t.target.result,a.style.display="block",n.style.display="none")},r.readAsDataURL(Qr)}}function QE(){Qr=null;const e=document.getElementById("editFoodImagePreview"),r=document.getElementById("editFoodImagePlaceholder"),t=document.getElementById("editFoodImage");e.style.display="none",r.style.display="flex",t.value="",Bt&&(Bt.image_url=null,Bt.image=null,Bt.picture=null),console.log("Food image marked for removal")}function ZE(e){if(e.files&&e.files[0]){Zr=e.files[0];const r=new FileReader;r.onload=function(t){var s;const a=document.getElementById("editMealImagePreview"),n=document.getElementById("editMealImagePlaceholder");(s=t.target)!=null&&s.result&&(a.src=t.target.result,a.style.display="block",n.style.display="none")},r.readAsDataURL(Zr)}}function e2(){Zr=null;const e=document.getElementById("editMealImagePreview"),r=document.getElementById("editMealImagePlaceholder"),t=document.getElementById("editMealImage");e.style.display="none",r.style.display="flex",t.value="",Mt&&(Mt.image_url=null,Mt.image=null,Mt.picture=null),console.log("Meal image marked for removal")}window.openEditFoodModal=LE;window.closeEditFoodModal=ao;window.loadFoodForEdit=ME;window.saveEditedFood=NE;window.deleteEditedFood=$E;window.previewFoodImage=JE;window.removeFoodImage=QE;window.openEditMealModal=UE;window.closeEditMealModal=no;window.loadMealForEdit=HE;window.saveEditedMeal=XE;window.deleteEditedMeal=YE;window.previewMealImage=ZE;window.removeMealImage=e2;window.addIngredientToMeal=WE;window.removeIngredientFromMeal=VE;window.updateIngredientFood=GE;window.updateIngredientQuantity=qE;window.updateIngredientNutrient=zE;window.updateIngredientInstructions=KE;document.addEventListener("DOMContentLoaded",()=>{setTimeout(t2,100)});function t2(){const e=document.createElement("div");e.id="splashScreen",e.style.position="fixed",e.style.top="0",e.style.left="0",e.style.width="100vw",e.style.height="100vh",e.style.background="linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%)",e.style.display="flex",e.style.flexDirection="column",e.style.justifyContent="center",e.style.alignItems="center",e.style.zIndex="9999";const r=document.querySelector('img[src*="nutrivalor_logo"]'),t=r?r.src:"/assets/nutrivalor_logo.png";e.innerHTML=`
    <img src="${t}" alt="NutriValor Logo" style="max-width: 320px; width: 40vw; height: auto; margin-bottom: 1rem;" />
    <div style="font-size: 1.6rem; font-weight: 400; color: #8a99b3; font-family: 'Poppins', sans-serif; font-style: italic;">"Value your Nutrition"</div>
  `,document.body.appendChild(e),setTimeout(()=>{e.style.transition="opacity 0.5s",e.style.opacity="0",setTimeout(()=>e.remove(),500)},2e3)}async function r2(){try{nl(),await il(),await hl(),await Tl(),await $h(),await Yh(),await yf(),await CE(),h2(),x2(),m2(),s2()}catch(e){console.error("❌ Error initializing application:",e)}}async function a2(){var e,r,t,a,n,s,i,o,c;console.log("👤 Updating profile...");try{const l=(e=document.getElementById("profileName"))==null?void 0:e.value,f=(r=document.getElementById("dateOfBirth"))==null?void 0:r.value,u=(t=document.getElementById("profileAge"))==null?void 0:t.value,d=(a=document.getElementById("profileGender"))==null?void 0:a.value,h=(n=document.getElementById("profileHeight"))==null?void 0:n.value,g=(s=document.getElementById("heightUnit"))==null?void 0:s.value,p=(i=document.getElementById("profileIdealWeight"))==null?void 0:i.value,m=(o=document.getElementById("weightUnit"))==null?void 0:o.value,_=(c=document.getElementById("profileCountry"))==null?void 0:c.value,b=document.getElementById("avatarPreview"),v={name:l,dateOfBirth:f,age:u,gender:d,height:h,heightUnit:g,idealWeight:p,weightUnit:m,country:_,avatar:(b==null?void 0:b.src)||null},C=await _l(v),R=document.getElementById("userEmail"),I=document.getElementById("headerAvatar"),T=document.getElementById("headerAvatarPlaceholder");R&&l&&l.trim()&&(R.textContent=l),I&&T&&(v.avatar?(I.src=v.avatar,I.style.display="block",T.style.display="none"):(I.style.display="none",T.style.display="flex")),Ie("Profile updated successfully!","success"),console.log("✅ Profile saved to Supabase:",C)}catch(l){console.error("❌ Error saving profile:",l),Ie("Error saving profile. Please try again.","error")}}async function Mf(){try{const e=await yi();if(e){const r=document.getElementById("profileName"),t=document.getElementById("dateOfBirth"),a=document.getElementById("profileAge"),n=document.getElementById("profileGender"),s=document.getElementById("profileHeight"),i=document.getElementById("heightUnit"),o=document.getElementById("profileIdealWeight"),c=document.getElementById("weightUnit"),l=document.getElementById("profileCountry"),f=document.getElementById("avatarPreview"),u=document.getElementById("avatarPlaceholder"),d=document.getElementById("removeAvatarBtn");r&&(r.value=e.name||""),t&&(t.value=e.date_of_birth||""),a&&(a.value=e.age||""),n&&(n.value=e.gender||""),s&&(s.value=e.height||""),i&&(i.value=e.height_unit||"cm"),o&&(o.value=e.ideal_weight||""),c&&(c.value=e.weight_unit||"kg"),l&&(l.value=e.country||""),e.avatar_url&&f&&u&&(f.src=e.avatar_url,f.style.display="block",u.style.display="none",d&&(d.style.display="inline-flex")),Ie("Profile loaded successfully!","success")}else Ie("No saved profile found","info")}catch(e){console.error("❌ Error loading profile:",e),Ie("Error loading profile","error")}}function n2(){const e=document.getElementById("avatarPreview"),r=document.getElementById("avatarPlaceholder"),t=document.getElementById("removeAvatarBtn"),a=document.getElementById("avatarInput"),n=document.getElementById("headerAvatar"),s=document.getElementById("headerAvatarPlaceholder");e&&r&&(e.style.display="none",e.src="",r.style.display="flex",t&&(t.style.display="none"),a&&(a.value="")),n&&s&&(n.style.display="none",n.src="",s.style.display="flex"),console.log("🗑️ Avatar removed")}function Ie(e,r="info"){const t=document.getElementById("messageToast");t&&(t.textContent=e,t.className=`message-toast ${r}`,t.style.display="block",setTimeout(()=>{t.style.display="none"},3e3))}function s2(){window.showUploadModal=i2,window.closeUploadModal=o2,window.showSection=Nf,window.updateProfile=a2,window.loadProfile=Mf,window.removeAvatar=n2,window.exportData=c2,window.clearAllData=l2,window.reloadMeals=_f,window.clearShoppingList=f2,window.formatText=y2,window.formatEditText=_2,window.removeMealPicture=T2,window.removeEditMealPicture=S2,window.setupMealPictureEventListeners=so}function i2(){const e=document.getElementById("uploadModal");e&&(e.style.display="flex",console.log("📤 Upload modal opened"))}function o2(){const e=document.getElementById("uploadModal");e&&(e.style.display="none",console.log("📤 Upload modal closed"))}function Nf(e){document.querySelectorAll(".nav-tab").forEach(a=>{a.classList.remove("active")}),document.querySelectorAll(".content-section").forEach(a=>{a.classList.remove("active")});const r=document.getElementById(e);r&&r.classList.add("active");const t=document.querySelector(`[data-section="${e}"]`);t&&t.classList.add("active"),e==="shopping-list"?window.updateShoppingListDisplay&&window.updateShoppingListDisplay():e==="admin"&&u2(),console.log(`📍 Switched to section: ${e}`)}function c2(){console.log("💾 Export data")}function l2(){console.log("🗑️ Clear all data")}function f2(){console.log("🗑️ Clear shopping list")}async function u2(){try{console.log("👑 Loading admin section...");const{initializeAdmin:e}=await Ue(async()=>{const{initializeAdmin:r}=await import("./admin-BMDOfuwc.js");return{initializeAdmin:r}},[]);await e(),console.log("✅ Admin section loaded")}catch(e){console.warn("⚠️ Admin initialization had errors, continuing with simple edit system:",e)}await d2()}async function d2(){try{if(console.log("🔧 Ensuring simple edit system is available..."),typeof window.openEditFoodModal=="function"&&typeof window.openEditMealModal=="function"){console.log("✅ Simple edit functions are available");const e=document.querySelector('[onclick*="openEditFoodModal"]'),r=document.querySelector('[onclick*="openEditMealModal"]');console.log(e?"✅ Edit Food button found":"⚠️ Edit Food button not found in DOM"),console.log(r?"✅ Edit Meal button found":"⚠️ Edit Meal button not found in DOM")}else console.error("❌ Simple edit functions not available")}catch(e){console.error("❌ Error initializing simple edit system:",e)}}function h2(){document.addEventListener("click",e=>{const r=e.target;r.classList.contains("modal")&&g2(r)}),document.addEventListener("keydown",e=>{e.key==="Escape"&&p2()})}function g2(e){e.style.display="none"}function p2(){document.querySelectorAll(".modal").forEach(e=>{e.style.display="none"})}function m2(){const e=document.getElementById("avatarPreview"),r=document.getElementById("chooseAvatarBtn"),t=document.getElementById("changeAvatarBtn");r&&(r.style.display="inline-flex"),t&&(t.style.display="none"),e&&e.src&&e.style.display!=="none"&&(r&&(r.style.display="none"),t&&(t.style.display="inline-flex"))}function x2(){const e=document.getElementById("avatarInput");e&&e.addEventListener("change",v2);const r=document.getElementById("dateOfBirth");r&&r.addEventListener("change",w2),setTimeout(()=>{Mf()},1e3)}function v2(e){var a;const t=(a=e.target.files)==null?void 0:a[0];if(t&&t.type.startsWith("image/")){const n=new FileReader;n.onload=s=>{var l;const i=document.getElementById("avatarPreview"),o=document.getElementById("avatarPlaceholder"),c=document.getElementById("removeAvatarBtn");i&&o&&((l=s.target)!=null&&l.result)&&(i.src=s.target.result,i.style.display="block",o.style.display="none",c&&(c.style.display="block"))},n.readAsDataURL(t)}else Ie("Please select a valid image file","error")}function w2(){const e=document.getElementById("dateOfBirth"),r=document.getElementById("profileAge");if(e&&r&&e.value){const t=new Date(e.value),a=new Date;let n=a.getFullYear()-t.getFullYear();const s=a.getMonth()-t.getMonth();(s<0||s===0&&a.getDate()<t.getDate())&&n--,r.value=n.toString()}}function y2(e){const r=document.getElementById("cookingInstructions"),t=document.getElementById("cookingInstructionsHidden");r&&(r.focus(),document.execCommand(e,!1),t&&(t.value=r.innerHTML))}function _2(e){const r=document.getElementById("editCookingInstructions"),t=document.getElementById("editCookingInstructionsHidden");r&&(r.focus(),document.execCommand(e,!1),t&&(t.value=r.innerHTML))}function E2(){const e=document.getElementById("cookingInstructions"),r=document.getElementById("cookingInstructionsHidden");e&&r&&(e.addEventListener("input",()=>{r.value=e.innerHTML}),e.addEventListener("paste",n=>{n.preventDefault();const s=(n.clipboardData||window.clipboardData).getData("text/plain");document.execCommand("insertText",!1,s)}));const t=document.getElementById("editCookingInstructions"),a=document.getElementById("editCookingInstructionsHidden");t&&a&&(t.addEventListener("input",()=>{a.value=t.innerHTML}),t.addEventListener("paste",n=>{n.preventDefault();const s=(n.clipboardData||window.clipboardData).getData("text/plain");document.execCommand("insertText",!1,s)}))}function so(){const e=document.getElementById("mealPictureFile");e&&e.addEventListener("change",k2)}function k2(e){var a;console.log("🖼️ Main meal picture upload triggered");const t=(a=e.target.files)==null?void 0:a[0];if(console.log("📁 Selected file:",t==null?void 0:t.name,t==null?void 0:t.type),t&&t.type.startsWith("image/")){console.log("✅ Valid image file detected");const n=new FileReader;n.onload=s=>{var f;console.log("📖 File read complete");const i=document.getElementById("mealPicturePreview"),o=document.getElementById("mealPicturePlaceholder"),c=document.getElementById("removeMealPictureBtn"),l=document.getElementById("mealPicture");console.log("🔍 Elements found:",{preview:!!i,placeholder:!!o,removeBtn:!!c,hiddenInput:!!l}),i&&o&&((f=s.target)!=null&&f.result)?(i.src=s.target.result,i.style.display="block",o.style.display="none",c&&(c.style.display="block"),l&&(l.value=s.target.result),console.log("✅ Image preview updated successfully")):console.error("❌ Missing required elements for image preview")},n.readAsDataURL(t)}else console.error("❌ Invalid file type:",t==null?void 0:t.type),Ie("Please select a valid image file","error")}function T2(){const e=document.getElementById("mealPicturePreview"),r=document.getElementById("mealPicturePlaceholder"),t=document.getElementById("removeMealPictureBtn"),a=document.getElementById("mealPicture"),n=document.getElementById("mealPictureFile");e&&(e.style.display="none"),r&&(r.style.display="block"),t&&(t.style.display="none"),a&&(a.value=""),n&&(n.value="")}function S2(){const e=document.getElementById("editMealPicturePreview"),r=document.getElementById("editMealPicturePlaceholder"),t=document.getElementById("removeEditMealPictureBtn"),a=document.getElementById("editMealPicture"),n=document.getElementById("editMealPictureFile");e&&(e.style.display="none"),r&&(r.style.display="block"),t&&(t.style.display="none"),a&&(a.value=""),n&&(n.value="")}r2();setTimeout(()=>{E2(),so()},2e3);const Oc=document.querySelector(`[onclick="showSection('admin')"]`);Oc&&Oc.addEventListener("click",()=>{setTimeout(()=>{so()},500)});window.showSection=Nf;const A2=Object.freeze(Object.defineProperty({__proto__:null,showMessage:Ie},Symbol.toStringTag,{value:"Module"}));export{Ca as a,fl as b,ul as g,pi as i,Ur as l,K as s};
//# sourceMappingURL=main-BI8YSnDa.js.map
