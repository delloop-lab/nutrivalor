(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function r(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(n){if(n.ep)return;n.ep=!0;const s=r(n);fetch(n.href,s)}})();const lf="modulepreload",ff=function(e){return"/"+e},ji={},$r=function(t,r,a){let n=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),o=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));n=Promise.allSettled(r.map(c=>{if(c=ff(c),c in ji)return;ji[c]=!0;const l=c.endsWith(".css"),f=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${f}`))return;const u=document.createElement("link");if(u.rel=l?"stylesheet":lf,l||(u.as="script"),u.crossOrigin="",u.href=c,o&&u.setAttribute("nonce",o),document.head.appendChild(u),l)return new Promise((h,d)=>{u.addEventListener("load",h),u.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(i){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i}return n.then(i=>{for(const o of i||[])o.status==="rejected"&&s(o.reason);return t().catch(s)})},uf=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>$r(async()=>{const{default:a}=await Promise.resolve().then(()=>ma);return{default:a}},void 0).then(({default:a})=>a(...r)):t=fetch,(...r)=>t(...r)};class Hs extends Error{constructor(t,r="FunctionsError",a){super(t),this.name=r,this.context=a}}class hf extends Hs{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class df extends Hs{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class pf extends Hs{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var ks;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(ks||(ks={}));var gf=function(e,t,r,a){function n(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(f){try{l(a.next(f))}catch(u){i(u)}}function c(f){try{l(a.throw(f))}catch(u){i(u)}}function l(f){f.done?s(f.value):n(f.value).then(o,c)}l((a=a.apply(e,t||[])).next())})};class xf{constructor(t,{headers:r={},customFetch:a,region:n=ks.Any}={}){this.url=t,this.headers=r,this.region=n,this.fetch=uf(a)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var a;return gf(this,void 0,void 0,function*(){try{const{headers:n,method:s,body:i}=r;let o={},{region:c}=r;c||(c=this.region),c&&c!=="any"&&(o["x-region"]=c);let l;i&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&(typeof Blob<"u"&&i instanceof Blob||i instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",l=i):typeof i=="string"?(o["Content-Type"]="text/plain",l=i):typeof FormData<"u"&&i instanceof FormData?l=i:(o["Content-Type"]="application/json",l=JSON.stringify(i)));const f=yield this.fetch(`${this.url}/${t}`,{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),n),body:l}).catch(g=>{throw new hf(g)}),u=f.headers.get("x-relay-error");if(u&&u==="true")throw new df(f);if(!f.ok)throw new pf(f);let h=((a=f.headers.get("Content-Type"))!==null&&a!==void 0?a:"text/plain").split(";")[0].trim(),d;return h==="application/json"?d=yield f.json():h==="application/octet-stream"?d=yield f.blob():h==="text/event-stream"?d=f:h==="multipart/form-data"?d=yield f.formData():d=yield f.text(),{data:d,error:null}}catch(n){return{data:null,error:n}}})}}var Br=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function mf(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function a(){return this instanceof a?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(a){var n=Object.getOwnPropertyDescriptor(e,a);Object.defineProperty(r,a,n.get?n:{enumerable:!0,get:function(){return e[a]}})}),r}var Er={},Vs={},zn={},on={},qn={},Xn={},vf=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},pa=vf();const wf=pa.fetch,hc=pa.fetch.bind(pa),dc=pa.Headers,_f=pa.Request,yf=pa.Response,ma=Object.freeze(Object.defineProperty({__proto__:null,Headers:dc,Request:_f,Response:yf,default:hc,fetch:wf},Symbol.toStringTag,{value:"Module"})),Ef=mf(ma);var Kn={};Object.defineProperty(Kn,"__esModule",{value:!0});let kf=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};Kn.default=kf;var pc=Br&&Br.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Xn,"__esModule",{value:!0});const Tf=pc(Ef),Sf=pc(Kn);let Af=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=Tf.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=Object.assign({},this.headers),this.headers[t]=r,this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const a=this.fetch;let n=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{var i,o,c;let l=null,f=null,u=null,h=s.status,d=s.statusText;if(s.ok){if(this.method!=="HEAD"){const y=await s.text();y===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?f=y:f=JSON.parse(y))}const p=(i=this.headers.Prefer)===null||i===void 0?void 0:i.match(/count=(exact|planned|estimated)/),x=(o=s.headers.get("content-range"))===null||o===void 0?void 0:o.split("/");p&&x&&x.length>1&&(u=parseInt(x[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(f)&&(f.length>1?(l={code:"PGRST116",details:`Results contain ${f.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},f=null,u=null,h=406,d="Not Acceptable"):f.length===1?f=f[0]:f=null)}else{const p=await s.text();try{l=JSON.parse(p),Array.isArray(l)&&s.status===404&&(f=[],l=null,h=200,d="OK")}catch{s.status===404&&p===""?(h=204,d="No Content"):l={message:p}}if(l&&this.isMaybeSingle&&(!((c=l==null?void 0:l.details)===null||c===void 0)&&c.includes("0 rows"))&&(l=null,h=200,d="OK"),l&&this.shouldThrowOnError)throw new Sf.default(l)}return{error:l,data:f,count:u,status:h,statusText:d}});return this.shouldThrowOnError||(n=n.catch(s=>{var i,o,c;return{error:{message:`${(i=s==null?void 0:s.name)!==null&&i!==void 0?i:"FetchError"}: ${s==null?void 0:s.message}`,details:`${(o=s==null?void 0:s.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(c=s==null?void 0:s.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),n.then(t,r)}returns(){return this}overrideTypes(){return this}};Xn.default=Af;var bf=Br&&Br.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(qn,"__esModule",{value:!0});const Ff=bf(Xn);let Cf=class extends Ff.default{select(t){let r=!1;const a=(t??"*").split("").map(n=>/\s/.test(n)&&!r?"":(n==='"'&&(r=!r),n)).join("");return this.url.searchParams.set("select",a),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:r=!0,nullsFirst:a,foreignTable:n,referencedTable:s=n}={}){const i=s?`${s}.order`:"order",o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${t}.${r?"asc":"desc"}${a===void 0?"":a?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:a=r}={}){const n=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(n,`${t}`),this}range(t,r,{foreignTable:a,referencedTable:n=a}={}){const s=typeof n>"u"?"offset":`${n}.offset`,i=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(s,`${t}`),this.url.searchParams.set(i,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:r=!1,settings:a=!1,buffers:n=!1,wal:s=!1,format:i="text"}={}){var o;const c=[t?"analyze":null,r?"verbose":null,a?"settings":null,n?"buffers":null,s?"wal":null].filter(Boolean).join("|"),l=(o=this.headers.Accept)!==null&&o!==void 0?o:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${i}; for="${l}"; options=${c};`,i==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};qn.default=Cf;var If=Br&&Br.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(on,"__esModule",{value:!0});const Of=If(qn);let Df=class extends Of.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const a=Array.from(new Set(r)).map(n=>typeof n=="string"&&new RegExp("[,()]").test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(t,`in.(${a})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:a,type:n}={}){let s="";n==="plain"?s="pl":n==="phrase"?s="ph":n==="websearch"&&(s="w");const i=a===void 0?"":`(${a})`;return this.url.searchParams.append(t,`${s}fts${i}.${r}`),this}match(t){return Object.entries(t).forEach(([r,a])=>{this.url.searchParams.append(r,`eq.${a}`)}),this}not(t,r,a){return this.url.searchParams.append(t,`not.${r}.${a}`),this}or(t,{foreignTable:r,referencedTable:a=r}={}){const n=a?`${a}.or`:"or";return this.url.searchParams.append(n,`(${t})`),this}filter(t,r,a){return this.url.searchParams.append(t,`${r}.${a}`),this}};on.default=Df;var Rf=Br&&Br.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(zn,"__esModule",{value:!0});const Fa=Rf(on);let Pf=class{constructor(t,{headers:r={},schema:a,fetch:n}){this.url=t,this.headers=r,this.schema=a,this.fetch=n}select(t,{head:r=!1,count:a}={}){const n=r?"HEAD":"GET";let s=!1;const i=(t??"*").split("").map(o=>/\s/.test(o)&&!s?"":(o==='"'&&(s=!s),o)).join("");return this.url.searchParams.set("select",i),a&&(this.headers.Prefer=`count=${a}`),new Fa.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:r,defaultToNull:a=!0}={}){const n="POST",s=[];if(this.headers.Prefer&&s.push(this.headers.Prefer),r&&s.push(`count=${r}`),a||s.push("missing=default"),this.headers.Prefer=s.join(","),Array.isArray(t)){const i=t.reduce((o,c)=>o.concat(Object.keys(c)),[]);if(i.length>0){const o=[...new Set(i)].map(c=>`"${c}"`);this.url.searchParams.set("columns",o.join(","))}}return new Fa.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:r,ignoreDuplicates:a=!1,count:n,defaultToNull:s=!0}={}){const i="POST",o=[`resolution=${a?"ignore":"merge"}-duplicates`];if(r!==void 0&&this.url.searchParams.set("on_conflict",r),this.headers.Prefer&&o.push(this.headers.Prefer),n&&o.push(`count=${n}`),s||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(t)){const c=t.reduce((l,f)=>l.concat(Object.keys(f)),[]);if(c.length>0){const l=[...new Set(c)].map(f=>`"${f}"`);this.url.searchParams.set("columns",l.join(","))}}return new Fa.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:r}={}){const a="PATCH",n=[];return this.headers.Prefer&&n.push(this.headers.Prefer),r&&n.push(`count=${r}`),this.headers.Prefer=n.join(","),new Fa.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const r="DELETE",a=[];return t&&a.push(`count=${t}`),this.headers.Prefer&&a.unshift(this.headers.Prefer),this.headers.Prefer=a.join(","),new Fa.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};zn.default=Pf;var Yn={},Jn={};Object.defineProperty(Jn,"__esModule",{value:!0});Jn.version=void 0;Jn.version="0.0.0-automated";Object.defineProperty(Yn,"__esModule",{value:!0});Yn.DEFAULT_HEADERS=void 0;const Lf=Jn;Yn.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${Lf.version}`};var gc=Br&&Br.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Vs,"__esModule",{value:!0});const Nf=gc(zn),Bf=gc(on),Mf=Yn;let $f=class xc{constructor(t,{headers:r={},schema:a,fetch:n}={}){this.url=t,this.headers=Object.assign(Object.assign({},Mf.DEFAULT_HEADERS),r),this.schemaName=a,this.fetch=n}from(t){const r=new URL(`${this.url}/${t}`);return new Nf.default(r,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new xc(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:a=!1,get:n=!1,count:s}={}){let i;const o=new URL(`${this.url}/rpc/${t}`);let c;a||n?(i=a?"HEAD":"GET",Object.entries(r).filter(([f,u])=>u!==void 0).map(([f,u])=>[f,Array.isArray(u)?`{${u.join(",")}}`:`${u}`]).forEach(([f,u])=>{o.searchParams.append(f,u)})):(i="POST",c=r);const l=Object.assign({},this.headers);return s&&(l.Prefer=`count=${s}`),new Bf.default({method:i,url:o,headers:l,schema:this.schemaName,body:c,fetch:this.fetch,allowEmpty:!1})}};Vs.default=$f;var va=Br&&Br.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Er,"__esModule",{value:!0});Er.PostgrestError=Er.PostgrestBuilder=Er.PostgrestTransformBuilder=Er.PostgrestFilterBuilder=Er.PostgrestQueryBuilder=Er.PostgrestClient=void 0;const mc=va(Vs);Er.PostgrestClient=mc.default;const vc=va(zn);Er.PostgrestQueryBuilder=vc.default;const wc=va(on);Er.PostgrestFilterBuilder=wc.default;const _c=va(qn);Er.PostgrestTransformBuilder=_c.default;const yc=va(Xn);Er.PostgrestBuilder=yc.default;const Ec=va(Kn);Er.PostgrestError=Ec.default;var Uf=Er.default={PostgrestClient:mc.default,PostgrestQueryBuilder:vc.default,PostgrestFilterBuilder:wc.default,PostgrestTransformBuilder:_c.default,PostgrestBuilder:yc.default,PostgrestError:Ec.default};const{PostgrestClient:jf,PostgrestQueryBuilder:ly,PostgrestFilterBuilder:fy,PostgrestTransformBuilder:uy,PostgrestBuilder:hy,PostgrestError:dy}=Uf;function Wf(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const Hf=Wf(),Vf="2.11.15",Gf=`realtime-js/${Vf}`,zf="1.0.0",kc=1e4,qf=1e3;var La;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(La||(La={}));var ir;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(ir||(ir={}));var Vr;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Vr||(Vr={}));var Ts;(function(e){e.websocket="websocket"})(Ts||(Ts={}));var Bt;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Bt||(Bt={}));class Xf{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),a=new TextDecoder;return this._decodeBroadcast(t,r,a)}_decodeBroadcast(t,r,a){const n=r.getUint8(1),s=r.getUint8(2);let i=this.HEADER_LENGTH+2;const o=a.decode(t.slice(i,i+n));i=i+n;const c=a.decode(t.slice(i,i+s));i=i+s;const l=JSON.parse(a.decode(t.slice(i,t.byteLength)));return{ref:null,topic:o,event:c,payload:l}}}class Tc{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Fe;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Fe||(Fe={}));const Wi=(e,t,r={})=>{var a;const n=(a=r.skipTypes)!==null&&a!==void 0?a:[];return Object.keys(t).reduce((s,i)=>(s[i]=Kf(i,e,t,n),s),{})},Kf=(e,t,r,a)=>{const n=t.find(o=>o.name===e),s=n==null?void 0:n.type,i=r[e];return s&&!a.includes(s)?Sc(s,i):Ss(i)},Sc=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return Qf(t,r)}switch(e){case Fe.bool:return Yf(t);case Fe.float4:case Fe.float8:case Fe.int2:case Fe.int4:case Fe.int8:case Fe.numeric:case Fe.oid:return Jf(t);case Fe.json:case Fe.jsonb:return Zf(t);case Fe.timestamp:return eu(t);case Fe.abstime:case Fe.date:case Fe.daterange:case Fe.int4range:case Fe.int8range:case Fe.money:case Fe.reltime:case Fe.text:case Fe.time:case Fe.timestamptz:case Fe.timetz:case Fe.tsrange:case Fe.tstzrange:return Ss(t);default:return Ss(t)}},Ss=e=>e,Yf=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},Jf=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},Zf=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},Qf=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,a=e[r];if(e[0]==="{"&&a==="}"){let s;const i=e.slice(1,r);try{s=JSON.parse("["+i+"]")}catch{s=i?i.split(","):[]}return s.map(o=>Sc(t,o))}return e},eu=e=>typeof e=="string"?e.replace(" ","T"):e,Ac=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class is{constructor(t,r,a={},n=kc){this.channel=t,this.event=r,this.payload=a,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var a;return this._hasReceived(t)&&r((a=this.receivedResp)===null||a===void 0?void 0:a.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(a=>a.status===t).forEach(a=>a.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Hi;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Hi||(Hi={}));class Na{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const a=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(a.state,{},n=>{const{onJoin:s,onLeave:i,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Na.syncState(this.state,n,s,i),this.pendingDiffs.forEach(c=>{this.state=Na.syncDiff(this.state,c,s,i)}),this.pendingDiffs=[],o()}),this.channel._on(a.diff,{},n=>{const{onJoin:s,onLeave:i,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=Na.syncDiff(this.state,n,s,i),o())}),this.onJoin((n,s,i)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:s,newPresences:i})}),this.onLeave((n,s,i)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:s,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,a,n){const s=this.cloneDeep(t),i=this.transformState(r),o={},c={};return this.map(s,(l,f)=>{i[l]||(c[l]=f)}),this.map(i,(l,f)=>{const u=s[l];if(u){const h=f.map(x=>x.presence_ref),d=u.map(x=>x.presence_ref),g=f.filter(x=>d.indexOf(x.presence_ref)<0),p=u.filter(x=>h.indexOf(x.presence_ref)<0);g.length>0&&(o[l]=g),p.length>0&&(c[l]=p)}else o[l]=f}),this.syncDiff(s,{joins:o,leaves:c},a,n)}static syncDiff(t,r,a,n){const{joins:s,leaves:i}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return a||(a=()=>{}),n||(n=()=>{}),this.map(s,(o,c)=>{var l;const f=(l=t[o])!==null&&l!==void 0?l:[];if(t[o]=this.cloneDeep(c),f.length>0){const u=t[o].map(d=>d.presence_ref),h=f.filter(d=>u.indexOf(d.presence_ref)<0);t[o].unshift(...h)}a(o,f,c)}),this.map(i,(o,c)=>{let l=t[o];if(!l)return;const f=c.map(u=>u.presence_ref);l=l.filter(u=>f.indexOf(u.presence_ref)<0),t[o]=l,n(o,l,c),l.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(a=>r(a,t[a]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,a)=>{const n=t[a];return"metas"in n?r[a]=n.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[a]=n,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Vi;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(Vi||(Vi={}));var Gi;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Gi||(Gi={}));var ct;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(ct||(ct={}));class Gs{constructor(t,r={config:{}},a){this.topic=t,this.params=r,this.socket=a,this.bindings={},this.state=ir.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new is(this,Vr.join,this.params,this.timeout),this.rejoinTimer=new Tc(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ir.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(n=>n.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ir.closed,this.socket._remove(this)}),this._onError(n=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=ir.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ir.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Vr.reply,{},(n,s)=>{this._trigger(this._replyEventName(s),n)}),this.presence=new Na(this),this.broadcastEndpointURL=Ac(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var a,n;if(this.socket.isConnected()||this.socket.connect(),this.state==ir.closed){const{config:{broadcast:s,presence:i,private:o}}=this.params;this._onError(f=>t==null?void 0:t(ct.CHANNEL_ERROR,f)),this._onClose(()=>t==null?void 0:t(ct.CLOSED));const c={},l={broadcast:s,presence:i,postgres_changes:(n=(a=this.bindings.postgres_changes)===null||a===void 0?void 0:a.map(f=>f.filter))!==null&&n!==void 0?n:[],private:o};this.socket.accessTokenValue&&(c.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:l},c)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:f})=>{var u;if(this.socket.setAuth(),f===void 0){t==null||t(ct.SUBSCRIBED);return}else{const h=this.bindings.postgres_changes,d=(u=h==null?void 0:h.length)!==null&&u!==void 0?u:0,g=[];for(let p=0;p<d;p++){const x=h[p],{filter:{event:y,schema:F,table:v,filter:C}}=x,P=f&&f[p];if(P&&P.event===y&&P.schema===F&&P.table===v&&P.filter===C)g.push(Object.assign(Object.assign({},x),{id:P.id}));else{this.unsubscribe(),this.state=ir.errored,t==null||t(ct.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=g,t&&t(ct.SUBSCRIBED);return}}).receive("error",f=>{this.state=ir.errored,t==null||t(ct.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(f).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(ct.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,a){return this._on(t,r,a)}async send(t,r={}){var a,n;if(!this._canPush()&&t.type==="broadcast"){const{event:s,payload:i}=t,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:i,private:this.private}]})};try{const l=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(a=r.timeout)!==null&&a!==void 0?a:this.timeout);return await((n=l.body)===null||n===void 0?void 0:n.cancel()),l.ok?"ok":"error"}catch(l){return l.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var i,o,c;const l=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(o=(i=this.params)===null||i===void 0?void 0:i.config)===null||o===void 0?void 0:o.broadcast)===null||c===void 0)&&c.ack)&&s("ok"),l.receive("ok",()=>s("ok")),l.receive("error",()=>s("error")),l.receive("timeout",()=>s("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=ir.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Vr.close,"leave",this._joinRef())};this.joinPush.destroy();let a=null;return new Promise(n=>{a=new is(this,Vr.leave,{},t),a.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),a.send(),this._canPush()||a.trigger("ok",{})}).finally(()=>{a==null||a.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(t,r,a){const n=new AbortController,s=setTimeout(()=>n.abort(),a),i=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:n.signal}));return clearTimeout(s),i}_push(t,r,a=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new is(this,t,r,a);return this._canPush()?n.send():(n.startTimeout(),this.pushBuffer.push(n)),n}_onMessage(t,r,a){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,a){var n,s;const i=t.toLocaleLowerCase(),{close:o,error:c,leave:l,join:f}=Vr;if(a&&[o,c,l,f].indexOf(i)>=0&&a!==this._joinRef())return;let h=this._onMessage(i,r,a);if(r&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(d=>{var g,p,x;return((g=d.filter)===null||g===void 0?void 0:g.event)==="*"||((x=(p=d.filter)===null||p===void 0?void 0:p.event)===null||x===void 0?void 0:x.toLocaleLowerCase())===i}).map(d=>d.callback(h,a)):(s=this.bindings[i])===null||s===void 0||s.filter(d=>{var g,p,x,y,F,v;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in d){const C=d.id,P=(g=d.filter)===null||g===void 0?void 0:g.event;return C&&((p=r.ids)===null||p===void 0?void 0:p.includes(C))&&(P==="*"||(P==null?void 0:P.toLocaleLowerCase())===((x=r.data)===null||x===void 0?void 0:x.type.toLocaleLowerCase()))}else{const C=(F=(y=d==null?void 0:d.filter)===null||y===void 0?void 0:y.event)===null||F===void 0?void 0:F.toLocaleLowerCase();return C==="*"||C===((v=r==null?void 0:r.event)===null||v===void 0?void 0:v.toLocaleLowerCase())}else return d.type.toLocaleLowerCase()===i}).map(d=>{if(typeof h=="object"&&"ids"in h){const g=h.data,{schema:p,table:x,commit_timestamp:y,type:F,errors:v}=g;h=Object.assign(Object.assign({},{schema:p,table:x,commit_timestamp:y,eventType:F,new:{},old:{},errors:v}),this._getPayloadRecords(g))}d.callback(h,a)})}_isClosed(){return this.state===ir.closed}_isJoined(){return this.state===ir.joined}_isJoining(){return this.state===ir.joining}_isLeaving(){return this.state===ir.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,a){const n=t.toLocaleLowerCase(),s={type:n,filter:r,callback:a};return this.bindings[n]?this.bindings[n].push(s):this.bindings[n]=[s],this}_off(t,r){const a=t.toLocaleLowerCase();return this.bindings[a]=this.bindings[a].filter(n=>{var s;return!(((s=n.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===a&&Gs.isEqual(n.filter,r))}),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const a in t)if(t[a]!==r[a])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Vr.close,{},t)}_onError(t){this._on(Vr.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ir.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=Wi(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=Wi(t.columns,t.old_record)),r}}const zi=()=>{},ru=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class tu{constructor(t,r){var a;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=kc,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=zi,this.ref=0,this.logger=zi,this.conn=null,this.sendBuffer=[],this.serializer=new Xf,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=s=>{let i;return s?i=s:typeof fetch>"u"?i=(...o)=>$r(async()=>{const{default:c}=await Promise.resolve().then(()=>ma);return{default:c}},void 0).then(({default:c})=>c(...o)):i=fetch,(...o)=>i(...o)},this.endPoint=`${t}/${Ts.websocket}`,this.httpEndpoint=Ac(t),r!=null&&r.transport?this.transport=r.transport:this.transport=null,r!=null&&r.params&&(this.params=r.params),r!=null&&r.timeout&&(this.timeout=r.timeout),r!=null&&r.logger&&(this.logger=r.logger),(r!=null&&r.logLevel||r!=null&&r.log_level)&&(this.logLevel=r.logLevel||r.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),r!=null&&r.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const n=(a=r==null?void 0:r.params)===null||a===void 0?void 0:a.apikey;if(n&&(this.accessTokenValue=n,this.apiKey=n),this.reconnectAfterMs=r!=null&&r.reconnectAfterMs?r.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=r!=null&&r.encode?r.encode:(s,i)=>i(JSON.stringify(s)),this.decode=r!=null&&r.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Tc(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r==null?void 0:r.fetch),r!=null&&r.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(r==null?void 0:r.worker)||!1,this.workerUrl=r==null?void 0:r.workerUrl}this.accessToken=(r==null?void 0:r.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=Hf),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:zf}))}disconnect(t,r){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(a=>a.teardown()))}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,a){this.logger(t,r,a)}connectionState(){switch(this.conn&&this.conn.readyState){case La.connecting:return Bt.Connecting;case La.open:return Bt.Open;case La.closing:return Bt.Closing;default:return Bt.Closed}}isConnected(){return this.connectionState()===Bt.Open}channel(t,r={config:{}}){const a=`realtime:${t}`,n=this.getChannels().find(s=>s.topic===a);if(n)return n;{const s=new Gs(`realtime:${t}`,r,this);return this.channels.push(s),s}}push(t){const{topic:r,event:a,payload:n,ref:s}=t,i=()=>{this.encode(t,o=>{var c;(c=this.conn)===null||c===void 0||c.send(o)})};this.log("push",`${r} ${a} (${s})`,n),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(t=null){let r=t||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(a=>{const n={access_token:r,version:Gf};r&&a.updateJoinPayload(n),a.joinedOnce&&a._isJoined()&&a._push(Vr.access_token,{access_token:r})}))}async sendHeartbeat(){var t;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(t=this.conn)===null||t===void 0||t.close(qf,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(a=>a.topic===t&&(a._isJoined()||a._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,r=>{let{topic:a,event:n,payload:s,ref:i}=r;a==="phoenix"&&n==="phx_reply"&&this.heartbeatCallback(r.payload.status=="ok"?"ok":"error"),i&&i===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${s.status||""} ${a} ${n} ${i&&"("+i+")"||""}`,s),Array.from(this.channels).filter(o=>o._isMember(a)).forEach(o=>o._trigger(n,s,i)),this.stateChangeCallbacks.message.forEach(o=>o(r))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(t=>t())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(t))}_onConnError(t){this.log("transport",`${t}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(Vr.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const a=t.match(/\?/)?"&":"?",n=new URLSearchParams(r);return`${t}${a}${n}`}_workerObjectUrl(t){let r;if(t)r=t;else{const a=new Blob([ru],{type:"application/javascript"});r=URL.createObjectURL(a)}return r}}class zs extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Ke(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class au extends zs{constructor(t,r){super(t),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class As extends zs{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var nu=function(e,t,r,a){function n(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(f){try{l(a.next(f))}catch(u){i(u)}}function c(f){try{l(a.throw(f))}catch(u){i(u)}}function l(f){f.done?s(f.value):n(f.value).then(o,c)}l((a=a.apply(e,t||[])).next())})};const bc=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>$r(async()=>{const{default:a}=await Promise.resolve().then(()=>ma);return{default:a}},void 0).then(({default:a})=>a(...r)):t=fetch,(...r)=>t(...r)},su=()=>nu(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield $r(()=>Promise.resolve().then(()=>ma),void 0)).Response:Response}),bs=e=>{if(Array.isArray(e))return e.map(r=>bs(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,a])=>{const n=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));t[n]=bs(a)}),t};var zt=function(e,t,r,a){function n(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(f){try{l(a.next(f))}catch(u){i(u)}}function c(f){try{l(a.throw(f))}catch(u){i(u)}}function l(f){f.done?s(f.value):n(f.value).then(o,c)}l((a=a.apply(e,t||[])).next())})};const os=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),iu=(e,t,r)=>zt(void 0,void 0,void 0,function*(){const a=yield su();e instanceof a&&!(r!=null&&r.noResolveJson)?e.json().then(n=>{t(new au(os(n),e.status||500))}).catch(n=>{t(new As(os(n),n))}):t(new As(os(e),e))}),ou=(e,t,r,a)=>{const n={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),a&&(n.body=JSON.stringify(a)),Object.assign(Object.assign({},n),r))};function cn(e,t,r,a,n,s){return zt(this,void 0,void 0,function*(){return new Promise((i,o)=>{e(r,ou(t,a,n,s)).then(c=>{if(!c.ok)throw c;return a!=null&&a.noResolveJson?c:c.json()}).then(c=>i(c)).catch(c=>iu(c,o,a))})})}function Rn(e,t,r,a){return zt(this,void 0,void 0,function*(){return cn(e,"GET",t,r,a)})}function _t(e,t,r,a,n){return zt(this,void 0,void 0,function*(){return cn(e,"POST",t,a,n,r)})}function cu(e,t,r,a,n){return zt(this,void 0,void 0,function*(){return cn(e,"PUT",t,a,n,r)})}function lu(e,t,r,a){return zt(this,void 0,void 0,function*(){return cn(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),a)})}function Fc(e,t,r,a,n){return zt(this,void 0,void 0,function*(){return cn(e,"DELETE",t,a,n,r)})}var _r=function(e,t,r,a){function n(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(f){try{l(a.next(f))}catch(u){i(u)}}function c(f){try{l(a.throw(f))}catch(u){i(u)}}function l(f){f.done?s(f.value):n(f.value).then(o,c)}l((a=a.apply(e,t||[])).next())})};const fu={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},qi={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class uu{constructor(t,r={},a,n){this.url=t,this.headers=r,this.bucketId=a,this.fetch=bc(n)}uploadOrUpdate(t,r,a,n){return _r(this,void 0,void 0,function*(){try{let s;const i=Object.assign(Object.assign({},qi),n);let o=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(i.upsert)});const c=i.metadata;typeof Blob<"u"&&a instanceof Blob?(s=new FormData,s.append("cacheControl",i.cacheControl),c&&s.append("metadata",this.encodeMetadata(c)),s.append("",a)):typeof FormData<"u"&&a instanceof FormData?(s=a,s.append("cacheControl",i.cacheControl),c&&s.append("metadata",this.encodeMetadata(c))):(s=a,o["cache-control"]=`max-age=${i.cacheControl}`,o["content-type"]=i.contentType,c&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),n!=null&&n.headers&&(o=Object.assign(Object.assign({},o),n.headers));const l=this._removeEmptyFolders(r),f=this._getFinalPath(l),u=yield this.fetch(`${this.url}/object/${f}`,Object.assign({method:t,body:s,headers:o},i!=null&&i.duplex?{duplex:i.duplex}:{})),h=yield u.json();return u.ok?{data:{path:l,id:h.Id,fullPath:h.Key},error:null}:{data:null,error:h}}catch(s){if(Ke(s))return{data:null,error:s};throw s}})}upload(t,r,a){return _r(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,a)})}uploadToSignedUrl(t,r,a,n){return _r(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(t),i=this._getFinalPath(s),o=new URL(this.url+`/object/upload/sign/${i}`);o.searchParams.set("token",r);try{let c;const l=Object.assign({upsert:qi.upsert},n),f=Object.assign(Object.assign({},this.headers),{"x-upsert":String(l.upsert)});typeof Blob<"u"&&a instanceof Blob?(c=new FormData,c.append("cacheControl",l.cacheControl),c.append("",a)):typeof FormData<"u"&&a instanceof FormData?(c=a,c.append("cacheControl",l.cacheControl)):(c=a,f["cache-control"]=`max-age=${l.cacheControl}`,f["content-type"]=l.contentType);const u=yield this.fetch(o.toString(),{method:"PUT",body:c,headers:f}),h=yield u.json();return u.ok?{data:{path:s,fullPath:h.Key},error:null}:{data:null,error:h}}catch(c){if(Ke(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(t,r){return _r(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t);const n=Object.assign({},this.headers);r!=null&&r.upsert&&(n["x-upsert"]="true");const s=yield _t(this.fetch,`${this.url}/object/upload/sign/${a}`,{},{headers:n}),i=new URL(this.url+s.url),o=i.searchParams.get("token");if(!o)throw new zs("No token returned by API");return{data:{signedUrl:i.toString(),path:t,token:o},error:null}}catch(a){if(Ke(a))return{data:null,error:a};throw a}})}update(t,r,a){return _r(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,a)})}move(t,r,a){return _r(this,void 0,void 0,function*(){try{return{data:yield _t(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:a==null?void 0:a.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(Ke(n))return{data:null,error:n};throw n}})}copy(t,r,a){return _r(this,void 0,void 0,function*(){try{return{data:{path:(yield _t(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:a==null?void 0:a.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(Ke(n))return{data:null,error:n};throw n}})}createSignedUrl(t,r,a){return _r(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t),s=yield _t(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:r},a!=null&&a.transform?{transform:a.transform}:{}),{headers:this.headers});const i=a!=null&&a.download?`&download=${a.download===!0?"":a.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${i}`)},{data:s,error:null}}catch(n){if(Ke(n))return{data:null,error:n};throw n}})}createSignedUrls(t,r,a){return _r(this,void 0,void 0,function*(){try{const n=yield _t(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),s=a!=null&&a.download?`&download=${a.download===!0?"":a.download}`:"";return{data:n.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${s}`):null})),error:null}}catch(n){if(Ke(n))return{data:null,error:n};throw n}})}download(t,r){return _r(this,void 0,void 0,function*(){const n=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),i=s?`?${s}`:"";try{const o=this._getFinalPath(t);return{data:yield(yield Rn(this.fetch,`${this.url}/${n}/${o}${i}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(Ke(o))return{data:null,error:o};throw o}})}info(t){return _r(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const a=yield Rn(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:bs(a),error:null}}catch(a){if(Ke(a))return{data:null,error:a};throw a}})}exists(t){return _r(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield lu(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(a){if(Ke(a)&&a instanceof As){const n=a.originalError;if([400,404].includes(n==null?void 0:n.status))return{data:!1,error:a}}throw a}})}getPublicUrl(t,r){const a=this._getFinalPath(t),n=[],s=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";s!==""&&n.push(s);const o=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});c!==""&&n.push(c);let l=n.join("&");return l!==""&&(l=`?${l}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${a}${l}`)}}}remove(t){return _r(this,void 0,void 0,function*(){try{return{data:yield Fc(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(Ke(r))return{data:null,error:r};throw r}})}list(t,r,a){return _r(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},fu),r),{prefix:t||""});return{data:yield _t(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},a),error:null}}catch(n){if(Ke(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const hu="2.7.1",du={"X-Client-Info":`storage-js/${hu}`};var ra=function(e,t,r,a){function n(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(f){try{l(a.next(f))}catch(u){i(u)}}function c(f){try{l(a.throw(f))}catch(u){i(u)}}function l(f){f.done?s(f.value):n(f.value).then(o,c)}l((a=a.apply(e,t||[])).next())})};class pu{constructor(t,r={},a){this.url=t,this.headers=Object.assign(Object.assign({},du),r),this.fetch=bc(a)}listBuckets(){return ra(this,void 0,void 0,function*(){try{return{data:yield Rn(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(Ke(t))return{data:null,error:t};throw t}})}getBucket(t){return ra(this,void 0,void 0,function*(){try{return{data:yield Rn(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(Ke(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return ra(this,void 0,void 0,function*(){try{return{data:yield _t(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(Ke(a))return{data:null,error:a};throw a}})}updateBucket(t,r){return ra(this,void 0,void 0,function*(){try{return{data:yield cu(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(Ke(a))return{data:null,error:a};throw a}})}emptyBucket(t){return ra(this,void 0,void 0,function*(){try{return{data:yield _t(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(Ke(r))return{data:null,error:r};throw r}})}deleteBucket(t){return ra(this,void 0,void 0,function*(){try{return{data:yield Fc(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(Ke(r))return{data:null,error:r};throw r}})}}class gu extends pu{constructor(t,r={},a){super(t,r,a)}from(t){return new uu(this.url,this.headers,t,this.fetch)}}const xu="2.50.2";let Ia="";typeof Deno<"u"?Ia="deno":typeof document<"u"?Ia="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ia="react-native":Ia="node";const mu={"X-Client-Info":`supabase-js-${Ia}/${xu}`},vu={headers:mu},wu={schema:"public"},_u={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},yu={};var Eu=function(e,t,r,a){function n(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(f){try{l(a.next(f))}catch(u){i(u)}}function c(f){try{l(a.throw(f))}catch(u){i(u)}}function l(f){f.done?s(f.value):n(f.value).then(o,c)}l((a=a.apply(e,t||[])).next())})};const ku=e=>{let t;return e?t=e:typeof fetch>"u"?t=hc:t=fetch,(...r)=>t(...r)},Tu=()=>typeof Headers>"u"?dc:Headers,Su=(e,t,r)=>{const a=ku(r),n=Tu();return(s,i)=>Eu(void 0,void 0,void 0,function*(){var o;const c=(o=yield t())!==null&&o!==void 0?o:e;let l=new n(i==null?void 0:i.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization",`Bearer ${c}`),a(s,Object.assign(Object.assign({},i),{headers:l}))})};var Au=function(e,t,r,a){function n(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(f){try{l(a.next(f))}catch(u){i(u)}}function c(f){try{l(a.throw(f))}catch(u){i(u)}}function l(f){f.done?s(f.value):n(f.value).then(o,c)}l((a=a.apply(e,t||[])).next())})};function bu(e){return e.endsWith("/")?e:e+"/"}function Fu(e,t){var r,a;const{db:n,auth:s,realtime:i,global:o}=e,{db:c,auth:l,realtime:f,global:u}=t,h={db:Object.assign(Object.assign({},c),n),auth:Object.assign(Object.assign({},l),s),realtime:Object.assign(Object.assign({},f),i),global:Object.assign(Object.assign(Object.assign({},u),o),{headers:Object.assign(Object.assign({},(r=u==null?void 0:u.headers)!==null&&r!==void 0?r:{}),(a=o==null?void 0:o.headers)!==null&&a!==void 0?a:{})}),accessToken:()=>Au(this,void 0,void 0,function*(){return""})};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}const Cc="2.70.0",ia=30*1e3,Fs=3,cs=Fs*ia,Cu="http://localhost:9999",Iu="supabase.auth.token",Ou={"X-Client-Info":`gotrue-js/${Cc}`},Cs="X-Supabase-Api-Version",Ic={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Du=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Ru=6e5;class qs extends Error{constructor(t,r,a){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=a}}function ge(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class Pu extends qs{constructor(t,r,a){super(t,r,a),this.name="AuthApiError",this.status=r,this.code=a}}function Lu(e){return ge(e)&&e.name==="AuthApiError"}class Oc extends qs{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Ot extends qs{constructor(t,r,a,n){super(t,a,n),this.name=r,this.status=a}}class wt extends Ot{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Nu(e){return ge(e)&&e.name==="AuthSessionMissingError"}class mn extends Ot{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class vn extends Ot{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class wn extends Ot{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Bu(e){return ge(e)&&e.name==="AuthImplicitGrantRedirectError"}class Xi extends Ot{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Is extends Ot{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function ls(e){return ge(e)&&e.name==="AuthRetryableFetchError"}class Ki extends Ot{constructor(t,r,a){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=a}}class Ba extends Ot{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Pn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Yi=` 	
\r=`.split(""),Mu=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Yi.length;t+=1)e[Yi[t].charCodeAt(0)]=-2;for(let t=0;t<Pn.length;t+=1)e[Pn[t].charCodeAt(0)]=t;return e})();function Ji(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const a=t.queue>>t.queuedBits-6&63;r(Pn[a]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const a=t.queue>>t.queuedBits-6&63;r(Pn[a]),t.queuedBits-=6}}function Dc(e,t,r){const a=Mu[e];if(a>-1)for(t.queue=t.queue<<6|a,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(a===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function Zi(e){const t=[],r=i=>{t.push(String.fromCodePoint(i))},a={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},s=i=>{ju(i,a,r)};for(let i=0;i<e.length;i+=1)Dc(e.charCodeAt(i),n,s);return t.join("")}function $u(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function Uu(e,t){for(let r=0;r<e.length;r+=1){let a=e.charCodeAt(r);if(a>55295&&a<=56319){const n=(a-55296)*1024&65535;a=(e.charCodeAt(r+1)-56320&65535|n)+65536,r+=1}$u(a,t)}}function ju(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let a=1;a<6;a+=1)if(!(e>>7-a&1)){t.utf8seq=a;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function Wu(e){const t=[],r={queue:0,queuedBits:0},a=n=>{t.push(n)};for(let n=0;n<e.length;n+=1)Dc(e.charCodeAt(n),r,a);return new Uint8Array(t)}function Hu(e){const t=[];return Uu(e,r=>t.push(r)),new Uint8Array(t)}function Vu(e){const t=[],r={queue:0,queuedBits:0},a=n=>{t.push(n)};return e.forEach(n=>Ji(n,r,a)),Ji(null,r,a),t.join("")}function Gu(e){return Math.round(Date.now()/1e3)+e}function zu(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const Hr=()=>typeof window<"u"&&typeof document<"u",Lt={tested:!1,writable:!1},Ma=()=>{if(!Hr())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Lt.tested)return Lt.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Lt.tested=!0,Lt.writable=!0}catch{Lt.tested=!0,Lt.writable=!1}return Lt.writable};function qu(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((n,s)=>{t[s]=n})}catch{}return r.searchParams.forEach((a,n)=>{t[n]=a}),t}const Rc=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>$r(async()=>{const{default:a}=await Promise.resolve().then(()=>ma);return{default:a}},void 0).then(({default:a})=>a(...r)):t=fetch,(...r)=>t(...r)},Xu=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Pc=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},_n=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},yn=async(e,t)=>{await e.removeItem(t)};class Zn{constructor(){this.promise=new Zn.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Zn.promiseConstructor=Promise;function fs(e){const t=e.split(".");if(t.length!==3)throw new Ba("Invalid JWT structure");for(let a=0;a<t.length;a++)if(!Du.test(t[a]))throw new Ba("JWT not in base64url format");return{header:JSON.parse(Zi(t[0])),payload:JSON.parse(Zi(t[1])),signature:Wu(t[2]),raw:{header:t[0],payload:t[1]}}}async function Ku(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function Yu(e,t){return new Promise((a,n)=>{(async()=>{for(let s=0;s<1/0;s++)try{const i=await e(s);if(!t(s,null,i)){a(i);return}}catch(i){if(!t(s,i)){n(i);return}}})()})}function Ju(e){return("0"+e.toString(16)).substr(-2)}function Zu(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",a=r.length;let n="";for(let s=0;s<56;s++)n+=r.charAt(Math.floor(Math.random()*a));return n}return crypto.getRandomValues(t),Array.from(t,Ju).join("")}async function Qu(e){const r=new TextEncoder().encode(e),a=await crypto.subtle.digest("SHA-256",r),n=new Uint8Array(a);return Array.from(n).map(s=>String.fromCharCode(s)).join("")}async function eh(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await Qu(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function ta(e,t,r=!1){const a=Zu();let n=a;r&&(n+="/PASSWORD_RECOVERY"),await Pc(e,`${t}-code-verifier`,n);const s=await eh(a);return[s,a===s?"plain":"s256"]}const rh=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function th(e){const t=e.headers.get(Cs);if(!t||!t.match(rh))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function ah(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function nh(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const sh=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function aa(e){if(!sh.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}var ih=function(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(r[a[n]]=e[a[n]]);return r};const Nt=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),oh=[502,503,504];async function Qi(e){var t;if(!Xu(e))throw new Is(Nt(e),0);if(oh.includes(e.status))throw new Is(Nt(e),e.status);let r;try{r=await e.json()}catch(s){throw new Oc(Nt(s),s)}let a;const n=th(e);if(n&&n.getTime()>=Ic["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?a=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(a=r.error_code),a){if(a==="weak_password")throw new Ki(Nt(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(a==="session_not_found")throw new wt}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,i)=>s&&typeof i=="string",!0))throw new Ki(Nt(r),e.status,r.weak_password.reasons);throw new Pu(Nt(r),e.status||500,a)}const ch=(e,t,r,a)=>{const n={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),n.body=JSON.stringify(a),Object.assign(Object.assign({},n),r))};async function we(e,t,r,a){var n;const s=Object.assign({},a==null?void 0:a.headers);s[Cs]||(s[Cs]=Ic["2024-01-01"].name),a!=null&&a.jwt&&(s.Authorization=`Bearer ${a.jwt}`);const i=(n=a==null?void 0:a.query)!==null&&n!==void 0?n:{};a!=null&&a.redirectTo&&(i.redirect_to=a.redirectTo);const o=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",c=await lh(e,t,r+o,{headers:s,noResolveJson:a==null?void 0:a.noResolveJson},{},a==null?void 0:a.body);return a!=null&&a.xform?a==null?void 0:a.xform(c):{data:Object.assign({},c),error:null}}async function lh(e,t,r,a,n,s){const i=ch(t,a,n,s);let o;try{o=await e(r,Object.assign({},i))}catch(c){throw console.error(c),new Is(Nt(c),0)}if(o.ok||await Qi(o),a!=null&&a.noResolveJson)return o;try{return await o.json()}catch(c){await Qi(c)}}function ot(e){var t;let r=null;dh(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=Gu(e.expires_in)));const a=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:a},error:null}}function eo(e){const t=ot(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,a)=>r&&typeof a=="string",!0)&&(t.data.weak_password=e.weak_password),t}function yt(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function fh(e){return{data:e,error:null}}function uh(e){const{action_link:t,email_otp:r,hashed_token:a,redirect_to:n,verification_type:s}=e,i=ih(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:a,redirect_to:n,verification_type:s},c=Object.assign({},i);return{data:{properties:o,user:c},error:null}}function hh(e){return e}function dh(e){return e.access_token&&e.refresh_token&&e.expires_in}const us=["global","local","others"];var ph=function(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(r[a[n]]=e[a[n]]);return r};class gh{constructor({url:t="",headers:r={},fetch:a}){this.url=t,this.headers=r,this.fetch=Rc(a),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r=us[0]){if(us.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${us.join(", ")}`);try{return await we(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(a){if(ge(a))return{data:null,error:a};throw a}}async inviteUserByEmail(t,r={}){try{return await we(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:yt})}catch(a){if(ge(a))return{data:{user:null},error:a};throw a}}async generateLink(t){try{const{options:r}=t,a=ph(t,["options"]),n=Object.assign(Object.assign({},a),r);return"newEmail"in a&&(n.new_email=a==null?void 0:a.newEmail,delete n.newEmail),await we(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:uh,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(ge(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await we(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:yt})}catch(r){if(ge(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,a,n,s,i,o,c;try{const l={nextPage:null,lastPage:0,total:0},f=await we(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:"",per_page:(s=(n=t==null?void 0:t.perPage)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:""},xform:hh});if(f.error)throw f.error;const u=await f.json(),h=(i=f.headers.get("x-total-count"))!==null&&i!==void 0?i:0,d=(c=(o=f.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&c!==void 0?c:[];return d.length>0&&(d.forEach(g=>{const p=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(g.split(";")[1].split("=")[1]);l[`${x}Page`]=p}),l.total=parseInt(h)),{data:Object.assign(Object.assign({},u),l),error:null}}catch(l){if(ge(l))return{data:{users:[]},error:l};throw l}}async getUserById(t){aa(t);try{return await we(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:yt})}catch(r){if(ge(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){aa(t);try{return await we(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:yt})}catch(a){if(ge(a))return{data:{user:null},error:a};throw a}}async deleteUser(t,r=!1){aa(t);try{return await we(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:yt})}catch(a){if(ge(a))return{data:{user:null},error:a};throw a}}async _listFactors(t){aa(t.userId);try{const{data:r,error:a}=await we(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:r,error:a}}catch(r){if(ge(r))return{data:null,error:r};throw r}}async _deleteFactor(t){aa(t.userId),aa(t.id);try{return{data:await we(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(ge(r))return{data:null,error:r};throw r}}}const xh={getItem:e=>Ma()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{Ma()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{Ma()&&globalThis.localStorage.removeItem(e)}};function ro(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function mh(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const na={debug:!!(globalThis&&Ma()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Lc extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class vh extends Lc{}async function wh(e,t,r){na.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const a=new globalThis.AbortController;return t>0&&setTimeout(()=>{a.abort(),na.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:a.signal},async n=>{if(n){na.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,n.name);try{return await r()}finally{na.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,n.name)}}else{if(t===0)throw na.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new vh(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(na.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}mh();const _h={url:Cu,storageKey:Iu,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Ou,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function to(e,t,r){return await r()}class Ka{constructor(t){var r,a;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Ka.nextInstanceID,Ka.nextInstanceID+=1,this.instanceID>0&&Hr()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},_h),t);if(this.logDebugMessages=!!n.debug,typeof n.debug=="function"&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new gh({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=Rc(n.fetch),this.lock=n.lock||to,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:Hr()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=wh:this.lock=to,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?n.storage?this.storage=n.storage:Ma()?this.storage=xh:(this.memoryStorage={},this.storage=ro(this.memoryStorage)):(this.memoryStorage={},this.storage=ro(this.memoryStorage)),Hr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(a=this.broadcastChannel)===null||a===void 0||a.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Cc}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=qu(window.location.href);let a="none";if(this._isImplicitGrantCallback(r)?a="implicit":await this._isPKCECallback(r)&&(a="pkce"),Hr()&&this.detectSessionInUrl&&a!=="none"){const{data:n,error:s}=await this._getSessionFromURL(r,a);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),Bu(s)){const c=(t=s.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:i,redirectType:o}=n;return this._debug("#_initialize()","detected session in URL",i,"redirect type",o),await this._saveSession(i),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return ge(r)?{error:r}:{error:new Oc("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,a,n;try{const s=await we(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(a=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&a!==void 0?a:{},gotrue_meta_security:{captcha_token:(n=t==null?void 0:t.options)===null||n===void 0?void 0:n.captchaToken}},xform:ot}),{data:i,error:o}=s;if(o||!i)return{data:{user:null,session:null},error:o};const c=i.session,l=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:l,session:c},error:null}}catch(s){if(ge(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(t){var r,a,n;try{let s;if("email"in t){const{email:f,password:u,options:h}=t;let d=null,g=null;this.flowType==="pkce"&&([d,g]=await ta(this.storage,this.storageKey)),s=await we(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:f,password:u,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:d,code_challenge_method:g},xform:ot})}else if("phone"in t){const{phone:f,password:u,options:h}=t;s=await we(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:f,password:u,data:(a=h==null?void 0:h.data)!==null&&a!==void 0?a:{},channel:(n=h==null?void 0:h.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:ot})}else throw new vn("You must provide either an email or phone number and a password");const{data:i,error:o}=s;if(o||!i)return{data:{user:null,session:null},error:o};const c=i.session,l=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:l,session:c},error:null}}catch(s){if(ge(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(t){try{let r;if("email"in t){const{email:s,password:i,options:o}=t;r=await we(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:eo})}else if("phone"in t){const{phone:s,password:i,options:o}=t;r=await we(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:eo})}else throw new vn("You must provide either an email or phone number and a password");const{data:a,error:n}=r;return n?{data:{user:null,session:null},error:n}:!a||!a.session||!a.user?{data:{user:null,session:null},error:new mn}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign({user:a.user,session:a.session},a.weak_password?{weakPassword:a.weak_password}:null),error:n})}catch(r){if(ge(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,a,n,s;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(a=t.options)===null||a===void 0?void 0:a.scopes,queryParams:(n=t.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(s=t.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;if(r==="solana")return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(t){var r,a,n,s,i,o,c,l,f,u,h,d;let g,p;if("message"in t)g=t.message,p=t.signature;else{const{chain:x,wallet:y,statement:F,options:v}=t;let C;if(Hr())if(typeof y=="object")C=y;else{const I=window;if("solana"in I&&typeof I.solana=="object"&&("signIn"in I.solana&&typeof I.solana.signIn=="function"||"signMessage"in I.solana&&typeof I.solana.signMessage=="function"))C=I.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!(v!=null&&v.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");C=y}const P=new URL((r=v==null?void 0:v.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in C&&C.signIn){const I=await C.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},v==null?void 0:v.signInWithSolana),{version:"1",domain:P.host,uri:P.href}),F?{statement:F}:null));let S;if(Array.isArray(I)&&I[0]&&typeof I[0]=="object")S=I[0];else if(I&&typeof I=="object"&&"signedMessage"in I&&"signature"in I)S=I;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in S&&"signature"in S&&(typeof S.signedMessage=="string"||S.signedMessage instanceof Uint8Array)&&S.signature instanceof Uint8Array)g=typeof S.signedMessage=="string"?S.signedMessage:new TextDecoder().decode(S.signedMessage),p=S.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in C)||typeof C.signMessage!="function"||!("publicKey"in C)||typeof C!="object"||!C.publicKey||!("toBase58"in C.publicKey)||typeof C.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");g=[`${P.host} wants you to sign in with your Solana account:`,C.publicKey.toBase58(),...F?["",F,""]:[""],"Version: 1",`URI: ${P.href}`,`Issued At: ${(n=(a=v==null?void 0:v.signInWithSolana)===null||a===void 0?void 0:a.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((s=v==null?void 0:v.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${v.signInWithSolana.notBefore}`]:[],...!((i=v==null?void 0:v.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${v.signInWithSolana.expirationTime}`]:[],...!((o=v==null?void 0:v.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${v.signInWithSolana.chainId}`]:[],...!((c=v==null?void 0:v.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${v.signInWithSolana.nonce}`]:[],...!((l=v==null?void 0:v.signInWithSolana)===null||l===void 0)&&l.requestId?[`Request ID: ${v.signInWithSolana.requestId}`]:[],...!((u=(f=v==null?void 0:v.signInWithSolana)===null||f===void 0?void 0:f.resources)===null||u===void 0)&&u.length?["Resources",...v.signInWithSolana.resources.map(S=>`- ${S}`)]:[]].join(`
`);const I=await C.signMessage(new TextEncoder().encode(g),"utf8");if(!I||!(I instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");p=I}}try{const{data:x,error:y}=await we(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:g,signature:Vu(p)},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(d=t.options)===null||d===void 0?void 0:d.captchaToken}}:null),xform:ot});if(y)throw y;return!x||!x.session||!x.user?{data:{user:null,session:null},error:new mn}:(x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("SIGNED_IN",x.session)),{data:Object.assign({},x),error:y})}catch(x){if(ge(x))return{data:{user:null,session:null},error:x};throw x}}async _exchangeCodeForSession(t){const r=await _n(this.storage,`${this.storageKey}-code-verifier`),[a,n]=(r??"").split("/");try{const{data:s,error:i}=await we(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:a},xform:ot});if(await yn(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new mn}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:n??null}),error:i})}catch(s){if(ge(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(t){try{const{options:r,provider:a,token:n,access_token:s,nonce:i}=t,o=await we(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:a,id_token:n,access_token:s,nonce:i,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:ot}),{data:c,error:l}=o;return l?{data:{user:null,session:null},error:l}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new mn}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:l})}catch(r){if(ge(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,a,n,s,i;try{if("email"in t){const{email:o,options:c}=t;let l=null,f=null;this.flowType==="pkce"&&([l,f]=await ta(this.storage,this.storageKey));const{error:u}=await we(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(a=c==null?void 0:c.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:l,code_challenge_method:f},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:u}}if("phone"in t){const{phone:o,options:c}=t,{data:l,error:f}=await we(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(n=c==null?void 0:c.data)!==null&&n!==void 0?n:{},create_user:(s=c==null?void 0:c.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(i=c==null?void 0:c.channel)!==null&&i!==void 0?i:"sms"}});return{data:{user:null,session:null,messageId:l==null?void 0:l.message_id},error:f}}throw new vn("You must provide either an email or phone number.")}catch(o){if(ge(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(t){var r,a;try{let n,s;"options"in t&&(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo,s=(a=t.options)===null||a===void 0?void 0:a.captchaToken);const{data:i,error:o}=await we(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:s}}),redirectTo:n,xform:ot});if(o)throw o;if(!i)throw new Error("An error occurred on token verification.");const c=i.session,l=i.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:l,session:c},error:null}}catch(n){if(ge(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithSSO(t){var r,a,n;try{let s=null,i=null;return this.flowType==="pkce"&&([s,i]=await ta(this.storage,this.storageKey)),await we(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&a!==void 0?a:void 0}),!((n=t==null?void 0:t.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:i}),headers:this.headers,xform:fh})}catch(s){if(ge(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:a}=t;if(a)throw a;if(!r)throw new wt;const{error:n}=await we(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:n}})}catch(t){if(ge(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:a,type:n,options:s}=t,{error:i}=await we(this.fetch,"POST",r,{headers:this.headers,body:{email:a,type:n,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:i}}else if("phone"in t){const{phone:a,type:n,options:s}=t,{data:i,error:o}=await we(this.fetch,"POST",r,{headers:this.headers,body:{phone:a,type:n,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:o}}throw new vn("You must provide either an email or phone number and a type")}catch(r){if(ge(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const a=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await a,await r()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const a=r();for(this.pendingInLock.push((async()=>{try{await a}catch{}})()),await a;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await a}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await _n(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const a=t.expires_at?t.expires_at*1e3-Date.now()<cs:!1;if(this._debug("#__loadSession()",`session has${a?"":" not"} expired`,"expires_at",t.expires_at),!a){if(this.storage.isServer){let i=this.suppressGetSessionWarning;t=new Proxy(t,{get:(c,l,f)=>(!i&&l==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),i=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,l,f))})}return{data:{session:t},error:null}}const{session:n,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{session:null},error:s}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await we(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:yt}):await this._useSession(async r=>{var a,n,s;const{data:i,error:o}=r;if(o)throw o;return!(!((a=i.session)===null||a===void 0)&&a.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new wt}:await we(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0,xform:yt})})}catch(r){if(ge(r))return Nu(r)&&(await this._removeSession(),await yn(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async a=>{const{data:n,error:s}=a;if(s)throw s;if(!n.session)throw new wt;const i=n.session;let o=null,c=null;this.flowType==="pkce"&&t.email!=null&&([o,c]=await ta(this.storage,this.storageKey));const{data:l,error:f}=await we(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:c}),jwt:i.access_token,xform:yt});if(f)throw f;return i.user=l.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(a){if(ge(a))return{data:{user:null},error:a};throw a}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new wt;const r=Date.now()/1e3;let a=r,n=!0,s=null;const{payload:i}=fs(t.access_token);if(i.exp&&(a=i.exp,n=a<=r),n){const{session:o,error:c}=await this._callRefreshToken(t.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!o)return{data:{user:null,session:null},error:null};s=o}else{const{data:o,error:c}=await this._getUser(t.access_token);if(c)throw c;s={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:a-r,expires_at:a},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(r){if(ge(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var a;if(!t){const{data:i,error:o}=r;if(o)throw o;t=(a=i.session)!==null&&a!==void 0?a:void 0}if(!(t!=null&&t.refresh_token))throw new wt;const{session:n,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{user:null,session:null},error:s}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(ge(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!Hr())throw new wn("No browser detected.");if(t.error||t.error_description||t.error_code)throw new wn(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Xi("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new wn("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Xi("No code detected.");const{data:F,error:v}=await this._exchangeCodeForSession(t.code);if(v)throw v;const C=new URL(window.location.href);return C.searchParams.delete("code"),window.history.replaceState(window.history.state,"",C.toString()),{data:{session:F.session,redirectType:null},error:null}}const{provider_token:a,provider_refresh_token:n,access_token:s,refresh_token:i,expires_in:o,expires_at:c,token_type:l}=t;if(!s||!o||!i||!l)throw new wn("No session defined in URL");const f=Math.round(Date.now()/1e3),u=parseInt(o);let h=f+u;c&&(h=parseInt(c));const d=h-f;d*1e3<=ia&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${d}s, should have been closer to ${u}s`);const g=h-u;f-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,h,f):f-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",g,h,f);const{data:p,error:x}=await this._getUser(s);if(x)throw x;const y={provider_token:a,provider_refresh_token:n,access_token:s,expires_in:u,expires_at:h,refresh_token:i,token_type:l,user:p.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:y,redirectType:t.type},error:null}}catch(a){if(ge(a))return{data:{session:null,redirectType:null},error:a};throw a}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await _n(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var a;const{data:n,error:s}=r;if(s)return{error:s};const i=(a=n.session)===null||a===void 0?void 0:a.access_token;if(i){const{error:o}=await this.admin.signOut(i,t);if(o&&!(Lu(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return t!=="others"&&(await this._removeSession(),await yn(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=zu(),a={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,a),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:a}}}async _emitInitialSession(t){return await this._useSession(async r=>{var a,n;try{const{data:{session:s},error:i}=r;if(i)throw i;await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",t,"session",s)}catch(s){await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",s),console.error(s)}})}async resetPasswordForEmail(t,r={}){let a=null,n=null;this.flowType==="pkce"&&([a,n]=await ta(this.storage,this.storageKey,!0));try{return await we(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:a,code_challenge_method:n,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(ge(s))return{data:null,error:s};throw s}}async getUserIdentities(){var t;try{const{data:r,error:a}=await this.getUser();if(a)throw a;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(ge(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:a,error:n}=await this._useSession(async s=>{var i,o,c,l,f;const{data:u,error:h}=s;if(h)throw h;const d=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(i=t.options)===null||i===void 0?void 0:i.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await we(this.fetch,"GET",d,{headers:this.headers,jwt:(f=(l=u.session)===null||l===void 0?void 0:l.access_token)!==null&&f!==void 0?f:void 0})});if(n)throw n;return Hr()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(a==null?void 0:a.url),{data:{provider:t.provider,url:a==null?void 0:a.url},error:null}}catch(a){if(ge(a))return{data:{provider:t.provider,url:null},error:a};throw a}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var a,n;const{data:s,error:i}=r;if(i)throw i;return await we(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(n=(a=s.session)===null||a===void 0?void 0:a.access_token)!==null&&n!==void 0?n:void 0})})}catch(r){if(ge(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const a=Date.now();return await Yu(async n=>(n>0&&await Ku(200*Math.pow(2,n-1)),this._debug(r,"refreshing attempt",n),await we(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:ot})),(n,s)=>{const i=200*Math.pow(2,n);return s&&ls(s)&&Date.now()+i-a<ia})}catch(a){if(this._debug(r,"error",a),ge(a))return{data:{session:null,user:null},error:a};throw a}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const a=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",a),Hr()&&!r.skipBrowserRedirect&&window.location.assign(a),{data:{provider:t,url:a},error:null}}async _recoverAndRefresh(){var t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const a=await _n(this.storage,this.storageKey);if(this._debug(r,"session from storage",a),!this._isValidSession(a)){this._debug(r,"session is not valid"),a!==null&&await this._removeSession();return}const n=((t=a.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<cs;if(this._debug(r,`session has${n?"":" not"} expired with margin of ${cs}s`),n){if(this.autoRefreshToken&&a.refresh_token){const{error:s}=await this._callRefreshToken(a.refresh_token);s&&(console.error(s),ls(s)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",s),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(r,"error",a),console.error(a);return}finally{this._debug(r,"end")}}async _callRefreshToken(t){var r,a;if(!t)throw new wt;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new Zn;const{data:s,error:i}=await this._refreshAccessToken(t);if(i)throw i;if(!s.session)throw new wt;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const o={session:s.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(s){if(this._debug(n,"error",s),ge(s)){const i={session:null,error:s};return ls(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(i),i}throw(a=this.refreshingDeferred)===null||a===void 0||a.reject(s),s}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(t,r,a=!0){const n=`#_notifyAllSubscribers(${t})`;this._debug(n,"begin",r,`broadcast = ${a}`);try{this.broadcastChannel&&a&&this.broadcastChannel.postMessage({event:t,session:r});const s=[],i=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(c){s.push(c)}});if(await Promise.all(i),s.length>0){for(let o=0;o<s.length;o+=1)console.error(s[o]);throw s[0]}}finally{this._debug(n,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await Pc(this.storage,this.storageKey,t)}async _removeSession(){this._debug("#_removeSession()"),await yn(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Hr()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),ia);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:a}}=r;if(!a||!a.refresh_token||!a.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((a.expires_at*1e3-t)/ia);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${ia}ms, refresh threshold is ${Fs} ticks`),n<=Fs&&await this._callRefreshToken(a.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof Lc)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Hr()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,a){const n=[`provider=${encodeURIComponent(r)}`];if(a!=null&&a.redirectTo&&n.push(`redirect_to=${encodeURIComponent(a.redirectTo)}`),a!=null&&a.scopes&&n.push(`scopes=${encodeURIComponent(a.scopes)}`),this.flowType==="pkce"){const[s,i]=await ta(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(i)}`});n.push(o.toString())}if(a!=null&&a.queryParams){const s=new URLSearchParams(a.queryParams);n.push(s.toString())}return a!=null&&a.skipBrowserRedirect&&n.push(`skip_http_redirect=${a.skipBrowserRedirect}`),`${t}?${n.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var a;const{data:n,error:s}=r;return s?{data:null,error:s}:await we(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(a=n==null?void 0:n.session)===null||a===void 0?void 0:a.access_token})})}catch(r){if(ge(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var a,n;const{data:s,error:i}=r;if(i)return{data:null,error:i};const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:c,error:l}=await we(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(a=s==null?void 0:s.session)===null||a===void 0?void 0:a.access_token});return l?{data:null,error:l}:(t.factorType==="totp"&&(!((n=c==null?void 0:c.totp)===null||n===void 0)&&n.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(r){if(ge(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var a;const{data:n,error:s}=r;if(s)return{data:null,error:s};const{data:i,error:o}=await we(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(a=n==null?void 0:n.session)===null||a===void 0?void 0:a.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:o})})}catch(r){if(ge(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var a;const{data:n,error:s}=r;return s?{data:null,error:s}:await we(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(a=n==null?void 0:n.session)===null||a===void 0?void 0:a.access_token})})}catch(r){if(ge(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:a}=await this._challenge({factorId:t.factorId});return a?{data:null,error:a}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const a=(t==null?void 0:t.factors)||[],n=a.filter(i=>i.factor_type==="totp"&&i.status==="verified"),s=a.filter(i=>i.factor_type==="phone"&&i.status==="verified");return{data:{all:a,totp:n,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,a;const{data:{session:n},error:s}=t;if(s)return{data:null,error:s};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=fs(n.access_token);let o=null;i.aal&&(o=i.aal);let c=o;((a=(r=n.user.factors)===null||r===void 0?void 0:r.filter(u=>u.status==="verified"))!==null&&a!==void 0?a:[]).length>0&&(c="aal2");const f=i.amr||[];return{data:{currentLevel:o,nextLevel:c,currentAuthenticationMethods:f},error:null}}))}async fetchJwk(t,r={keys:[]}){let a=r.keys.find(i=>i.kid===t);if(a||(a=this.jwks.keys.find(i=>i.kid===t),a&&this.jwks_cached_at+Ru>Date.now()))return a;const{data:n,error:s}=await we(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(s)throw s;if(!n.keys||n.keys.length===0)throw new Ba("JWKS is empty");if(this.jwks=n,this.jwks_cached_at=Date.now(),a=n.keys.find(i=>i.kid===t),!a)throw new Ba("No matching signing key found in JWKS");return a}async getClaims(t,r={keys:[]}){try{let a=t;if(!a){const{data:d,error:g}=await this.getSession();if(g||!d.session)return{data:null,error:g};a=d.session.access_token}const{header:n,payload:s,signature:i,raw:{header:o,payload:c}}=fs(a);if(ah(s.exp),!n.kid||n.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:d}=await this.getUser(a);if(d)throw d;return{data:{claims:s,header:n,signature:i},error:null}}const l=nh(n.alg),f=await this.fetchJwk(n.kid,r),u=await crypto.subtle.importKey("jwk",f,l,!0,["verify"]);if(!await crypto.subtle.verify(l,u,i,Hu(`${o}.${c}`)))throw new Ba("Invalid JWT signature");return{data:{claims:s,header:n,signature:i},error:null}}catch(a){if(ge(a))return{data:null,error:a};throw a}}}Ka.nextInstanceID=0;const yh=Ka;class Eh extends yh{constructor(t){super(t)}}var kh=function(e,t,r,a){function n(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(f){try{l(a.next(f))}catch(u){i(u)}}function c(f){try{l(a.throw(f))}catch(u){i(u)}}function l(f){f.done?s(f.value):n(f.value).then(o,c)}l((a=a.apply(e,t||[])).next())})};class Th{constructor(t,r,a){var n,s,i;if(this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const o=bu(t),c=new URL(o);this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const l=`sb-${c.hostname.split(".")[0]}-auth-token`,f={db:wu,realtime:yu,auth:Object.assign(Object.assign({},_u),{storageKey:l}),global:vu},u=Fu(a??{},f);this.storageKey=(n=u.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(s=u.global.headers)!==null&&s!==void 0?s:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(h,d)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(d)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=u.auth)!==null&&i!==void 0?i:{},this.headers,u.global.fetch),this.fetch=Su(r,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new jf(new URL("rest/v1",c).href,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),u.accessToken||this._listenForAuthEvents()}get functions(){return new xf(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new gu(this.storageUrl.href,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},a={}){return this.rest.rpc(t,r,a)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return kh(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:a}=yield this.auth.getSession();return(r=(t=a.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:a,storage:n,storageKey:s,flowType:i,lock:o,debug:c},l,f){const u={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Eh({url:this.authUrl.href,headers:Object.assign(Object.assign({},u),l),storageKey:s,autoRefreshToken:t,persistSession:r,detectSessionInUrl:a,storage:n,flowType:i,lock:o,debug:c,fetch:f,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new tu(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,a)=>{this._handleTokenChanged(r,"CLIENT",a==null?void 0:a.access_token)})}_handleTokenChanged(t,r,a){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==a?this.changedAccessToken=a:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Sh=(e,t,r)=>new Th(e,t,r),Ah="https://ehutpsrutyiorhqrwstz.supabase.co",bh="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVodXRwc3J1dHlpb3JocXJ3c3R6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTExMTMyNzQsImV4cCI6MjA2NjY4OTI3NH0.lcfz59Uc2S6q9Mn2lj2OC_WAMG5CncrNbEnHX7MFTeI";let le=null;function Xs(){try{le=Sh(Ah,bh),console.log("✅ Supabase client initialized successfully")}catch(e){console.warn("⚠️ Supabase initialization failed, using localStorage fallback:",e),le=null}}const At={getItem:e=>localStorage.getItem(`nutrivalor_${e}`),setItem:(e,t)=>localStorage.setItem(`nutrivalor_${e}`,t),removeItem:e=>localStorage.removeItem(`nutrivalor_${e}`)};async function Nc(){if(le)try{const{data:{user:t}}=await le.auth.getUser();return t}catch(t){return console.error("Error getting current user:",t),null}const e=At.getItem("currentUser");return e?JSON.parse(e):null}Xs();const Bc=Object.freeze(Object.defineProperty({__proto__:null,getCurrentUser:Nc,initializeSupabase:Xs,localStorageWrapper:At,get supabase(){return le}},Symbol.toStringTag,{value:"Module"}));let Ks=null;async function Fh(){console.log("🔐 Initializing authentication..."),await Ih(),Ch()}function Ch(){const e=document.querySelector("#loginForm form"),t=document.querySelector("#signupForm form"),r=document.querySelector("#forgotForm form"),a=document.getElementById("logoutBtn");e?(e.addEventListener("submit",Ph),console.log("✅ Login form event listener attached")):console.warn("❌ Login form not found"),t?(t.addEventListener("submit",Lh),console.log("✅ Signup form event listener attached")):console.warn("❌ Signup form not found"),r?(r.addEventListener("submit",Nh),console.log("✅ Forgot password form event listener attached")):console.warn("❌ Forgot password form not found"),a?(a.addEventListener("click",Bh),console.log("✅ Logout button event listener attached")):console.warn("❌ Logout button not found"),document.querySelectorAll("[data-auth-tab]").forEach(s=>{s.addEventListener("click",i=>{const c=i.target.getAttribute("data-auth-tab");c&&Mc(c)})});const n=document.querySelector("[data-forgot-password]");n&&n.addEventListener("click",s=>{s.preventDefault(),Rh()})}async function Ih(){try{Ys();const e=await Nc();e?Ya(e):ft()}catch(e){console.error("Error checking auth state:",e),ft()}}function qt(){return Ks}function Ya(e){Ks=e,Js(),Oh(),Dh(e),Mh()}function Ys(){const e=document.getElementById("loadingScreen"),t=document.getElementById("auth-section"),r=document.getElementById("app-section");e&&(e.style.display="flex"),t&&(t.style.display="none"),r&&(r.style.display="none")}function Js(){const e=document.getElementById("loadingScreen");e&&(e.style.display="none")}function ft(){Js();const e=document.getElementById("auth-section"),t=document.getElementById("app-section");e&&(e.style.display="flex"),t&&(t.style.display="none")}function Oh(){Js();const e=document.getElementById("auth-section"),t=document.getElementById("app-section");e&&(e.style.display="none"),t&&(t.style.display="block")}function Dh(e){const t=document.getElementById("userEmail"),r=document.getElementById("headerAvatar"),a=document.getElementById("headerAvatarPlaceholder");if(t){const n=localStorage.getItem("nutrivalor_profile");let s=e.email||"User",i=null;if(n)try{const o=JSON.parse(n);o.name&&o.name.trim()&&(s=o.name),o.avatar&&(i=o.avatar)}catch{console.log("Could not parse saved profile for display name")}t.textContent=s,r&&a&&(i?(r.src=i,r.style.display="block",a.style.display="none"):(r.style.display="none",a.style.display="flex"))}}function Mc(e){document.querySelectorAll(".auth-tab").forEach(n=>n.classList.remove("active"));const t=document.getElementById("loginForm"),r=document.getElementById("signupForm"),a=document.getElementById("forgotForm");if(t&&(t.style.display="none"),r&&(r.style.display="none"),a&&(a.style.display="none"),e==="login"){const n=document.querySelector(".auth-tab");n&&n.classList.add("active"),t&&(t.style.display="block")}else if(e==="signup"){const n=document.querySelectorAll(".auth-tab")[1];n&&n.classList.add("active"),r&&(r.style.display="block")}}function Rh(){document.querySelectorAll(".auth-tab").forEach(a=>a.classList.remove("active"));const e=document.getElementById("loginForm"),t=document.getElementById("signupForm"),r=document.getElementById("forgotForm");e&&(e.style.display="none"),t&&(t.style.display="none"),r&&(r.style.display="block")}function Je(e,t="success"){let r=document.getElementById("auth-message");if(!r){r=document.createElement("div"),r.id="auth-message",r.className="message";const a=document.getElementById("auth-section");a&&a.insertBefore(r,a.firstChild)}r.textContent=e,r.className=`message ${t}`,r.style.display="block",setTimeout(()=>{r&&(r.style.display="none")},5e3)}async function Ph(e){e.preventDefault();const t=e.target,r=new FormData(t),a=r.get("email"),n=r.get("password");if(!a||!n){Je("Please fill in all fields","error");return}try{if(Ys(),!le){const c=JSON.parse(At.getItem("users")||"[]").find(f=>f.email===a&&f.password===n);if(!c){Je("Invalid email or password","error"),ft();return}const l={...c};delete l.password,At.setItem("currentUser",JSON.stringify(l)),Ya(l);return}const{data:s,error:i}=await le.auth.signInWithPassword({email:a,password:n});if(i){Je(i.message,"error"),ft();return}s.user&&(Ya(s.user),Je("Login successful!","success"))}catch(s){console.error("Login error:",s),Je("An error occurred during login","error"),ft()}}async function Lh(e){e.preventDefault();const t=e.target,r=new FormData(t),a=r.get("name"),n=r.get("email"),s=r.get("password");if(!a||!n||!s){Je("Please fill in all fields","error");return}if(s.length<6){Je("Password must be at least 6 characters","error");return}try{if(Ys(),!le){const c=JSON.parse(At.getItem("users")||"[]");if(c.find(u=>u.email===n)){Je("User already exists","error"),ft();return}const f={id:$h(),email:n,user_metadata:{name:a},app_metadata:{},aud:"authenticated",created_at:new Date().toISOString()};c.push({...f,password:s}),At.setItem("users",JSON.stringify(c)),At.setItem("currentUser",JSON.stringify(f)),Ya(f),Je("Account created successfully!","success");return}const{data:i,error:o}=await le.auth.signUp({email:n,password:s,options:{data:{name:a}}});if(o){Je(o.message,"error"),ft();return}i.user&&(Ya(i.user),Je("Account created successfully!","success"))}catch(i){console.error("Signup error:",i),Je("An error occurred during signup","error"),ft()}}async function Nh(e){e.preventDefault();const t=e.target,a=new FormData(t).get("email");if(!a){Je("Please enter your email","error");return}try{if(!le){Je("Password reset functionality requires Supabase connection","error");return}const{error:n}=await le.auth.resetPasswordForEmail(a);if(n){Je(n.message,"error");return}Je("Password reset email sent!","success"),Mc("login")}catch(n){console.error("Password reset error:",n),Je("An error occurred sending reset email","error")}}async function Bh(){try{le&&await le.auth.signOut(),At.removeItem("currentUser"),Ks=null,ft()}catch(e){console.error("Logout error:",e),Je("Error during logout","error")}}async function Mh(){try{console.log("Loading user data...");const{loadAndDisplayFoods:e}=await $r(async()=>{const{loadAndDisplayFoods:t}=await Promise.resolve().then(()=>Yh);return{loadAndDisplayFoods:t}},void 0);await e(),console.log("✅ User data loaded successfully")}catch(e){console.error("❌ Error loading user data:",e)}}function $h(){return"id_"+Math.random().toString(36).substr(2,9)+Date.now().toString(36)}async function $c(){if(console.log("🗄️ Initializing database..."),!le)throw new Error("Supabase client not initialized");try{const{data:e,error:t}=await le.from("foods").select("count").limit(1);t&&t.code!=="PGRST116"?(console.warn("Database tables may not be created yet:",t.message),console.log("Please run the SQL script from database-setup.sql in your Supabase dashboard")):console.log("✅ Database connection verified")}catch(e){console.warn("Database verification failed:",e)}}async function Uc(e){if(!le)throw new Error("Supabase not initialized");const{data:t,error:r}=await le.from("foods").insert([e]).select();if(r)throw r;return t[0]}async function jc(e){if(!le)throw new Error("Supabase not initialized");const{data:t,error:r}=await le.from("foods").insert(e).select();if(r)throw r;return t||[]}async function Wc(){if(!le)throw new Error("Supabase not initialized");const{data:{user:e},error:t}=await le.auth.getUser();if(t||!e)return console.log("No authenticated user, returning empty food list"),[];const{data:r,error:a}=await le.from("foods").select("*").eq("user_id",e.id).order("name");if(a)throw a;return r||[]}async function Zs(){if(!le)throw new Error("Supabase not initialized");const{data:{user:e},error:t}=await le.auth.getUser();if(t||!e)throw new Error("User must be authenticated to clear foods");const{error:r}=await le.from("foods").delete().eq("user_id",e.id);if(r)throw r;console.log("✅ Cleared all existing foods for user:",e.id)}async function Hc(e,t=1){if(!le)throw new Error("Supabase not initialized");const{data:{user:r},error:a}=await le.auth.getUser();if(a||!r)throw new Error("User must be authenticated to add to shopping list");const{data:n,error:s}=await le.from("foods").select("*").eq("id",e).eq("user_id",r.id).single();if(s||!n)throw new Error("Food not found or access denied");const{data:i,error:o}=await le.from("shopping_list").select("*").eq("food_id",e).eq("user_id",r.id).single();if(o&&o.code!=="PGRST116")throw o;if(i){console.log(`📦 Found existing item "${n.name}" with quantity ${i.quantity}, adding ${t}`);const{data:c,error:l}=await le.from("shopping_list").update({quantity:i.quantity+t}).eq("id",i.id).eq("user_id",r.id).select();if(l)throw l;return console.log(`✅ Updated "${n.name}" quantity to ${i.quantity+t}`),c[0]}else{console.log(`📦 Adding new item "${n.name}" with quantity ${t}`);const{data:c,error:l}=await le.from("shopping_list").insert([{food_id:e,quantity:t,user_id:r.id,name:n.name,brand:n.brand||"",carbs:n.carbs||0,fat:n.fat||0,protein:n.protein||0,category:n.category||"General"}]).select();if(l)throw l;return console.log(`✅ Added new item "${n.name}" to shopping list`),c[0]}}async function Qs(){if(!le)throw new Error("Supabase not initialized");const{data:{user:e},error:t}=await le.auth.getUser();if(t||!e)throw new Error("User must be authenticated to view shopping list");const{data:r,error:a}=await le.from("shopping_list").select("*").eq("user_id",e.id).order("created_at");if(a)throw a;return r||[]}async function ei(e){if(!le)throw new Error("Supabase not initialized");const{data:{user:t},error:r}=await le.auth.getUser();if(r||!t)throw new Error("User must be authenticated to remove from shopping list");const{error:a}=await le.from("shopping_list").delete().eq("id",e).eq("user_id",t.id);if(a)throw a}async function Vc(e,t){if(!le)throw new Error("Supabase not initialized");const{data:{user:r},error:a}=await le.auth.getUser();if(a||!r)throw new Error("User must be authenticated to update shopping list");const{data:n,error:s}=await le.from("shopping_list").update({quantity:t}).eq("id",e).eq("user_id",r.id).select();if(s)throw s;return n[0]}async function ri(){if(!le)throw new Error("Supabase not initialized");const{data:{user:e},error:t}=await le.auth.getUser();if(t||!e)throw new Error("User must be authenticated to clear shopping list");const{error:r}=await le.from("shopping_list").delete().eq("user_id",e.id);if(r)throw r;console.log("✅ Cleared shopping list for user:",e.id)}const ti=Object.freeze(Object.defineProperty({__proto__:null,addToShoppingList:Hc,clearAllFoodsForUser:Zs,clearShoppingListFromDatabase:ri,initializeDatabase:$c,loadFoodsFromDatabase:Wc,loadShoppingListFromDatabase:Qs,removeFromShoppingList:ei,saveAllFoodsToDatabase:jc,saveFoodToDatabase:Uc,updateShoppingListQuantity:Vc},Symbol.toStringTag,{value:"Module"}));async function Gc(){console.log("🍎 Initializing food tracker..."),Uh(),await ai(),await zc(),Xc()}function Uh(){const e=document.getElementById("foodFileInput");e?(e.addEventListener("change",Kc),console.log("✅ Food file input listener attached")):console.warn("❌ Food file input not found"),jh(),Wh()}function jh(){console.log("Category filters will be initialized after loading foods...")}function Wh(){console.log("Setting up search functionality...")}let zr=[],Ze=[];async function zc(){try{console.log("🛒 Loading shopping list from database..."),Ze=await Qs()||[],console.log(`🛒 Loaded ${Ze.length} items in shopping list`),wa()}catch(e){console.error("❌ Error loading shopping list:",e),Ze=[]}}async function ai(){try{console.log("📊 Loading foods from database...");const e=await Wc();console.log(`📊 Loaded ${e.length} foods from database`),zr=e,Hh(e),Xt(e)}catch(e){console.error("❌ Error loading foods:",e),je("Error loading foods: "+e.message,"error")}}function Hh(e){const t=document.querySelector(".category-filters");if(!t)return;const r=[...new Set(e.map(s=>s.category).filter(s=>s&&s!=="General"))],n=["all",...["VEGETABLES","SALAD","DAIRY","PROTEIN","CONDIMENTS","DRINKS","OTHER"].filter(s=>r.includes(s))];t.innerHTML=n.map((s,i)=>`
      <button class="filter-btn ${i===0?"active":""}" onclick="filterByCategory('${s}')" data-category="${s}">
        ${s==="all"?"ALL":s}
      </button>
    `).join(""),console.log(`✅ Created filters for categories: ${n.join(", ")}`)}function qc(e){console.log(`🔍 Filtering by category: ${e}`),document.querySelectorAll(".filter-btn").forEach(a=>{a.classList.remove("active")});const t=document.querySelector(`[data-category="${e}"]`);t&&t.classList.add("active");let r=zr;e!=="all"&&(r=zr.filter(a=>a.category&&a.category.toLowerCase()===e.toLowerCase())),console.log(`📊 Filtered to ${r.length} foods`),Xt(r)}function Xt(e){const t=document.getElementById("foodGrid");if(!t){console.warn("❌ Food grid element not found");return}if(console.log(`🍽️ Displaying ${e.length} foods`),e.length===0){t.innerHTML='<p class="empty-state">No foods found. Upload your food data to get started!</p>';return}e.sort((r,a)=>r.name.localeCompare(a.name)),t.innerHTML=e.map(r=>{const a=Ze.some(o=>o.id===r.id||o.food_id===r.id),n=a?"add-btn added":"add-btn",s=a?"Remove from List":"Add to List",i=a?`handleRemoveFromShoppingList('${r.id}', true)`:`addToShoppingList('${r.id}')`;return`
      <div class="food-card">
        <h4>${r.name}</h4>
        ${r.brand?`<div class="brand-info">Brand: ${r.brand}</div>`:""}
        <div class="nutrition-info">
          <span>Carbs: ${la(r.carbs)}g</span>
          <span>Fat: ${la(r.fat)}g</span>
          <span>Protein: ${la(r.protein)}g</span>
        </div>
        <div class="food-actions">
          <input type="number" class="quantity-input" value="1" min="1" id="qty-${r.id}">
          <button class="${n}" onclick="${i}">
            ${s}
          </button>
        </div>
      </div>
    `}).join(""),console.log("✅ Food cards displayed successfully")}function la(e){if(e==null||e==="")return"0";const t=parseFloat(e);return isNaN(t)?"0":t.toFixed(1)}function Vh(){const e=new Date,t=e.toLocaleDateString()+" "+e.toLocaleTimeString();localStorage.setItem("lastFoodUploadDate",t),Xc()}function Xc(){const e=localStorage.getItem("lastFoodUploadDate"),t=document.getElementById("lastUpdateInfo"),r=document.getElementById("lastUpdateDate");e&&t&&r?(r.textContent=e,t.style.display="block"):t&&(t.style.display="none")}async function Kc(e){const t=e.target;if(!t.files||t.files.length===0)return;const r=t.files[0];try{if(je("Processing file...","success"),console.log("📄 Processing file:",r.name),!r.name.endsWith(".xlsx")&&!r.name.endsWith(".xls"))throw new Error("Please upload an Excel file (.xlsx or .xls)");if(!le)throw new Error("Supabase client not initialized");const{data:{user:a},error:n}=await le.auth.getUser();if(n||!a)throw new Error("You must be logged in to upload food data");console.log("👤 Current user:",a.id);const s=await Gh(r);if(s&&s.length>0){console.log(`📊 Parsed ${s.length} foods from Excel`),je("Clearing existing foods and uploading new data...","success");try{await Zs(),console.log("🗑️ Cleared all existing foods")}catch(u){console.warn("⚠️ Could not clear existing foods:",u)}const i=s.map(u=>({...u,user_id:a.id}));console.log(`💾 Saving ${i.length} foods in bulk...`);let o=0,c=0;try{await jc(i),console.log(`✅ Successfully saved all ${i.length} foods`),o=i.length,c=0}catch(u){console.error("❌ Failed to save foods in bulk:",u),console.log("🔄 Falling back to individual saves..."),o=0,c=0;for(const h of i)try{await Uc(h),o++}catch(d){console.warn("❌ Failed to save food:",h.name,d),c++}}console.log(`📊 Save results: ${o} saved, ${c} errors`),await ai();const l=document.getElementById("uploadModal");l&&(l.style.display="none");const f=c>0?`Uploaded ${o} foods (${c} failed)`:`Successfully uploaded ${o} food items!`;je(f,"success"),Vh()}else je("No valid food data found in the file","error")}catch(a){console.error("❌ Error processing food file:",a),je(`Error: ${a instanceof Error?a.message:"Unknown error"}`,"error")}t.value=""}async function Gh(e){return new Promise((t,r)=>{const a=new FileReader;a.onload=function(n){var s;try{typeof window.XLSX>"u"?zh(()=>{var i;ao((i=n.target)==null?void 0:i.result,t,r)}):ao((s=n.target)==null?void 0:s.result,t,r)}catch(i){r(i)}},a.onerror=()=>r(new Error("Failed to read file")),a.readAsArrayBuffer(e)})}function zh(e){const t=document.createElement("script");t.src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js",t.onload=e,t.onerror=()=>{throw new Error("Failed to load XLSX library")},document.head.appendChild(t)}function ao(e,t,r){try{const a=window.XLSX,n=a.read(e,{type:"array"}),s=n.SheetNames[0],i=n.Sheets[s],o=a.utils.decode_range(i["!ref"]),c=[];for(let f=o.s.r;f<=o.e.r;f++){const u=[];for(let h=o.s.c;h<=o.e.c;h++){const d=a.utils.encode_cell({r:f,c:h}),g=i[d],p=g&&g.v||"";u.push(p.toString().trim())}c.push(u)}console.log("📊 Excel data converted to 2D array, first 3 rows:",c.slice(0,3));const l=qh(c);console.log(`📊 Parsed ${l.length} foods from Excel file`),t(l)}catch(a){console.error("❌ Error parsing Excel data:",a),r(new Error("Failed to parse Excel file. Please check the format."))}}function qh(e){const t=[];if(e.length<3)return console.error("Excel has too few rows to parse."),[];const r=e[0].length;for(let a=0;a+4<r;a+=6){const n=(e[0][a]||"").toString().trim();if(!n)continue;const s=[(e[1][a]||"").toString().trim().toLowerCase(),(e[1][a+1]||"").toString().trim().toLowerCase(),(e[1][a+2]||"").toString().trim().toLowerCase(),(e[1][a+3]||"").toString().trim().toLowerCase(),(e[1][a+4]||"").toString().trim().toLowerCase()];if(s.join(",")!=="food item,brand,carb,fat,prot"){console.log(`⚠️ Skipping section "${n}" - headers don't match expected format:`,s);continue}console.log(`📊 Processing section "${n}" at column ${a}`);for(let i=2;i<e.length;i++){const o=e[i];if(!o||o.length<=a+4)continue;const c=(o[a]||"").toString().trim();if(!c)continue;let l=(o[a+1]||"").toString().trim();const f=parseFloat(o[a+2])||0,u=parseFloat(o[a+3])||0,h=parseFloat(o[a+4])||0;if((!l||l.length<=1||/^\d+$/.test(l)||/^\d+\.\d+$/.test(l)||/^[0-9\s\.]+$/.test(l)||l.toLowerCase().includes("carb")||l.toLowerCase().includes("fat")||l.toLowerCase().includes("prot")||l.toLowerCase().includes("protein")||l.toLowerCase().includes("brand")||l.toLowerCase().includes("item")||l.toLowerCase().includes("total")||l.toLowerCase().includes("example"))&&(l=""),c&&c.length>0&&c.length<100){const d=c.toLowerCase();if(["food item","foor item","brand","item","carb","fat","prot","total","add up values","example"].some(x=>d.includes(x)))continue;t.find(x=>x.name.toLowerCase()===En(c).toLowerCase()&&x.brand.toLowerCase()===(l?En(l):"").toLowerCase()&&x.category===n)||t.push({name:En(c),brand:l?En(l):"",carbs:f,fat:u,protein:h,category:n,created_at:new Date().toISOString(),updated_at:new Date().toISOString()})}}}return t}function En(e){return e.replace(/\w\S*/g,t=>t.charAt(0).toUpperCase()+t.substr(1).toLowerCase())}async function Yc(e){try{const t=zr.find(n=>n.id===e),r=document.getElementById(`qty-${e}`),a=r?parseInt(r.value):1;if(t){const n=Ze.find(s=>s.food_id===e||s.id===e);if(n)n.quantity+=a;else{const s={...t,food_id:e,quantity:a};Ze.push(s)}await Hc(e,a),await zc(),Xt(zr.filter(s=>{var c;const i=document.querySelector(".filter-btn.active"),o=(i==null?void 0:i.getAttribute("data-category"))||"all";return o==="all"||((c=s.category)==null?void 0:c.toLowerCase())===o.toLowerCase()}));try{typeof window.loadAndDisplayShoppingList=="function"&&(await window.loadAndDisplayShoppingList(),console.log("✅ Shopping list display refreshed"));const s=new CustomEvent("shoppingListNeedsRefresh",{detail:{source:"food-tracker",timestamp:Date.now()}});window.dispatchEvent(s)}catch(s){console.warn("⚠️ Could not refresh shopping list display:",s)}}else console.error("Could not find food with ID:",e),je("Error: Could not add item to list.","error")}catch(t){console.error("Error adding to shopping list:",t),je("Error adding to shopping list","error")}}function je(e,t="success"){let r=document.getElementById("food-tracker-message");if(!r){r=document.createElement("div"),r.id="food-tracker-message",r.className="message";const a=document.getElementById("food-tracker")||document.body;a.insertBefore(r,a.firstChild)}r.textContent=e,r.className=`message ${t}`,r.style.display="block",setTimeout(()=>{r&&(r.style.display="none")},3e3)}async function ni(e,t=!1){try{const r=Ze.find(a=>a.food_id===e||a.id===e);if(r){const{removeFromShoppingList:a}=await $r(async()=>{const{removeFromShoppingList:n}=await Promise.resolve().then(()=>ti);return{removeFromShoppingList:n}},void 0);await a(r.id),Ze=Ze.filter(n=>n.food_id!==e&&n.id!==e),wa(),Xt(zr.filter(n=>{var o;const s=document.querySelector(".filter-btn.active"),i=(s==null?void 0:s.getAttribute("data-category"))||"all";return i==="all"||((o=n.category)==null?void 0:o.toLowerCase())===i.toLowerCase()})),setTimeout(()=>{document.querySelectorAll(".food-card").forEach(s=>{const i=s.querySelector(".add-btn"),o=s.getAttribute("data-food-id");if(i&&o){const c=Ze.some(l=>l.food_id===o||l.id===o);i.textContent=c?"Remove":"Add to List",i.classList.toggle("added",c)}})},100)}}catch(r){console.error("Error removing from shopping list:",r),je("Error removing item from shopping list","error")}}function wa(){const e=document.getElementById("shoppingItems");if(!e)return;e.innerHTML="";let t=0,r=0,a=0;if(Ze.length===0)e.innerHTML='<p class="empty-state">Your shopping list is empty. Add some foods from the Food Tracker!</p>';else{const o={};Ze.forEach(c=>{const l=c.category||"Other";o[l]||(o[l]=[]),o[l].push(c)}),Object.keys(o).sort().forEach(c=>{const l=document.createElement("div");l.className="shopping-category-group",l.innerHTML=`<h4 class="shopping-category-heading">${c}</h4>`;const f=document.createElement("div");f.className="shopping-category-items",o[c].forEach(u=>{const h=document.createElement("div");h.className="shopping-item";const d=u.brand||"",g=u.name||"",p=parseFloat(u.carbs)||0,x=parseFloat(u.fat)||0,y=parseFloat(u.protein)||0;h.innerHTML=`
          <div class="item-info">
            <h4>${g}</h4>
            ${d?`<span class="item-brand">Brand: ${d}</span>`:""}
            <span class="item-quantity">Qty: ${u.quantity}</span>
          </div>
          <div class="item-nutrition">
            <span>carbs: ${p.toFixed(1)}g</span>
            <span>fat: ${x.toFixed(1)}g</span>  
            <span>protein: ${y.toFixed(1)}g</span>
          </div>
          <button class="remove-btn" onclick="handleRemoveFromShoppingList('${u.food_id||u.id}')">Remove</button>
        `,f.appendChild(h),t+=p*u.quantity,r+=x*u.quantity,a+=y*u.quantity}),l.appendChild(f),e.appendChild(l)})}const n=document.getElementById("totalCarbs"),s=document.getElementById("totalFat"),i=document.getElementById("totalProtein");n&&(n.textContent=t.toFixed(1)+"g"),s&&(s.textContent=r.toFixed(1)+"g"),i&&(i.textContent=a.toFixed(1)+"g")}async function si(){try{await ri(),Ze=[],wa(),Xt(zr.filter(e=>{var a;const t=document.querySelector(".filter-btn.active"),r=(t==null?void 0:t.getAttribute("data-category"))||"all";return r==="all"||((a=e.category)==null?void 0:a.toLowerCase())===r.toLowerCase()})),je("Shopping list cleared! 🧹","success")}catch(e){console.error("Error clearing shopping list:",e),je("Error clearing shopping list","error")}}window.addToShoppingList=Yc;window.removeFromShoppingList=ni;window.handleRemoveFromShoppingList=Kh;window.filterByCategory=qc;window.clearShoppingList=si;window.handleClearShoppingList=Xh;window.updateShoppingListDisplay=wa;window.printShoppingList=Jc;window.handleClearFoodTracker=()=>{Zc().catch(e=>{console.error("Error clearing food tracker:",e),je("Error clearing food tracker","error")})};function Xh(){si().catch(e=>{console.error("Error clearing shopping list:",e),je("Error clearing shopping list","error")})}function Kh(e,t=!1){ni(e,t).catch(r=>{console.error("Error removing from shopping list:",r),je("Error removing item","error")})}function Jc(){var l;if(!Ze||Ze.length===0){je("Your shopping list is empty. Add some items first!","error");return}const e=qt(),t=((l=e==null?void 0:e.user_metadata)==null?void 0:l.name)||(e==null?void 0:e.email)||"User",r=window.open("","_blank");if(!r){je("Please allow popups to print your shopping list","error");return}let a=0,n=0,s=0,i=0;Ze.forEach(f=>{a+=(parseFloat(f.carbs)||0)*f.quantity,n+=(parseFloat(f.fat)||0)*f.quantity,s+=(parseFloat(f.protein)||0)*f.quantity,i+=f.quantity});const o={};Ze.forEach(f=>{const u=f.category||"Other";o[u]||(o[u]=[]),o[u].push(f)});const c=`
    <!DOCTYPE html>
    <html>
    <head>
      <title>NutriValor - Shopping List</title>
      <style>
        body { 
          font-family: Arial, sans-serif; 
          margin: 10px; 
          line-height: 1.2;
          font-size: 12px;
        }
        .header {
          text-align: center;
          border-bottom: 1px solid #333;
          padding-bottom: 8px;
          margin-bottom: 15px;
        }
        .header h1 {
          font-size: 18px;
          margin: 0 0 5px 0;
        }
        .user-info {
          font-size: 12px;
          color: #667eea;
          font-weight: bold;
          margin-bottom: 5px;
        }
        .header p {
          font-size: 10px;
          margin: 0;
          color: #666;
        }
        .content-wrapper {
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 15px;
          column-fill: balance;
        }
        .category {
          margin-bottom: 12px;
          break-inside: avoid;
          page-break-inside: avoid;
        }
        .category-title {
          background: #f5f5f5;
          padding: 4px 8px;
          font-weight: bold;
          font-size: 13px;
          border-left: 3px solid #667eea;
          margin-bottom: 5px;
        }
        .item {
          padding: 3px 8px;
          border-bottom: 1px solid #eee;
          display: flex;
          justify-content: space-between;
          align-items: flex-start;
          font-size: 11px;
        }
        .item-checkbox {
          width: 12px;
          height: 12px;
          border: 1px solid #333;
          margin-right: 8px;
          margin-top: 2px;
          flex-shrink: 0;
        }
        .item-details {
          flex: 1;
          margin-right: 8px;
        }
        .item-name {
          font-weight: bold;
          font-size: 12px;
          line-height: 1.2;
        }
        .item-brand {
          color: #666;
          font-style: italic;
          font-size: 10px;
          line-height: 1.1;
        }
        .item-nutrition {
          font-size: 9px;
          color: #888;
          line-height: 1.1;
          margin-top: 2px;
        }
        .item-quantity {
          font-weight: bold;
          color: #667eea;
          font-size: 11px;
          white-space: nowrap;
        }
        .totals {
          margin-top: 15px;
          border: 1px solid #333;
          padding: 10px;
          background: #f9f9f9;
          break-inside: avoid;
          page-break-inside: avoid;
          grid-column: 1 / -1;
        }
        .totals-title {
          font-size: 14px;
          font-weight: bold;
          margin-bottom: 8px;
          text-align: center;
        }
        .totals-grid {
          display: grid;
          grid-template-columns: repeat(4, 1fr);
          gap: 8px;
          text-align: center;
        }
        .total-item {
          padding: 5px;
          background: white;
          border-radius: 3px;
        }
        .total-label {
          font-size: 9px;
          color: #666;
          display: block;
        }
        .total-value {
          font-size: 12px;
          font-weight: bold;
          color: #333;
        }
        .footer {
          margin-top: 15px;
          text-align: center;
          font-size: 9px;
          color: #666;
          border-top: 1px solid #ccc;
          padding-top: 5px;
          grid-column: 1 / -1;
        }
        @media screen and (max-width: 600px) {
          .content-wrapper {
            grid-template-columns: 1fr;
          }
        }
        @media print {
          body { margin: 5px; }
          .category { break-inside: avoid; page-break-inside: avoid; }
          .item { break-inside: avoid; }
          .totals { break-inside: avoid; page-break-inside: avoid; }
        }
      </style>
    </head>
    <body>
      <div class="header">
        <h1>NutriValor Shopping List</h1>
        <div class="user-info">For: ${t}</div>
        <p>${new Date().toLocaleDateString()} ${new Date().toLocaleTimeString()}</p>
      </div>
      
      <div class="content-wrapper">
        ${Object.keys(o).sort().map(f=>`
          <div class="category">
            <div class="category-title">${f}</div>
            ${o[f].map(u=>`
              <div class="item">
                <div class="item-checkbox"></div>
                <div class="item-details">
                  <div class="item-name">${u.name}</div>
                  ${u.brand?`<div class="item-brand">${u.brand}</div>`:""}
                  <div class="item-nutrition">
                    C:${la(u.carbs)}g F:${la(u.fat)}g P:${la(u.protein)}g
                  </div>
                </div>
                <div class="item-quantity">${u.quantity}</div>
              </div>
            `).join("")}
          </div>
        `).join("")}
        
        <div class="totals">
          <div class="totals-title">Nutrition Totals</div>
          <div class="totals-grid">
            <div class="total-item">
              <span class="total-label">Items</span>
              <div class="total-value">${i}</div>
            </div>
            <div class="total-item">
              <span class="total-label">Carbs</span>
              <div class="total-value">${a.toFixed(1)}g</div>
            </div>
            <div class="total-item">
              <span class="total-label">Fat</span>
              <div class="total-value">${n.toFixed(1)}g</div>
            </div>
            <div class="total-item">
              <span class="total-label">Protein</span>
              <div class="total-value">${s.toFixed(1)}g</div>
            </div>
          </div>
        </div>
        
        <div class="footer">
          <p>© NutriValor - Value your Nutrition</p>
        </div>
      </div>
      
      <script>
        window.onload = function() {
          window.print();
        }
      <\/script>
    </body>
    </html>
  `;r.document.write(c),r.document.close(),je("Opening print dialog...","success")}async function Zc(){if(console.log("🗑️ Clear food tracker requested..."),!zr||zr.length===0){je("Food tracker is already empty!","error");return}if(!confirm(`Are you sure you want to clear all ${zr.length} food items from the Food Tracker? This will also clear your shopping list. This action cannot be undone.`)){console.log("🚫 Clear food tracker cancelled by user");return}try{if(!await qt()){je("Please log in first.","error");return}console.log("🗑️ Clearing all foods for user..."),await Zs(),await ri(),zr=[],Ze=[],Xt([]),wa();const r=document.querySelector(".category-filters");r&&(r.innerHTML=`<button class="filter-btn active" onclick="filterByCategory('all')">ALL</button>`),localStorage.removeItem("lastFoodUploadDate");const a=document.getElementById("lastUpdateInfo");a&&(a.style.display="none"),je("Food tracker and shopping list cleared successfully!","success"),console.log("✅ Food tracker cleared successfully")}catch(t){console.error("❌ Error clearing food tracker:",t),je("Error clearing food tracker: "+t.message,"error")}}const Yh=Object.freeze(Object.defineProperty({__proto__:null,addToShoppingList:Yc,clearShoppingList:si,displayFoods:Xt,filterByCategory:qc,handleClearFoodTracker:Zc,handleFoodFileUpload:Kc,initializeFoodTracker:Gc,loadAndDisplayFoods:ai,printShoppingList:Jc,removeFromShoppingList:ni,updateShoppingListDisplay:wa},Symbol.toStringTag,{value:"Module"}));let Tr=[],Ir="",Ft="",et="",gr=null;async function Jh(){console.log("⚖️ Initializing weight tracker..."),Zh(),rd(),ed(),ii(),oi(),Qh()}function Zh(){const e=qt(),t=(e==null?void 0:e.id)||"anonymous";Tr=JSON.parse(localStorage.getItem(`weights_${t}`)||"[]"),Ir=localStorage.getItem(`startingWeight_${t}`)||"",Ft=localStorage.getItem(`idealWeight_${t}`)||"",et=localStorage.getItem(`targetDate_${t}`)||""}function Qc(){const e=qt(),t=(e==null?void 0:e.id)||"anonymous";localStorage.setItem(`weights_${t}`,JSON.stringify(Tr)),localStorage.setItem(`startingWeight_${t}`,Ir),localStorage.setItem(`idealWeight_${t}`,Ft),localStorage.setItem(`targetDate_${t}`,et)}function Qh(){const e=new Date().toISOString().split("T")[0],t=document.getElementById("entryDate");t&&!t.value&&(t.value=e)}function ed(){const e=document.getElementById("startingWeight"),t=document.getElementById("idealWeight"),r=document.getElementById("targetDate");e&&(e.value=Ir,e.addEventListener("change",hs)),t&&(t.value=Ft,t.addEventListener("change",hs)),r&&(r.value=et,r.addEventListener("change",hs))}function rd(){if(document.getElementById("weightChart"))if(typeof window.Chart>"u"){const t=document.createElement("script");t.src="https://cdn.jsdelivr.net/npm/chart.js",t.onload=()=>no(),document.head.appendChild(t)}else no()}function no(){const e=document.getElementById("weightChart");if(!e)return;gr&&(gr.destroy(),gr=null);const t=e.getContext("2d");t&&(gr=new window.Chart(t,{type:"line",data:{labels:[],datasets:[{label:"Actual Weight",data:[],borderColor:"#667eea",backgroundColor:"rgba(102, 126, 234, 0.1)",tension:.3,fill:!0},{label:"Ideal Path",data:[],borderColor:"#10b981",borderDash:[5,5],tension:0,fill:!1,pointRadius:0}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{x:{title:{display:!0,text:"Date"}},y:{title:{display:!0,text:"Weight (kg)"}}},plugins:{title:{display:!0,text:"Weight Progress",font:{size:16,weight:"bold"}},legend:{position:"bottom",labels:{padding:20,font:{size:12}}}}}}))}function td(e){if(!Ir||!Ft||!et||Tr.length===0)return[];const t=Tr[0].date,r=new Date(t).getTime(),n=new Date(et).getTime()-r;if(n<=0)return[];const s=parseFloat(Ir),o=parseFloat(Ft)-s;return[...new Set([...e,et])].sort().map(l=>{const f=new Date(l).getTime();if(f<r)return null;const u=f-r,h=Math.min(1,u/n),d=s+o*h;return{x:l,y:d.toFixed(1)}}).filter(l=>l!==null)}function ii(){if(!gr)return;Tr.sort((a,n)=>new Date(a.date).getTime()-new Date(n.date).getTime());const e=Tr.map(a=>a.date);gr.data.datasets[0].data=Tr.map(a=>({x:a.date,y:a.weight}));const t=td(e);gr.data.datasets[1].data=t;const r=[...new Set([...e,et])].sort();et&&Ir&&Ft?gr.data.labels=r:gr.data.labels=e,gr.update()}function oi(){const e=document.getElementById("progressText");if(!e||!Ir||Tr.length===0){e&&(e.textContent="");return}const t=Tr[Tr.length-1].weight,r=(parseFloat(Ir)-t).toFixed(1);parseFloat(r)>0?(e.textContent=`Congratulations! You've lost ${r}kg so far.`,e.style.color="#065f46"):parseFloat(r)<0?(e.textContent=`You've gained ${Math.abs(parseFloat(r))}kg. Keep going!`,e.style.color="#991b1b"):(e.textContent="Your weight is the same as your starting weight.",e.style.color="#1e293b")}function ad(){const e=document.getElementById("entryDate"),t=document.getElementById("entryWeight"),r=document.getElementById("startingWeight"),a=e==null?void 0:e.value,n=parseFloat((t==null?void 0:t.value)||"0"),s=parseFloat((r==null?void 0:r.value)||"0");if(!a||!n){Dn("Please enter a date and weight.","error");return}if(!s&&!Ir){Dn("Please enter a starting weight first.","error");return}s&&!Ir&&(Ir=s.toString());const i=Tr.findIndex(o=>o.date===a);i>-1?Tr[i].weight=n:Tr.push({date:a,weight:n}),Qc(),ii(),oi(),t&&(t.value=""),Dn("Weight entry added successfully!","success")}function hs(){const e=document.getElementById("startingWeight"),t=document.getElementById("idealWeight"),r=document.getElementById("targetDate");Ir=(e==null?void 0:e.value)||"",Ft=(t==null?void 0:t.value)||"",et=(r==null?void 0:r.value)||"",Qc(),ii(),oi()}function nd(){if(!confirm("Are you sure you want to delete all weight data? This cannot be undone."))return;const e=qt(),t=(e==null?void 0:e.id)||"anonymous";localStorage.removeItem(`weights_${t}`),localStorage.removeItem(`startingWeight_${t}`),localStorage.removeItem(`idealWeight_${t}`),localStorage.removeItem(`targetDate_${t}`),Tr=[],Ir="",Ft="",et="",gr&&(gr.data.labels=[],gr.data.datasets[0].data=[],gr.data.datasets[1].data=[],gr.update());const r=document.getElementById("startingWeight"),a=document.getElementById("idealWeight"),n=document.getElementById("targetDate"),s=document.getElementById("progressText");r&&(r.value=""),a&&(a.value=""),n&&(n.value=""),s&&(s.textContent=""),Dn("All weight data cleared successfully!","success")}function Dn(e,t="success"){let r=document.getElementById("weight-message");if(!r){r=document.createElement("div"),r.id="weight-message",r.className="message";const a=document.getElementById("weight-tracker")||document.body;a.insertBefore(r,a.firstChild)}r.textContent=e,r.className=`message ${t}`,r.style.display="block",setTimeout(()=>{r&&(r.style.display="none")},3e3)}window.addWeightEntry=ad;window.clearWeightData=nd;async function sd(){console.log("🧮 Initializing macro calculator..."),id(),od()}function id(){const e=qt(),t=(e==null?void 0:e.id)||"anonymous",r=localStorage.getItem(`macroProfile_${t}`);if(r)try{const a=JSON.parse(r);cd(a)}catch(a){console.error("Error loading saved macro profile:",a)}}function od(){const e=document.getElementById("macro-age"),t=document.getElementById("macro-weight"),r=document.getElementById("macro-height");e&&!e.value&&(e.value="30"),t&&!t.value&&(t.value="70"),r&&!r.value&&(r.value="175")}function cd(e){const t=document.getElementById("macro-age"),r=document.getElementById("macro-gender"),a=document.getElementById("macro-weight"),n=document.getElementById("macro-height"),s=document.getElementById("macro-activity"),i=document.getElementById("macro-lossRate"),o=document.getElementById("macro-proteinRatio"),c=document.getElementById("macro-fatRatio");t&&(t.value=e.age.toString()),r&&(r.value=e.gender),a&&(a.value=e.weight.toString()),n&&(n.value=e.height.toString()),s&&(s.value=e.activity.toString()),i&&(i.value=e.lossRate.toString()),o&&(o.value=e.proteinRatio.toString()),c&&(c.value=e.fatRatio.toString())}function ld(){const e=document.getElementById("macro-age"),t=document.getElementById("macro-gender"),r=document.getElementById("macro-weight"),a=document.getElementById("macro-height"),n=document.getElementById("macro-activity"),s=document.getElementById("macro-lossRate"),i=document.getElementById("macro-proteinRatio"),o=document.getElementById("macro-fatRatio"),c=parseFloat((e==null?void 0:e.value)||"0"),l=(t==null?void 0:t.value)||"male",f=parseFloat((r==null?void 0:r.value)||"0"),u=parseFloat((a==null?void 0:a.value)||"0"),h=parseFloat((n==null?void 0:n.value)||"1.55"),d=parseFloat((s==null?void 0:s.value)||"0"),g=parseFloat((i==null?void 0:i.value)||"2.2"),p=parseFloat((o==null?void 0:o.value)||"0.8");if(!c||!f||!u){Et("Please fill in all required fields (Age, Weight, Height)","error");return}if(c<10||c>120){Et("Please enter a valid age between 10 and 120","error");return}if(f<20||f>300){Et("Please enter a valid weight between 20 and 300 kg","error");return}if(u<100||u>250){Et("Please enter a valid height between 100 and 250 cm","error");return}let x;l==="male"?x=10*f+6.25*u-5*c+5:x=10*f+6.25*u-5*c-161;let y=x*h;const F=y+d;let v=f*g,C=f*p,P=(F-v*4-C*9)/4;v=Math.max(0,Math.round(v)),C=Math.max(0,Math.round(C)),P=Math.max(10,Math.round(P));const I={protein:v,carbs:P,fat:C,calories:Math.round(F),bmr:Math.round(x),tdee:Math.round(y)};fd(I),Et("Macro calculations completed successfully!","success")}function fd(e){const t=document.getElementById("protein-value"),r=document.getElementById("carbs-value"),a=document.getElementById("fat-value"),n=document.getElementById("calories-value"),s=document.getElementById("bmr-value"),i=document.getElementById("tdee-value"),o=document.getElementById("adjusted-calories"),c=document.getElementById("macro-results"),l=document.getElementById("macro-explanation");t&&(t.textContent=`${e.protein}g`),r&&(r.textContent=`${e.carbs}g`),a&&(a.textContent=`${e.fat}g`),n&&(n.textContent=e.calories.toString()),s&&(s.textContent=e.bmr.toString()),i&&(i.textContent=e.tdee.toString()),o&&(o.textContent=e.calories.toString()),c&&(c.style.display="grid",c.classList.add("show-results")),l&&(l.style.display="block")}function ud(){const e=document.getElementById("macro-age"),t=document.getElementById("macro-gender"),r=document.getElementById("macro-weight"),a=document.getElementById("macro-height"),n=document.getElementById("macro-activity"),s=document.getElementById("macro-lossRate"),i=document.getElementById("macro-proteinRatio"),o=document.getElementById("macro-fatRatio"),c={age:parseFloat((e==null?void 0:e.value)||"0"),gender:(t==null?void 0:t.value)||"male",weight:parseFloat((r==null?void 0:r.value)||"0"),height:parseFloat((a==null?void 0:a.value)||"0"),activity:parseFloat((n==null?void 0:n.value)||"1.55"),lossRate:parseFloat((s==null?void 0:s.value)||"0"),proteinRatio:parseFloat((i==null?void 0:i.value)||"2.2"),fatRatio:parseFloat((o==null?void 0:o.value)||"0.8")};if(!c.age||!c.weight||!c.height){Et("Please fill in all required fields before saving","error");return}const l=qt(),f=(l==null?void 0:l.id)||"anonymous";try{localStorage.setItem(`macroProfile_${f}`,JSON.stringify(c)),Et("Macro profile saved successfully!","success")}catch(u){console.error("Error saving macro profile:",u),Et("Error saving macro profile","error")}}function Et(e,t="success"){let r=document.getElementById("macro-message");if(!r){r=document.createElement("div"),r.id="macro-message",r.className="message";const a=document.getElementById("macro-calculator")||document.body;a.insertBefore(r,a.firstChild)}r.textContent=e,r.className=`message ${t}`,r.style.display="block",setTimeout(()=>{r&&(r.style.display="none")},4e3)}window.calculateMacros=ld;window.saveMacroProfile=ud;/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var e0=1252,hd=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],ci={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},li=function(e){hd.indexOf(e)!=-1&&(e0=ci[0]=e)};function dd(){li(1252)}var qr=function(e){li(e)};function r0(){qr(1200),dd()}function so(e){for(var t=[],r=0,a=e.length;r<a;++r)t[r]=e.charCodeAt(r);return t}function pd(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function t0(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Oa=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?pd(e.slice(2)):t==254&&r==255?t0(e.slice(2)):t==65279?e.slice(1):e},kn=function(t){return String.fromCharCode(t)},io=function(t){return String.fromCharCode(t)},Ja,Tt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function oo(e){for(var t="",r=0,a=0,n=0,s=0,i=0,o=0,c=0,l=0;l<e.length;)r=e.charCodeAt(l++),s=r>>2,a=e.charCodeAt(l++),i=(r&3)<<4|a>>4,n=e.charCodeAt(l++),o=(a&15)<<2|n>>6,c=n&63,isNaN(a)?o=c=64:isNaN(n)&&(c=64),t+=Tt.charAt(s)+Tt.charAt(i)+Tt.charAt(o)+Tt.charAt(c);return t}function Or(e){var t="",r=0,a=0,n=0,s=0,i=0,o=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)s=Tt.indexOf(e.charAt(l++)),i=Tt.indexOf(e.charAt(l++)),r=s<<2|i>>4,t+=String.fromCharCode(r),o=Tt.indexOf(e.charAt(l++)),a=(i&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(a)),c=Tt.indexOf(e.charAt(l++)),n=(o&3)<<6|c,c!==64&&(t+=String.fromCharCode(n));return t}var _e=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Kt=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Ct(e){return _e?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function co(e){return _e?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Gr=function(t){return _e?Kt(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Yt(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function fi(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return fi(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var kt=_e?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Kt(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var a=new Uint8Array(r),n=0;for(t=0,r=0;t<e.length;r+=n,++t)if(n=e[t].length,e[t]instanceof Uint8Array)a.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";a.set(new Uint8Array(e[t]),r)}return a}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function gd(e){for(var t=[],r=0,a=e.length+250,n=Ct(e.length+255),s=0;s<e.length;++s){var i=e.charCodeAt(s);if(i<128)n[r++]=i;else if(i<2048)n[r++]=192|i>>6&31,n[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=e.charCodeAt(++s)&1023;n[r++]=240|i>>8&7,n[r++]=128|i>>2&63,n[r++]=128|o>>6&15|(i&3)<<4,n[r++]=128|o&63}else n[r++]=224|i>>12&15,n[r++]=128|i>>6&63,n[r++]=128|i&63;r>a&&(t.push(n.slice(0,r)),r=0,n=Ct(65535),a=65530)}return t.push(n.slice(0,r)),kt(t)}var vr=/\u0000/g,Da=/[\u0001-\u0006]/g;function fa(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Xr(e,t){var r=""+e;return r.length>=t?r:Le("0",t-r.length)+r}function ui(e,t){var r=""+e;return r.length>=t?r:Le(" ",t-r.length)+r}function Ln(e,t){var r=""+e;return r.length>=t?r:r+Le(" ",t-r.length)}function xd(e,t){var r=""+Math.round(e);return r.length>=t?r:Le("0",t-r.length)+r}function md(e,t){var r=""+e;return r.length>=t?r:Le("0",t-r.length)+r}var lo=Math.pow(2,32);function sa(e,t){if(e>lo||e<-lo)return xd(e,t);var r=Math.round(e);return md(r,t)}function Nn(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var fo=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],ds=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function vd(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var xe={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},uo={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},wd={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Bn(e,t,r){for(var a=e<0?-1:1,n=e*a,s=0,i=1,o=0,c=1,l=0,f=0,u=Math.floor(n);l<t&&(u=Math.floor(n),o=u*i+s,f=u*l+c,!(n-u<5e-8));)n=1/(n-u),s=i,i=o,c=l,l=f;if(f>t&&(l>t?(f=c,o=s):(f=l,o=i)),!r)return[0,a*o,f];var h=Math.floor(a*o/f);return[h,a*o-h*f,f]}function $t(e,t,r){if(e>2958465||e<0)return null;var a=e|0,n=Math.floor(86400*(e-a)),s=0,i=[],o={D:a,T:n,u:86400*(e-a)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(a+=1462),o.u>.9999&&(o.u=0,++n==86400&&(o.T=n=0,++a,++o.D)),a===60)i=r?[1317,10,29]:[1900,2,29],s=3;else if(a===0)i=r?[1317,8,29]:[1900,1,0],s=6;else{a>60&&--a;var c=new Date(1900,0,1);c.setDate(c.getDate()+a-1),i=[c.getFullYear(),c.getMonth()+1,c.getDate()],s=c.getDay(),a<60&&(s=(s+6)%7),r&&(s=Sd(c,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=n%60,n=Math.floor(n/60),o.M=n%60,n=Math.floor(n/60),o.H=n,o.q=s,o}var a0=new Date(1899,11,31,0,0,0),_d=a0.getTime(),yd=new Date(1900,2,1,0,0,0);function n0(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=yd&&(r+=24*60*60*1e3),(r-(_d+(e.getTimezoneOffset()-a0.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function hi(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Ed(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function kd(e){var t=e<0?12:11,r=hi(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function Td(e){var t=hi(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Za(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=kd(e):t===10?r=e.toFixed(10).substr(0,12):r=Td(e),hi(Ed(r.toUpperCase()))}function Wt(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Za(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Mr(14,n0(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Sd(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function Ad(e,t,r,a){var n="",s=0,i=0,o=r.y,c,l=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:c=o%100,l=2;break;default:c=o%1e4,l=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,l=t.length;break;case 3:return ds[r.m-1][1];case 5:return ds[r.m-1][0];default:return ds[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,l=t.length;break;case 3:return fo[r.q][0];default:return fo[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,l=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,l=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,l=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Xr(r.S,t.length):(a>=2?i=a===3?1e3:100:i=a===1?10:1,s=Math.round(i*(r.S+r.u)),s>=60*i&&(s=0),t==="s"?s===0?"0":""+s/i:(n=Xr(s,2+a),t==="ss"?n.substr(0,2):"."+n.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}l=t.length===3?1:2;break;case 101:c=o,l=1;break}var f=l>0?Xr(c,l):"";return f}function St(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,a=e.substr(0,r);r!=e.length;r+=t)a+=(a.length>0?",":"")+e.substr(r,t);return a}var s0=/%/g;function bd(e,t,r){var a=t.replace(s0,""),n=t.length-a.length;return ut(e,a,r*Math.pow(10,2*n))+Le("%",n)}function Fd(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return ut(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function i0(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+i0(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%n;if(s<0&&(s+=n),r=(t/Math.pow(10,s)).toPrecision(a+1+(n+s)%n),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,n)+"."+r.substr(2+n),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,f){return c+l+f.substr(0,(n+s)%n)+"."+f.substr(s)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var o0=/# (\?+)( ?)\/( ?)(\d+)/;function Cd(e,t,r){var a=parseInt(e[4],10),n=Math.round(t*a),s=Math.floor(n/a),i=n-s*a,o=a;return r+(s===0?"":""+s)+" "+(i===0?Le(" ",e[1].length+1+e[4].length):ui(i,e[1].length)+e[2]+"/"+e[3]+Xr(o,e[4].length))}function Id(e,t,r){return r+(t===0?"":""+t)+Le(" ",e[1].length+2+e[4].length)}var c0=/^#*0*\.([0#]+)/,l0=/\).*[0#]/,f0=/\(###\) ###\\?-####/;function pr(e){for(var t="",r,a=0;a!=e.length;++a)switch(r=e.charCodeAt(a)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function ho(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function po(e,t){var r=e-Math.floor(e),a=Math.pow(10,t);return t<(""+Math.round(r*a)).length?0:Math.round(r*a)}function Od(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function Dd(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Lr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(l0)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Lr("n",a,r):"("+Lr("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Fd(e,t,r);if(t.indexOf("%")!==-1)return bd(e,t,r);if(t.indexOf("E")!==-1)return i0(t,r);if(t.charCodeAt(0)===36)return"$"+Lr(e,t.substr(t.charAt(1)==" "?2:1),r);var n,s,i,o,c=Math.abs(r),l=r<0?"-":"";if(t.match(/^00+$/))return l+sa(c,t.length);if(t.match(/^[#?]+$/))return n=sa(r,0),n==="0"&&(n=""),n.length>t.length?n:pr(t.substr(0,t.length-n.length))+n;if(s=t.match(o0))return Cd(s,c,l);if(t.match(/^#+0+$/))return l+sa(c,t.length-t.indexOf("0"));if(s=t.match(c0))return n=ho(r,s[1].length).replace(/^([^\.]+)$/,"$1."+pr(s[1])).replace(/\.$/,"."+pr(s[1])).replace(/\.(\d*)$/,function(g,p){return"."+p+Le("0",pr(s[1]).length-p.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return l+ho(c,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return l+St(sa(c,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Lr(e,t,-r):St(""+(Math.floor(r)+Od(r,s[1].length)))+"."+Xr(po(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return Lr(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=fa(Lr(e,t.replace(/[\\-]/g,""),r)),i=0,fa(fa(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return i<n.length?n.charAt(i++):g==="0"?"0":""}));if(t.match(f0))return n=Lr(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var f="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=Bn(c,Math.pow(10,i)-1,!1),n=""+l,f=ut("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),n+=f+s[2]+"/"+s[3],f=Ln(o[2],i),f.length<s[4].length&&(f=pr(s[4].substr(s[4].length-f.length))+f),n+=f,n;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=Bn(c,Math.pow(10,i)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?ui(o[1],i)+s[2]+"/"+s[3]+Ln(o[2],i):Le(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return n=sa(r,0),t.length<=n.length?n:pr(t.substr(0,t.length-n.length))+n;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=n.indexOf(".");var u=t.indexOf(".")-i,h=t.length-n.length-u;return pr(t.substr(0,u)+n+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return i=po(r,s[1].length),r<0?"-"+Lr(e,t,-r):St(Dd(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Xr(0,3-g.length):"")+g})+"."+Xr(i,s[1].length);switch(t){case"###,##0.00":return Lr(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var d=St(sa(c,0));return d!=="0"?l+d:"";case"###,###.00":return Lr(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Lr(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Rd(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return ut(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function Pd(e,t,r){var a=t.replace(s0,""),n=t.length-a.length;return ut(e,a,r*Math.pow(10,2*n))+Le("%",n)}function u0(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+u0(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%n;if(s<0&&(s+=n),r=(t/Math.pow(10,s)).toPrecision(a+1+(n+s)%n),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,f){return c+l+f.substr(0,(n+s)%n)+"."+f.substr(s)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Qr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(l0)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Qr("n",a,r):"("+Qr("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Rd(e,t,r);if(t.indexOf("%")!==-1)return Pd(e,t,r);if(t.indexOf("E")!==-1)return u0(t,r);if(t.charCodeAt(0)===36)return"$"+Qr(e,t.substr(t.charAt(1)==" "?2:1),r);var n,s,i,o,c=Math.abs(r),l=r<0?"-":"";if(t.match(/^00+$/))return l+Xr(c,t.length);if(t.match(/^[#?]+$/))return n=""+r,r===0&&(n=""),n.length>t.length?n:pr(t.substr(0,t.length-n.length))+n;if(s=t.match(o0))return Id(s,c,l);if(t.match(/^#+0+$/))return l+Xr(c,t.length-t.indexOf("0"));if(s=t.match(c0))return n=(""+r).replace(/^([^\.]+)$/,"$1."+pr(s[1])).replace(/\.$/,"."+pr(s[1])),n=n.replace(/\.(\d*)$/,function(g,p){return"."+p+Le("0",pr(s[1]).length-p.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return l+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return l+St(""+c);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Qr(e,t,-r):St(""+r)+"."+Le("0",s[1].length);if(s=t.match(/^#,#*,#0/))return Qr(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=fa(Qr(e,t.replace(/[\\-]/g,""),r)),i=0,fa(fa(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return i<n.length?n.charAt(i++):g==="0"?"0":""}));if(t.match(f0))return n=Qr(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var f="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=Bn(c,Math.pow(10,i)-1,!1),n=""+l,f=ut("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),n+=f+s[2]+"/"+s[3],f=Ln(o[2],i),f.length<s[4].length&&(f=pr(s[4].substr(s[4].length-f.length))+f),n+=f,n;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=Bn(c,Math.pow(10,i)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?ui(o[1],i)+s[2]+"/"+s[3]+Ln(o[2],i):Le(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return n=""+r,t.length<=n.length?n:pr(t.substr(0,t.length-n.length))+n;if(s=t.match(/^([#0]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=n.indexOf(".");var u=t.indexOf(".")-i,h=t.length-n.length-u;return pr(t.substr(0,u)+n+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Qr(e,t,-r):St(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Xr(0,3-g.length):"")+g})+"."+Xr(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var d=St(""+c);return d!=="0"?l+d:"";default:if(t.match(/\.[0#?]*$/))return Qr(e,t.slice(0,t.lastIndexOf(".")),r)+pr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function ut(e,t,r){return(r|0)===r?Qr(e,t,r):Lr(e,t,r)}function Ld(e){for(var t=[],r=!1,a=0,n=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(n,a-n),n=a+1}if(t[t.length]=e.substr(n),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var h0=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function _a(e){for(var t=0,r="",a="";t<e.length;)switch(r=e.charAt(t)){case"G":Nn(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(a=r;e.charAt(t++)!=="]"&&t<e.length;)a+=e.charAt(t);if(a.match(h0))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function Nd(e,t,r,a){for(var n=[],s="",i=0,o="",c="t",l,f,u,h="H";i<e.length;)switch(o=e.charAt(i)){case"G":if(!Nn(e,i))throw new Error("unrecognized character "+o+" in "+e);n[n.length]={t:"G",v:"General"},i+=7;break;case'"':for(s="";(u=e.charCodeAt(++i))!==34&&i<e.length;)s+=String.fromCharCode(u);n[n.length]={t:"t",v:s},++i;break;case"\\":var d=e.charAt(++i),g=d==="("||d===")"?d:"t";n[n.length]={t:g,v:d},++i;break;case"_":n[n.length]={t:"t",v:" "},i+=2;break;case"@":n[n.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(l==null&&(l=$t(t,r,e.charAt(i+1)==="2"),l==null))return"";n[n.length]={t:"X",v:e.substr(i,2)},c=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||l==null&&(l=$t(t,r),l==null))return"";for(s=o;++i<e.length&&e.charAt(i).toLowerCase()===o;)s+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),n[n.length]={t:o,v:s},c=o;break;case"A":case"a":case"上":var p={t:o,v:o};if(l==null&&(l=$t(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(l!=null&&(p.v=l.H>=12?"P":"A"),p.t="T",h="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(l!=null&&(p.v=l.H>=12?"PM":"AM"),p.t="T",i+=5,h="h"):e.substr(i,5).toUpperCase()==="上午/下午"?(l!=null&&(p.v=l.H>=12?"下午":"上午"),p.t="T",i+=5,h="h"):(p.t="t",++i),l==null&&p.t==="T")return"";n[n.length]=p,c=o;break;case"[":for(s=o;e.charAt(i++)!=="]"&&i<e.length;)s+=e.charAt(i);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(h0)){if(l==null&&(l=$t(t,r),l==null))return"";n[n.length]={t:"Z",v:s.toLowerCase()},c=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",_a(e)||(n[n.length]={t:"t",v:s}));break;case".":if(l!=null){for(s=o;++i<e.length&&(o=e.charAt(i))==="0";)s+=o;n[n.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++i<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(i))>-1;)s+=o;n[n.length]={t:"n",v:s};break;case"?":for(s=o;e.charAt(++i)===o;)s+=o;n[n.length]={t:o,v:s},c=o;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":n[n.length]={t:a===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)s+=e.charAt(i);n[n.length]={t:"D",v:s};break;case" ":n[n.length]={t:o,v:o},++i;break;case"$":n[n.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);n[n.length]={t:"t",v:o},++i;break}var x=0,y=0,F;for(i=n.length-1,c="t";i>=0;--i)switch(n[i].t){case"h":case"H":n[i].t=h,c="h",x<1&&(x=1);break;case"s":(F=n[i].v.match(/\.0+$/))&&(y=Math.max(y,F[0].length-1)),x<3&&(x=3);case"d":case"y":case"M":case"e":c=n[i].t;break;case"m":c==="s"&&(n[i].t="M",x<2&&(x=2));break;case"X":break;case"Z":x<1&&n[i].v.match(/[Hh]/)&&(x=1),x<2&&n[i].v.match(/[Mm]/)&&(x=2),x<3&&n[i].v.match(/[Ss]/)&&(x=3)}switch(x){case 0:break;case 1:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M),l.M>=60&&(l.M=0,++l.H);break;case 2:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M);break}var v="",C;for(i=0;i<n.length;++i)switch(n[i].t){case"t":case"T":case" ":case"D":break;case"X":n[i].v="",n[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[i].v=Ad(n[i].t.charCodeAt(0),n[i].v,l,y),n[i].t="t";break;case"n":case"?":for(C=i+1;n[C]!=null&&((o=n[C].t)==="?"||o==="D"||(o===" "||o==="t")&&n[C+1]!=null&&(n[C+1].t==="?"||n[C+1].t==="t"&&n[C+1].v==="/")||n[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(n[C].v==="/"||n[C].v===" "&&n[C+1]!=null&&n[C+1].t=="?"));)n[i].v+=n[C].v,n[C]={v:"",t:";"},++C;v+=n[i].v,i=C-1;break;case"G":n[i].t="t",n[i].v=Wt(t,r);break}var P="",I,S;if(v.length>0){v.charCodeAt(0)==40?(I=t<0&&v.charCodeAt(0)===45?-t:t,S=ut("n",v,I)):(I=t<0&&a>1?-t:t,S=ut("n",v,I),I<0&&n[0]&&n[0].t=="t"&&(S=S.substr(1),n[0].v="-"+n[0].v)),C=S.length-1;var W=n.length;for(i=0;i<n.length;++i)if(n[i]!=null&&n[i].t!="t"&&n[i].v.indexOf(".")>-1){W=i;break}var O=n.length;if(W===n.length&&S.indexOf("E")===-1){for(i=n.length-1;i>=0;--i)n[i]==null||"n?".indexOf(n[i].t)===-1||(C>=n[i].v.length-1?(C-=n[i].v.length,n[i].v=S.substr(C+1,n[i].v.length)):C<0?n[i].v="":(n[i].v=S.substr(0,C+1),C=-1),n[i].t="t",O=i);C>=0&&O<n.length&&(n[O].v=S.substr(0,C+1)+n[O].v)}else if(W!==n.length&&S.indexOf("E")===-1){for(C=S.indexOf(".")-1,i=W;i>=0;--i)if(!(n[i]==null||"n?".indexOf(n[i].t)===-1)){for(f=n[i].v.indexOf(".")>-1&&i===W?n[i].v.indexOf(".")-1:n[i].v.length-1,P=n[i].v.substr(f+1);f>=0;--f)C>=0&&(n[i].v.charAt(f)==="0"||n[i].v.charAt(f)==="#")&&(P=S.charAt(C--)+P);n[i].v=P,n[i].t="t",O=i}for(C>=0&&O<n.length&&(n[O].v=S.substr(0,C+1)+n[O].v),C=S.indexOf(".")+1,i=W;i<n.length;++i)if(!(n[i]==null||"n?(".indexOf(n[i].t)===-1&&i!==W)){for(f=n[i].v.indexOf(".")>-1&&i===W?n[i].v.indexOf(".")+1:0,P=n[i].v.substr(0,f);f<n[i].v.length;++f)C<S.length&&(P+=S.charAt(C++));n[i].v=P,n[i].t="t",O=i}}}for(i=0;i<n.length;++i)n[i]!=null&&"n?".indexOf(n[i].t)>-1&&(I=a>1&&t<0&&i>0&&n[i-1].v==="-"?-t:t,n[i].v=ut(n[i].t,n[i].v,I),n[i].t="t");var z="";for(i=0;i!==n.length;++i)n[i]!=null&&(z+=n[i].v);return z}var go=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function xo(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function Bd(e,t){var r=Ld(e),a=r.length,n=r[a-1].indexOf("@");if(a<4&&n>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||n>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=n>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=n>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=n>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[a,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(go),o=r[1].match(go);return xo(t,i)?[a,r[0]]:xo(t,o)?[a,r[1]]:[a,r[i!=null&&o!=null?2:1]]}return[a,s]}function Mr(e,t,r){r==null&&(r={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?a=r.dateNF:a=e;break;case"number":e==14&&r.dateNF?a=r.dateNF:a=(r.table!=null?r.table:xe)[e],a==null&&(a=r.table&&r.table[uo[e]]||xe[uo[e]]),a==null&&(a=wd[e]||"General");break}if(Nn(a,0))return Wt(t,r);t instanceof Date&&(t=n0(t,r.date1904));var n=Bd(a,t);if(Nn(n[1]))return Wt(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return Nd(n[1],t,r,n[0])}function Ut(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(xe[r]==null){t<0&&(t=r);continue}if(xe[r]==e){t=r;break}}t<0&&(t=391)}return xe[t]=e,t}function d0(){xe=vd()}var Md={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},p0=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function $d(e){var t=typeof e=="number"?xe[e]:e;return t=t.replace(p0,"(\\d+)"),new RegExp("^"+t+"$")}function Ud(e,t,r){var a=-1,n=-1,s=-1,i=-1,o=-1,c=-1;(t.match(p0)||[]).forEach(function(u,h){var d=parseInt(r[h+1],10);switch(u.toLowerCase().charAt(0)){case"y":a=d;break;case"d":s=d;break;case"h":i=d;break;case"s":c=d;break;case"m":i>=0?o=d:n=d;break}}),c>=0&&o==-1&&n>=0&&(o=n,n=-1);var l=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);l.length==7&&(l="0"+l),l.length==8&&(l="20"+l);var f=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return i==-1&&o==-1&&c==-1?l:a==-1&&n==-1&&s==-1?f:l+"T"+f}var jd=function(){var e={};e.version="1.2.0";function t(){for(var S=0,W=new Array(256),O=0;O!=256;++O)S=O,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,W[O]=S;return typeof Int32Array<"u"?new Int32Array(W):W}var r=t();function a(S){var W=0,O=0,z=0,V=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(z=0;z!=256;++z)V[z]=S[z];for(z=0;z!=256;++z)for(O=S[z],W=256+z;W<4096;W+=256)O=V[W]=O>>>8^S[O&255];var L=[];for(z=1;z!=16;++z)L[z-1]=typeof Int32Array<"u"?V.subarray(z*256,z*256+256):V.slice(z*256,z*256+256);return L}var n=a(r),s=n[0],i=n[1],o=n[2],c=n[3],l=n[4],f=n[5],u=n[6],h=n[7],d=n[8],g=n[9],p=n[10],x=n[11],y=n[12],F=n[13],v=n[14];function C(S,W){for(var O=W^-1,z=0,V=S.length;z<V;)O=O>>>8^r[(O^S.charCodeAt(z++))&255];return~O}function P(S,W){for(var O=W^-1,z=S.length-15,V=0;V<z;)O=v[S[V++]^O&255]^F[S[V++]^O>>8&255]^y[S[V++]^O>>16&255]^x[S[V++]^O>>>24]^p[S[V++]]^g[S[V++]]^d[S[V++]]^h[S[V++]]^u[S[V++]]^f[S[V++]]^l[S[V++]]^c[S[V++]]^o[S[V++]]^i[S[V++]]^s[S[V++]]^r[S[V++]];for(z+=15;V<z;)O=O>>>8^r[(O^S[V++])&255];return~O}function I(S,W){for(var O=W^-1,z=0,V=S.length,L=0,Y=0;z<V;)L=S.charCodeAt(z++),L<128?O=O>>>8^r[(O^L)&255]:L<2048?(O=O>>>8^r[(O^(192|L>>6&31))&255],O=O>>>8^r[(O^(128|L&63))&255]):L>=55296&&L<57344?(L=(L&1023)+64,Y=S.charCodeAt(z++)&1023,O=O>>>8^r[(O^(240|L>>8&7))&255],O=O>>>8^r[(O^(128|L>>2&63))&255],O=O>>>8^r[(O^(128|Y>>6&15|(L&3)<<4))&255],O=O>>>8^r[(O^(128|Y&63))&255]):(O=O>>>8^r[(O^(224|L>>12&15))&255],O=O>>>8^r[(O^(128|L>>6&63))&255],O=O>>>8^r[(O^(128|L&63))&255]);return~O}return e.table=r,e.bstr=C,e.buf=P,e.str=I,e}(),ye=function(){var t={};t.version="1.2.1";function r(m,E){for(var w=m.split("/"),_=E.split("/"),k=0,T=0,B=Math.min(w.length,_.length);k<B;++k){if(T=w[k].length-_[k].length)return T;if(w[k]!=_[k])return w[k]<_[k]?-1:1}return w.length-_.length}function a(m){if(m.charAt(m.length-1)=="/")return m.slice(0,-1).indexOf("/")===-1?m:a(m.slice(0,-1));var E=m.lastIndexOf("/");return E===-1?m:m.slice(0,E+1)}function n(m){if(m.charAt(m.length-1)=="/")return n(m.slice(0,-1));var E=m.lastIndexOf("/");return E===-1?m:m.slice(E+1)}function s(m,E){typeof E=="string"&&(E=new Date(E));var w=E.getHours();w=w<<6|E.getMinutes(),w=w<<5|E.getSeconds()>>>1,m.write_shift(2,w);var _=E.getFullYear()-1980;_=_<<4|E.getMonth()+1,_=_<<5|E.getDate(),m.write_shift(2,_)}function i(m){var E=m.read_shift(2)&65535,w=m.read_shift(2)&65535,_=new Date,k=w&31;w>>>=5;var T=w&15;w>>>=4,_.setMilliseconds(0),_.setFullYear(w+1980),_.setMonth(T-1),_.setDate(k);var B=E&31;E>>>=5;var G=E&63;return E>>>=6,_.setHours(E),_.setMinutes(G),_.setSeconds(B<<1),_}function o(m){er(m,0);for(var E={},w=0;m.l<=m.length-4;){var _=m.read_shift(2),k=m.read_shift(2),T=m.l+k,B={};switch(_){case 21589:w=m.read_shift(1),w&1&&(B.mtime=m.read_shift(4)),k>5&&(w&2&&(B.atime=m.read_shift(4)),w&4&&(B.ctime=m.read_shift(4))),B.mtime&&(B.mt=new Date(B.mtime*1e3));break}m.l=T,E[_]=B}return E}var c;function l(){return c||(c={})}function f(m,E){if(m[0]==80&&m[1]==75)return Ui(m,E);if((m[0]|32)==109&&(m[1]|32)==105)return tf(m,E);if(m.length<512)throw new Error("CFB file size "+m.length+" < 512");var w=3,_=512,k=0,T=0,B=0,G=0,N=0,M=[],j=m.slice(0,512);er(j,0);var X=u(j);switch(w=X[0],w){case 3:_=512;break;case 4:_=4096;break;case 0:if(X[1]==0)return Ui(m,E);default:throw new Error("Major Version: Expected 3 or 4 saw "+w)}_!==512&&(j=m.slice(0,_),er(j,28));var Q=m.slice(0,_);h(j,w);var se=j.read_shift(4,"i");if(w===3&&se!==0)throw new Error("# Directory Sectors: Expected 0 saw "+se);j.l+=4,B=j.read_shift(4,"i"),j.l+=4,j.chk("00100000","Mini Stream Cutoff Size: "),G=j.read_shift(4,"i"),k=j.read_shift(4,"i"),N=j.read_shift(4,"i"),T=j.read_shift(4,"i");for(var J=-1,ae=0;ae<109&&(J=j.read_shift(4,"i"),!(J<0));++ae)M[ae]=J;var pe=d(m,_);x(N,T,pe,_,M);var Re=F(pe,B,M,_);Re[B].name="!Directory",k>0&&G!==Y&&(Re[G].name="!MiniFAT"),Re[M[0]].name="!FAT",Re.fat_addrs=M,Re.ssz=_;var Pe={},nr=[],Sa=[],Aa=[];v(B,Re,pe,nr,k,Pe,Sa,G),g(Sa,Aa,nr),nr.shift();var ba={FileIndex:Sa,FullPaths:Aa};return E&&E.raw&&(ba.raw={header:Q,sectors:pe}),ba}function u(m){if(m[m.l]==80&&m[m.l+1]==75)return[0,0];m.chk(ce,"Header Signature: "),m.l+=16;var E=m.read_shift(2,"u");return[m.read_shift(2,"u"),E]}function h(m,E){var w=9;switch(m.l+=2,w=m.read_shift(2)){case 9:if(E!=3)throw new Error("Sector Shift: Expected 9 saw "+w);break;case 12:if(E!=4)throw new Error("Sector Shift: Expected 12 saw "+w);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+w)}m.chk("0600","Mini Sector Shift: "),m.chk("000000000000","Reserved: ")}function d(m,E){for(var w=Math.ceil(m.length/E)-1,_=[],k=1;k<w;++k)_[k-1]=m.slice(k*E,(k+1)*E);return _[w-1]=m.slice(w*E),_}function g(m,E,w){for(var _=0,k=0,T=0,B=0,G=0,N=w.length,M=[],j=[];_<N;++_)M[_]=j[_]=_,E[_]=w[_];for(;G<j.length;++G)_=j[G],k=m[_].L,T=m[_].R,B=m[_].C,M[_]===_&&(k!==-1&&M[k]!==k&&(M[_]=M[k]),T!==-1&&M[T]!==T&&(M[_]=M[T])),B!==-1&&(M[B]=_),k!==-1&&_!=M[_]&&(M[k]=M[_],j.lastIndexOf(k)<G&&j.push(k)),T!==-1&&_!=M[_]&&(M[T]=M[_],j.lastIndexOf(T)<G&&j.push(T));for(_=1;_<N;++_)M[_]===_&&(T!==-1&&M[T]!==T?M[_]=M[T]:k!==-1&&M[k]!==k&&(M[_]=M[k]));for(_=1;_<N;++_)if(m[_].type!==0){if(G=_,G!=M[G])do G=M[G],E[_]=E[G]+"/"+E[_];while(G!==0&&M[G]!==-1&&G!=M[G]);M[_]=-1}for(E[0]+="/",_=1;_<N;++_)m[_].type!==2&&(E[_]+="/")}function p(m,E,w){for(var _=m.start,k=m.size,T=[],B=_;w&&k>0&&B>=0;)T.push(E.slice(B*L,B*L+L)),k-=L,B=Mt(w,B*4);return T.length===0?ze(0):kt(T).slice(0,m.size)}function x(m,E,w,_,k){var T=Y;if(m===Y){if(E!==0)throw new Error("DIFAT chain shorter than expected")}else if(m!==-1){var B=w[m],G=(_>>>2)-1;if(!B)return;for(var N=0;N<G&&(T=Mt(B,N*4))!==Y;++N)k.push(T);x(Mt(B,_-4),E-1,w,_,k)}}function y(m,E,w,_,k){var T=[],B=[];k||(k=[]);var G=_-1,N=0,M=0;for(N=E;N>=0;){k[N]=!0,T[T.length]=N,B.push(m[N]);var j=w[Math.floor(N*4/_)];if(M=N*4&G,_<4+M)throw new Error("FAT boundary crossed: "+N+" 4 "+_);if(!m[j])break;N=Mt(m[j],M)}return{nodes:T,data:Ao([B])}}function F(m,E,w,_){var k=m.length,T=[],B=[],G=[],N=[],M=_-1,j=0,X=0,Q=0,se=0;for(j=0;j<k;++j)if(G=[],Q=j+E,Q>=k&&(Q-=k),!B[Q]){N=[];var J=[];for(X=Q;X>=0;){J[X]=!0,B[X]=!0,G[G.length]=X,N.push(m[X]);var ae=w[Math.floor(X*4/_)];if(se=X*4&M,_<4+se)throw new Error("FAT boundary crossed: "+X+" 4 "+_);if(!m[ae]||(X=Mt(m[ae],se),J[X]))break}T[Q]={nodes:G,data:Ao([N])}}return T}function v(m,E,w,_,k,T,B,G){for(var N=0,M=_.length?2:0,j=E[m].data,X=0,Q=0,se;X<j.length;X+=128){var J=j.slice(X,X+128);er(J,64),Q=J.read_shift(2),se=mi(J,0,Q-M),_.push(se);var ae={name:se,type:J.read_shift(1),color:J.read_shift(1),L:J.read_shift(4,"i"),R:J.read_shift(4,"i"),C:J.read_shift(4,"i"),clsid:J.read_shift(16),state:J.read_shift(4,"i"),start:0,size:0},pe=J.read_shift(2)+J.read_shift(2)+J.read_shift(2)+J.read_shift(2);pe!==0&&(ae.ct=C(J,J.l-8));var Re=J.read_shift(2)+J.read_shift(2)+J.read_shift(2)+J.read_shift(2);Re!==0&&(ae.mt=C(J,J.l-8)),ae.start=J.read_shift(4,"i"),ae.size=J.read_shift(4,"i"),ae.size<0&&ae.start<0&&(ae.size=ae.type=0,ae.start=Y,ae.name=""),ae.type===5?(N=ae.start,k>0&&N!==Y&&(E[N].name="!StreamData")):ae.size>=4096?(ae.storage="fat",E[ae.start]===void 0&&(E[ae.start]=y(w,ae.start,E.fat_addrs,E.ssz)),E[ae.start].name=ae.name,ae.content=E[ae.start].data.slice(0,ae.size)):(ae.storage="minifat",ae.size<0?ae.size=0:N!==Y&&ae.start!==Y&&E[N]&&(ae.content=p(ae,E[N].data,(E[G]||{}).data))),ae.content&&er(ae.content,0),T[se]=ae,B.push(ae)}}function C(m,E){return new Date((Ar(m,E+4)/1e7*Math.pow(2,32)+Ar(m,E)/1e7-11644473600)*1e3)}function P(m,E){return l(),f(c.readFileSync(m),E)}function I(m,E){var w=E&&E.type;switch(w||_e&&Buffer.isBuffer(m)&&(w="buffer"),w||"base64"){case"file":return P(m,E);case"base64":return f(Gr(Or(m)),E);case"binary":return f(Gr(m),E)}return f(m,E)}function S(m,E){var w=E||{},_=w.root||"Root Entry";if(m.FullPaths||(m.FullPaths=[]),m.FileIndex||(m.FileIndex=[]),m.FullPaths.length!==m.FileIndex.length)throw new Error("inconsistent CFB structure");m.FullPaths.length===0&&(m.FullPaths[0]=_+"/",m.FileIndex[0]={name:_,type:5}),w.CLSID&&(m.FileIndex[0].clsid=w.CLSID),W(m)}function W(m){var E="Sh33tJ5";if(!ye.find(m,"/"+E)){var w=ze(4);w[0]=55,w[1]=w[3]=50,w[2]=54,m.FileIndex.push({name:E,type:2,content:w,size:4,L:69,R:69,C:69}),m.FullPaths.push(m.FullPaths[0]+E),O(m)}}function O(m,E){S(m);for(var w=!1,_=!1,k=m.FullPaths.length-1;k>=0;--k){var T=m.FileIndex[k];switch(T.type){case 0:_?w=!0:(m.FileIndex.pop(),m.FullPaths.pop());break;case 1:case 2:case 5:_=!0,isNaN(T.R*T.L*T.C)&&(w=!0),T.R>-1&&T.L>-1&&T.R==T.L&&(w=!0);break;default:w=!0;break}}if(!(!w&&!E)){var B=new Date(1987,1,19),G=0,N=Object.create?Object.create(null):{},M=[];for(k=0;k<m.FullPaths.length;++k)N[m.FullPaths[k]]=!0,m.FileIndex[k].type!==0&&M.push([m.FullPaths[k],m.FileIndex[k]]);for(k=0;k<M.length;++k){var j=a(M[k][0]);_=N[j],_||(M.push([j,{name:n(j).replace("/",""),type:1,clsid:oe,ct:B,mt:B,content:null}]),N[j]=!0)}for(M.sort(function(se,J){return r(se[0],J[0])}),m.FullPaths=[],m.FileIndex=[],k=0;k<M.length;++k)m.FullPaths[k]=M[k][0],m.FileIndex[k]=M[k][1];for(k=0;k<M.length;++k){var X=m.FileIndex[k],Q=m.FullPaths[k];if(X.name=n(Q).replace("/",""),X.L=X.R=X.C=-(X.color=1),X.size=X.content?X.content.length:0,X.start=0,X.clsid=X.clsid||oe,k===0)X.C=M.length>1?1:-1,X.size=0,X.type=5;else if(Q.slice(-1)=="/"){for(G=k+1;G<M.length&&a(m.FullPaths[G])!=Q;++G);for(X.C=G>=M.length?-1:G,G=k+1;G<M.length&&a(m.FullPaths[G])!=a(Q);++G);X.R=G>=M.length?-1:G,X.type=1}else a(m.FullPaths[k+1]||"")==a(Q)&&(X.R=k+1),X.type=2}}}function z(m,E){var w=E||{};if(w.fileType=="mad")return af(m,w);switch(O(m),w.fileType){case"zip":return Yl(m,w)}var _=function(se){for(var J=0,ae=0,pe=0;pe<se.FileIndex.length;++pe){var Re=se.FileIndex[pe];if(Re.content){var Pe=Re.content.length;Pe>0&&(Pe<4096?J+=Pe+63>>6:ae+=Pe+511>>9)}}for(var nr=se.FullPaths.length+3>>2,Sa=J+7>>3,Aa=J+127>>7,ba=Sa+ae+nr+Aa,Pt=ba+127>>7,ss=Pt<=109?0:Math.ceil((Pt-109)/127);ba+Pt+ss+127>>7>Pt;)ss=++Pt<=109?0:Math.ceil((Pt-109)/127);var it=[1,ss,Pt,Aa,nr,ae,J,0];return se.FileIndex[0].size=J<<6,it[7]=(se.FileIndex[0].start=it[0]+it[1]+it[2]+it[3]+it[4]+it[5])+(it[6]+7>>3),it}(m),k=ze(_[7]<<9),T=0,B=0;{for(T=0;T<8;++T)k.write_shift(1,re[T]);for(T=0;T<8;++T)k.write_shift(2,0);for(k.write_shift(2,62),k.write_shift(2,3),k.write_shift(2,65534),k.write_shift(2,9),k.write_shift(2,6),T=0;T<3;++T)k.write_shift(2,0);for(k.write_shift(4,0),k.write_shift(4,_[2]),k.write_shift(4,_[0]+_[1]+_[2]+_[3]-1),k.write_shift(4,0),k.write_shift(4,4096),k.write_shift(4,_[3]?_[0]+_[1]+_[2]-1:Y),k.write_shift(4,_[3]),k.write_shift(-4,_[1]?_[0]-1:Y),k.write_shift(4,_[1]),T=0;T<109;++T)k.write_shift(-4,T<_[2]?_[1]+T:-1)}if(_[1])for(B=0;B<_[1];++B){for(;T<236+B*127;++T)k.write_shift(-4,T<_[2]?_[1]+T:-1);k.write_shift(-4,B===_[1]-1?Y:B+1)}var G=function(se){for(B+=se;T<B-1;++T)k.write_shift(-4,T+1);se&&(++T,k.write_shift(-4,Y))};for(B=T=0,B+=_[1];T<B;++T)k.write_shift(-4,ie.DIFSECT);for(B+=_[2];T<B;++T)k.write_shift(-4,ie.FATSECT);G(_[3]),G(_[4]);for(var N=0,M=0,j=m.FileIndex[0];N<m.FileIndex.length;++N)j=m.FileIndex[N],j.content&&(M=j.content.length,!(M<4096)&&(j.start=B,G(M+511>>9)));for(G(_[6]+7>>3);k.l&511;)k.write_shift(-4,ie.ENDOFCHAIN);for(B=T=0,N=0;N<m.FileIndex.length;++N)j=m.FileIndex[N],j.content&&(M=j.content.length,!(!M||M>=4096)&&(j.start=B,G(M+63>>6)));for(;k.l&511;)k.write_shift(-4,ie.ENDOFCHAIN);for(T=0;T<_[4]<<2;++T){var X=m.FullPaths[T];if(!X||X.length===0){for(N=0;N<17;++N)k.write_shift(4,0);for(N=0;N<3;++N)k.write_shift(4,-1);for(N=0;N<12;++N)k.write_shift(4,0);continue}j=m.FileIndex[T],T===0&&(j.start=j.size?j.start-1:Y);var Q=T===0&&w.root||j.name;if(M=2*(Q.length+1),k.write_shift(64,Q,"utf16le"),k.write_shift(2,M),k.write_shift(1,j.type),k.write_shift(1,j.color),k.write_shift(-4,j.L),k.write_shift(-4,j.R),k.write_shift(-4,j.C),j.clsid)k.write_shift(16,j.clsid,"hex");else for(N=0;N<4;++N)k.write_shift(4,0);k.write_shift(4,j.state||0),k.write_shift(4,0),k.write_shift(4,0),k.write_shift(4,0),k.write_shift(4,0),k.write_shift(4,j.start),k.write_shift(4,j.size),k.write_shift(4,0)}for(T=1;T<m.FileIndex.length;++T)if(j=m.FileIndex[T],j.size>=4096)if(k.l=j.start+1<<9,_e&&Buffer.isBuffer(j.content))j.content.copy(k,k.l,0,j.size),k.l+=j.size+511&-512;else{for(N=0;N<j.size;++N)k.write_shift(1,j.content[N]);for(;N&511;++N)k.write_shift(1,0)}for(T=1;T<m.FileIndex.length;++T)if(j=m.FileIndex[T],j.size>0&&j.size<4096)if(_e&&Buffer.isBuffer(j.content))j.content.copy(k,k.l,0,j.size),k.l+=j.size+63&-64;else{for(N=0;N<j.size;++N)k.write_shift(1,j.content[N]);for(;N&63;++N)k.write_shift(1,0)}if(_e)k.l=k.length;else for(;k.l<k.length;)k.write_shift(1,0);return k}function V(m,E){var w=m.FullPaths.map(function(N){return N.toUpperCase()}),_=w.map(function(N){var M=N.split("/");return M[M.length-(N.slice(-1)=="/"?2:1)]}),k=!1;E.charCodeAt(0)===47?(k=!0,E=w[0].slice(0,-1)+E):k=E.indexOf("/")!==-1;var T=E.toUpperCase(),B=k===!0?w.indexOf(T):_.indexOf(T);if(B!==-1)return m.FileIndex[B];var G=!T.match(Da);for(T=T.replace(vr,""),G&&(T=T.replace(Da,"!")),B=0;B<w.length;++B)if((G?w[B].replace(Da,"!"):w[B]).replace(vr,"")==T||(G?_[B].replace(Da,"!"):_[B]).replace(vr,"")==T)return m.FileIndex[B];return null}var L=64,Y=-2,ce="d0cf11e0a1b11ae1",re=[208,207,17,224,161,177,26,225],oe="00000000000000000000000000000000",ie={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Y,FREESECT:-1,HEADER_SIGNATURE:ce,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:oe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Ie(m,E,w){l();var _=z(m,w);c.writeFileSync(E,_)}function H(m){for(var E=new Array(m.length),w=0;w<m.length;++w)E[w]=String.fromCharCode(m[w]);return E.join("")}function ue(m,E){var w=z(m,E);switch(E&&E.type||"buffer"){case"file":return l(),c.writeFileSync(E.filename,w),w;case"binary":return typeof w=="string"?w:H(w);case"base64":return oo(typeof w=="string"?w:H(w));case"buffer":if(_e)return Buffer.isBuffer(w)?w:Kt(w);case"array":return typeof w=="string"?Gr(w):w}return w}var he;function A(m){try{var E=m.InflateRaw,w=new E;if(w._processChunk(new Uint8Array([3,0]),w._finishFlushFlag),w.bytesRead)he=m;else throw new Error("zlib does not expose bytesRead")}catch(_){console.error("cannot use native zlib: "+(_.message||_))}}function U(m,E){if(!he)return Mi(m,E);var w=he.InflateRaw,_=new w,k=_._processChunk(m.slice(m.l),_._finishFlushFlag);return m.l+=_.bytesRead,k}function R(m){return he?he.deflateRawSync(m):me(m)}var D=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],q=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ee=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ne(m){var E=(m<<1|m<<11)&139536|(m<<5|m<<15)&558144;return(E>>16|E>>8|E)&255}for(var Z=typeof Uint8Array<"u",K=Z?new Uint8Array(256):[],ke=0;ke<256;++ke)K[ke]=ne(ke);function b(m,E){var w=K[m&255];return E<=8?w>>>8-E:(w=w<<8|K[m>>8&255],E<=16?w>>>16-E:(w=w<<8|K[m>>16&255],w>>>24-E))}function Be(m,E){var w=E&7,_=E>>>3;return(m[_]|(w<=6?0:m[_+1]<<8))>>>w&3}function Se(m,E){var w=E&7,_=E>>>3;return(m[_]|(w<=5?0:m[_+1]<<8))>>>w&7}function be(m,E){var w=E&7,_=E>>>3;return(m[_]|(w<=4?0:m[_+1]<<8))>>>w&15}function ve(m,E){var w=E&7,_=E>>>3;return(m[_]|(w<=3?0:m[_+1]<<8))>>>w&31}function te(m,E){var w=E&7,_=E>>>3;return(m[_]|(w<=1?0:m[_+1]<<8))>>>w&127}function Me(m,E,w){var _=E&7,k=E>>>3,T=(1<<w)-1,B=m[k]>>>_;return w<8-_||(B|=m[k+1]<<8-_,w<16-_)||(B|=m[k+2]<<16-_,w<24-_)||(B|=m[k+3]<<24-_),B&T}function Dr(m,E,w){var _=E&7,k=E>>>3;return _<=5?m[k]|=(w&7)<<_:(m[k]|=w<<_&255,m[k+1]=(w&7)>>8-_),E+3}function Yr(m,E,w){var _=E&7,k=E>>>3;return w=(w&1)<<_,m[k]|=w,E+1}function nt(m,E,w){var _=E&7,k=E>>>3;return w<<=_,m[k]|=w&255,w>>>=8,m[k+1]=w,E+8}function ka(m,E,w){var _=E&7,k=E>>>3;return w<<=_,m[k]|=w&255,w>>>=8,m[k+1]=w&255,m[k+2]=w>>>8,E+16}function xt(m,E){var w=m.length,_=2*w>E?2*w:E+5,k=0;if(w>=E)return m;if(_e){var T=co(_);if(m.copy)m.copy(T);else for(;k<m.length;++k)T[k]=m[k];return T}else if(Z){var B=new Uint8Array(_);if(B.set)B.set(m);else for(;k<w;++k)B[k]=m[k];return B}return m.length=_,m}function Sr(m){for(var E=new Array(m),w=0;w<m;++w)E[w]=0;return E}function st(m,E,w){var _=1,k=0,T=0,B=0,G=0,N=m.length,M=Z?new Uint16Array(32):Sr(32);for(T=0;T<32;++T)M[T]=0;for(T=N;T<w;++T)m[T]=0;N=m.length;var j=Z?new Uint16Array(N):Sr(N);for(T=0;T<N;++T)M[k=m[T]]++,_<k&&(_=k),j[T]=0;for(M[0]=0,T=1;T<=_;++T)M[T+16]=G=G+M[T-1]<<1;for(T=0;T<N;++T)G=m[T],G!=0&&(j[T]=M[G+16]++);var X=0;for(T=0;T<N;++T)if(X=m[T],X!=0)for(G=b(j[T],_)>>_-X,B=(1<<_+4-X)-1;B>=0;--B)E[G|B<<X]=X&15|T<<4;return _}var mt=Z?new Uint16Array(512):Sr(512),Ta=Z?new Uint16Array(32):Sr(32);if(!Z){for(var dr=0;dr<512;++dr)mt[dr]=0;for(dr=0;dr<32;++dr)Ta[dr]=0}(function(){for(var m=[],E=0;E<32;E++)m.push(5);st(m,Ta,32);var w=[];for(E=0;E<=143;E++)w.push(8);for(;E<=255;E++)w.push(9);for(;E<=279;E++)w.push(7);for(;E<=287;E++)w.push(8);st(w,mt,288)})();var Jr=function(){for(var E=Z?new Uint8Array(32768):[],w=0,_=0;w<ee.length-1;++w)for(;_<ee[w+1];++_)E[_]=w;for(;_<32768;++_)E[_]=29;var k=Z?new Uint8Array(259):[];for(w=0,_=0;w<q.length-1;++w)for(;_<q[w+1];++_)k[_]=w;function T(G,N){for(var M=0;M<G.length;){var j=Math.min(65535,G.length-M),X=M+j==G.length;for(N.write_shift(1,+X),N.write_shift(2,j),N.write_shift(2,~j&65535);j-- >0;)N[N.l++]=G[M++]}return N.l}function B(G,N){for(var M=0,j=0,X=Z?new Uint16Array(32768):[];j<G.length;){var Q=Math.min(65535,G.length-j);if(Q<10){for(M=Dr(N,M,+(j+Q==G.length)),M&7&&(M+=8-(M&7)),N.l=M/8|0,N.write_shift(2,Q),N.write_shift(2,~Q&65535);Q-- >0;)N[N.l++]=G[j++];M=N.l*8;continue}M=Dr(N,M,+(j+Q==G.length)+2);for(var se=0;Q-- >0;){var J=G[j];se=(se<<5^J)&32767;var ae=-1,pe=0;if((ae=X[se])&&(ae|=j&-32768,ae>j&&(ae-=32768),ae<j))for(;G[ae+pe]==G[j+pe]&&pe<250;)++pe;if(pe>2){J=k[pe],J<=22?M=nt(N,M,K[J+1]>>1)-1:(nt(N,M,3),M+=5,nt(N,M,K[J-23]>>5),M+=3);var Re=J<8?0:J-4>>2;Re>0&&(ka(N,M,pe-q[J]),M+=Re),J=E[j-ae],M=nt(N,M,K[J]>>3),M-=3;var Pe=J<4?0:J-2>>1;Pe>0&&(ka(N,M,j-ae-ee[J]),M+=Pe);for(var nr=0;nr<pe;++nr)X[se]=j&32767,se=(se<<5^G[j])&32767,++j;Q-=pe-1}else J<=143?J=J+48:M=Yr(N,M,1),M=nt(N,M,K[J]),X[se]=j&32767,++j}M=nt(N,M,0)-1}return N.l=(M+7)/8|0,N.l}return function(N,M){return N.length<8?T(N,M):B(N,M)}}();function me(m){var E=ze(50+Math.floor(m.length*1.1)),w=Jr(m,E);return E.slice(0,w)}var $e=Z?new Uint16Array(32768):Sr(32768),Rr=Z?new Uint16Array(32768):Sr(32768),Ge=Z?new Uint16Array(128):Sr(128),Rt=1,Bi=1;function ql(m,E){var w=ve(m,E)+257;E+=5;var _=ve(m,E)+1;E+=5;var k=be(m,E)+4;E+=4;for(var T=0,B=Z?new Uint8Array(19):Sr(19),G=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],N=1,M=Z?new Uint8Array(8):Sr(8),j=Z?new Uint8Array(8):Sr(8),X=B.length,Q=0;Q<k;++Q)B[D[Q]]=T=Se(m,E),N<T&&(N=T),M[T]++,E+=3;var se=0;for(M[0]=0,Q=1;Q<=N;++Q)j[Q]=se=se+M[Q-1]<<1;for(Q=0;Q<X;++Q)(se=B[Q])!=0&&(G[Q]=j[se]++);var J=0;for(Q=0;Q<X;++Q)if(J=B[Q],J!=0){se=K[G[Q]]>>8-J;for(var ae=(1<<7-J)-1;ae>=0;--ae)Ge[se|ae<<J]=J&7|Q<<3}var pe=[];for(N=1;pe.length<w+_;)switch(se=Ge[te(m,E)],E+=se&7,se>>>=3){case 16:for(T=3+Be(m,E),E+=2,se=pe[pe.length-1];T-- >0;)pe.push(se);break;case 17:for(T=3+Se(m,E),E+=3;T-- >0;)pe.push(0);break;case 18:for(T=11+te(m,E),E+=7;T-- >0;)pe.push(0);break;default:pe.push(se),N<se&&(N=se);break}var Re=pe.slice(0,w),Pe=pe.slice(w);for(Q=w;Q<286;++Q)Re[Q]=0;for(Q=_;Q<30;++Q)Pe[Q]=0;return Rt=st(Re,$e,286),Bi=st(Pe,Rr,30),E}function Xl(m,E){if(m[0]==3&&!(m[1]&3))return[Ct(E),2];for(var w=0,_=0,k=co(E||1<<18),T=0,B=k.length>>>0,G=0,N=0;!(_&1);){if(_=Se(m,w),w+=3,_>>>1)_>>1==1?(G=9,N=5):(w=ql(m,w),G=Rt,N=Bi);else{w&7&&(w+=8-(w&7));var M=m[w>>>3]|m[(w>>>3)+1]<<8;if(w+=32,M>0)for(!E&&B<T+M&&(k=xt(k,T+M),B=k.length);M-- >0;)k[T++]=m[w>>>3],w+=8;continue}for(;;){!E&&B<T+32767&&(k=xt(k,T+32767),B=k.length);var j=Me(m,w,G),X=_>>>1==1?mt[j]:$e[j];if(w+=X&15,X>>>=4,!(X>>>8&255))k[T++]=X;else{if(X==256)break;X-=257;var Q=X<8?0:X-4>>2;Q>5&&(Q=0);var se=T+q[X];Q>0&&(se+=Me(m,w,Q),w+=Q),j=Me(m,w,N),X=_>>>1==1?Ta[j]:Rr[j],w+=X&15,X>>>=4;var J=X<4?0:X-2>>1,ae=ee[X];for(J>0&&(ae+=Me(m,w,J),w+=J),!E&&B<se&&(k=xt(k,se+100),B=k.length);T<se;)k[T]=k[T-ae],++T}}}return E?[k,w+7>>>3]:[k.slice(0,T),w+7>>>3]}function Mi(m,E){var w=m.slice(m.l||0),_=Xl(w,E);return m.l+=_[1],_[0]}function $i(m,E){if(m)typeof console<"u"&&console.error(E);else throw new Error(E)}function Ui(m,E){var w=m;er(w,0);var _=[],k=[],T={FileIndex:_,FullPaths:k};S(T,{root:E.root});for(var B=w.length-4;(w[B]!=80||w[B+1]!=75||w[B+2]!=5||w[B+3]!=6)&&B>=0;)--B;w.l=B+4,w.l+=4;var G=w.read_shift(2);w.l+=6;var N=w.read_shift(4);for(w.l=N,B=0;B<G;++B){w.l+=20;var M=w.read_shift(4),j=w.read_shift(4),X=w.read_shift(2),Q=w.read_shift(2),se=w.read_shift(2);w.l+=8;var J=w.read_shift(4),ae=o(w.slice(w.l+X,w.l+X+Q));w.l+=X+Q+se;var pe=w.l;w.l=J+4,Kl(w,M,j,T,ae),w.l=pe}return T}function Kl(m,E,w,_,k){m.l+=2;var T=m.read_shift(2),B=m.read_shift(2),G=i(m);if(T&8257)throw new Error("Unsupported ZIP encryption");for(var N=m.read_shift(4),M=m.read_shift(4),j=m.read_shift(4),X=m.read_shift(2),Q=m.read_shift(2),se="",J=0;J<X;++J)se+=String.fromCharCode(m[m.l++]);if(Q){var ae=o(m.slice(m.l,m.l+Q));(ae[21589]||{}).mt&&(G=ae[21589].mt),((k||{})[21589]||{}).mt&&(G=k[21589].mt)}m.l+=Q;var pe=m.slice(m.l,m.l+M);switch(B){case 8:pe=U(m,j);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+B)}var Re=!1;T&8&&(N=m.read_shift(4),N==134695760&&(N=m.read_shift(4),Re=!0),M=m.read_shift(4),j=m.read_shift(4)),M!=E&&$i(Re,"Bad compressed size: "+E+" != "+M),j!=w&&$i(Re,"Bad uncompressed size: "+w+" != "+j),ns(_,se,pe,{unsafe:!0,mt:G})}function Yl(m,E){var w=E||{},_=[],k=[],T=ze(1),B=w.compression?8:0,G=0,N=0,M=0,j=0,X=0,Q=m.FullPaths[0],se=Q,J=m.FileIndex[0],ae=[],pe=0;for(N=1;N<m.FullPaths.length;++N)if(se=m.FullPaths[N].slice(Q.length),J=m.FileIndex[N],!(!J.size||!J.content||se=="Sh33tJ5")){var Re=j,Pe=ze(se.length);for(M=0;M<se.length;++M)Pe.write_shift(1,se.charCodeAt(M)&127);Pe=Pe.slice(0,Pe.l),ae[X]=jd.buf(J.content,0);var nr=J.content;B==8&&(nr=R(nr)),T=ze(30),T.write_shift(4,67324752),T.write_shift(2,20),T.write_shift(2,G),T.write_shift(2,B),J.mt?s(T,J.mt):T.write_shift(4,0),T.write_shift(-4,ae[X]),T.write_shift(4,nr.length),T.write_shift(4,J.content.length),T.write_shift(2,Pe.length),T.write_shift(2,0),j+=T.length,_.push(T),j+=Pe.length,_.push(Pe),j+=nr.length,_.push(nr),T=ze(46),T.write_shift(4,33639248),T.write_shift(2,0),T.write_shift(2,20),T.write_shift(2,G),T.write_shift(2,B),T.write_shift(4,0),T.write_shift(-4,ae[X]),T.write_shift(4,nr.length),T.write_shift(4,J.content.length),T.write_shift(2,Pe.length),T.write_shift(2,0),T.write_shift(2,0),T.write_shift(2,0),T.write_shift(2,0),T.write_shift(4,0),T.write_shift(4,Re),pe+=T.l,k.push(T),pe+=Pe.length,k.push(Pe),++X}return T=ze(22),T.write_shift(4,101010256),T.write_shift(2,0),T.write_shift(2,0),T.write_shift(2,X),T.write_shift(2,X),T.write_shift(4,pe),T.write_shift(4,j),T.write_shift(2,0),kt([kt(_),kt(k),T])}var xn={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Jl(m,E){if(m.ctype)return m.ctype;var w=m.name||"",_=w.match(/\.([^\.]+)$/);return _&&xn[_[1]]||E&&(_=(w=E).match(/[\.\\]([^\.\\])+$/),_&&xn[_[1]])?xn[_[1]]:"application/octet-stream"}function Zl(m){for(var E=oo(m),w=[],_=0;_<E.length;_+=76)w.push(E.slice(_,_+76));return w.join(`\r
`)+`\r
`}function Ql(m){var E=m.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(M){var j=M.charCodeAt(0).toString(16).toUpperCase();return"="+(j.length==1?"0"+j:j)});E=E.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),E.charAt(0)==`
`&&(E="=0D"+E.slice(1)),E=E.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var w=[],_=E.split(`\r
`),k=0;k<_.length;++k){var T=_[k];if(T.length==0){w.push("");continue}for(var B=0;B<T.length;){var G=76,N=T.slice(B,B+G);N.charAt(G-1)=="="?G--:N.charAt(G-2)=="="?G-=2:N.charAt(G-3)=="="&&(G-=3),N=T.slice(B,B+G),B+=G,B<T.length&&(N+="="),w.push(N)}}return w.join(`\r
`)}function ef(m){for(var E=[],w=0;w<m.length;++w){for(var _=m[w];w<=m.length&&_.charAt(_.length-1)=="=";)_=_.slice(0,_.length-1)+m[++w];E.push(_)}for(var k=0;k<E.length;++k)E[k]=E[k].replace(/[=][0-9A-Fa-f]{2}/g,function(T){return String.fromCharCode(parseInt(T.slice(1),16))});return Gr(E.join(`\r
`))}function rf(m,E,w){for(var _="",k="",T="",B,G=0;G<10;++G){var N=E[G];if(!N||N.match(/^\s*$/))break;var M=N.match(/^(.*?):\s*([^\s].*)$/);if(M)switch(M[1].toLowerCase()){case"content-location":_=M[2].trim();break;case"content-type":T=M[2].trim();break;case"content-transfer-encoding":k=M[2].trim();break}}switch(++G,k.toLowerCase()){case"base64":B=Gr(Or(E.slice(G).join("")));break;case"quoted-printable":B=ef(E.slice(G));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+k)}var j=ns(m,_.slice(w.length),B,{unsafe:!0});T&&(j.ctype=T)}function tf(m,E){if(H(m.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var w=E&&E.root||"",_=(_e&&Buffer.isBuffer(m)?m.toString("binary"):H(m)).split(`\r
`),k=0,T="";for(k=0;k<_.length;++k)if(T=_[k],!!/^Content-Location:/i.test(T)&&(T=T.slice(T.indexOf("file")),w||(w=T.slice(0,T.lastIndexOf("/")+1)),T.slice(0,w.length)!=w))for(;w.length>0&&(w=w.slice(0,w.length-1),w=w.slice(0,w.lastIndexOf("/")+1),T.slice(0,w.length)!=w););var B=(_[1]||"").match(/boundary="(.*?)"/);if(!B)throw new Error("MAD cannot find boundary");var G="--"+(B[1]||""),N=[],M=[],j={FileIndex:N,FullPaths:M};S(j);var X,Q=0;for(k=0;k<_.length;++k){var se=_[k];se!==G&&se!==G+"--"||(Q++&&rf(j,_.slice(X,k),w),X=k)}return j}function af(m,E){var w=E||{},_=w.boundary||"SheetJS";_="------="+_;for(var k=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+_.slice(2)+'"',"","",""],T=m.FullPaths[0],B=T,G=m.FileIndex[0],N=1;N<m.FullPaths.length;++N)if(B=m.FullPaths[N].slice(T.length),G=m.FileIndex[N],!(!G.size||!G.content||B=="Sh33tJ5")){B=B.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(pe){return"_x"+pe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(pe){return"_u"+pe.charCodeAt(0).toString(16)+"_"});for(var M=G.content,j=_e&&Buffer.isBuffer(M)?M.toString("binary"):H(M),X=0,Q=Math.min(1024,j.length),se=0,J=0;J<=Q;++J)(se=j.charCodeAt(J))>=32&&se<128&&++X;var ae=X>=Q*4/5;k.push(_),k.push("Content-Location: "+(w.root||"file:///C:/SheetJS/")+B),k.push("Content-Transfer-Encoding: "+(ae?"quoted-printable":"base64")),k.push("Content-Type: "+Jl(G,B)),k.push(""),k.push(ae?Ql(j):Zl(j))}return k.push(_+`--\r
`),k.join(`\r
`)}function nf(m){var E={};return S(E,m),E}function ns(m,E,w,_){var k=_&&_.unsafe;k||S(m);var T=!k&&ye.find(m,E);if(!T){var B=m.FullPaths[0];E.slice(0,B.length)==B?B=E:(B.slice(-1)!="/"&&(B+="/"),B=(B+E).replace("//","/")),T={name:n(E),type:2},m.FileIndex.push(T),m.FullPaths.push(B),k||ye.utils.cfb_gc(m)}return T.content=w,T.size=w?w.length:0,_&&(_.CLSID&&(T.clsid=_.CLSID),_.mt&&(T.mt=_.mt),_.ct&&(T.ct=_.ct)),T}function sf(m,E){S(m);var w=ye.find(m,E);if(w){for(var _=0;_<m.FileIndex.length;++_)if(m.FileIndex[_]==w)return m.FileIndex.splice(_,1),m.FullPaths.splice(_,1),!0}return!1}function of(m,E,w){S(m);var _=ye.find(m,E);if(_){for(var k=0;k<m.FileIndex.length;++k)if(m.FileIndex[k]==_)return m.FileIndex[k].name=n(w),m.FullPaths[k]=w,!0}return!1}function cf(m){O(m,!0)}return t.find=V,t.read=I,t.parse=f,t.write=ue,t.writeFile=Ie,t.utils={cfb_new:nf,cfb_add:ns,cfb_del:sf,cfb_mov:of,cfb_gc:cf,ReadShift:$a,CheckField:N0,prep_blob:er,bconcat:kt,use_zlib:A,_deflateRaw:me,_inflateRaw:Mi,consts:ie},t}();function Wd(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+e)}function rt(e){for(var t=Object.keys(e),r=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e,t[a])&&r.push(t[a]);return r}function di(e){for(var t=[],r=rt(e),a=0;a!==r.length;++a)t[e[r[a]]]=r[a];return t}var Mn=new Date(1899,11,30,0,0,0);function wr(e,t){var r=e.getTime(),a=Mn.getTime()+(e.getTimezoneOffset()-Mn.getTimezoneOffset())*6e4;return(r-a)/(24*60*60*1e3)}var g0=new Date,Hd=Mn.getTime()+(g0.getTimezoneOffset()-Mn.getTimezoneOffset())*6e4,mo=g0.getTimezoneOffset();function Qn(e){var t=new Date;return t.setTime(e*24*60*60*1e3+Hd),t.getTimezoneOffset()!==mo&&t.setTime(t.getTime()+(t.getTimezoneOffset()-mo)*6e4),t}function Vd(e){var t=0,r=0,a=!1,n=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=n.length;++s)if(n[s]){switch(r=1,s>3&&(a=!0),n[s].slice(n[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[s].slice(n[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(a)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(n[s],10)}return t}var vo=new Date("2017-02-19T19:06:09.000Z"),x0=isNaN(vo.getFullYear())?new Date("2/19/17"):vo,Gd=x0.getFullYear()==2017;function Qe(e,t){var r=new Date(e);if(Gd)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(x0.getFullYear()==1917&&!isNaN(r.getFullYear())){var a=r.getFullYear();return e.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var n=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Ht(e,t){if(_e&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Pa(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Pa(t0(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Pa(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Pa(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(s){return r[s]||s})}catch{}for(var a=[],n=0;n!=e.length;++n)a.push(String.fromCharCode(e[n]));return a.join("")}function tr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=tr(e[r]));return t}function Le(e,t){for(var r="";r.length<t;)r+=e;return r}function Kr(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(a))||(a=a.replace(/[(](.*)[)]/,function(n,s){return r=-r,s}),!isNaN(t=Number(a)))?t/r:t}var zd=["january","february","march","april","may","june","july","august","september","october","november","december"];function ga(e){var t=new Date(e),r=new Date(NaN),a=t.getYear(),n=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&zd.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return a<0||a>8099?r:(n>0||s>1)&&a!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var qd=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,a,n){if(e||typeof a=="string")return r.split(a);for(var s=r.split(a),i=[s[0]],o=1;o<s.length;++o)i.push(n),i.push(s[o]);return i}}();function m0(e){return e?e.content&&e.type?Ht(e.content,!0):e.data?Oa(e.data):e.asNodeBuffer&&_e?Oa(e.asNodeBuffer().toString("binary")):e.asBinary?Oa(e.asBinary()):e._data&&e._data.getContent?Oa(Ht(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function v0(e){if(!e)return null;if(e.data)return so(e.data);if(e.asNodeBuffer&&_e)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?so(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function Xd(e){return e&&e.name.slice(-4)===".bin"?v0(e):m0(e)}function Nr(e,t){for(var r=e.FullPaths||rt(e.files),a=t.toLowerCase().replace(/[\/]/g,"\\"),n=a.replace(/\\/g,"/"),s=0;s<r.length;++s){var i=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==i||n==i)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function pi(e,t){var r=Nr(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function He(e,t,r){if(!r)return Xd(pi(e,t));if(!t)return null;try{return He(e,t)}catch{return null}}function Fr(e,t,r){if(!r)return m0(pi(e,t));if(!t)return null;try{return Fr(e,t)}catch{return null}}function Kd(e,t,r){return v0(pi(e,t))}function wo(e){for(var t=e.FullPaths||rt(e.files),r=[],a=0;a<t.length;++a)t[a].slice(-1)!="/"&&r.push(t[a].replace(/^Root Entry[\/]/,""));return r.sort()}function Yd(e,t,r){if(e.FullPaths){if(typeof r=="string"){var a;return _e?a=Kt(r):a=gd(r),ye.utils.cfb_add(e,t,a)}ye.utils.cfb_add(e,t,r)}else e.file(t,r)}function w0(e,t){switch(t.type){case"base64":return ye.read(e,{type:"base64"});case"binary":return ye.read(e,{type:"binary"});case"buffer":case"array":return ye.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Ra(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var a=e.split("/");a.length!==0;){var n=a.shift();n===".."?r.pop():n!=="."&&r.push(n)}return r.join("/")}var _0=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Jd=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,_o=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,Zd=/<[^>]*>/g,hr=_0.match(_o)?_o:Zd,Qd=/<\w*:/,e1=/<(\/?)\w+:/;function fe(e,t,r){for(var a={},n=0,s=0;n!==e.length&&!((s=e.charCodeAt(n))===32||s===10||s===13);++n);if(t||(a[0]=e.slice(0,n)),n===e.length)return a;var i=e.match(Jd),o=0,c="",l=0,f="",u="",h=1;if(i)for(l=0;l!=i.length;++l){for(u=i[l],s=0;s!=u.length&&u.charCodeAt(s)!==61;++s);for(f=u.slice(0,s).trim();u.charCodeAt(s+1)==32;)++s;for(h=(n=u.charCodeAt(s+1))==34||n==39?1:0,c=u.slice(s+1+h,u.length-h),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),a[f]=c,a[f.toLowerCase()]=c;else{var d=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(a[d]&&f.slice(o-3,o)=="ext")continue;a[d]=c,a[d.toLowerCase()]=c}}return a}function tt(e){return e.replace(e1,"<$1")}var y0={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},r1=di(y0),Te=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(a){var n=a+"",s=n.indexOf("<![CDATA[");if(s==-1)return n.replace(e,function(o,c){return y0[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,c){return String.fromCharCode(parseInt(c,16))});var i=n.indexOf("]]>");return r(n.slice(0,s))+n.slice(s+9,i)+r(n.slice(i+3))}}(),t1=/[&<>'"]/g,a1=/[\u0000-\u001f]/g;function gi(e){var t=e+"";return t.replace(t1,function(r){return r1[r]}).replace(/\n/g,"<br/>").replace(a1,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var yo=function(){var e=/&#(\d+);/g;function t(r,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(e,t)}}();function De(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function ps(e){for(var t="",r=0,a=0,n=0,s=0,i=0,o=0;r<e.length;){if(a=e.charCodeAt(r++),a<128){t+=String.fromCharCode(a);continue}if(n=e.charCodeAt(r++),a>191&&a<224){i=(a&31)<<6,i|=n&63,t+=String.fromCharCode(i);continue}if(s=e.charCodeAt(r++),a<240){t+=String.fromCharCode((a&15)<<12|(n&63)<<6|s&63);continue}i=e.charCodeAt(r++),o=((a&7)<<18|(n&63)<<12|(s&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function Eo(e){var t=Ct(2*e.length),r,a,n=1,s=0,i=0,o;for(a=0;a<e.length;a+=n)n=1,(o=e.charCodeAt(a))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(a+1)&63),n=2):o<240?(r=(o&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),n=3):(n=4,r=(o&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[s++]=i&255,t[s++]=i>>>8,i=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function ko(e){return Kt(e,"binary").toString("utf8")}var Tn="foo bar bazâð£",Ce=_e&&(ko(Tn)==ps(Tn)&&ko||Eo(Tn)==ps(Tn)&&Eo)||ps,Pa=_e?function(e){return Kt(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,a=0,n=0;r<e.length;)switch(a=e.charCodeAt(r++),!0){case a<128:t.push(String.fromCharCode(a));break;case a<2048:t.push(String.fromCharCode(192+(a>>6))),t.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,n=e.charCodeAt(r++)-56320+(a<<10),t.push(String.fromCharCode(240+(n>>18&7))),t.push(String.fromCharCode(144+(n>>12&63))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)));break;default:t.push(String.fromCharCode(224+(a>>12))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)))}return t.join("")},Qa=function(){var e={};return function(r,a){var n=r+"|"+(a||"");return e[n]?e[n]:e[n]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",a||"")}}(),E0=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var a=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<e.length;++n)a=a.replace(e[n][0],e[n][1]);return a}}(),n1=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),s1=/<\/?(?:vt:)?variant>/g,i1=/<(?:vt:)([^>]*)>([\s\S]*)</;function To(e,t){var r=fe(e),a=e.match(n1(r.baseType))||[],n=[];if(a.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+a.length+" != "+r.size);return n}return a.forEach(function(s){var i=s.replace(s1,"").match(i1);i&&n.push({v:Ce(i[2]),t:i[1]})}),n}var o1=/(^\s|\s$|\n)/;function c1(e){return rt(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function l1(e,t,r){return"<"+e+(r!=null?c1(r):"")+(t!=null?(t.match(o1)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function xi(e){if(_e&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Ce(Yt(fi(e)));throw new Error("Bad input format: expected Buffer or string")}var en=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,f1={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},u1=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function h1(e,t){for(var r=1-2*(e[t+7]>>>7),a=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),n=e[t+6]&15,s=5;s>=0;--s)n=n*256+e[t+s];return a==2047?n==0?r*(1/0):NaN:(a==0?a=-1022:(a-=1023,n+=Math.pow(2,52)),r*Math.pow(2,a-52)*n)}function d1(e,t,r){var a=(t<0||1/t==-1/0?1:0)<<7,n=0,s=0,i=a?-t:t;isFinite(i)?i==0?n=s=0:(n=Math.floor(Math.log(i)/Math.LN2),s=i*Math.pow(2,52-n),n<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?n=-1022:(s-=Math.pow(2,52),n+=1023)):(n=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[r+o]=s&255;e[r+6]=(n&15)<<4|s&15,e[r+7]=n>>4|a}var So=function(e){for(var t=[],r=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var n=0,s=e[0][a].length;n<s;n+=r)t.push.apply(t,e[0][a].slice(n,n+r));return t},Ao=_e?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Kt(t)})):So(e)}:So,bo=function(e,t,r){for(var a=[],n=t;n<r;n+=2)a.push(String.fromCharCode(lt(e,n)));return a.join("").replace(vr,"")},mi=_e?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(vr,""):bo(e,t,r)}:bo,Fo=function(e,t,r){for(var a=[],n=t;n<t+r;++n)a.push(("0"+e[n].toString(16)).slice(-2));return a.join("")},k0=_e?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Fo(e,t,r)}:Fo,Co=function(e,t,r){for(var a=[],n=t;n<r;n++)a.push(String.fromCharCode(oa(e,n)));return a.join("")},ln=_e?function(t,r,a){return Buffer.isBuffer(t)?t.toString("utf8",r,a):Co(t,r,a)}:Co,T0=function(e,t){var r=Ar(e,t);return r>0?ln(e,t+4,t+4+r-1):""},S0=T0,A0=function(e,t){var r=Ar(e,t);return r>0?ln(e,t+4,t+4+r-1):""},b0=A0,F0=function(e,t){var r=2*Ar(e,t);return r>0?ln(e,t+4,t+4+r-1):""},C0=F0,I0=function(t,r){var a=Ar(t,r);return a>0?mi(t,r+4,r+4+a):""},O0=I0,D0=function(e,t){var r=Ar(e,t);return r>0?ln(e,t+4,t+4+r):""},R0=D0,P0=function(e,t){return h1(e,t)},$n=P0,L0=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};_e&&(S0=function(t,r){if(!Buffer.isBuffer(t))return T0(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},b0=function(t,r){if(!Buffer.isBuffer(t))return A0(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},C0=function(t,r){if(!Buffer.isBuffer(t))return F0(t,r);var a=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a-1)},O0=function(t,r){if(!Buffer.isBuffer(t))return I0(t,r);var a=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a)},R0=function(t,r){if(!Buffer.isBuffer(t))return D0(t,r);var a=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+a)},$n=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):P0(t,r)},L0=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var oa=function(e,t){return e[t]},lt=function(e,t){return e[t+1]*256+e[t]},p1=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Ar=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Mt=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},g1=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function $a(e,t){var r="",a,n,s=[],i,o,c,l;switch(t){case"dbcs":if(l=this.l,_e&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(lt(this,l)),l+=2;e*=2;break;case"utf8":r=ln(this,this.l,this.l+e);break;case"utf16le":e*=2,r=mi(this,this.l,this.l+e);break;case"wstr":return $a.call(this,e,"dbcs");case"lpstr-ansi":r=S0(this,this.l),e=4+Ar(this,this.l);break;case"lpstr-cp":r=b0(this,this.l),e=4+Ar(this,this.l);break;case"lpwstr":r=C0(this,this.l),e=4+2*Ar(this,this.l);break;case"lpp4":e=4+Ar(this,this.l),r=O0(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Ar(this,this.l),r=R0(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=oa(this,this.l+e++))!==0;)s.push(kn(i));r=s.join("");break;case"_wstr":for(e=0,r="";(i=lt(this,this.l+e))!==0;)s.push(kn(i)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",l=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return i=oa(this,l),this.l=l+1,o=$a.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(kn(lt(this,l))),l+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",l=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return i=oa(this,l),this.l=l+1,o=$a.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(kn(oa(this,l))),l+=1}r=s.join("");break;default:switch(e){case 1:return a=oa(this,this.l),this.l++,a;case 2:return a=(t==="i"?p1:lt)(this,this.l),this.l+=2,a;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(a=(e>0?Mt:g1)(this,this.l),this.l+=4,a):(n=Ar(this,this.l),this.l+=4,n);case 8:case-8:if(t==="f")return e==8?n=$n(this,this.l):n=$n([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:r=k0(this,this.l,e);break}}return this.l+=e,r}var x1=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},m1=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},v1=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function w1(e,t,r){var a=0,n=0;if(r==="dbcs"){for(n=0;n!=t.length;++n)v1(this,t.charCodeAt(n),this.l+2*n);a=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=t.length;++n)this[this.l+n]=t.charCodeAt(n)&255;a=t.length}else if(r==="hex"){for(;n<e;++n)this[this.l++]=parseInt(t.slice(2*n,2*n+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(n=0;n<Math.min(t.length,e);++n){var i=t.charCodeAt(n);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=t&255;break;case 2:a=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:a=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:a=4,x1(this,t,this.l);break;case 8:if(a=8,r==="f"){d1(this,t,this.l);break}case 16:break;case-4:a=4,m1(this,t,this.l);break}return this.l+=a,this}function N0(e,t){var r=k0(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function er(e,t){e.l=t,e.read_shift=$a,e.chk=N0,e.write_shift=w1}function ur(e,t){e.l+=t}function ze(e){var t=Ct(e);return er(t,0),t}function gt(e,t,r){if(e){var a,n,s;er(e,e.l||0);for(var i=e.length,o=0,c=0;e.l<i;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var l=Gn[o]||Gn[65535];for(a=e.read_shift(1),s=a&127,n=1;n<4&&a&128;++n)s+=((a=e.read_shift(1))&127)<<7*n;c=e.l+s;var f=l.f&&l.f(e,s,r);if(e.l=c,t(f,l,o))return}}}function Os(){var e=[],t=_e?256:2048,r=function(l){var f=ze(l);return er(f,0),f},a=r(t),n=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},s=function(l){return a&&l<a.length-a.l?a:(n(),a=r(Math.max(l+1,t)))},i=function(){return n(),kt(e)},o=function(l){n(),a=l,a.l==null&&(a.l=a.length),s(t)};return{next:s,push:o,end:i,_bufs:e}}function Ua(e,t,r){var a=tr(e);if(t.s?(a.cRel&&(a.c+=t.s.c),a.rRel&&(a.r+=t.s.r)):(a.cRel&&(a.c+=t.c),a.rRel&&(a.r+=t.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function Io(e,t,r){var a=tr(e);return a.s=Ua(a.s,t.s,r),a.e=Ua(a.e,t.s,r),a}function ja(e,t){if(e.cRel&&e.c<0)for(e=tr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=tr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=de(e);return!e.cRel&&e.cRel!=null&&(r=E1(r)),!e.rRel&&e.rRel!=null&&(r=_1(r)),r}function gs(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+qe(e.s.c)+":"+(e.e.cRel?"":"$")+qe(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+ar(e.s.r)+":"+(e.e.rRel?"":"$")+ar(e.e.r):ja(e.s,t.biff)+":"+ja(e.e,t.biff)}function vi(e){return parseInt(y1(e),10)-1}function ar(e){return""+(e+1)}function _1(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function y1(e){return e.replace(/\$(\d+)$/,"$1")}function wi(e){for(var t=k1(e),r=0,a=0;a!==t.length;++a)r=26*r+t.charCodeAt(a)-64;return r-1}function qe(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function E1(e){return e.replace(/^([A-Z])/,"$$$1")}function k1(e){return e.replace(/^\$([A-Z])/,"$1")}function T1(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function mr(e){for(var t=0,r=0,a=0;a<e.length;++a){var n=e.charCodeAt(a);n>=48&&n<=57?t=10*t+(n-48):n>=65&&n<=90&&(r=26*r+(n-64))}return{c:r-1,r:t-1}}function de(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function ya(e){var t=e.indexOf(":");return t==-1?{s:mr(e),e:mr(e)}:{s:mr(e.slice(0,t)),e:mr(e.slice(t+1))}}function Ee(e,t){return typeof t>"u"||typeof t=="number"?Ee(e.s,e.e):(typeof e!="string"&&(e=de(e)),typeof t!="string"&&(t=de(t)),e==t?e:e+":"+t)}function Ne(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,n=0,s=e.length;for(r=0;a<s&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(t.s.c=--r,r=0;a<s&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;if(t.s.r=--r,a===s||n!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++a,r=0;a!=s&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(t.e.c=--r,r=0;a!=s&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;return t.e.r=--r,t}function Oo(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Mr(e.z,r?wr(t):t)}catch{}try{return e.w=Mr((e.XF||{}).numFmtId||(r?14:0),r?wr(t):t)}catch{return""+t}}function pt(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Qt[e.v]||e.v:t==null?Oo(e,e.v):Oo(e,t))}function Dt(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",a={};return a[r]=e,{SheetNames:[r],Sheets:a}}function B0(e,t,r){var a=r||{},n=e?Array.isArray(e):a.dense,s=e||(n?[]:{}),i=0,o=0;if(s&&a.origin!=null){if(typeof a.origin=="number")i=a.origin;else{var c=typeof a.origin=="string"?mr(a.origin):a.origin;i=c.r,o=c.c}s["!ref"]||(s["!ref"]="A1:A1")}var l={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var f=Ne(s["!ref"]);l.s.c=f.s.c,l.s.r=f.s.r,l.e.c=Math.max(l.e.c,f.e.c),l.e.r=Math.max(l.e.r,f.e.r),i==-1&&(l.e.r=i=f.e.r+1)}for(var u=0;u!=t.length;++u)if(t[u]){if(!Array.isArray(t[u]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[u].length;++h)if(!(typeof t[u][h]>"u")){var d={v:t[u][h]},g=i+u,p=o+h;if(l.s.r>g&&(l.s.r=g),l.s.c>p&&(l.s.c=p),l.e.r<g&&(l.e.r=g),l.e.c<p&&(l.e.c=p),t[u][h]&&typeof t[u][h]=="object"&&!Array.isArray(t[u][h])&&!(t[u][h]instanceof Date))d=t[u][h];else if(Array.isArray(d.v)&&(d.f=t[u][h][1],d.v=d.v[0]),d.v===null)if(d.f)d.t="n";else if(a.nullError)d.t="e",d.v=0;else if(a.sheetStubs)d.t="z";else continue;else typeof d.v=="number"?d.t="n":typeof d.v=="boolean"?d.t="b":d.v instanceof Date?(d.z=a.dateNF||xe[14],a.cellDates?(d.t="d",d.w=Mr(d.z,wr(d.v))):(d.t="n",d.v=wr(d.v),d.w=Mr(d.z,d.v))):d.t="s";if(n)s[g]||(s[g]=[]),s[g][p]&&s[g][p].z&&(d.z=s[g][p].z),s[g][p]=d;else{var x=de({c:p,r:g});s[x]&&s[x].z&&(d.z=s[x].z),s[x]=d}}}return l.s.c<1e7&&(s["!ref"]=Ee(l)),s}function Ea(e,t){return B0(null,e,t)}function S1(e){return e.read_shift(4,"i")}function fr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function A1(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function _i(e,t){var r=e.l,a=e.read_shift(1),n=fr(e),s=[],i={t:n,h:n};if(a&1){for(var o=e.read_shift(4),c=0;c!=o;++c)s.push(A1(e));i.r=s}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}var b1=_i;function Ur(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Jt(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var F1=fr;function yi(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var C1=fr,Ds=yi;function Ei(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,a=t[0]&2;e.l+=4;var n=a===0?$n([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Mt(t,0)>>2;return r?n/100:n}function M0(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var Zt=M0;function cr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function I1(e){var t={},r=e.read_shift(1),a=r>>>1,n=e.read_shift(1),s=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,a){case 0:t.auto=1;break;case 1:t.index=n;var l=jt[n];l&&(t.rgb=tn(l));break;case 2:t.rgb=tn([i,o,c]);break;case 3:t.theme=n;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function O1(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function $0(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=e.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function D1(e){return $0(e,1)}function R1(e){return $0(e,2)}var ki=2,yr=3,Sn=11,Do=12,Un=19,An=64,P1=65,L1=71,N1=4108,B1=4126,Ye=80,U0=81,M1=[Ye,U0],$1={1:{n:"CodePage",t:ki},2:{n:"Category",t:Ye},3:{n:"PresentationFormat",t:Ye},4:{n:"ByteCount",t:yr},5:{n:"LineCount",t:yr},6:{n:"ParagraphCount",t:yr},7:{n:"SlideCount",t:yr},8:{n:"NoteCount",t:yr},9:{n:"HiddenCount",t:yr},10:{n:"MultimediaClipCount",t:yr},11:{n:"ScaleCrop",t:Sn},12:{n:"HeadingPairs",t:N1},13:{n:"TitlesOfParts",t:B1},14:{n:"Manager",t:Ye},15:{n:"Company",t:Ye},16:{n:"LinksUpToDate",t:Sn},17:{n:"CharacterCount",t:yr},19:{n:"SharedDoc",t:Sn},22:{n:"HyperlinksChanged",t:Sn},23:{n:"AppVersion",t:yr,p:"version"},24:{n:"DigSig",t:P1},26:{n:"ContentType",t:Ye},27:{n:"ContentStatus",t:Ye},28:{n:"Language",t:Ye},29:{n:"Version",t:Ye},255:{},2147483648:{n:"Locale",t:Un},2147483651:{n:"Behavior",t:Un},1919054434:{}},U1={1:{n:"CodePage",t:ki},2:{n:"Title",t:Ye},3:{n:"Subject",t:Ye},4:{n:"Author",t:Ye},5:{n:"Keywords",t:Ye},6:{n:"Comments",t:Ye},7:{n:"Template",t:Ye},8:{n:"LastAuthor",t:Ye},9:{n:"RevNumber",t:Ye},10:{n:"EditTime",t:An},11:{n:"LastPrinted",t:An},12:{n:"CreatedDate",t:An},13:{n:"ModifiedDate",t:An},14:{n:"PageCount",t:yr},15:{n:"WordCount",t:yr},16:{n:"CharCount",t:yr},17:{n:"Thumbnail",t:L1},18:{n:"Application",t:Ye},19:{n:"DocSecurity",t:yr},255:{},2147483648:{n:"Locale",t:Un},2147483651:{n:"Behavior",t:Un},1919054434:{}},Ro={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},j1=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function W1(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var H1=W1([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),jt=tr(H1),Qt={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},j0={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Po={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function V1(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function G1(e){var t=V1();if(!e||!e.match)return t;var r={};if((e.match(hr)||[]).forEach(function(a){var n=fe(a);switch(n[0].replace(Qd,"<")){case"<?xml":break;case"<Types":t.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[n.Extension]=n.ContentType;break;case"<Override":t[Po[n.ContentType]]!==void 0&&t[Po[n.ContentType]].push(n.PartName);break}}),t.xmlns!==f1.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var ca={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Rs(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Wa(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var a={};return(e.match(hr)||[]).forEach(function(n){var s=fe(n);if(s[0]==="<Relationship"){var i={};i.Type=s.Type,i.Target=s.Target,i.Id=s.Id,s.TargetMode&&(i.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:Ra(s.Target,t);r[o]=i,a[s.Id]=i}}),r["!id"]=a,r}var z1="application/vnd.oasis.opendocument.spreadsheet";function q1(e,t){for(var r=xi(e),a,n;a=en.exec(r);)switch(a[3]){case"manifest":break;case"file-entry":if(n=fe(a[0],!1),n.path=="/"&&n.type!==z1)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw a}}var Ha=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],X1=function(){for(var e=new Array(Ha.length),t=0;t<Ha.length;++t){var r=Ha[t],a="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return e}();function W0(e){var t={};e=Ce(e);for(var r=0;r<Ha.length;++r){var a=Ha[r],n=e.match(X1[r]);n!=null&&n.length>0&&(t[a[1]]=Te(n[1])),a[2]==="date"&&t[a[1]]&&(t[a[1]]=Qe(t[a[1]]))}return t}var K1=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function H0(e,t,r,a){var n=[];if(typeof e=="string")n=To(e,a);else for(var s=0;s<e.length;++s)n=n.concat(e[s].map(function(f){return{v:f}}));var i=typeof t=="string"?To(t,a).map(function(f){return f.v}):t,o=0,c=0;if(i.length>0)for(var l=0;l!==n.length;l+=2){switch(c=+n[l+1].v,n[l].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=i.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":r.NamedRanges=c,r.DefinedNames=i.slice(o,o+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=i.slice(o,o+c);break}o+=c}}function Y1(e,t,r){var a={};return t||(t={}),e=Ce(e),K1.forEach(function(n){var s=(e.match(Qa(n[0]))||[])[1];switch(n[2]){case"string":s&&(t[n[1]]=Te(s));break;case"bool":t[n[1]]=s==="true";break;case"raw":var i=e.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));i&&i.length>0&&(a[n[1]]=i[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&H0(a.HeadingPairs,a.TitlesOfParts,t,r),t}var J1=/<[^>]+>[^<]*/g;function Z1(e,t){var r={},a="",n=e.match(J1);if(n)for(var s=0;s!=n.length;++s){var i=n[s],o=fe(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":a=Te(o.name);break;case"</property>":a=null;break;default:if(i.indexOf("<vt:")===0){var c=i.split(">"),l=c[0].slice(4),f=c[1];switch(l){case"lpstr":case"bstr":case"lpwstr":r[a]=Te(f);break;case"bool":r[a]=De(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[a]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[a]=parseFloat(f);break;case"filetime":case"date":r[a]=Qe(f);break;case"cy":case"error":r[a]=Te(f);break;default:if(l.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,l,c)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}var Q1={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},xs;function ep(e,t,r){xs||(xs=di(Q1)),t=xs[t]||t,e[t]=r}function Ti(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function V0(e,t,r){var a=e.l,n=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-a&3;)++e.l;return n}function G0(e,t,r){var a=e.read_shift(0,"lpwstr");return a}function z0(e,t,r){return t===31?G0(e):V0(e,t,r)}function Ps(e,t,r){return z0(e,t,r===!1?0:4)}function rp(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return z0(e,t,0)}function tp(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a){var n=e.l;r[a]=e.read_shift(0,"lpwstr").replace(vr,""),e.l-n&2&&(e.l+=2)}return r}function ap(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a)r[a]=e.read_shift(0,"lpstr-cp").replace(vr,"");return r}function np(e){var t=e.l,r=jn(e,U0);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var a=jn(e,yr);return[r,a]}function sp(e){for(var t=e.read_shift(4),r=[],a=0;a<t/2;++a)r.push(np(e));return r}function Lo(e,t){for(var r=e.read_shift(4),a={},n=0;n!=r;++n){var s=e.read_shift(4),i=e.read_shift(4);a[s]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(vr,"").replace(Da,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),a}function q0(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function ip(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function jn(e,t,r){var a=e.read_shift(2),n,s=r||{};if(e.l+=2,t!==Do&&a!==t&&M1.indexOf(t)===-1&&!((t&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+t+" saw "+a);switch(t===Do?a:t){case 2:return n=e.read_shift(2,"i"),s.raw||(e.l+=2),n;case 3:return n=e.read_shift(4,"i"),n;case 11:return e.read_shift(4)!==0;case 19:return n=e.read_shift(4),n;case 30:return V0(e,a,4).replace(vr,"");case 31:return G0(e);case 64:return Ti(e);case 65:return q0(e);case 71:return ip(e);case 80:return Ps(e,a,!s.raw).replace(vr,"");case 81:return rp(e,a).replace(vr,"");case 4108:return sp(e);case 4126:case 4127:return a==4127?tp(e):ap(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+a)}}function No(e,t){var r=e.l,a=e.read_shift(4),n=e.read_shift(4),s=[],i=0,o=0,c=-1,l={};for(i=0;i!=n;++i){var f=e.read_shift(4),u=e.read_shift(4);s[i]=[f,u+r]}s.sort(function(F,v){return F[1]-v[1]});var h={};for(i=0;i!=n;++i){if(e.l!==s[i][1]){var d=!0;if(i>0&&t)switch(t[s[i-1][0]].t){case 2:e.l+2===s[i][1]&&(e.l+=2,d=!1);break;case 80:e.l<=s[i][1]&&(e.l=s[i][1],d=!1);break;case 4108:e.l<=s[i][1]&&(e.l=s[i][1],d=!1);break}if((!t||i==0)&&e.l<=s[i][1]&&(d=!1,e.l=s[i][1]),d)throw new Error("Read Error: Expected address "+s[i][1]+" at "+e.l+" :"+i)}if(t){var g=t[s[i][0]];if(h[g.n]=jn(e,g.t,{raw:!0}),g.p==="version"&&(h[g.n]=String(h[g.n]>>16)+"."+("0000"+String(h[g.n]&65535)).slice(-4)),g.n=="CodePage")switch(h[g.n]){case 0:h[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:qr(o=h[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[g.n])}}else if(s[i][0]===1){if(o=h.CodePage=jn(e,ki),qr(o),c!==-1){var p=e.l;e.l=s[c][1],l=Lo(e,o),e.l=p}}else if(s[i][0]===0){if(o===0){c=i,e.l=s[i+1][1];continue}l=Lo(e,o)}else{var x=l[s[i][0]],y;switch(e[e.l]){case 65:e.l+=4,y=q0(e);break;case 30:e.l+=4,y=Ps(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,y=Ps(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,y=e.read_shift(4,"i");break;case 19:e.l+=4,y=e.read_shift(4);break;case 5:e.l+=4,y=e.read_shift(8,"f");break;case 11:e.l+=4,y=Ue(e,4);break;case 64:e.l+=4,y=Qe(Ti(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[x]=y}}return e.l=r+a,h}function Bo(e,t,r){var a=e.content;if(!a)return{};er(a,0);var n,s,i,o,c=0;a.chk("feff","Byte Order: "),a.read_shift(2);var l=a.read_shift(4),f=a.read_shift(16);if(f!==ye.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(n=a.read_shift(4),n!==1&&n!==2)throw new Error("Unrecognized #Sets: "+n);if(s=a.read_shift(16),o=a.read_shift(4),n===1&&o!==a.l)throw new Error("Length mismatch: "+o+" !== "+a.l);n===2&&(i=a.read_shift(16),c=a.read_shift(4));var u=No(a,t),h={SystemIdentifier:l};for(var d in u)h[d]=u[d];if(h.FMTID=s,n===1)return h;if(c-a.l==2&&(a.l+=2),a.l!==c)throw new Error("Length mismatch 2: "+a.l+" !== "+c);var g;try{g=No(a,null)}catch{}for(d in g)h[d]=g[d];return h.FMTID=[s,i],h}function vt(e,t){return e.read_shift(t),null}function op(e,t,r){for(var a=[],n=e.l+t;e.l<n;)a.push(r(e,n-e.l));if(n!==e.l)throw new Error("Slurp error");return a}function Ue(e,t){return e.read_shift(t)===1}function Ve(e){return e.read_shift(2,"u")}function X0(e,t){return op(e,t,Ve)}function cp(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function fn(e,t,r){var a=e.read_shift(r&&r.biff>=12?2:1),n="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(n="dbcs-cont")}else r.biff==12&&(n="wstr");r.biff>=2&&r.biff<=5&&(n="cpstr");var i=a?e.read_shift(a,n):"";return i}function lp(e){var t=e.read_shift(2),r=e.read_shift(1),a=r&4,n=r&8,s=1+(r&1),i=0,o,c={};n&&(i=e.read_shift(2)),a&&(o=e.read_shift(4));var l=s==2?"dbcs-cont":"sbcs-cont",f=t===0?"":e.read_shift(t,l);return n&&(e.l+=4*i),a&&(e.l+=o),c.t=f,n||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function Vt(e,t,r){var a;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var n=e.read_shift(1);return n===0?a=e.read_shift(t,"sbcs-cont"):a=e.read_shift(t,"dbcs-cont"),a}function un(e,t,r){var a=e.read_shift(r&&r.biff==2?1:2);return a===0?(e.l++,""):Vt(e,a,r)}function ea(e,t,r){if(r.biff>5)return un(e,t,r);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function fp(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function up(e){var t=e.read_shift(4),r=e.l,a=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),e.l=r);var n=e.read_shift((a?t-24:t)>>1,"utf16le").replace(vr,"");return a&&(e.l+=24),n}function hp(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var a=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var n=e.read_shift(4);if(n===0)return r+a.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(s>>1,"utf16le").replace(vr,"");return r+i}function dp(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return up(e);case"0303000000000000c000000000000046":return hp(e);default:throw new Error("Unsupported Moniker "+r)}}function bn(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(vr,""):"";return r}function pp(e,t){var r=e.l+t,a=e.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var n=e.read_shift(2);e.l+=2;var s,i,o,c,l="",f,u;n&16&&(s=bn(e,r-e.l)),n&128&&(i=bn(e,r-e.l)),(n&257)===257&&(o=bn(e,r-e.l)),(n&257)===1&&(c=dp(e,r-e.l)),n&8&&(l=bn(e,r-e.l)),n&32&&(f=e.read_shift(16)),n&64&&(u=Ti(e)),e.l=r;var h=i||o||c||"";h&&l&&(h+="#"+l),h||(h="#"+l),n&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var d={Target:h};return f&&(d.guid=f),u&&(d.time=u),s&&(d.Tooltip=s),d}function K0(e){var t=e.read_shift(1),r=e.read_shift(1),a=e.read_shift(1),n=e.read_shift(1);return[t,r,a,n]}function Y0(e,t){var r=K0(e);return r[3]=0,r}function at(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return{r:t,c:r,ixfe:a}}function gp(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function xp(e,t,r){return t===0?"":ea(e,t,r)}function mp(e,t,r){var a=r.biff>8?4:2,n=e.read_shift(a),s=e.read_shift(a,"i"),i=e.read_shift(a,"i");return[n,s,i]}function J0(e){var t=e.read_shift(2),r=Ei(e);return[t,r]}function vp(e,t,r){e.l+=4,t-=4;var a=e.l+t,n=fn(e,t,r),s=e.read_shift(2);if(a-=e.l,s!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+s);return e.l+=s,n}function es(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2);return{s:{c:a,r:t},e:{c:n,r}}}function Z0(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(1),n=e.read_shift(1);return{s:{c:a,r:t},e:{c:n,r}}}var wp=Z0;function Q0(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return e.l+=12,[r,t,a]}function _p(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function yp(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function sr(e){e.l+=2,e.l+=e.read_shift(2)}var Ep={0:sr,4:sr,5:sr,6:sr,7:yp,8:sr,9:sr,10:sr,11:sr,12:sr,13:_p,14:sr,15:sr,16:sr,17:sr,18:sr,19:sr,20:sr,21:Q0};function kp(e,t){for(var r=e.l+t,a=[];e.l<r;){var n=e.read_shift(2);e.l-=2;try{a.push(Ep[n](e,r-e.l))}catch{return e.l=r,a}}return e.l!=r&&(e.l=r),a}function Fn(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Tp(e,t){return t===0||e.read_shift(2),1200}function Sp(e,t,r){if(r.enc)return e.l+=t,"";var a=e.l,n=ea(e,0,r);return e.read_shift(t+a-e.l),n}function Ap(e,t,r){var a=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function bp(e,t,r){var a=e.read_shift(4),n=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var i=fn(e,0,r);return i.length===0&&(i="Sheet1"),{pos:a,hs:n,dt:s,name:i}}function Fp(e,t){for(var r=e.l+t,a=e.read_shift(4),n=e.read_shift(4),s=[],i=0;i!=n&&e.l<r;++i)s.push(lp(e));return s.Count=a,s.Unique=n,s}function Cp(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function Ip(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var a=e.read_shift(1);return e.l+=3,a&7&&(t.level=a&7),a&32&&(t.hidden=!0),a&64&&(t.hpt=r/20),t}function Op(e){var t=gp(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function Dp(e){return e.read_shift(2),e.read_shift(4)}function Mo(e,t,r){var a=0;r&&r.biff==2||(a=e.read_shift(2));var n=e.read_shift(2);r&&r.biff==2&&(a=1-(n>>15),n&=32767);var s={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[s,n]}function Rp(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),l=e.read_shift(2);return{Pos:[t,r],Dim:[a,n],Flags:s,CurTab:i,FirstTab:o,Selected:c,TabRatio:l}}function Pp(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var a=e.read_shift(2);return{RTL:a&64}}function Lp(){}function Np(e,t,r){var a={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return a.name=fn(e,0,r),a}function Bp(e){var t=at(e);return t.isst=e.read_shift(4),t}function Mp(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=e.l+t,n=at(e);r.biff==2&&e.l++;var s=un(e,a-e.l,r);return n.val=s,n}function $p(e,t,r){var a=e.read_shift(2),n=ea(e,0,r);return[a,n]}var Up=ea;function $o(e,t,r){var a=e.l+t,n=r.biff==8||!r.biff?4:2,s=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(2),c=e.read_shift(2);return e.l=a,{s:{r:s,c:o},e:{r:i,c}}}function jp(e){var t=e.read_shift(2),r=e.read_shift(2),a=J0(e);return{r:t,c:r,ixfe:a[0],rknum:a[1]}}function Wp(e,t){for(var r=e.l+t-2,a=e.read_shift(2),n=e.read_shift(2),s=[];e.l<r;)s.push(J0(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(s.length!=i-n+1)throw new Error("MulRK length mismatch");return{r:a,c:n,C:i,rkrec:s}}function Hp(e,t){for(var r=e.l+t-2,a=e.read_shift(2),n=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(s.length!=i-n+1)throw new Error("MulBlank length mismatch");return{r:a,c:n,C:i,ixfe:s}}function Vp(e,t,r,a){var n={},s=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(2);return n.patternType=j1[o>>26],a.cellStyles&&(n.alc=s&7,n.fWrap=s>>3&1,n.alcV=s>>4&7,n.fJustLast=s>>7&1,n.trot=s>>8&255,n.cIndent=s>>16&15,n.fShrinkToFit=s>>20&1,n.iReadOrder=s>>22&2,n.fAtrNum=s>>26&1,n.fAtrFnt=s>>27&1,n.fAtrAlc=s>>28&1,n.fAtrBdr=s>>29&1,n.fAtrPat=s>>30&1,n.fAtrProt=s>>31&1,n.dgLeft=i&15,n.dgRight=i>>4&15,n.dgTop=i>>8&15,n.dgBottom=i>>12&15,n.icvLeft=i>>16&127,n.icvRight=i>>23&127,n.grbitDiag=i>>30&3,n.icvTop=o&127,n.icvBottom=o>>7&127,n.icvDiag=o>>14&127,n.dgDiag=o>>21&15,n.icvFore=c&127,n.icvBack=c>>7&127,n.fsxButton=c>>14&1),n}function Gp(e,t,r){var a={};return a.ifnt=e.read_shift(2),a.numFmtId=e.read_shift(2),a.flags=e.read_shift(2),a.fStyle=a.flags>>2&1,t-=6,a.data=Vp(e,t,a.fStyle,r),a}function zp(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function Uo(e,t,r){var a=at(e);(r.biff==2||t==9)&&++e.l;var n=cp(e);return a.val=n,a.t=n===!0||n===!1?"b":"e",a}function qp(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=at(e),n=cr(e);return a.val=n,a}var jo=xp;function Xp(e,t,r){var a=e.l+t,n=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,n];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var i=Vt(e,s),o=[];a>e.l;)o.push(un(e));return[s,n,i,o]}function Wo(e,t,r){var a=e.read_shift(2),n,s={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return r.sbcch===14849&&(n=vp(e,t-2,r)),s.body=n||e.read_shift(t-2),typeof n=="string"&&(s.Name=n),s}var Kp=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Ho(e,t,r){var a=e.l+t,n=e.read_shift(2),s=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var l=Vt(e,i,r);n&32&&(l=Kp[l.charCodeAt(0)]);var f=a-e.l;r&&r.biff==2&&--f;var u=a==e.l||o===0||!(f>0)?[]:Iv(e,f,r,o);return{chKey:s,Name:l,itab:c,rgce:u}}function el(e,t,r){if(r.biff<8)return Yp(e,t,r);for(var a=[],n=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)a.push(mp(e,r.biff>8?12:6,r));if(e.l!=n)throw new Error("Bad ExternSheet: "+e.l+" != "+n);return a}function Yp(e,t,r){e[e.l+1]==3&&e[e.l]++;var a=fn(e,t,r);return a.charCodeAt(0)==3?a.slice(1):a}function Jp(e,t,r){if(r.biff<8){e.l+=t;return}var a=e.read_shift(2),n=e.read_shift(2),s=Vt(e,a,r),i=Vt(e,n,r);return[s,i]}function Zp(e,t,r){var a=Z0(e);e.l++;var n=e.read_shift(1);return t-=8,[Ov(e,t,r),n,a]}function Vo(e,t,r){var a=wp(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[a,Fv(e,t,r)]}function Qp(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,a=e.read_shift(4);return[t,r,a]}function eg(e,t,r){if(!(r.biff<8)){var a=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=ea(e,0,r);return r.biff<8&&e.read_shift(1),[{r:a,c:n},o,i,s]}}function rg(e,t,r){return eg(e,t,r)}function tg(e,t){for(var r=[],a=e.read_shift(2);a--;)r.push(es(e));return r}function ag(e,t,r){if(r&&r.biff<8)return sg(e,t,r);var a=Q0(e),n=kp(e,t-22,a[1]);return{cmo:a,ft:n}}var ng={8:function(e,t){var r=e.l+t;e.l+=10;var a=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var n=e.read_shift(1);return e.l+=n,e.l=r,{fmt:a}}};function sg(e,t,r){e.l+=4;var a=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((ng[a]||ur)(e,t,r)),{cmo:[n,a,s],ft:i}}function ig(e,t,r){var a=e.l,n="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:i=fp(e,6,r);var o=e.read_shift(2);e.read_shift(2),Ve(e,2);var c=e.read_shift(2);e.l+=c;for(var l=1;l<e.lens.length-1;++l){if(e.l-a!=e.lens[l])throw new Error("TxO: bad continue record");var f=e[e.l],u=Vt(e,e.lens[l+1]-e.lens[l]-1);if(n+=u,n.length>=(f?o:2*o))break}if(n.length!==o&&n.length!==o*2)throw new Error("cchText: "+o+" != "+n.length);return e.l=a+t,{t:n}}catch{return e.l=a+t,{t:n}}}function og(e,t){var r=es(e);e.l+=16;var a=pp(e,t-24);return[r,a]}function cg(e,t){e.read_shift(2);var r=es(e),a=e.read_shift((t-10)/2,"dbcs-cont");return a=a.replace(vr,""),[r,a]}function lg(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Ro[r]||r,r=e.read_shift(2),t[1]=Ro[r]||r,t}function fg(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Y0(e));return r}function ug(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Y0(e));return r}function hg(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function rl(e,t,r){if(!r.cellStyles)return ur(e,t);var a=r&&r.biff>=12?4:2,n=e.read_shift(a),s=e.read_shift(a),i=e.read_shift(a),o=e.read_shift(a),c=e.read_shift(2);a==2&&(e.l+=2);var l={s:n,e:s,w:i,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(l.level=c>>8&7),l}function dg(e,t){var r={};return t<32||(e.l+=16,r.header=cr(e),r.footer=cr(e),e.l+=2),r}function pg(e,t,r){var a={area:!1};if(r.biff!=5)return e.l+=t,a;var n=e.read_shift(1);return e.l+=3,n&16&&(a.area=!0),a}var gg=at,xg=X0,mg=un;function vg(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),n={fmt:t,env:r,len:a,data:e.slice(e.l,e.l+a)};return e.l+=a,n}function wg(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var a=at(e);++e.l;var n=ea(e,t-7,r);return a.t="str",a.val=n,a}function _g(e){var t=at(e);++e.l;var r=cr(e);return t.t="n",t.val=r,t}function yg(e){var t=at(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function Eg(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function kg(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function Tg(e,t,r){var a=e.l+t,n=at(e),s=e.read_shift(2),i=Vt(e,s,r);return e.l=a,n.t="str",n.val=i,n}var Sg=[2,3,48,49,131,139,140,245],Go=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=di({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var l=[],f=Ct(1);switch(c.type){case"base64":f=Gr(Or(o));break;case"binary":f=Gr(o);break;case"buffer":case"array":f=o;break}er(f,0);var u=f.read_shift(1),h=!!(u&136),d=!1,g=!1;switch(u){case 2:break;case 3:break;case 48:d=!0,h=!0;break;case 49:d=!0,h=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+u.toString(16))}var p=0,x=521;u==2&&(p=f.read_shift(2)),f.l+=3,u!=2&&(p=f.read_shift(4)),p>1048576&&(p=1e6),u!=2&&(x=f.read_shift(2));var y=f.read_shift(2),F=c.codepage||1252;u!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(F=e[f[f.l]]),f.l+=1,f.l+=2),g&&(f.l+=36);for(var v=[],C={},P=Math.min(f.length,u==2?521:x-10-(d?264:0)),I=g?32:11;f.l<P&&f[f.l]!=13;)switch(C={},C.name=Ja.utils.decode(F,f.slice(f.l,f.l+I)).replace(/[\u0000\r\n].*$/g,""),f.l+=I,C.type=String.fromCharCode(f.read_shift(1)),u!=2&&!g&&(C.offset=f.read_shift(4)),C.len=f.read_shift(1),u==2&&(C.offset=f.read_shift(2)),C.dec=f.read_shift(1),C.name.length&&v.push(C),u!=2&&(f.l+=g?13:14),C.type){case"B":(!d||C.len!=8)&&c.WTF&&console.log("Skipping "+C.name+":"+C.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+C.name+":"+C.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+C.type)}if(f[f.l]!==13&&(f.l=x-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=x;var S=0,W=0;for(l[0]=[],W=0;W!=v.length;++W)l[0][W]=v[W].name;for(;p-- >0;){if(f[f.l]===42){f.l+=y;continue}for(++f.l,l[++S]=[],W=0,W=0;W!=v.length;++W){var O=f.slice(f.l,f.l+v[W].len);f.l+=v[W].len,er(O,0);var z=Ja.utils.decode(F,O);switch(v[W].type){case"C":z.trim().length&&(l[S][W]=z.replace(/\s+$/,""));break;case"D":z.length===8?l[S][W]=new Date(+z.slice(0,4),+z.slice(4,6)-1,+z.slice(6,8)):l[S][W]=z;break;case"F":l[S][W]=parseFloat(z.trim());break;case"+":case"I":l[S][W]=g?O.read_shift(-4,"i")^2147483648:O.read_shift(4,"i");break;case"L":switch(z.trim().toUpperCase()){case"Y":case"T":l[S][W]=!0;break;case"N":case"F":l[S][W]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+z+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+u.toString(16));l[S][W]="##MEMO##"+(g?parseInt(z.trim(),10):O.read_shift(4));break;case"N":z=z.replace(/\u0000/g,"").trim(),z&&z!="."&&(l[S][W]=+z||0);break;case"@":l[S][W]=new Date(O.read_shift(-8,"f")-621356832e5);break;case"T":l[S][W]=new Date((O.read_shift(4)-2440588)*864e5+O.read_shift(4));break;case"Y":l[S][W]=O.read_shift(4,"i")/1e4+O.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":l[S][W]=-O.read_shift(-8,"f");break;case"B":if(d&&v[W].len==8){l[S][W]=O.read_shift(8,"f");break}case"G":case"P":O.l+=v[W].len;break;case"0":if(v[W].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+v[W].type)}}}if(u!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return c&&c.sheetRows&&(l=l.slice(0,c.sheetRows)),c.DBF=v,l}function a(o,c){var l=c||{};l.dateNF||(l.dateNF="yyyymmdd");var f=Ea(r(o,l),l);return f["!cols"]=l.DBF.map(function(u){return{wch:u.len,DBF:u}}),delete l.DBF,f}function n(o,c){try{return Dt(a(o,c),c)}catch(l){if(c&&c.WTF)throw l}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,c){var l=c||{};if(+l.codepage>=0&&qr(+l.codepage),l.type=="string")throw new Error("Cannot write DBF to JS string");var f=Os(),u=js(o,{header:1,raw:!0,cellDates:!0}),h=u[0],d=u.slice(1),g=o["!cols"]||[],p=0,x=0,y=0,F=1;for(p=0;p<h.length;++p){if(((g[p]||{}).DBF||{}).name){h[p]=g[p].DBF.name,++y;continue}if(h[p]!=null){if(++y,typeof h[p]=="number"&&(h[p]=h[p].toString(10)),typeof h[p]!="string")throw new Error("DBF Invalid column name "+h[p]+" |"+typeof h[p]+"|");if(h.indexOf(h[p])!==p){for(x=0;x<1024;++x)if(h.indexOf(h[p]+"_"+x)==-1){h[p]+="_"+x;break}}}}var v=Ne(o["!ref"]),C=[],P=[],I=[];for(p=0;p<=v.e.c-v.s.c;++p){var S="",W="",O=0,z=[];for(x=0;x<d.length;++x)d[x][p]!=null&&z.push(d[x][p]);if(z.length==0||h[p]==null){C[p]="?";continue}for(x=0;x<z.length;++x){switch(typeof z[x]){case"number":W="B";break;case"string":W="C";break;case"boolean":W="L";break;case"object":W=z[x]instanceof Date?"D":"C";break;default:W="C"}O=Math.max(O,String(z[x]).length),S=S&&S!=W?"C":W}O>250&&(O=250),W=((g[p]||{}).DBF||{}).type,W=="C"&&g[p].DBF.len>O&&(O=g[p].DBF.len),S=="B"&&W=="N"&&(S="N",I[p]=g[p].DBF.dec,O=g[p].DBF.len),P[p]=S=="C"||W=="N"?O:s[S]||0,F+=P[p],C[p]=S}var V=f.next(32);for(V.write_shift(4,318902576),V.write_shift(4,d.length),V.write_shift(2,296+32*y),V.write_shift(2,F),p=0;p<4;++p)V.write_shift(4,0);for(V.write_shift(4,0|(+t[e0]||3)<<8),p=0,x=0;p<h.length;++p)if(h[p]!=null){var L=f.next(32),Y=(h[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);L.write_shift(1,Y,"sbcs"),L.write_shift(1,C[p]=="?"?"C":C[p],"sbcs"),L.write_shift(4,x),L.write_shift(1,P[p]||s[C[p]]||0),L.write_shift(1,I[p]||0),L.write_shift(1,2),L.write_shift(4,0),L.write_shift(1,0),L.write_shift(4,0),L.write_shift(4,0),x+=P[p]||s[C[p]]||0}var ce=f.next(264);for(ce.write_shift(4,13),p=0;p<65;++p)ce.write_shift(4,0);for(p=0;p<d.length;++p){var re=f.next(F);for(re.write_shift(1,0),x=0;x<h.length;++x)if(h[x]!=null)switch(C[x]){case"L":re.write_shift(1,d[p][x]==null?63:d[p][x]?84:70);break;case"B":re.write_shift(8,d[p][x]||0,"f");break;case"N":var oe="0";for(typeof d[p][x]=="number"&&(oe=d[p][x].toFixed(I[x]||0)),y=0;y<P[x]-oe.length;++y)re.write_shift(1,32);re.write_shift(1,oe,"sbcs");break;case"D":d[p][x]?(re.write_shift(4,("0000"+d[p][x].getFullYear()).slice(-4),"sbcs"),re.write_shift(2,("00"+(d[p][x].getMonth()+1)).slice(-2),"sbcs"),re.write_shift(2,("00"+d[p][x].getDate()).slice(-2),"sbcs")):re.write_shift(8,"00000000","sbcs");break;case"C":var ie=String(d[p][x]!=null?d[p][x]:"").slice(0,P[x]);for(re.write_shift(1,ie,"sbcs"),y=0;y<P[x]-ie.length;++y)re.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:n,to_sheet:a,from_sheet:i}}(),Ag=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+rt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,d){var g=e[d];return typeof g=="number"?io(g):g},a=function(h,d,g){var p=d.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return p==59?h:io(p)};e["|"]=254;function n(h,d){switch(d.type){case"base64":return s(Or(h),d);case"binary":return s(h,d);case"buffer":return s(_e&&Buffer.isBuffer(h)?h.toString("binary"):Yt(h),d);case"array":return s(Ht(h),d)}throw new Error("Unrecognized type "+d.type)}function s(h,d){var g=h.split(/[\n\r]+/),p=-1,x=-1,y=0,F=0,v=[],C=[],P=null,I={},S=[],W=[],O=[],z=0,V;for(+d.codepage>=0&&qr(+d.codepage);y!==g.length;++y){z=0;var L=g[y].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(t,r),Y=L.replace(/;;/g,"\0").split(";").map(function(D){return D.replace(/\u0000/g,";")}),ce=Y[0],re;if(L.length>0)switch(ce){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Y[1].charAt(0)=="P"&&C.push(L.slice(3).replace(/;;/g,";"));break;case"C":var oe=!1,ie=!1,Ie=!1,H=!1,ue=-1,he=-1;for(F=1;F<Y.length;++F)switch(Y[F].charAt(0)){case"A":break;case"X":x=parseInt(Y[F].slice(1))-1,ie=!0;break;case"Y":for(p=parseInt(Y[F].slice(1))-1,ie||(x=0),V=v.length;V<=p;++V)v[V]=[];break;case"K":re=Y[F].slice(1),re.charAt(0)==='"'?re=re.slice(1,re.length-1):re==="TRUE"?re=!0:re==="FALSE"?re=!1:isNaN(Kr(re))?isNaN(ga(re).getDate())||(re=Qe(re)):(re=Kr(re),P!==null&&_a(P)&&(re=Qn(re))),oe=!0;break;case"E":H=!0;var A=ua(Y[F].slice(1),{r:p,c:x});v[p][x]=[v[p][x],A];break;case"S":Ie=!0,v[p][x]=[v[p][x],"S5S"];break;case"G":break;case"R":ue=parseInt(Y[F].slice(1))-1;break;case"C":he=parseInt(Y[F].slice(1))-1;break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+L)}if(oe&&(v[p][x]&&v[p][x].length==2?v[p][x][0]=re:v[p][x]=re,P=null),Ie){if(H)throw new Error("SYLK shared formula cannot have own formula");var U=ue>-1&&v[ue][he];if(!U||!U[1])throw new Error("SYLK shared formula cannot find base");v[p][x][1]=ul(U[1],{r:p-ue,c:x-he})}break;case"F":var R=0;for(F=1;F<Y.length;++F)switch(Y[F].charAt(0)){case"X":x=parseInt(Y[F].slice(1))-1,++R;break;case"Y":for(p=parseInt(Y[F].slice(1))-1,V=v.length;V<=p;++V)v[V]=[];break;case"M":z=parseInt(Y[F].slice(1))/20;break;case"F":break;case"G":break;case"P":P=C[parseInt(Y[F].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(O=Y[F].slice(1).split(" "),V=parseInt(O[0],10);V<=parseInt(O[1],10);++V)z=parseInt(O[2],10),W[V-1]=z===0?{hidden:!0}:{wch:z},xa(W[V-1]);break;case"C":x=parseInt(Y[F].slice(1))-1,W[x]||(W[x]={});break;case"R":p=parseInt(Y[F].slice(1))-1,S[p]||(S[p]={}),z>0?(S[p].hpt=z,S[p].hpx=an(z)):z===0&&(S[p].hidden=!0);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+L)}R<1&&(P=null);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+L)}}return S.length>0&&(I["!rows"]=S),W.length>0&&(I["!cols"]=W),d&&d.sheetRows&&(v=v.slice(0,d.sheetRows)),[v,I]}function i(h,d){var g=n(h,d),p=g[0],x=g[1],y=Ea(p,d);return rt(x).forEach(function(F){y[F]=x[F]}),y}function o(h,d){return Dt(i(h,d),d)}function c(h,d,g,p){var x="C;Y"+(g+1)+";X"+(p+1)+";K";switch(h.t){case"n":x+=h.v||0,h.f&&!h.F&&(x+=";E"+hm(h.f,{r:g,c:p}));break;case"b":x+=h.v?"TRUE":"FALSE";break;case"e":x+=h.w||h.v;break;case"d":x+='"'+(h.w||h.v)+'"';break;case"s":x+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return x}function l(h,d){d.forEach(function(g,p){var x="F;W"+(p+1)+" "+(p+1)+" ";g.hidden?x+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=Hn(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=Vn(g.wpx)),typeof g.wch=="number"&&(x+=Math.round(g.wch))),x.charAt(x.length-1)!=" "&&h.push(x)})}function f(h,d){d.forEach(function(g,p){var x="F;";g.hidden?x+="M0;":g.hpt?x+="M"+20*g.hpt+";":g.hpx&&(x+="M"+20*cl(g.hpx)+";"),x.length>2&&h.push(x+"R"+(p+1))})}function u(h,d){var g=["ID;PWXL;N;E"],p=[],x=Ne(h["!ref"]),y,F=Array.isArray(h),v=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),h["!cols"]&&l(g,h["!cols"]),h["!rows"]&&f(g,h["!rows"]),g.push("B;Y"+(x.e.r-x.s.r+1)+";X"+(x.e.c-x.s.c+1)+";D"+[x.s.c,x.s.r,x.e.c,x.e.r].join(" "));for(var C=x.s.r;C<=x.e.r;++C)for(var P=x.s.c;P<=x.e.c;++P){var I=de({r:C,c:P});y=F?(h[C]||[])[P]:h[I],!(!y||y.v==null&&(!y.f||y.F))&&p.push(c(y,h,C,P))}return g.join(v)+v+p.join(v)+v+"E"+v}return{to_workbook:o,to_sheet:i,from_sheet:u}}(),bg=function(){function e(s,i){switch(i.type){case"base64":return t(Or(s),i);case"binary":return t(s,i);case"buffer":return t(_e&&Buffer.isBuffer(s)?s.toString("binary"):Yt(s),i);case"array":return t(Ht(s),i)}throw new Error("Unrecognized type "+i.type)}function t(s,i){for(var o=s.split(`
`),c=-1,l=-1,f=0,u=[];f!==o.length;++f){if(o[f].trim()==="BOT"){u[++c]=[],l=0;continue}if(!(c<0)){var h=o[f].trim().split(","),d=h[0],g=h[1];++f;for(var p=o[f]||"";(p.match(/["]/g)||[]).length&1&&f<o.length-1;)p+=`
`+o[++f];switch(p=p.trim(),+d){case-1:if(p==="BOT"){u[++c]=[],l=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?u[c][l]=!0:p==="FALSE"?u[c][l]=!1:isNaN(Kr(g))?isNaN(ga(g).getDate())?u[c][l]=g:u[c][l]=Qe(g):u[c][l]=Kr(g),++l;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),u[c][l++]=p!==""?p:null;break}if(p==="EOD")break}}return i&&i.sheetRows&&(u=u.slice(0,i.sheetRows)),u}function r(s,i){return Ea(e(s,i),i)}function a(s,i){return Dt(r(s,i),i)}var n=function(){var s=function(c,l,f,u,h){c.push(l),c.push(f+","+u),c.push('"'+h.replace(/"/g,'""')+'"')},i=function(c,l,f,u){c.push(l+","+f),c.push(l==1?'"'+u.replace(/"/g,'""')+'"':u)};return function(c){var l=[],f=Ne(c["!ref"]),u,h=Array.isArray(c);s(l,"TABLE",0,1,"sheetjs"),s(l,"VECTORS",0,f.e.r-f.s.r+1,""),s(l,"TUPLES",0,f.e.c-f.s.c+1,""),s(l,"DATA",0,0,"");for(var d=f.s.r;d<=f.e.r;++d){i(l,-1,0,"BOT");for(var g=f.s.c;g<=f.e.c;++g){var p=de({r:d,c:g});if(u=h?(c[d]||[])[g]:c[p],!u){i(l,1,0,"");continue}switch(u.t){case"n":var x=u.w;!x&&u.v!=null&&(x=u.v),x==null?u.f&&!u.F?i(l,1,0,"="+u.f):i(l,1,0,""):i(l,0,x,"V");break;case"b":i(l,0,u.v?1:0,u.v?"TRUE":"FALSE");break;case"s":i(l,1,0,isNaN(u.v)?u.v:'="'+u.v+'"');break;case"d":u.w||(u.w=Mr(u.z||xe[14],wr(Qe(u.v)))),i(l,0,u.w,"V");break;default:i(l,1,0,"")}}}i(l,-1,0,"EOD");var y=`\r
`,F=l.join(y);return F}}();return{to_workbook:a,to_sheet:r,from_sheet:n}}(),Fg=function(){function e(u){return u.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(u){return u.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(u,h){for(var d=u.split(`
`),g=-1,p=-1,x=0,y=[];x!==d.length;++x){var F=d[x].trim().split(":");if(F[0]==="cell"){var v=mr(F[1]);if(y.length<=v.r)for(g=y.length;g<=v.r;++g)y[g]||(y[g]=[]);switch(g=v.r,p=v.c,F[2]){case"t":y[g][p]=e(F[3]);break;case"v":y[g][p]=+F[3];break;case"vtf":var C=F[F.length-1];case"vtc":switch(F[3]){case"nl":y[g][p]=!!+F[4];break;default:y[g][p]=+F[4];break}F[2]=="vtf"&&(y[g][p]=[y[g][p],C])}}}return h&&h.sheetRows&&(y=y.slice(0,h.sheetRows)),y}function a(u,h){return Ea(r(u,h),h)}function n(u,h){return Dt(a(u,h),h)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function l(u){if(!u||!u["!ref"])return"";for(var h=[],d=[],g,p="",x=ya(u["!ref"]),y=Array.isArray(u),F=x.s.r;F<=x.e.r;++F)for(var v=x.s.c;v<=x.e.c;++v)if(p=de({r:F,c:v}),g=y?(u[F]||[])[v]:u[p],!(!g||g.v==null||g.t==="z")){switch(d=["cell",p,"t"],g.t){case"s":case"str":d.push(t(g.v));break;case"n":g.f?(d[2]="vtf",d[3]="n",d[4]=g.v,d[5]=t(g.f)):(d[2]="v",d[3]=g.v);break;case"b":d[2]="vt"+(g.f?"f":"c"),d[3]="nl",d[4]=g.v?"1":"0",d[5]=t(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var C=wr(Qe(g.v));d[2]="vtc",d[3]="nd",d[4]=""+C,d[5]=g.w||Mr(g.z||xe[14],C);break;case"e":continue}h.push(d.join(":"))}return h.push("sheet:c:"+(x.e.c-x.s.c+1)+":r:"+(x.e.r-x.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function f(u){return[s,i,o,i,l(u),c].join(`
`)}return{to_workbook:n,to_sheet:a,from_sheet:f}}(),rn=function(){function e(f,u,h,d,g){g.raw?u[h][d]=f:f===""||(f==="TRUE"?u[h][d]=!0:f==="FALSE"?u[h][d]=!1:isNaN(Kr(f))?isNaN(ga(f).getDate())?u[h][d]=f:u[h][d]=Qe(f):u[h][d]=Kr(f))}function t(f,u){var h=u||{},d=[];if(!f||f.length===0)return d;for(var g=f.split(/[\r\n]/),p=g.length-1;p>=0&&g[p].length===0;)--p;for(var x=10,y=0,F=0;F<=p;++F)y=g[F].indexOf(" "),y==-1?y=g[F].length:y++,x=Math.max(x,y);for(F=0;F<=p;++F){d[F]=[];var v=0;for(e(g[F].slice(0,x).trim(),d,F,v,h),v=1;v<=(g[F].length-x)/10+1;++v)e(g[F].slice(x+(v-1)*10,x+v*10).trim(),d,F,v,h)}return h.sheetRows&&(d=d.slice(0,h.sheetRows)),d}var r={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function n(f){for(var u={},h=!1,d=0,g=0;d<f.length;++d)(g=f.charCodeAt(d))==34?h=!h:!h&&g in r&&(u[g]=(u[g]||0)+1);g=[];for(d in u)Object.prototype.hasOwnProperty.call(u,d)&&g.push([u[d],d]);if(!g.length){u=a;for(d in u)Object.prototype.hasOwnProperty.call(u,d)&&g.push([u[d],d])}return g.sort(function(p,x){return p[0]-x[0]||a[p[1]]-a[x[1]]}),r[g.pop()[1]]||44}function s(f,u){var h=u||{},d="",g=h.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(d=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(d=f.charAt(4),f=f.slice(6)):d=n(f.slice(0,1024)):h&&h.FS?d=h.FS:d=n(f.slice(0,1024));var x=0,y=0,F=0,v=0,C=0,P=d.charCodeAt(0),I=!1,S=0,W=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var O=h.dateNF!=null?$d(h.dateNF):null;function z(){var V=f.slice(v,C),L={};if(V.charAt(0)=='"'&&V.charAt(V.length-1)=='"'&&(V=V.slice(1,-1).replace(/""/g,'"')),V.length===0)L.t="z";else if(h.raw)L.t="s",L.v=V;else if(V.trim().length===0)L.t="s",L.v=V;else if(V.charCodeAt(0)==61)V.charCodeAt(1)==34&&V.charCodeAt(V.length-1)==34?(L.t="s",L.v=V.slice(2,-1).replace(/""/g,'"')):pm(V)?(L.t="n",L.f=V.slice(1)):(L.t="s",L.v=V);else if(V=="TRUE")L.t="b",L.v=!0;else if(V=="FALSE")L.t="b",L.v=!1;else if(!isNaN(F=Kr(V)))L.t="n",h.cellText!==!1&&(L.w=V),L.v=F;else if(!isNaN(ga(V).getDate())||O&&V.match(O)){L.z=h.dateNF||xe[14];var Y=0;O&&V.match(O)&&(V=Ud(V,h.dateNF,V.match(O)||[]),Y=1),h.cellDates?(L.t="d",L.v=Qe(V,Y)):(L.t="n",L.v=wr(Qe(V,Y))),h.cellText!==!1&&(L.w=Mr(L.z,L.v instanceof Date?wr(L.v):L.v)),h.cellNF||delete L.z}else L.t="s",L.v=V;if(L.t=="z"||(h.dense?(g[x]||(g[x]=[]),g[x][y]=L):g[de({c:y,r:x})]=L),v=C+1,W=f.charCodeAt(v),p.e.c<y&&(p.e.c=y),p.e.r<x&&(p.e.r=x),S==P)++y;else if(y=0,++x,h.sheetRows&&h.sheetRows<=x)return!0}e:for(;C<f.length;++C)switch(S=f.charCodeAt(C)){case 34:W===34&&(I=!I);break;case P:case 10:case 13:if(!I&&z())break e;break}return C-v>0&&z(),g["!ref"]=Ee(p),g}function i(f,u){return!(u&&u.PRN)||u.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?s(f,u):Ea(t(f,u),u)}function o(f,u){var h="",d=u.type=="string"?[0,0,0,0]:Di(f,u);switch(u.type){case"base64":h=Or(f);break;case"binary":h=f;break;case"buffer":u.codepage==65001?h=f.toString("utf8"):u.codepage&&typeof Ja<"u"||(h=_e&&Buffer.isBuffer(f)?f.toString("binary"):Yt(f));break;case"array":h=Ht(f);break;case"string":h=f;break;default:throw new Error("Unrecognized type "+u.type)}return d[0]==239&&d[1]==187&&d[2]==191?h=Ce(h.slice(3)):u.type!="string"&&u.type!="buffer"&&u.codepage==65001?h=Ce(h):u.type=="binary"&&typeof Ja<"u",h.slice(0,19)=="socialcalc:version:"?Fg.to_sheet(u.type=="string"?h:Ce(h),u):i(h,u)}function c(f,u){return Dt(o(f,u),u)}function l(f){for(var u=[],h=Ne(f["!ref"]),d,g=Array.isArray(f),p=h.s.r;p<=h.e.r;++p){for(var x=[],y=h.s.c;y<=h.e.c;++y){var F=de({r:p,c:y});if(d=g?(f[p]||[])[y]:f[F],!d||d.v==null){x.push("          ");continue}for(var v=(d.w||(pt(d),d.w)||"").slice(0,10);v.length<10;)v+=" ";x.push(v+(y===0?" ":""))}u.push(x.join(""))}return u.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:l}}();function Cg(e,t){var r=t||{},a=!!r.WTF;r.WTF=!0;try{var n=Ag.to_workbook(e,r);return r.WTF=a,n}catch(s){if(r.WTF=a,!s.message.match(/SYLK bad record ID/)&&a)throw s;return rn.to_workbook(e,t)}}var Va=function(){function e(A,U,R){if(A){er(A,A.l||0);for(var D=R.Enum||ue;A.l<A.length;){var q=A.read_shift(2),ee=D[q]||D[65535],ne=A.read_shift(2),Z=A.l+ne,K=ee.f&&ee.f(A,ne,R);if(A.l=Z,U(K,ee,q))return}}}function t(A,U){switch(U.type){case"base64":return r(Gr(Or(A)),U);case"binary":return r(Gr(A),U);case"buffer":case"array":return r(A,U)}throw"Unsupported type "+U.type}function r(A,U){if(!A)return A;var R=U||{},D=R.dense?[]:{},q="Sheet1",ee="",ne=0,Z={},K=[],ke=[],b={s:{r:0,c:0},e:{r:0,c:0}},Be=R.sheetRows||0;if(A[2]==0&&(A[3]==8||A[3]==9)&&A.length>=16&&A[14]==5&&A[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(A[2]==2)R.Enum=ue,e(A,function(te,Me,Dr){switch(Dr){case 0:R.vers=te,te>=4096&&(R.qpro=!0);break;case 6:b=te;break;case 204:te&&(ee=te);break;case 222:ee=te;break;case 15:case 51:R.qpro||(te[1].v=te[1].v.slice(1));case 13:case 14:case 16:Dr==14&&(te[2]&112)==112&&(te[2]&15)>1&&(te[2]&15)<15&&(te[1].z=R.dateNF||xe[14],R.cellDates&&(te[1].t="d",te[1].v=Qn(te[1].v))),R.qpro&&te[3]>ne&&(D["!ref"]=Ee(b),Z[q]=D,K.push(q),D=R.dense?[]:{},b={s:{r:0,c:0},e:{r:0,c:0}},ne=te[3],q=ee||"Sheet"+(ne+1),ee="");var Yr=R.dense?(D[te[0].r]||[])[te[0].c]:D[de(te[0])];if(Yr){Yr.t=te[1].t,Yr.v=te[1].v,te[1].z!=null&&(Yr.z=te[1].z),te[1].f!=null&&(Yr.f=te[1].f);break}R.dense?(D[te[0].r]||(D[te[0].r]=[]),D[te[0].r][te[0].c]=te[1]):D[de(te[0])]=te[1];break}},R);else if(A[2]==26||A[2]==14)R.Enum=he,A[2]==14&&(R.qpro=!0,A.l=0),e(A,function(te,Me,Dr){switch(Dr){case 204:q=te;break;case 22:te[1].v=te[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(te[3]>ne&&(D["!ref"]=Ee(b),Z[q]=D,K.push(q),D=R.dense?[]:{},b={s:{r:0,c:0},e:{r:0,c:0}},ne=te[3],q="Sheet"+(ne+1)),Be>0&&te[0].r>=Be)break;R.dense?(D[te[0].r]||(D[te[0].r]=[]),D[te[0].r][te[0].c]=te[1]):D[de(te[0])]=te[1],b.e.c<te[0].c&&(b.e.c=te[0].c),b.e.r<te[0].r&&(b.e.r=te[0].r);break;case 27:te[14e3]&&(ke[te[14e3][0]]=te[14e3][1]);break;case 1537:ke[te[0]]=te[1],te[0]==ne&&(q=te[1]);break}},R);else throw new Error("Unrecognized LOTUS BOF "+A[2]);if(D["!ref"]=Ee(b),Z[ee||q]=D,K.push(ee||q),!ke.length)return{SheetNames:K,Sheets:Z};for(var Se={},be=[],ve=0;ve<ke.length;++ve)Z[K[ve]]?(be.push(ke[ve]||K[ve]),Se[ke[ve]]=Z[ke[ve]]||Z[K[ve]]):(be.push(ke[ve]),Se[ke[ve]]={"!ref":"A1"});return{SheetNames:be,Sheets:Se}}function a(A,U){var R=U||{};if(+R.codepage>=0&&qr(+R.codepage),R.type=="string")throw new Error("Cannot write WK1 to JS string");var D=Os(),q=Ne(A["!ref"]),ee=Array.isArray(A),ne=[];Wr(D,0,s(1030)),Wr(D,6,c(q));for(var Z=Math.min(q.e.r,8191),K=q.s.r;K<=Z;++K)for(var ke=ar(K),b=q.s.c;b<=q.e.c;++b){K===q.s.r&&(ne[b]=qe(b));var Be=ne[b]+ke,Se=ee?(A[K]||[])[b]:A[Be];if(!(!Se||Se.t=="z"))if(Se.t=="n")(Se.v|0)==Se.v&&Se.v>=-32768&&Se.v<=32767?Wr(D,13,d(K,b,Se.v)):Wr(D,14,p(K,b,Se.v));else{var be=pt(Se);Wr(D,15,u(K,b,be.slice(0,239)))}}return Wr(D,1),D.end()}function n(A,U){var R=U||{};if(+R.codepage>=0&&qr(+R.codepage),R.type=="string")throw new Error("Cannot write WK3 to JS string");var D=Os();Wr(D,0,i(A));for(var q=0,ee=0;q<A.SheetNames.length;++q)(A.Sheets[A.SheetNames[q]]||{})["!ref"]&&Wr(D,27,H(A.SheetNames[q],ee++));var ne=0;for(q=0;q<A.SheetNames.length;++q){var Z=A.Sheets[A.SheetNames[q]];if(!(!Z||!Z["!ref"])){for(var K=Ne(Z["!ref"]),ke=Array.isArray(Z),b=[],Be=Math.min(K.e.r,8191),Se=K.s.r;Se<=Be;++Se)for(var be=ar(Se),ve=K.s.c;ve<=K.e.c;++ve){Se===K.s.r&&(b[ve]=qe(ve));var te=b[ve]+be,Me=ke?(Z[Se]||[])[ve]:Z[te];if(!(!Me||Me.t=="z"))if(Me.t=="n")Wr(D,23,z(Se,ve,ne,Me.v));else{var Dr=pt(Me);Wr(D,22,S(Se,ve,ne,Dr.slice(0,239)))}}++ne}}return Wr(D,1),D.end()}function s(A){var U=ze(2);return U.write_shift(2,A),U}function i(A){var U=ze(26);U.write_shift(2,4096),U.write_shift(2,4),U.write_shift(4,0);for(var R=0,D=0,q=0,ee=0;ee<A.SheetNames.length;++ee){var ne=A.SheetNames[ee],Z=A.Sheets[ne];if(!(!Z||!Z["!ref"])){++q;var K=ya(Z["!ref"]);R<K.e.r&&(R=K.e.r),D<K.e.c&&(D=K.e.c)}}return R>8191&&(R=8191),U.write_shift(2,R),U.write_shift(1,q),U.write_shift(1,D),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(1,1),U.write_shift(1,2),U.write_shift(4,0),U.write_shift(4,0),U}function o(A,U,R){var D={s:{c:0,r:0},e:{c:0,r:0}};return U==8&&R.qpro?(D.s.c=A.read_shift(1),A.l++,D.s.r=A.read_shift(2),D.e.c=A.read_shift(1),A.l++,D.e.r=A.read_shift(2),D):(D.s.c=A.read_shift(2),D.s.r=A.read_shift(2),U==12&&R.qpro&&(A.l+=2),D.e.c=A.read_shift(2),D.e.r=A.read_shift(2),U==12&&R.qpro&&(A.l+=2),D.s.c==65535&&(D.s.c=D.e.c=D.s.r=D.e.r=0),D)}function c(A){var U=ze(8);return U.write_shift(2,A.s.c),U.write_shift(2,A.s.r),U.write_shift(2,A.e.c),U.write_shift(2,A.e.r),U}function l(A,U,R){var D=[{c:0,r:0},{t:"n",v:0},0,0];return R.qpro&&R.vers!=20768?(D[0].c=A.read_shift(1),D[3]=A.read_shift(1),D[0].r=A.read_shift(2),A.l+=2):(D[2]=A.read_shift(1),D[0].c=A.read_shift(2),D[0].r=A.read_shift(2)),D}function f(A,U,R){var D=A.l+U,q=l(A,U,R);if(q[1].t="s",R.vers==20768){A.l++;var ee=A.read_shift(1);return q[1].v=A.read_shift(ee,"utf8"),q}return R.qpro&&A.l++,q[1].v=A.read_shift(D-A.l,"cstr"),q}function u(A,U,R){var D=ze(7+R.length);D.write_shift(1,255),D.write_shift(2,U),D.write_shift(2,A),D.write_shift(1,39);for(var q=0;q<D.length;++q){var ee=R.charCodeAt(q);D.write_shift(1,ee>=128?95:ee)}return D.write_shift(1,0),D}function h(A,U,R){var D=l(A,U,R);return D[1].v=A.read_shift(2,"i"),D}function d(A,U,R){var D=ze(7);return D.write_shift(1,255),D.write_shift(2,U),D.write_shift(2,A),D.write_shift(2,R,"i"),D}function g(A,U,R){var D=l(A,U,R);return D[1].v=A.read_shift(8,"f"),D}function p(A,U,R){var D=ze(13);return D.write_shift(1,255),D.write_shift(2,U),D.write_shift(2,A),D.write_shift(8,R,"f"),D}function x(A,U,R){var D=A.l+U,q=l(A,U,R);if(q[1].v=A.read_shift(8,"f"),R.qpro)A.l=D;else{var ee=A.read_shift(2);C(A.slice(A.l,A.l+ee),q),A.l+=ee}return q}function y(A,U,R){var D=U&32768;return U&=-32769,U=(D?A:0)+(U>=8192?U-16384:U),(D?"":"$")+(R?qe(U):ar(U))}var F={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},v=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function C(A,U){er(A,0);for(var R=[],D=0,q="",ee="",ne="",Z="";A.l<A.length;){var K=A[A.l++];switch(K){case 0:R.push(A.read_shift(8,"f"));break;case 1:ee=y(U[0].c,A.read_shift(2),!0),q=y(U[0].r,A.read_shift(2),!1),R.push(ee+q);break;case 2:{var ke=y(U[0].c,A.read_shift(2),!0),b=y(U[0].r,A.read_shift(2),!1);ee=y(U[0].c,A.read_shift(2),!0),q=y(U[0].r,A.read_shift(2),!1),R.push(ke+b+":"+ee+q)}break;case 3:if(A.l<A.length){console.error("WK1 premature formula end");return}break;case 4:R.push("("+R.pop()+")");break;case 5:R.push(A.read_shift(2));break;case 6:{for(var Be="";K=A[A.l++];)Be+=String.fromCharCode(K);R.push('"'+Be.replace(/"/g,'""')+'"')}break;case 8:R.push("-"+R.pop());break;case 23:R.push("+"+R.pop());break;case 22:R.push("NOT("+R.pop()+")");break;case 20:case 21:Z=R.pop(),ne=R.pop(),R.push(["AND","OR"][K-20]+"("+ne+","+Z+")");break;default:if(K<32&&v[K])Z=R.pop(),ne=R.pop(),R.push(ne+v[K]+Z);else if(F[K]){if(D=F[K][1],D==69&&(D=A[A.l++]),D>R.length){console.error("WK1 bad formula parse 0x"+K.toString(16)+":|"+R.join("|")+"|");return}var Se=R.slice(-D);R.length-=D,R.push(F[K][0]+"("+Se.join(",")+")")}else return K<=7?console.error("WK1 invalid opcode "+K.toString(16)):K<=24?console.error("WK1 unsupported op "+K.toString(16)):K<=30?console.error("WK1 invalid opcode "+K.toString(16)):K<=115?console.error("WK1 unsupported function opcode "+K.toString(16)):console.error("WK1 unrecognized opcode "+K.toString(16))}}R.length==1?U[1].f=""+R[0]:console.error("WK1 bad formula parse |"+R.join("|")+"|")}function P(A){var U=[{c:0,r:0},{t:"n",v:0},0];return U[0].r=A.read_shift(2),U[3]=A[A.l++],U[0].c=A[A.l++],U}function I(A,U){var R=P(A);return R[1].t="s",R[1].v=A.read_shift(U-4,"cstr"),R}function S(A,U,R,D){var q=ze(6+D.length);q.write_shift(2,A),q.write_shift(1,R),q.write_shift(1,U),q.write_shift(1,39);for(var ee=0;ee<D.length;++ee){var ne=D.charCodeAt(ee);q.write_shift(1,ne>=128?95:ne)}return q.write_shift(1,0),q}function W(A,U){var R=P(A);R[1].v=A.read_shift(2);var D=R[1].v>>1;if(R[1].v&1)switch(D&7){case 0:D=(D>>3)*5e3;break;case 1:D=(D>>3)*500;break;case 2:D=(D>>3)/20;break;case 3:D=(D>>3)/200;break;case 4:D=(D>>3)/2e3;break;case 5:D=(D>>3)/2e4;break;case 6:D=(D>>3)/16;break;case 7:D=(D>>3)/64;break}return R[1].v=D,R}function O(A,U){var R=P(A),D=A.read_shift(4),q=A.read_shift(4),ee=A.read_shift(2);if(ee==65535)return D===0&&q===3221225472?(R[1].t="e",R[1].v=15):D===0&&q===3489660928?(R[1].t="e",R[1].v=42):R[1].v=0,R;var ne=ee&32768;return ee=(ee&32767)-16446,R[1].v=(1-ne*2)*(q*Math.pow(2,ee+32)+D*Math.pow(2,ee)),R}function z(A,U,R,D){var q=ze(14);if(q.write_shift(2,A),q.write_shift(1,R),q.write_shift(1,U),D==0)return q.write_shift(4,0),q.write_shift(4,0),q.write_shift(2,65535),q;var ee=0,ne=0,Z=0,K=0;return D<0&&(ee=1,D=-D),ne=Math.log2(D)|0,D/=Math.pow(2,ne-31),K=D>>>0,K&2147483648||(D/=2,++ne,K=D>>>0),D-=K,K|=2147483648,K>>>=0,D*=Math.pow(2,32),Z=D>>>0,q.write_shift(4,Z),q.write_shift(4,K),ne+=16383+(ee?32768:0),q.write_shift(2,ne),q}function V(A,U){var R=O(A);return A.l+=U-14,R}function L(A,U){var R=P(A),D=A.read_shift(4);return R[1].v=D>>6,R}function Y(A,U){var R=P(A),D=A.read_shift(8,"f");return R[1].v=D,R}function ce(A,U){var R=Y(A);return A.l+=U-10,R}function re(A,U){return A[A.l+U-1]==0?A.read_shift(U,"cstr"):""}function oe(A,U){var R=A[A.l++];R>U-1&&(R=U-1);for(var D="";D.length<R;)D+=String.fromCharCode(A[A.l++]);return D}function ie(A,U,R){if(!(!R.qpro||U<21)){var D=A.read_shift(1);A.l+=17,A.l+=1,A.l+=2;var q=A.read_shift(U-21,"cstr");return[D,q]}}function Ie(A,U){for(var R={},D=A.l+U;A.l<D;){var q=A.read_shift(2);if(q==14e3){for(R[q]=[0,""],R[q][0]=A.read_shift(2);A[A.l];)R[q][1]+=String.fromCharCode(A[A.l]),A.l++;A.l++}}return R}function H(A,U){var R=ze(5+A.length);R.write_shift(2,14e3),R.write_shift(2,U);for(var D=0;D<A.length;++D){var q=A.charCodeAt(D);R[R.l++]=q>127?95:q}return R[R.l++]=0,R}var ue={0:{n:"BOF",f:Ve},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:g},15:{n:"LABEL",f},16:{n:"FORMULA",f:x},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:re},222:{n:"SHEETNAMELP",f:oe},65535:{n:""}},he={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:I},23:{n:"NUMBER17",f:O},24:{n:"NUMBER18",f:W},25:{n:"FORMULA19",f:V},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Ie},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:L},38:{n:"??"},39:{n:"NUMBER27",f:Y},40:{n:"FORMULA28",f:ce},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:re},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ie},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:n,to_workbook:t}}();function Ig(e){var t={},r=e.match(hr),a=0,n=!1;if(r)for(;a!=r.length;++a){var s=fe(r[a]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=ci[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(s[0].charCodeAt(1)!==47&&!n)throw new Error("Unrecognized rich format "+s[0])}}return t}var Og=function(){var e=Qa("t"),t=Qa("rPr");function r(s){var i=s.match(e);if(!i)return{t:"s",v:""};var o={t:"s",v:Te(i[1])},c=s.match(t);return c&&(o.s=Ig(c[1])),o}var a=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(i){return i.replace(a,"").split(n).map(r).filter(function(o){return o.v})}}(),Dg=function(){var t=/(\r\n|\n)/g;function r(n,s,i){var o=[];n.u&&o.push("text-decoration: underline;"),n.uval&&o.push("text-underline-style:"+n.uval+";"),n.sz&&o.push("font-size:"+n.sz+"pt;"),n.outline&&o.push("text-effect: outline;"),n.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),n.b&&(s.push("<b>"),i.push("</b>")),n.i&&(s.push("<i>"),i.push("</i>")),n.strike&&(s.push("<s>"),i.push("</s>"));var c=n.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(s.push("<"+c+">"),i.push("</"+c+">")),i.push("</span>"),n}function a(n){var s=[[],n.v,[]];return n.v?(n.s&&r(n.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(a).join("")}}(),Rg=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Pg=/<(?:\w+:)?r>/,Lg=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Si(e,t){var r=t?t.cellHTML:!0,a={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=Te(Ce(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=Ce(e),r&&(a.h=gi(a.t))):e.match(Pg)&&(a.r=Ce(e),a.t=Te(Ce((e.replace(Lg,"").match(Rg)||[]).join("").replace(hr,""))),r&&(a.h=Dg(Og(a.r)))),a):{t:""}}var Ng=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Bg=/<(?:\w+:)?(?:si|sstItem)>/g,Mg=/<\/(?:\w+:)?(?:si|sstItem)>/;function $g(e,t){var r=[],a="";if(!e)return r;var n=e.match(Ng);if(n){a=n[2].replace(Bg,"").split(Mg);for(var s=0;s!=a.length;++s){var i=Si(a[s].trim(),t);i!=null&&(r[r.length]=i)}n=fe(n[1]),r.Count=n.count,r.Unique=n.uniqueCount}return r}function Ug(e){return[e.read_shift(4),e.read_shift(4)]}function jg(e,t){var r=[],a=!1;return gt(e,function(s,i,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(i.T,!a||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function tl(e){for(var t=[],r=e.split(""),a=0;a<r.length;++a)t[a]=r[a].charCodeAt(0);return t}function ht(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function Wg(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=ht(e,4),t.U=ht(e,4),t.W=ht(e,4),t}function Hg(e){for(var t=e.read_shift(4),r=e.l+t-4,a={},n=e.read_shift(4),s=[];n-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(a.name=e.read_shift(0,"lpp4"),a.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return a}function Vg(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(Hg(e));return t}function Gg(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function zg(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=ht(e,4),t.U=ht(e,4),t.W=ht(e,4),t}function qg(e){var t=zg(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function al(e,t){var r=e.l+t,a={};a.Flags=e.read_shift(4)&63,e.l+=4,a.AlgID=e.read_shift(4);var n=!1;switch(a.AlgID){case 26126:case 26127:case 26128:n=a.Flags==36;break;case 26625:n=a.Flags==4;break;case 0:n=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=e.read_shift(4),a.KeySize=e.read_shift(4),a.ProviderType=e.read_shift(4),e.l+=8,a.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,a}function nl(e,t){var r={},a=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,a),e.l=a,r}function Xg(e){var t=ht(e);switch(t.Minor){case 2:return[t.Minor,Kg(e)];case 3:return[t.Minor,Yg()];case 4:return[t.Minor,Jg(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function Kg(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),a=al(e,r),n=nl(e,e.length-e.l);return{t:"Std",h:a,v:n}}function Yg(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Jg(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),a={};return r.replace(hr,function(s){var i=fe(s);switch(tt(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){a[o]=i[o]});break;case"<dataIntegrity":a.encryptedHmacKey=i.encryptedHmacKey,a.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(i);break;default:throw i[0]}}),a}function Zg(e,t){var r={},a=r.EncryptionVersionInfo=ht(e,4);if(t-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);r.Flags=e.read_shift(4),t-=4;var n=e.read_shift(4);return t-=4,r.EncryptionHeader=al(e,n),t-=n,r.EncryptionVerifier=nl(e,t),r}function Qg(e){var t={},r=t.EncryptionVersionInfo=ht(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function ex(e){var t=0,r,a=tl(e),n=a.length+1,s,i,o,c,l;for(r=Ct(n),r[0]=a.length,s=1;s!=n;++s)r[s]=a[s-1];for(s=n-1;s>=0;--s)i=r[s],o=t&16384?1:0,c=t<<1&32767,l=o|c,t=l^i;return t^52811}var sl=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(i){return(i/2|i*128)&255},n=function(i,o){return a(i^o)},s=function(i){for(var o=t[i.length-1],c=104,l=i.length-1;l>=0;--l)for(var f=i[l],u=0;u!=7;++u)f&64&&(o^=r[c]),f*=2,--c;return o};return function(i){for(var o=tl(i),c=s(o),l=o.length,f=Ct(16),u=0;u!=16;++u)f[u]=0;var h,d,g;for((l&1)===1&&(h=c>>8,f[l]=n(e[0],h),--l,h=c&255,d=o[o.length-1],f[l]=n(d,h));l>0;)--l,h=c>>8,f[l]=n(o[l],h),--l,h=c&255,f[l]=n(o[l],h);for(l=15,g=15-o.length;g>0;)h=c>>8,f[l]=n(e[g],h),--l,--g,h=c&255,f[l]=n(o[l],h),--l,--g;return f}}(),rx=function(e,t,r,a,n){n||(n=t),a||(a=sl(e));var s,i;for(s=0;s!=t.length;++s)i=t[s],i^=a[r],i=(i>>5|i<<3)&255,n[s]=i,++r;return[n,r,a]},tx=function(e){var t=0,r=sl(e);return function(a){var n=rx("",a,t,r);return t=n[1],n[0]}};function ax(e,t,r,a){var n={key:Ve(e),verificationBytes:Ve(e)};return r.password&&(n.verifier=ex(r.password)),a.valid=n.verificationBytes===n.verifier,a.valid&&(a.insitu=tx(r.password)),n}function nx(e,t,r){var a=r||{};return a.Info=e.read_shift(2),e.l-=2,a.Info===1?a.Data=Qg(e):a.Data=Zg(e,t),a}function sx(e,t,r){var a={Type:r.biff>=8?e.read_shift(2):0};return a.Type?nx(e,t-2,a):ax(e,r.biff>=8?t:t-2,r,a),a}var ix=function(){function e(n,s){switch(s.type){case"base64":return t(Or(n),s);case"binary":return t(n,s);case"buffer":return t(_e&&Buffer.isBuffer(n)?n.toString("binary"):Yt(n),s);case"array":return t(Ht(n),s)}throw new Error("Unrecognized type "+s.type)}function t(n,s){var i=s||{},o=i.dense?[]:{},c=n.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var l={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(f,u){Array.isArray(o)&&(o[u]=[]);for(var h=/\\\w+\b/g,d=0,g,p=-1;g=h.exec(f);){switch(g[0]){case"\\cell":var x=f.slice(d,h.lastIndex-g[0].length);if(x[0]==" "&&(x=x.slice(1)),++p,x.length){var y={v:x,t:"s"};Array.isArray(o)?o[u][p]=y:o[de({r:u,c:p})]=y}break}d=h.lastIndex}p>l.e.c&&(l.e.c=p)}),o["!ref"]=Ee(l),o}function r(n,s){return Dt(e(n,s),s)}function a(n){for(var s=["{\\rtf1\\ansi"],i=Ne(n["!ref"]),o,c=Array.isArray(n),l=i.s.r;l<=i.e.r;++l){s.push("\\trowd\\trautofit1");for(var f=i.s.c;f<=i.e.c;++f)s.push("\\cellx"+(f+1));for(s.push("\\pard\\intbl"),f=i.s.c;f<=i.e.c;++f){var u=de({r:l,c:f});o=c?(n[l]||[])[f]:n[u],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(pt(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:a}}();function ox(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function tn(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function cx(e){var t=e[0]/255,r=e[1]/255,a=e[2]/255,n=Math.max(t,r,a),s=Math.min(t,r,a),i=n-s;if(i===0)return[0,0,t];var o=0,c=0,l=n+s;switch(c=i/(l>1?2-l:l),n){case t:o=((r-a)/i+6)%6;break;case r:o=(a-t)/i+2;break;case a:o=(t-r)/i+4;break}return[o/6,c,l/2]}function lx(e){var t=e[0],r=e[1],a=e[2],n=r*2*(a<.5?a:1-a),s=a-n/2,i=[s,s,s],o=6*t,c;if(r!==0)switch(o|0){case 0:case 6:c=n*o,i[0]+=n,i[1]+=c;break;case 1:c=n*(2-o),i[0]+=c,i[1]+=n;break;case 2:c=n*(o-2),i[1]+=n,i[2]+=c;break;case 3:c=n*(4-o),i[1]+=c,i[2]+=n;break;case 4:c=n*(o-4),i[2]+=n,i[0]+=c;break;case 5:c=n*(6-o),i[2]+=c,i[0]+=n;break}for(var l=0;l!=3;++l)i[l]=Math.round(i[l]*255);return i}function Wn(e,t){if(t===0)return e;var r=cx(ox(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),tn(lx(r))}var il=6,fx=15,ux=1,xr=il;function Hn(e){return Math.floor((e+Math.round(128/xr)/256)*xr)}function Vn(e){return Math.floor((e-5)/xr*100+.5)/100}function Ls(e){return Math.round((e*xr+5)/xr*256)/256}function ms(e){return Ls(Vn(Hn(e)))}function Ai(e){var t=Math.abs(e-ms(e)),r=xr;if(t>.005)for(xr=ux;xr<fx;++xr)Math.abs(e-ms(e))<=t&&(t=Math.abs(e-ms(e)),r=xr);xr=r}function xa(e){e.width?(e.wpx=Hn(e.width),e.wch=Vn(e.wpx),e.MDW=xr):e.wpx?(e.wch=Vn(e.wpx),e.width=Ls(e.wch),e.MDW=xr):typeof e.wch=="number"&&(e.width=Ls(e.wch),e.wpx=Hn(e.width),e.MDW=xr),e.customWidth&&delete e.customWidth}var hx=96,ol=hx;function cl(e){return e*96/ol}function an(e){return e*ol/96}var dx={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function px(e,t,r,a){t.Borders=[];var n={},s=!1;(e[0].match(hr)||[]).forEach(function(i){var o=fe(i);switch(tt(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":n={},o.diagonalUp&&(n.diagonalUp=De(o.diagonalUp)),o.diagonalDown&&(n.diagonalDown=De(o.diagonalDown)),t.Borders.push(n);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function gx(e,t,r,a){t.Fills=[];var n={},s=!1;(e[0].match(hr)||[]).forEach(function(i){var o=fe(i);switch(tt(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":n={},t.Fills.push(n);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":o.patternType&&(n.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":n.bgColor||(n.bgColor={}),o.indexed&&(n.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(n.bgColor.theme=parseInt(o.theme,10)),o.tint&&(n.bgColor.tint=parseFloat(o.tint)),o.rgb&&(n.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":n.fgColor||(n.fgColor={}),o.theme&&(n.fgColor.theme=parseInt(o.theme,10)),o.tint&&(n.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(n.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function xx(e,t,r,a){t.Fonts=[];var n={},s=!1;(e[0].match(hr)||[]).forEach(function(i){var o=fe(i);switch(tt(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(n),n={};break;case"<name":o.val&&(n.name=Ce(o.val));break;case"<name/>":case"</name>":break;case"<b":n.bold=o.val?De(o.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=o.val?De(o.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(o.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34;break}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=o.val?De(o.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=o.val?De(o.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=o.val?De(o.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=o.val?De(o.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=o.val?De(o.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":o.val&&(n.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(n.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(n.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(n.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=ci[parseInt(o.val,10)];break;case"<color":if(n.color||(n.color={}),o.auto&&(n.color.auto=De(o.auto)),o.rgb)n.color.rgb=o.rgb.slice(-6);else if(o.indexed){n.color.index=parseInt(o.indexed,10);var c=jt[n.color.index];n.color.index==81&&(c=jt[1]),c||(c=jt[1]),n.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(n.color.theme=parseInt(o.theme,10),o.tint&&(n.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(n.color.rgb=Wn(r.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function mx(e,t,r){t.NumberFmt=[];for(var a=rt(xe),n=0;n<a.length;++n)t.NumberFmt[a[n]]=xe[a[n]];var s=e[0].match(hr);if(s)for(n=0;n<s.length;++n){var i=fe(s[n]);switch(tt(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Te(Ce(i.formatCode)),c=parseInt(i.numFmtId,10);if(t.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=o}Ut(o,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}var Cn=["numFmtId","fillId","fontId","borderId","xfId"],In=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function vx(e,t,r){t.CellXf=[];var a,n=!1;(e[0].match(hr)||[]).forEach(function(s){var i=fe(s),o=0;switch(tt(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=i,delete a[0],o=0;o<Cn.length;++o)a[Cn[o]]&&(a[Cn[o]]=parseInt(a[Cn[o]],10));for(o=0;o<In.length;++o)a[In[o]]&&(a[In[o]]=De(a[In[o]]));if(t.NumberFmt&&a.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[a.numFmtId]==t.NumberFmt[o]){a.numFmtId=o;break}}t.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};i.vertical&&(c.vertical=i.vertical),i.horizontal&&(c.horizontal=i.horizontal),i.textRotation!=null&&(c.textRotation=i.textRotation),i.indent&&(c.indent=i.indent),i.wrapText&&(c.wrapText=De(i.wrapText)),a.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(r&&r.WTF&&!n)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}var wx=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,l){var f={};if(!o)return f;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var u;return(u=o.match(t))&&mx(u,f,l),(u=o.match(n))&&xx(u,f,c,l),(u=o.match(a))&&gx(u,f,c,l),(u=o.match(s))&&px(u,f,c,l),(u=o.match(r))&&vx(u,f,l),f}}();function _x(e,t){var r=e.read_shift(2),a=fr(e);return[r,a]}function yx(e,t,r){var a={};a.sz=e.read_shift(2)/20;var n=O1(e);n.fItalic&&(a.italic=1),n.fCondense&&(a.condense=1),n.fExtend&&(a.extend=1),n.fShadow&&(a.shadow=1),n.fOutline&&(a.outline=1),n.fStrikeout&&(a.strike=1);var s=e.read_shift(2);switch(s===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(a.underline=i);var o=e.read_shift(1);o>0&&(a.family=o);var c=e.read_shift(1);switch(c>0&&(a.charset=c),e.l++,a.color=I1(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=fr(e),a}var Ex=ur;function kx(e,t){var r=e.l+t,a=e.read_shift(2),n=e.read_shift(2);return e.l=r,{ixfe:a,numFmtId:n}}var Tx=ur;function Sx(e,t,r){var a={};a.NumberFmt=[];for(var n in xe)a.NumberFmt[n]=xe[n];a.CellXf=[],a.Fonts=[];var s=[],i=!1;return gt(e,function(c,l,f){switch(f){case 44:a.NumberFmt[c[0]]=c[1],Ut(c[1],c[0]);break;case 43:a.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=Wn(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&a.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:s.push(f),i=!0;break;case 38:s.pop(),i=!1;break;default:if(l.T>0)s.push(f);else if(l.T<0)s.pop();else if(!i||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),a}var Ax=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function bx(e,t,r){t.themeElements.clrScheme=[];var a={};(e[0].match(hr)||[]).forEach(function(n){var s=fe(n);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=s.val;break;case"<a:sysClr":a.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[Ax.indexOf(s[0])]=a,a={}):a.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function Fx(){}function Cx(){}var Ix=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Ox=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Dx=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Rx(e,t,r){t.themeElements={};var a;[["clrScheme",Ix,bx],["fontScheme",Ox,Fx],["fmtScheme",Dx,Cx]].forEach(function(n){if(!(a=e.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](a,t,r)})}var Px=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function ll(e,t){(!e||e.length===0)&&(e=Lx());var r,a={};if(!(r=e.match(Px)))throw new Error("themeElements not found in theme");return Rx(r[0],a,t),a.raw=e,a}function Lx(e,t){var r=[_0];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Nx(e,t,r){var a=e.l+t,n=e.read_shift(4);if(n!==124226){if(!r.cellStyles){e.l=a;return}var s=e.slice(e.l);e.l=a;var i;try{i=w0(s,{type:"array"})}catch{return}var o=Fr(i,"theme/theme/theme1.xml",!0);if(o)return ll(o,r)}}function Bx(e){return e.read_shift(4)}function Mx(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=$x(e,4);break;case 2:t.xclrValue=K0(e);break;case 3:t.xclrValue=Bx(e);break;case 4:e.l+=4;break}return e.l+=8,t}function $x(e,t){return ur(e,t)}function Ux(e,t){return ur(e,t)}function jx(e){var t=e.read_shift(2),r=e.read_shift(2)-4,a=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=Mx(e);break;case 6:a[1]=Ux(e,r);break;case 14:case 15:a[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return a}function Wx(e,t){var r=e.l+t;e.l+=2;var a=e.read_shift(2);e.l+=2;for(var n=e.read_shift(2),s=[];n-- >0;)s.push(jx(e,r-e.l));return{ixfe:a,ext:s}}function Hx(e,t){t.forEach(function(r){switch(r[0]){}})}function Vx(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:fr(e)}}function Gx(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function zx(e){return e.l+=4,e.read_shift(4)!=0}function qx(e,t,r){var a={Types:[],Cell:[],Value:[]},n=r||{},s=[],i=!1,o=2;return gt(e,function(c,l,f){switch(f){case 335:a.Types.push({name:c.name});break;case 51:c.forEach(function(u){o==1?a.Cell.push({type:a.Types[u[0]-1].name,index:u[1]}):o==0&&a.Value.push({type:a.Types[u[0]-1].name,index:u[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:s.push(f),i=!0;break;case 36:s.pop(),i=!1;break;default:if(!l.T){if(!i||n.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),a}function Xx(e,t,r){var a={Types:[],Cell:[],Value:[]};if(!e)return a;var n=!1,s=2,i;return e.replace(hr,function(o){var c=fe(o);switch(tt(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var l=0;l<a.Types.length;++l)a.Types[l].name==c.name&&(i=a.Types[l]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?a.Cell.push({type:a.Types[c.t-1].name,index:+c.v}):s==0&&a.Value.push({type:a.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+c.i);break;default:if(!n&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),a}function Kx(e){var t=[];if(!e)return t;var r=1;return(e.match(hr)||[]).forEach(function(a){var n=fe(a);switch(n[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?r=n.i:n.i=r,t.push(n);break}}),t}function Yx(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=de(r);var a=e.read_shift(1);return a&2&&(t.l="1"),a&8&&(t.a="1"),t}function Jx(e,t,r){var a=[];return gt(e,function(s,i,o){switch(o){case 63:a.push(s);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),a}function Zx(e,t,r,a){if(!e)return e;var n=a||{},s=!1;gt(e,function(o,c,l){switch(l){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!c.T){if(!s||n.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}},n)}function Qx(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function zo(e,t,r,a){var n=Array.isArray(e),s;t.forEach(function(i){var o=mr(i.ref);if(n?(e[o.r]||(e[o.r]=[]),s=e[o.r][o.c]):s=e[i.ref],!s){s={t:"z"},n?e[o.r][o.c]=s:e[i.ref]=s;var c=Ne(e["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var l=Ee(c);l!==e["!ref"]&&(e["!ref"]=l)}s.c||(s.c=[]);var f={a:i.author,t:i.t,r:i.r,T:r};i.h&&(f.h=i.h);for(var u=s.c.length-1;u>=0;--u){if(!r&&s.c[u].T)return;r&&!s.c[u].T&&s.c.splice(u,1)}if(r&&a){for(u=0;u<a.length;++u)if(f.a==a[u].id){f.a=a[u].name||f.a;break}}s.c.push(f)})}function em(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],a=[],n=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=fe(o[0]),l={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},f=mr(c.ref);if(!(t.sheetRows&&t.sheetRows<=f.r)){var u=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!u&&!!u[1]&&Si(u[1])||{r:"",t:"",h:""};l.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),l.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(l.h=h.h),a.push(l)}}}}),a}function rm(e,t){var r=[],a=!1,n={},s=0;return e.replace(hr,function(o,c){var l=fe(o);switch(tt(l[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":n={author:l.personId,guid:l.id,ref:l.ref,T:1};break;case"</threadedComment>":n.t!=null&&r.push(n);break;case"<text>":case"<text":s=c+o.length;break;case"</text>":n.t=e.slice(s,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return o}),r}function tm(e,t){var r=[],a=!1;return e.replace(hr,function(s){var i=fe(s);switch(tt(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return s}),r}function am(e){var t={};t.iauthor=e.read_shift(4);var r=Zt(e);return t.rfx=r.s,t.ref=de(r.s),e.l+=16,t}var nm=fr;function sm(e,t){var r=[],a=[],n={},s=!1;return gt(e,function(o,c,l){switch(l){case 632:a.push(o);break;case 635:n=o;break;case 637:n.t=o.t,n.h=o.h,n.r=o.r;break;case 636:if(n.author=a[n.iauthor],delete n.iauthor,t.sheetRows&&n.rfx&&t.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,r.push(n);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}}),r}var im="application/vnd.ms-office.vbaProject";function om(e){var t=ye.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,a){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var n=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");ye.utils.cfb_add(t,n,e.FileIndex[a].content)}}),ye.write(t)}function cm(){return{"!type":"dialog"}}function lm(){return{"!type":"dialog"}}function fm(){return{"!type":"macro"}}function um(){return{"!type":"macro"}}var ua=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(a,n,s,i){var o=!1,c=!1;s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var l=s.length>0?parseInt(s,10)|0:0,f=i.length>0?parseInt(i,10)|0:0;return o?f+=t.c:--f,c?l+=t.r:--l,n+(o?"":"$")+qe(f)+(c?"":"$")+ar(l)}return function(n,s){return t=s,n.replace(e,r)}}(),fl=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,hm=function(){return function(t,r){return t.replace(fl,function(a,n,s,i,o,c){var l=wi(i)-(s?0:r.c),f=vi(c)-(o?0:r.r),u=f==0?"":o?f+1:"["+f+"]",h=l==0?"":s?l+1:"["+l+"]";return n+"R"+u+"C"+h})}}();function ul(e,t){return e.replace(fl,function(r,a,n,s,i,o){return a+(n=="$"?n+s:qe(wi(s)+t.c))+(i=="$"?i+o:ar(vi(o)+t.r))})}function dm(e,t,r){var a=ya(t),n=a.s,s=mr(r),i={r:s.r-n.r,c:s.c-n.c};return ul(e,i)}function pm(e){return e.length!=1}function qo(e){return e.replace(/_xlfn\./g,"")}function We(e){e.l+=1}function It(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function hl(e,t,r){var a=2;if(r){if(r.biff>=2&&r.biff<=5)return dl(e);r.biff==12&&(a=4)}var n=e.read_shift(a),s=e.read_shift(a),i=It(e),o=It(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function dl(e){var t=It(e),r=It(e),a=e.read_shift(1),n=e.read_shift(1);return{s:{r:t[0],c:a,cRel:t[1],rRel:t[2]},e:{r:r[0],c:n,cRel:r[1],rRel:r[2]}}}function gm(e,t,r){if(r.biff<8)return dl(e);var a=e.read_shift(r.biff==12?4:2),n=e.read_shift(r.biff==12?4:2),s=It(e),i=It(e);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:n,c:i[0],cRel:i[1],rRel:i[2]}}}function pl(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return xm(e);var a=e.read_shift(r&&r.biff==12?4:2),n=It(e);return{r:a,c:n[0],cRel:n[1],rRel:n[2]}}function xm(e){var t=It(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function mm(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function vm(e,t,r){var a=r&&r.biff?r.biff:8;if(a>=2&&a<=5)return wm(e);var n=e.read_shift(a>=12?4:2),s=e.read_shift(2),i=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;n>524287;)n-=1048576;if(i==1)for(;s>8191;)s=s-16384;return{r:n,c:s,cRel:i,rRel:o}}function wm(e){var t=e.read_shift(2),r=e.read_shift(1),a=(t&32768)>>15,n=(t&16384)>>14;return t&=16383,a==1&&t>=8192&&(t=t-16384),n==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:n,rRel:a}}function _m(e,t,r){var a=(e[e.l++]&96)>>5,n=hl(e,r.biff>=2&&r.biff<=5?6:8,r);return[a,n]}function ym(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var i=hl(e,s,r);return[a,n,i]}function Em(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}function km(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[a,n]}function Tm(e,t,r){var a=(e[e.l++]&96)>>5,n=gm(e,t-1,r);return[a,n]}function Sm(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[a]}function Xo(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function Am(e,t,r){e.l+=2;for(var a=e.read_shift(r&&r.biff==2?1:2),n=[],s=0;s<=a;++s)n.push(e.read_shift(r&&r.biff==2?1:2));return n}function bm(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function Fm(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function Cm(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function Im(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[a]}function gl(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function Om(e){return e.read_shift(2),gl(e)}function Dm(e){return e.read_shift(2),gl(e)}function Rm(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=pl(e,0,r);return[a,n]}function Pm(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=vm(e,0,r);return[a,n]}function Lm(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=pl(e,0,r);return[a,n,s]}function Nm(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(r&&r.biff<=3?1:2);return[Bv[n],vl[n],a]}function Bm(e,t,r){var a=e[e.l++],n=e.read_shift(1),s=r&&r.biff<=3?[a==88?-1:0,e.read_shift(1)]:Mm(e);return[n,(s[0]===0?vl:Nv)[s[1]]]}function Mm(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function $m(e,t,r){e.l+=r&&r.biff==2?3:4}function Um(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function jm(e){return e.l++,Qt[e.read_shift(1)]}function Wm(e){return e.l++,e.read_shift(2)}function Hm(e){return e.l++,e.read_shift(1)!==0}function Vm(e){return e.l++,cr(e)}function Gm(e,t,r){return e.l++,fn(e,t-1,r)}function zm(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Ue(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Qt[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=cr(e);break;case 2:r[1]=ea(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function qm(e,t,r){for(var a=e.read_shift(r.biff==12?4:2),n=[],s=0;s!=a;++s)n.push((r.biff==12?Zt:es)(e));return n}function Xm(e,t,r){var a=0,n=0;r.biff==12?(a=e.read_shift(4),n=e.read_shift(4)):(n=1+e.read_shift(1),a=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,--n==0&&(n=256));for(var s=0,i=[];s!=a&&(i[s]=[]);++s)for(var o=0;o!=n;++o)i[s][o]=zm(e,r.biff);return i}function Km(e,t,r){var a=e.read_shift(1)>>>5&3,n=!r||r.biff>=8?4:2,s=e.read_shift(n);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,s]}function Ym(e,t,r){if(r.biff==5)return Jm(e);var a=e.read_shift(1)>>>5&3,n=e.read_shift(2),s=e.read_shift(4);return[a,n,s]}function Jm(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[t,r,a]}function Zm(e,t,r){var a=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function Qm(e,t,r){var a=e.read_shift(1)>>>5&3,n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function ev(e,t,r){var a=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[a]}function rv(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[a,n]}var tv=ur,av=ur,nv=ur;function hn(e,t,r){return e.l+=2,[mm(e)]}function bi(e){return e.l+=6,[]}var sv=hn,iv=bi,ov=bi,cv=hn;function xl(e){return e.l+=2,[Ve(e),e.read_shift(2)&1]}var lv=hn,fv=xl,uv=bi,hv=hn,dv=hn,pv=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function gv(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),n=e.read_shift(2),s=e.read_shift(2),i=pv[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:a,c:n,C:s}}function xv(e){return e.l+=2,[e.read_shift(4)]}function mv(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function vv(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function wv(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function _v(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function yv(e){return e.l+=4,[0,0]}var Ko={1:{n:"PtgExp",f:Um},2:{n:"PtgTbl",f:nv},3:{n:"PtgAdd",f:We},4:{n:"PtgSub",f:We},5:{n:"PtgMul",f:We},6:{n:"PtgDiv",f:We},7:{n:"PtgPower",f:We},8:{n:"PtgConcat",f:We},9:{n:"PtgLt",f:We},10:{n:"PtgLe",f:We},11:{n:"PtgEq",f:We},12:{n:"PtgGe",f:We},13:{n:"PtgGt",f:We},14:{n:"PtgNe",f:We},15:{n:"PtgIsect",f:We},16:{n:"PtgUnion",f:We},17:{n:"PtgRange",f:We},18:{n:"PtgUplus",f:We},19:{n:"PtgUminus",f:We},20:{n:"PtgPercent",f:We},21:{n:"PtgParen",f:We},22:{n:"PtgMissArg",f:We},23:{n:"PtgStr",f:Gm},26:{n:"PtgSheet",f:mv},27:{n:"PtgEndSheet",f:vv},28:{n:"PtgErr",f:jm},29:{n:"PtgBool",f:Hm},30:{n:"PtgInt",f:Wm},31:{n:"PtgNum",f:Vm},32:{n:"PtgArray",f:Sm},33:{n:"PtgFunc",f:Nm},34:{n:"PtgFuncVar",f:Bm},35:{n:"PtgName",f:Km},36:{n:"PtgRef",f:Rm},37:{n:"PtgArea",f:_m},38:{n:"PtgMemArea",f:Zm},39:{n:"PtgMemErr",f:tv},40:{n:"PtgMemNoMem",f:av},41:{n:"PtgMemFunc",f:Qm},42:{n:"PtgRefErr",f:ev},43:{n:"PtgAreaErr",f:Em},44:{n:"PtgRefN",f:Pm},45:{n:"PtgAreaN",f:Tm},46:{n:"PtgMemAreaN",f:wv},47:{n:"PtgMemNoMemN",f:_v},57:{n:"PtgNameX",f:Ym},58:{n:"PtgRef3d",f:Lm},59:{n:"PtgArea3d",f:ym},60:{n:"PtgRefErr3d",f:rv},61:{n:"PtgAreaErr3d",f:km},255:{}},Ev={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},kv={1:{n:"PtgElfLel",f:xl},2:{n:"PtgElfRw",f:hv},3:{n:"PtgElfCol",f:sv},6:{n:"PtgElfRwV",f:dv},7:{n:"PtgElfColV",f:cv},10:{n:"PtgElfRadical",f:lv},11:{n:"PtgElfRadicalS",f:uv},13:{n:"PtgElfColS",f:iv},15:{n:"PtgElfColSV",f:ov},16:{n:"PtgElfRadicalLel",f:fv},25:{n:"PtgList",f:gv},29:{n:"PtgSxName",f:xv},255:{}},Tv={0:{n:"PtgAttrNoop",f:yv},1:{n:"PtgAttrSemi",f:Im},2:{n:"PtgAttrIf",f:Fm},4:{n:"PtgAttrChoose",f:Am},8:{n:"PtgAttrGoto",f:bm},16:{n:"PtgAttrSum",f:$m},32:{n:"PtgAttrBaxcel",f:Xo},33:{n:"PtgAttrBaxcel",f:Xo},64:{n:"PtgAttrSpace",f:Om},65:{n:"PtgAttrSpaceSemi",f:Dm},128:{n:"PtgAttrIfError",f:Cm},255:{}};function dn(e,t,r,a){if(a.biff<8)return ur(e,t);for(var n=e.l+t,s=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=Xm(e,0,a),s.push(r[i][1]);break;case"PtgMemArea":r[i][2]=qm(e,r[i][1],a),s.push(r[i][2]);break;case"PtgExp":a&&a.biff==12&&(r[i][1][1]=e.read_shift(4),s.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=n-e.l,t!==0&&s.push(ur(e,t)),s}function pn(e,t,r){for(var a=e.l+t,n,s,i=[];a!=e.l;)t=a-e.l,s=e[e.l],n=Ko[s]||Ko[Ev[s]],(s===24||s===25)&&(n=(s===24?kv:Tv)[e[e.l+1]]),!n||!n.f?ur(e,t):i.push([n.n,n.f(e,t,r)]);return i}function Sv(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r],n=[],s=0;s<a.length;++s){var i=a[s];if(i)switch(i[0]){case 2:n.push('"'+i[1].replace(/"/g,'""')+'"');break;default:n.push(i[1])}else n.push("")}t.push(n.join(","))}return t.join(";")}var Av={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function bv(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function ml(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!a)return"SH33TJSERR1";var n="";if(r.biff>8)switch(e[a[0]][0]){case 357:return n=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[a[0]][0];case 355:default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return n=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[a[0]][0][3]?(n=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?n:n+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function Yo(e,t,r){var a=ml(e,t,r);return a=="#REF"?a:bv(a,r)}function or(e,t,r,a,n){var s=n&&n.biff||8,i={s:{c:0,r:0}},o=[],c,l,f,u=0,h=0,d,g="";if(!e[0]||!e[0][0])return"";for(var p=-1,x="",y=0,F=e[0].length;y<F;++y){var v=e[0][y];switch(v[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),l=o.pop(),p>=0){switch(e[0][p][1][0]){case 0:x=Le(" ",e[0][p][1][1]);break;case 1:x=Le("\r",e[0][p][1][1]);break;default:if(x="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}l=l+x,p=-1}o.push(l+Av[v[0]]+c);break;case"PtgIsect":c=o.pop(),l=o.pop(),o.push(l+" "+c);break;case"PtgUnion":c=o.pop(),l=o.pop(),o.push(l+","+c);break;case"PtgRange":c=o.pop(),l=o.pop(),o.push(l+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=Ua(v[1][1],i,n),o.push(ja(f,s));break;case"PtgRefN":f=r?Ua(v[1][1],r,n):v[1][1],o.push(ja(f,s));break;case"PtgRef3d":u=v[1][1],f=Ua(v[1][2],i,n),g=Yo(a,u,n),o.push(g+"!"+ja(f,s));break;case"PtgFunc":case"PtgFuncVar":var C=v[1][0],P=v[1][1];C||(C=0),C&=127;var I=C==0?[]:o.slice(-C);o.length-=C,P==="User"&&(P=I.shift()),o.push(P+"("+I.join(",")+")");break;case"PtgBool":o.push(v[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(v[1]);break;case"PtgNum":o.push(String(v[1]));break;case"PtgStr":o.push('"'+v[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(v[1]);break;case"PtgAreaN":d=Io(v[1][1],r?{s:r}:i,n),o.push(gs(d,n));break;case"PtgArea":d=Io(v[1][1],i,n),o.push(gs(d,n));break;case"PtgArea3d":u=v[1][1],d=v[1][2],g=Yo(a,u,n),o.push(g+"!"+gs(d,n));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=v[1][2];var S=(a.names||[])[h-1]||(a[0]||[])[h],W=S?S.Name:"SH33TJSNAME"+String(h);W&&W.slice(0,6)=="_xlfn."&&!n.xlfn&&(W=W.slice(6)),o.push(W);break;case"PtgNameX":var O=v[1][1];h=v[1][2];var z;if(n.biff<=5)O<0&&(O=-O),a[O]&&(z=a[O][h]);else{var V="";if(((a[O]||[])[0]||[])[0]==14849||(((a[O]||[])[0]||[])[0]==1025?a[O][h]&&a[O][h].itab>0&&(V=a.SheetNames[a[O][h].itab-1]+"!"):V=a.SheetNames[h-1]+"!"),a[O]&&a[O][h])V+=a[O][h].Name;else if(a[0]&&a[0][h])V+=a[0][h].Name;else{var L=(ml(a,O,n)||"").split(";;");L[h-1]?V=L[h-1]:V+="SH33TJSERRX"}o.push(V);break}z||(z={Name:"SH33TJSERRY"}),o.push(z.Name);break;case"PtgParen":var Y="(",ce=")";if(p>=0){switch(x="",e[0][p][1][0]){case 2:Y=Le(" ",e[0][p][1][1])+Y;break;case 3:Y=Le("\r",e[0][p][1][1])+Y;break;case 4:ce=Le(" ",e[0][p][1][1])+ce;break;case 5:ce=Le("\r",e[0][p][1][1])+ce;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}o.push(Y+o.pop()+ce);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:v[1][1],r:v[1][0]};var re={c:r.c,r:r.r};if(a.sharedf[de(f)]){var oe=a.sharedf[de(f)];o.push(or(oe,i,re,a,n))}else{var ie=!1;for(c=0;c!=a.arrayf.length;++c)if(l=a.arrayf[c],!(f.c<l[0].s.c||f.c>l[0].e.c)&&!(f.r<l[0].s.r||f.r>l[0].e.r)){o.push(or(l[1],i,re,a,n)),ie=!0;break}ie||o.push(v[1])}break;case"PtgArray":o.push("{"+Sv(v[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=y;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+v[1].idx+"[#"+v[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(v));default:throw new Error("Unrecognized Formula Token: "+String(v))}var Ie=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&p>=0&&Ie.indexOf(e[0][y][0])==-1){v=e[0][p];var H=!0;switch(v[1][0]){case 4:H=!1;case 0:x=Le(" ",v[1][1]);break;case 5:H=!1;case 1:x=Le("\r",v[1][1]);break;default:if(x="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+v[1][0])}o.push((H?x:"")+o.pop()+(H?"":x)),p=-1}}if(o.length>1&&n.WTF)throw new Error("bad formula stack");return o[0]}function Fv(e,t,r){var a=e.l+t,n=r.biff==2?1:2,s,i=e.read_shift(n);if(i==65535)return[[],ur(e,t-2)];var o=pn(e,i,r);return t!==i+n&&(s=dn(e,t-i-n,o,r)),e.l=a,[o,s]}function Cv(e,t,r){var a=e.l+t,n=r.biff==2?1:2,s,i=e.read_shift(n);if(i==65535)return[[],ur(e,t-2)];var o=pn(e,i,r);return t!==i+n&&(s=dn(e,t-i-n,o,r)),e.l=a,[o,s]}function Iv(e,t,r,a){var n=e.l+t,s=pn(e,a,r),i;return n!==e.l&&(i=dn(e,n-e.l,s,r)),[s,i]}function Ov(e,t,r){var a=e.l+t,n,s=e.read_shift(2),i=pn(e,s,r);return s==65535?[[],ur(e,t-2)]:(t!==s+2&&(n=dn(e,a-s-2,i,r)),[i,n])}function Dv(e){var t;if(lt(e,e.l+6)!==65535)return[cr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function vs(e,t,r){var a=e.l+t,n=at(e);r.biff==2&&++e.l;var s=Dv(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=Cv(e,a-e.l,r);return{cell:n,val:s[0],formula:o,shared:i>>3&1,tt:s[1]}}function rs(e,t,r){var a=e.read_shift(4),n=pn(e,a,r),s=e.read_shift(4),i=s>0?dn(e,s,n,r):null;return[n,i]}var Rv=rs,ts=rs,Pv=rs,Lv=rs,Nv={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},vl={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Bv={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Jo(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function ws(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var Ga={},ha={};function za(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function wl(e,t,r,a,n,s){try{a.cellNF&&(e.z=xe[t])}catch(o){if(a.WTF)throw o}if(!(e.t==="z"&&!a.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Qe(e.v)),(!a||a.cellText!==!1)&&e.t!=="z")try{if(xe[t]==null&&Ut(Md[t]||"General",t),e.t==="e")e.w=e.w||Qt[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Za(e.v);else if(e.t==="d"){var i=wr(e.v);(i|0)===i?e.w=i.toString(10):e.w=Za(i)}else{if(e.v===void 0)return"";e.w=Wt(e.v,ha)}else e.t==="d"?e.w=Mr(t,wr(e.v),ha):e.w=Mr(t,e.v,ha)}catch(o){if(a.WTF)throw o}if(a.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Wn(n.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF&&(e.s.fgColor.raw_rgb=n.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Wn(n.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF&&(e.s.bgColor.raw_rgb=n.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(a.WTF&&s.Fills)throw o}}}function Mv(e,t){var r=Ne(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Ee(r))}var $v=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Uv=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,jv=/<(?:\w:)?hyperlink [^>]*>/mg,Wv=/"(\w*:\w*)"/,Hv=/<(?:\w:)?col\b[^>]*[\/]?>/g,Vv=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Gv=/<(?:\w:)?pageMargins[^>]*\/>/g,_l=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,zv=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,qv=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Xv(e,t,r,a,n,s,i){if(!e)return e;a||(a={"!id":{}});var o=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},l="",f="",u=e.match(Uv);u?(l=e.slice(0,u.index),f=e.slice(u.index+u[0].length)):l=f=e;var h=l.match(_l);h?Fi(h[0],o,n,r):(h=l.match(zv))&&Kv(h[0],h[1]||"",o,n,r);var d=(l.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(d>0){var g=l.slice(d,d+50).match(Wv);g&&Mv(o,g[1])}var p=l.match(qv);p&&p[1]&&rw(p[1],n);var x=[];if(t.cellStyles){var y=l.match(Hv);y&&Zv(x,y)}u&&tw(u[1],o,t,c,s,i);var F=f.match(Vv);F&&(o["!autofilter"]=Qv(F[0]));var v=[],C=f.match($v);if(C)for(d=0;d!=C.length;++d)v[d]=Ne(C[d].slice(C[d].indexOf('"')+1));var P=f.match(jv);P&&Yv(o,P,a);var I=f.match(Gv);if(I&&(o["!margins"]=Jv(fe(I[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=Ee(c)),t.sheetRows>0&&o["!ref"]){var S=Ne(o["!ref"]);t.sheetRows<=+S.e.r&&(S.e.r=t.sheetRows-1,S.e.r>c.e.r&&(S.e.r=c.e.r),S.e.r<S.s.r&&(S.s.r=S.e.r),S.e.c>c.e.c&&(S.e.c=c.e.c),S.e.c<S.s.c&&(S.s.c=S.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Ee(S))}return x.length>0&&(o["!cols"]=x),v.length>0&&(o["!merges"]=v),o}function Fi(e,t,r,a){var n=fe(e);r.Sheets[a]||(r.Sheets[a]={}),n.codeName&&(r.Sheets[a].CodeName=Te(Ce(n.codeName)))}function Kv(e,t,r,a,n){Fi(e.slice(0,e.indexOf(">")),r,a,n)}function Yv(e,t,r){for(var a=Array.isArray(e),n=0;n!=t.length;++n){var s=fe(Ce(t[n]),!0);if(!s.ref)return;var i=((r||{})["!id"]||[])[s.id];i?(s.Target=i.Target,s.location&&(s.Target+="#"+Te(s.location))):(s.Target="#"+Te(s.location),i={Target:s.Target,TargetMode:"Internal"}),s.Rel=i,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=Ne(s.ref),c=o.s.r;c<=o.e.r;++c)for(var l=o.s.c;l<=o.e.c;++l){var f=de({c:l,r:c});a?(e[c]||(e[c]=[]),e[c][l]||(e[c][l]={t:"z",v:void 0}),e[c][l].l=s):(e[f]||(e[f]={t:"z",v:void 0}),e[f].l=s)}}}function Jv(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function Zv(e,t){for(var r=!1,a=0;a!=t.length;++a){var n=fe(t[a],!0);n.hidden&&(n.hidden=De(n.hidden));var s=parseInt(n.min,10)-1,i=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!r&&n.width&&(r=!0,Ai(n.width)),xa(n);s<=i;)e[s++]=tr(n)}}function Qv(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var ew=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function rw(e,t){t.Views||(t.Views=[{}]),(e.match(ew)||[]).forEach(function(r,a){var n=fe(r);t.Views[a]||(t.Views[a]={}),+n.zoomScale&&(t.Views[a].zoom=+n.zoomScale),De(n.rightToLeft)&&(t.Views[a].RTL=!0)})}var tw=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,s=Qa("v"),i=Qa("f");return function(c,l,f,u,h,d){for(var g=0,p="",x=[],y=[],F=0,v=0,C=0,P="",I,S,W=0,O=0,z,V,L=0,Y=0,ce=Array.isArray(d.CellXf),re,oe=[],ie=[],Ie=Array.isArray(l),H=[],ue={},he=!1,A=!!f.sheetStubs,U=c.split(t),R=0,D=U.length;R!=D;++R){p=U[R].trim();var q=p.length;if(q!==0){var ee=0;e:for(g=0;g<q;++g)switch(p[g]){case">":if(p[g-1]!="/"){++g;break e}if(f&&f.cellStyles){if(S=fe(p.slice(ee,g),!0),W=S.r!=null?parseInt(S.r,10):W+1,O=-1,f.sheetRows&&f.sheetRows<W)continue;ue={},he=!1,S.ht&&(he=!0,ue.hpt=parseFloat(S.ht),ue.hpx=an(ue.hpt)),S.hidden=="1"&&(he=!0,ue.hidden=!0),S.outlineLevel!=null&&(he=!0,ue.level=+S.outlineLevel),he&&(H[W-1]=ue)}break;case"<":ee=g;break}if(ee>=g)break;if(S=fe(p.slice(ee,g),!0),W=S.r!=null?parseInt(S.r,10):W+1,O=-1,!(f.sheetRows&&f.sheetRows<W)){u.s.r>W-1&&(u.s.r=W-1),u.e.r<W-1&&(u.e.r=W-1),f&&f.cellStyles&&(ue={},he=!1,S.ht&&(he=!0,ue.hpt=parseFloat(S.ht),ue.hpx=an(ue.hpt)),S.hidden=="1"&&(he=!0,ue.hidden=!0),S.outlineLevel!=null&&(he=!0,ue.level=+S.outlineLevel),he&&(H[W-1]=ue)),x=p.slice(g).split(e);for(var ne=0;ne!=x.length&&x[ne].trim().charAt(0)=="<";++ne);for(x=x.slice(ne),g=0;g!=x.length;++g)if(p=x[g].trim(),p.length!==0){if(y=p.match(r),F=g,v=0,C=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,y!=null&&y.length===2){for(F=0,P=y[1],v=0;v!=P.length&&!((C=P.charCodeAt(v)-64)<1||C>26);++v)F=26*F+C;--F,O=F}else++O;for(v=0;v!=p.length&&p.charCodeAt(v)!==62;++v);if(++v,S=fe(p.slice(0,v),!0),S.r||(S.r=de({r:W-1,c:O})),P=p.slice(v),I={t:""},(y=P.match(s))!=null&&y[1]!==""&&(I.v=Te(y[1])),f.cellFormula){if((y=P.match(i))!=null&&y[1]!==""){if(I.f=Te(Ce(y[1])).replace(/\r\n/g,`
`),f.xlfn||(I.f=qo(I.f)),y[0].indexOf('t="array"')>-1)I.F=(P.match(n)||[])[1],I.F.indexOf(":")>-1&&oe.push([Ne(I.F),I.F]);else if(y[0].indexOf('t="shared"')>-1){V=fe(y[0]);var Z=Te(Ce(y[1]));f.xlfn||(Z=qo(Z)),ie[parseInt(V.si,10)]=[V,Z,S.r]}}else(y=P.match(/<f[^>]*\/>/))&&(V=fe(y[0]),ie[V.si]&&(I.f=dm(ie[V.si][1],ie[V.si][2],S.r)));var K=mr(S.r);for(v=0;v<oe.length;++v)K.r>=oe[v][0].s.r&&K.r<=oe[v][0].e.r&&K.c>=oe[v][0].s.c&&K.c<=oe[v][0].e.c&&(I.F=oe[v][1])}if(S.t==null&&I.v===void 0)if(I.f||I.F)I.v=0,I.t="n";else if(A)I.t="z";else continue;else I.t=S.t||"n";switch(u.s.c>O&&(u.s.c=O),u.e.c<O&&(u.e.c=O),I.t){case"n":if(I.v==""||I.v==null){if(!A)continue;I.t="z"}else I.v=parseFloat(I.v);break;case"s":if(typeof I.v>"u"){if(!A)continue;I.t="z"}else z=Ga[parseInt(I.v,10)],I.v=z.t,I.r=z.r,f.cellHTML&&(I.h=z.h);break;case"str":I.t="s",I.v=I.v!=null?Ce(I.v):"",f.cellHTML&&(I.h=gi(I.v));break;case"inlineStr":y=P.match(a),I.t="s",y!=null&&(z=Si(y[1]))?(I.v=z.t,f.cellHTML&&(I.h=z.h)):I.v="";break;case"b":I.v=De(I.v);break;case"d":f.cellDates?I.v=Qe(I.v,1):(I.v=wr(Qe(I.v,1)),I.t="n");break;case"e":(!f||f.cellText!==!1)&&(I.w=I.v),I.v=j0[I.v];break}if(L=Y=0,re=null,ce&&S.s!==void 0&&(re=d.CellXf[S.s],re!=null&&(re.numFmtId!=null&&(L=re.numFmtId),f.cellStyles&&re.fillId!=null&&(Y=re.fillId))),wl(I,L,Y,f,h,d),f.cellDates&&ce&&I.t=="n"&&_a(xe[L])&&(I.t="d",I.v=Qn(I.v)),S.cm&&f.xlmeta){var ke=(f.xlmeta.Cell||[])[+S.cm-1];ke&&ke.type=="XLDAPR"&&(I.D=!0)}if(Ie){var b=mr(S.r);l[b.r]||(l[b.r]=[]),l[b.r][b.c]=I}else l[S.r]=I}}}}H.length>0&&(l["!rows"]=H)}}();function aw(e,t){var r={},a=e.l+t;r.r=e.read_shift(4),e.l+=4;var n=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=a,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=n/20),r}var nw=Zt;function sw(){}function iw(e,t){var r={},a=e[e.l];return++e.l,r.above=!(a&64),r.left=!(a&128),e.l+=18,r.name=F1(e),r}function ow(e){var t=Ur(e);return[t]}function cw(e){var t=Jt(e);return[t]}function lw(e){var t=Ur(e),r=e.read_shift(1);return[t,r,"b"]}function fw(e){var t=Jt(e),r=e.read_shift(1);return[t,r,"b"]}function uw(e){var t=Ur(e),r=e.read_shift(1);return[t,r,"e"]}function hw(e){var t=Jt(e),r=e.read_shift(1);return[t,r,"e"]}function dw(e){var t=Ur(e),r=e.read_shift(4);return[t,r,"s"]}function pw(e){var t=Jt(e),r=e.read_shift(4);return[t,r,"s"]}function gw(e){var t=Ur(e),r=cr(e);return[t,r,"n"]}function yl(e){var t=Jt(e),r=cr(e);return[t,r,"n"]}function xw(e){var t=Ur(e),r=Ei(e);return[t,r,"n"]}function mw(e){var t=Jt(e),r=Ei(e);return[t,r,"n"]}function vw(e){var t=Ur(e),r=_i(e);return[t,r,"is"]}function ww(e){var t=Ur(e),r=fr(e);return[t,r,"str"]}function _w(e){var t=Jt(e),r=fr(e);return[t,r,"str"]}function yw(e,t,r){var a=e.l+t,n=Ur(e);n.r=r["!row"];var s=e.read_shift(1),i=[n,s,"b"];if(r.cellFormula){e.l+=2;var o=ts(e,a-e.l,r);i[3]=or(o,null,n,r.supbooks,r)}else e.l=a;return i}function Ew(e,t,r){var a=e.l+t,n=Ur(e);n.r=r["!row"];var s=e.read_shift(1),i=[n,s,"e"];if(r.cellFormula){e.l+=2;var o=ts(e,a-e.l,r);i[3]=or(o,null,n,r.supbooks,r)}else e.l=a;return i}function kw(e,t,r){var a=e.l+t,n=Ur(e);n.r=r["!row"];var s=cr(e),i=[n,s,"n"];if(r.cellFormula){e.l+=2;var o=ts(e,a-e.l,r);i[3]=or(o,null,n,r.supbooks,r)}else e.l=a;return i}function Tw(e,t,r){var a=e.l+t,n=Ur(e);n.r=r["!row"];var s=fr(e),i=[n,s,"str"];if(r.cellFormula){e.l+=2;var o=ts(e,a-e.l,r);i[3]=or(o,null,n,r.supbooks,r)}else e.l=a;return i}var Sw=Zt;function Aw(e,t){var r=e.l+t,a=Zt(e),n=yi(e),s=fr(e),i=fr(e),o=fr(e);e.l=r;var c={rfx:a,relId:n,loc:s,display:o};return i&&(c.Tooltip=i),c}function bw(){}function Fw(e,t,r){var a=e.l+t,n=M0(e),s=e.read_shift(1),i=[n];if(i[2]=s,r.cellFormula){var o=Rv(e,a-e.l,r);i[1]=o}else e.l=a;return i}function Cw(e,t,r){var a=e.l+t,n=Zt(e),s=[n];if(r.cellFormula){var i=Lv(e,a-e.l,r);s[1]=i,e.l=a}else e.l=a;return s}var Iw=["left","right","top","bottom","header","footer"];function Ow(e){var t={};return Iw.forEach(function(r){t[r]=cr(e)}),t}function Dw(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function Rw(){}function Pw(){}function Lw(e,t,r,a,n,s,i){if(!e)return e;var o=t||{};a||(a={"!id":{}});var c=o.dense?[]:{},l,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},u=!1,h=!1,d,g,p,x,y,F,v,C,P,I=[];o.biff=12,o["!row"]=0;var S=0,W=!1,O=[],z={},V=o.supbooks||n.supbooks||[[]];if(V.sharedf=z,V.arrayf=O,V.SheetNames=n.SheetNames||n.Sheets.map(function(Ie){return Ie.name}),!o.supbooks&&(o.supbooks=V,n.Names))for(var L=0;L<n.Names.length;++L)V[0][L+1]=n.Names[L];var Y=[],ce=[],re=!1;Gn[16]={n:"BrtShortReal",f:yl};var oe;if(gt(e,function(H,ue,he){if(!h)switch(he){case 148:l=H;break;case 0:d=H,o.sheetRows&&o.sheetRows<=d.r&&(h=!0),C=ar(x=d.r),o["!row"]=d.r,(H.hidden||H.hpt||H.level!=null)&&(H.hpt&&(H.hpx=an(H.hpt)),ce[H.r]=H);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:H[2]},H[2]){case"n":g.v=H[1];break;case"s":v=Ga[H[1]],g.v=v.t,g.r=v.r;break;case"b":g.v=!!H[1];break;case"e":g.v=H[1],o.cellText!==!1&&(g.w=Qt[g.v]);break;case"str":g.t="s",g.v=H[1];break;case"is":g.t="s",g.v=H[1].t;break}if((p=i.CellXf[H[0].iStyleRef])&&wl(g,p.numFmtId,null,o,s,i),y=H[0].c==-1?y+1:H[0].c,o.dense?(c[x]||(c[x]=[]),c[x][y]=g):c[qe(y)+C]=g,o.cellFormula){for(W=!1,S=0;S<O.length;++S){var A=O[S];d.r>=A[0].s.r&&d.r<=A[0].e.r&&y>=A[0].s.c&&y<=A[0].e.c&&(g.F=Ee(A[0]),W=!0)}!W&&H.length>3&&(g.f=H[3])}if(f.s.r>d.r&&(f.s.r=d.r),f.s.c>y&&(f.s.c=y),f.e.r<d.r&&(f.e.r=d.r),f.e.c<y&&(f.e.c=y),o.cellDates&&p&&g.t=="n"&&_a(xe[p.numFmtId])){var U=$t(g.v);U&&(g.t="d",g.v=new Date(U.y,U.m-1,U.d,U.H,U.M,U.S,U.u))}oe&&(oe.type=="XLDAPR"&&(g.D=!0),oe=void 0);break;case 1:case 12:if(!o.sheetStubs||u)break;g={t:"z",v:void 0},y=H[0].c==-1?y+1:H[0].c,o.dense?(c[x]||(c[x]=[]),c[x][y]=g):c[qe(y)+C]=g,f.s.r>d.r&&(f.s.r=d.r),f.s.c>y&&(f.s.c=y),f.e.r<d.r&&(f.e.r=d.r),f.e.c<y&&(f.e.c=y),oe&&(oe.type=="XLDAPR"&&(g.D=!0),oe=void 0);break;case 176:I.push(H);break;case 49:oe=((o.xlmeta||{}).Cell||[])[H-1];break;case 494:var R=a["!id"][H.relId];for(R?(H.Target=R.Target,H.loc&&(H.Target+="#"+H.loc),H.Rel=R):H.relId==""&&(H.Target="#"+H.loc),x=H.rfx.s.r;x<=H.rfx.e.r;++x)for(y=H.rfx.s.c;y<=H.rfx.e.c;++y)o.dense?(c[x]||(c[x]=[]),c[x][y]||(c[x][y]={t:"z",v:void 0}),c[x][y].l=H):(F=de({c:y,r:x}),c[F]||(c[F]={t:"z",v:void 0}),c[F].l=H);break;case 426:if(!o.cellFormula)break;O.push(H),P=o.dense?c[x][y]:c[qe(y)+C],P.f=or(H[1],f,{r:d.r,c:y},V,o),P.F=Ee(H[0]);break;case 427:if(!o.cellFormula)break;z[de(H[0].s)]=H[1],P=o.dense?c[x][y]:c[qe(y)+C],P.f=or(H[1],f,{r:d.r,c:y},V,o);break;case 60:if(!o.cellStyles)break;for(;H.e>=H.s;)Y[H.e--]={width:H.w/256,hidden:!!(H.flags&1),level:H.level},re||(re=!0,Ai(H.w/256)),xa(Y[H.e+1]);break;case 161:c["!autofilter"]={ref:Ee(H)};break;case 476:c["!margins"]=H;break;case 147:n.Sheets[r]||(n.Sheets[r]={}),H.name&&(n.Sheets[r].CodeName=H.name),(H.above||H.left)&&(c["!outline"]={above:H.above,left:H.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),H.RTL&&(n.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:u=!0;break;case 36:u=!1;break;case 37:u=!0;break;case 38:u=!1;break;default:if(!ue.T){if(!u||o.WTF)throw new Error("Unexpected record 0x"+he.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(f.s.r<2e6||l&&(l.e.r>0||l.e.c>0||l.s.r>0||l.s.c>0))&&(c["!ref"]=Ee(l||f)),o.sheetRows&&c["!ref"]){var ie=Ne(c["!ref"]);o.sheetRows<=+ie.e.r&&(ie.e.r=o.sheetRows-1,ie.e.r>f.e.r&&(ie.e.r=f.e.r),ie.e.r<ie.s.r&&(ie.s.r=ie.e.r),ie.e.c>f.e.c&&(ie.e.c=f.e.c),ie.e.c<ie.s.c&&(ie.s.c=ie.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Ee(ie))}return I.length>0&&(c["!merges"]=I),Y.length>0&&(c["!cols"]=Y),ce.length>0&&(c["!rows"]=ce),c}function Nw(e){var t=[],r=e.match(/^<c:numCache>/),a;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var i=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var n=Te((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){a=s.replace(/<.*?>/g,"")}),[t,n,a]}function Bw(e,t,r,a,n,s){var i=s||{"!type":"chart"};if(!e)return s;var o=0,c=0,l="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(u){var h=Nw(u);f.s.r=f.s.c=0,f.e.c=o,l=qe(o),h[0].forEach(function(d,g){i[l+ar(g)]={t:"n",v:d,z:h[1]},c=g}),f.e.r<c&&(f.e.r=c),++o}),o>0&&(i["!ref"]=Ee(f)),i}function Mw(e,t,r,a,n){if(!e)return e;a||(a={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i,o=e.match(_l);return o&&Fi(o[0],s,n,r),(i=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=i[1]),a["!id"][s["!rel"]]&&(s["!drawel"]=a["!id"][s["!rel"]]),s}function $w(e,t){e.l+=10;var r=fr(e);return{name:r}}function Uw(e,t,r,a,n){if(!e)return e;a||(a={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i=!1;return gt(e,function(c,l,f){switch(f){case 550:s["!rel"]=c;break;case 651:n.Sheets[r]||(n.Sheets[r]={}),c.name&&(n.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(l.T>0)){if(!(l.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},t),a["!id"][s["!rel"]]&&(s["!drawel"]=a["!id"][s["!rel"]]),s}var El=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],jw=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Ww=[],Hw=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Zo(e,t){for(var r=0;r!=e.length;++r)for(var a=e[r],n=0;n!=t.length;++n){var s=t[n];if(a[s[0]]==null)a[s[0]]=s[1];else switch(s[2]){case"bool":typeof a[s[0]]=="string"&&(a[s[0]]=De(a[s[0]]));break;case"int":typeof a[s[0]]=="string"&&(a[s[0]]=parseInt(a[s[0]],10));break}}}function Qo(e,t){for(var r=0;r!=t.length;++r){var a=t[r];if(e[a[0]]==null)e[a[0]]=a[1];else switch(a[2]){case"bool":typeof e[a[0]]=="string"&&(e[a[0]]=De(e[a[0]]));break;case"int":typeof e[a[0]]=="string"&&(e[a[0]]=parseInt(e[a[0]],10));break}}}function kl(e){Qo(e.WBProps,El),Qo(e.CalcPr,Hw),Zo(e.WBView,jw),Zo(e.Sheets,Ww),ha.date1904=De(e.WBProps.date1904)}var Vw="][*?/\\".split("");function Gw(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return Vw.forEach(function(a){if(e.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var zw=/<\w+:workbook/;function qw(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,n="xmlns",s={},i=0;if(e.replace(hr,function(c,l){var f=fe(c);switch(tt(f[0])){case"<?xml":break;case"<workbook":c.match(zw)&&(n="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=f[n];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":El.forEach(function(u){if(f[u[0]]!=null)switch(u[2]){case"bool":r.WBProps[u[0]]=De(f[u[0]]);break;case"int":r.WBProps[u[0]]=parseInt(f[u[0]],10);break;default:r.WBProps[u[0]]=f[u[0]]}}),f.codeName&&(r.WBProps.CodeName=Ce(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=Te(Ce(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":s={},s.Name=Ce(f.name),f.comment&&(s.Comment=f.comment),f.localSheetId&&(s.Sheet=+f.localSheetId),De(f.hidden||"0")&&(s.Hidden=!0),i=l+c.length;break;case"</definedName>":s.Ref=Te(Ce(e.slice(i,l))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&t.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return c}),u1.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return kl(r),r}function Xw(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Ds(e),r.name=fr(e),r}function Kw(e,t){var r={},a=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var n=t>8?fr(e):"";return n.length>0&&(r.CodeName=n),r.autoCompressPictures=!!(a&65536),r.backupFile=!!(a&64),r.checkCompatibility=!!(a&4096),r.date1904=!!(a&1),r.filterPrivacy=!!(a&8),r.hidePivotFieldList=!!(a&1024),r.promptedSolutions=!!(a&16),r.publishItems=!!(a&2048),r.refreshAllConnections=!!(a&262144),r.saveExternalLinkValues=!!(a&128),r.showBorderUnselectedTables=!!(a&4),r.showInkAnnotation=!!(a&32),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(a&32768),r.updateLinks=["userSet","never","always"][a>>8&3],r}function Yw(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function Jw(e,t,r){var a=e.l+t;e.l+=4,e.l+=1;var n=e.read_shift(4),s=C1(e),i=Pv(e,0,r),o=yi(e);e.l=a;var c={Name:s,Ptg:i};return n<268435455&&(c.Sheet=n),o&&(c.Comment=o),c}function Zw(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],n=!1;t||(t={}),t.biff=12;var s=[],i=[[]];return i.SheetNames=[],i.XTI=[],Gn[16]={n:"BrtFRTArchID$",f:Yw},gt(e,function(c,l,f){switch(f){case 156:i.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=or(c.Ptg,null,null,i,t),delete t.SID,delete c.Ptg,s.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([f,c]):i[0]=[f,c],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(c),i.XTI=i.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(f),n=!0;break;case 36:a.pop(),n=!1;break;case 37:a.push(f),n=!0;break;case 38:a.pop(),n=!1;break;case 16:break;default:if(!l.T){if(!n||t.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},t),kl(r),r.Names=s,r.supbooks=i,r}function Qw(e,t,r){return t.slice(-4)===".bin"?Zw(e,r):qw(e,r)}function e_(e,t,r,a,n,s,i,o){return t.slice(-4)===".bin"?Lw(e,a,r,n,s,i,o):Xv(e,a,r,n,s,i,o)}function r_(e,t,r,a,n,s,i,o){return t.slice(-4)===".bin"?Uw(e,a,r,n,s):Mw(e,a,r,n,s)}function t_(e,t,r,a,n,s,i,o){return t.slice(-4)===".bin"?fm():um()}function a_(e,t,r,a,n,s,i,o){return t.slice(-4)===".bin"?cm():lm()}function n_(e,t,r,a){return t.slice(-4)===".bin"?Sx(e,r,a):wx(e,r,a)}function s_(e,t,r){return ll(e,r)}function i_(e,t,r){return t.slice(-4)===".bin"?jg(e,r):$g(e,r)}function o_(e,t,r){return t.slice(-4)===".bin"?sm(e,r):em(e,r)}function c_(e,t,r){return t.slice(-4)===".bin"?Jx(e):Kx(e)}function l_(e,t,r,a){return r.slice(-4)===".bin"?Zx(e,t,r,a):void 0}function f_(e,t,r){return t.slice(-4)===".bin"?qx(e,t,r):Xx(e,t,r)}var Tl=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Sl=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function jr(e,t){var r=e.split(/\s+/),a=[];if(a[0]=r[0],r.length===1)return a;var n=e.match(Tl),s,i,o,c;if(n)for(c=0;c!=n.length;++c)s=n[c].match(Sl),(i=s[1].indexOf(":"))===-1?a[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(i+1),a[o]=s[2].slice(1,s[2].length-1));return a}function u_(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var a=e.match(Tl),n,s,i,o;if(a)for(o=0;o!=a.length;++o)n=a[o].match(Sl),(s=n[1].indexOf(":"))===-1?r[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?i="xmlns"+n[1].slice(6):i=n[1].slice(s+1),r[i]=n[2].slice(1,n[2].length-1));return r}var qa;function h_(e,t){var r=qa[e]||Te(e);return r==="General"?Wt(t):Mr(r,t)}function d_(e,t,r,a){var n=a;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=De(a);break;case"i2":case"int":n=parseInt(a,10);break;case"r4":case"float":n=parseFloat(a);break;case"date":case"dateTime.tz":n=Qe(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Te(t)]=n}function p_(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Qt[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Za(e.v):e.w=Wt(e.v):e.w=h_(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var a=qa[t]||t||"General";if(r.cellNF&&(e.z=a),r.cellDates&&e.t=="n"&&_a(a)){var n=$t(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(s){if(r.WTF)throw s}}}function g_(e,t,r){if(r.cellStyles&&t.Interior){var a=t.Interior;a.Pattern&&(a.patternType=dx[a.Pattern]||a.Pattern)}e[t.ID]=t}function x_(e,t,r,a,n,s,i,o,c,l){var f="General",u=a.StyleID,h={};l=l||{};var d=[],g=0;for(u===void 0&&o&&(u=o.StyleID),u===void 0&&i&&(u=i.StyleID);s[u]!==void 0&&(s[u].nf&&(f=s[u].nf),s[u].Interior&&d.push(s[u].Interior),!!s[u].Parent);)u=s[u].Parent;switch(r.Type){case"Boolean":a.t="b",a.v=De(e);break;case"String":a.t="s",a.r=yo(Te(e)),a.v=e.indexOf("<")>-1?Te(t||e).replace(/<.*?>/g,""):a.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),a.v=(Qe(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),a.v!==a.v?a.v=Te(e):a.v<60&&(a.v=a.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+e),a.t||(a.t="n");break;case"Error":a.t="e",a.v=j0[e],l.cellText!==!1&&(a.w=e);break;default:e==""&&t==""?a.t="z":(a.t="s",a.v=yo(t||e));break}if(p_(a,f,l),l.cellFormula!==!1)if(a.Formula){var p=Te(a.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),a.f=ua(p,n),delete a.Formula,a.ArrayRange=="RC"?a.F=ua("RC:RC",n):a.ArrayRange&&(a.F=ua(a.ArrayRange,n),c.push([Ne(a.F),a.F]))}else for(g=0;g<c.length;++g)n.r>=c[g][0].s.r&&n.r<=c[g][0].e.r&&n.c>=c[g][0].s.c&&n.c<=c[g][0].e.c&&(a.F=c[g][1]);l.cellStyles&&(d.forEach(function(x){!h.patternType&&x.patternType&&(h.patternType=x.patternType)}),a.s=h),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function m_(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function _s(e,t){var r=t||{};d0();var a=Oa(xi(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(a=Ce(a));var n=a.slice(0,1024).toLowerCase(),s=!1;if(n=n.replace(/".*?"/g,""),(n.indexOf(">")&1023)>Math.min(n.indexOf(",")&1023,n.indexOf(";")&1023)){var i=tr(r);return i.type="string",rn.to_workbook(a,i)}if(n.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Me){n.indexOf("<"+Me)>=0&&(s=!0)}),s)return A_(a,r);qa={"General Number":"General","General Date":xe[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":xe[15],"Short Date":xe[14],"Long Time":xe[19],"Medium Time":xe[18],"Short Time":xe[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:xe[2],Standard:xe[4],Percent:xe[10],Scientific:xe[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],l,f={},u=[],h=r.dense?[]:{},d="",g={},p={},x=jr('<Data ss:Type="String">'),y=0,F=0,v=0,C={s:{r:2e6,c:2e6},e:{r:0,c:0}},P={},I={},S="",W=0,O=[],z={},V={},L=0,Y=[],ce=[],re={},oe=[],ie,Ie=!1,H=[],ue=[],he={},A=0,U=0,R={Sheets:[],WBProps:{date1904:!1}},D={};en.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var q="";o=en.exec(a);)switch(o[3]=(q=o[3]).toLowerCase()){case"data":if(q=="data"){if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?x_(a.slice(y,o.index),S,x,c[c.length-1][0]=="comment"?re:g,{c:F,r:v},P,oe[F],p,H,r):(S="",x=jr(o[0]),y=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(ce.length>0&&(g.c=ce),(!r.sheetRows||r.sheetRows>v)&&g.v!==void 0&&(r.dense?(h[v]||(h[v]=[]),h[v][F]=g):h[qe(F)+ar(v)]=g),g.HRef&&(g.l={Target:Te(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(A=F+(parseInt(g.MergeAcross,10)|0),U=v+(parseInt(g.MergeDown,10)|0),O.push({s:{c:F,r:v},e:{c:A,r:U}})),!r.sheetStubs)g.MergeAcross?F=A+1:++F;else if(g.MergeAcross||g.MergeDown){for(var ee=F;ee<=A;++ee)for(var ne=v;ne<=U;++ne)(ee>F||ne>v)&&(r.dense?(h[ne]||(h[ne]=[]),h[ne][ee]={t:"z"}):h[qe(ee)+ar(ne)]={t:"z"});F=A+1}else++F;else g=u_(o[0]),g.Index&&(F=+g.Index-1),F<C.s.c&&(C.s.c=F),F>C.e.c&&(C.e.c=F),o[0].slice(-2)==="/>"&&++F,ce=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(v<C.s.r&&(C.s.r=v),v>C.e.r&&(C.e.r=v),o[0].slice(-2)==="/>"&&(p=jr(o[0]),p.Index&&(v=+p.Index-1)),F=0,++v):(p=jr(o[0]),p.Index&&(v=+p.Index-1),he={},(p.AutoFitHeight=="0"||p.Height)&&(he.hpx=parseInt(p.Height,10),he.hpt=cl(he.hpx),ue[v]=he),p.Hidden=="1"&&(he.hidden=!0,ue[v]=he));break;case"worksheet":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"));u.push(d),C.s.r<=C.e.r&&C.s.c<=C.e.c&&(h["!ref"]=Ee(C),r.sheetRows&&r.sheetRows<=C.e.r&&(h["!fullref"]=h["!ref"],C.e.r=r.sheetRows-1,h["!ref"]=Ee(C))),O.length&&(h["!merges"]=O),oe.length>0&&(h["!cols"]=oe),ue.length>0&&(h["!rows"]=ue),f[d]=h}else C={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=F=0,c.push([o[3],!1]),l=jr(o[0]),d=Te(l.Name),h=r.dense?[]:{},O=[],H=[],ue=[],D={name:d,Hidden:0},R.Sheets.push(D);break;case"table":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),oe=[],Ie=!1}break;case"style":o[1]==="/"?g_(P,I,r):I=jr(o[0]);break;case"numberformat":I.nf=Te(jr(o[0]).Format||"General"),qa[I.nf]&&(I.nf=qa[I.nf]);for(var Z=0;Z!=392&&xe[Z]!=I.nf;++Z);if(Z==392){for(Z=57;Z!=392;++Z)if(xe[Z]==null){Ut(I.nf,Z);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(ie=jr(o[0]),ie.Hidden&&(ie.hidden=!0,delete ie.Hidden),ie.Width&&(ie.wpx=parseInt(ie.Width,10)),!Ie&&ie.wpx>10){Ie=!0,xr=il;for(var K=0;K<oe.length;++K)oe[K]&&xa(oe[K])}Ie&&xa(ie),oe[ie.Index-1||oe.length]=ie;for(var ke=0;ke<+ie.Span;++ke)oe[oe.length]=tr(ie);break;case"namedrange":if(o[1]==="/")break;R.Names||(R.Names=[]);var b=fe(o[0]),Be={Name:b.Name,Ref:ua(b.RefersTo.slice(1),{r:0,c:0})};R.Sheets.length>0&&(Be.Sheet=R.Sheets.length-1),R.Names.push(Be);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?S+=a.slice(W,o.index):W=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;I.Interior=jr(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?ep(z,q,a.slice(L,o.index)):L=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"));m_(re),ce.push(re)}else c.push([o[3],!1]),l=jr(o[0]),re={a:l.Author};break;case"autofilter":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Se=jr(o[0]);h["!autofilter"]={ref:ua(Se.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return sc(a,r);var be=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:be=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:be=!1}break;case"excelworkbook":switch(o[3]){case"date1904":R.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:be=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:be=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(a.slice(L,o.index)){case"SheetHidden":D.Hidden=1;break;case"SheetVeryHidden":D.Hidden=2;break}else L=o.index+o[0].length;break;case"header":h["!margins"]||za(h["!margins"]={},"xlml"),isNaN(+fe(o[0]).Margin)||(h["!margins"].header=+fe(o[0]).Margin);break;case"footer":h["!margins"]||za(h["!margins"]={},"xlml"),isNaN(+fe(o[0]).Margin)||(h["!margins"].footer=+fe(o[0]).Margin);break;case"pagemargins":var ve=fe(o[0]);h["!margins"]||za(h["!margins"]={},"xlml"),isNaN(+ve.Top)||(h["!margins"].top=+ve.Top),isNaN(+ve.Left)||(h["!margins"].left=+ve.Left),isNaN(+ve.Right)||(h["!margins"].right=+ve.Right),isNaN(+ve.Bottom)||(h["!margins"].bottom=+ve.Bottom);break;case"displayrighttoleft":R.Views||(R.Views=[]),R.Views[0]||(R.Views[0]={}),R.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:be=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:be=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:be=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:be=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:be=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:be=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:be=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:be=!1}break;case"smarttags":break;default:be=!1;break}if(be||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?d_(V,q,Y,a.slice(L,o.index)):(Y=o,L=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var te={};return!r.bookSheets&&!r.bookProps&&(te.Sheets=f),te.SheetNames=u,te.Workbook=R,te.SSF=tr(xe),te.Props=z,te.Custprops=V,te}function Ns(e,t){switch(Oi(t=t||{}),t.type||"base64"){case"base64":return _s(Or(e),t);case"binary":case"buffer":case"file":return _s(e,t);case"array":return _s(Yt(e),t)}}function v_(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=D1(r),r.length-r.l<=4)return t;var a=r.read_shift(4);if(a==0||a>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(a=r.read_shift(4),a!==1907505652)||(t.UnicodeClipboardFormat=R1(r),a=r.read_shift(4),a==0||a>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var w_=[60,1084,2066,2165,2175];function __(e,t,r,a,n){var s=a,i=[],o=r.slice(r.l,r.l+s);if(n&&n.enc&&n.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:n.enc.insitu(o)}i.push(o),r.l+=s;for(var c=lt(r,r.l),l=Bs[c],f=0;l!=null&&w_.indexOf(c)>-1;)s=lt(r,r.l+2),f=r.l+4,c==2066?f+=4:(c==2165||c==2175)&&(f+=12),o=r.slice(f,r.l+4+s),i.push(o),r.l+=4+s,l=Bs[c=lt(r,r.l)];var u=kt(i);er(u,0);var h=0;u.lens=[];for(var d=0;d<i.length;++d)u.lens.push(h),h+=i[d].length;if(u.length<a)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+u.length+" < "+a;return t.f(u,u.length,n)}function Zr(e,t,r){if(e.t!=="z"&&e.XF){var a=0;try{a=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=xe[a])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Qt[e.v]:a===0||a=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Za(e.v):e.w=Wt(e.v):e.w=Mr(a,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&a&&e.t=="n"&&_a(xe[a]||String(a))){var n=$t(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function On(e,t,r){return{v:e,ixfe:t,t:r}}function y_(e,t){var r={opts:{}},a={},n=t.dense?[]:{},s={},i={},o=null,c=[],l="",f={},u,h="",d,g,p,x,y={},F=[],v,C,P=[],I=[],S={Sheets:[],WBProps:{date1904:!1},Views:[{}]},W={},O=function(me){return me<8?jt[me]:me<64&&I[me-8]||jt[me]},z=function(me,$e,Rr){var Ge=$e.XF.data;if(!(!Ge||!Ge.patternType||!Rr||!Rr.cellStyles)){$e.s={},$e.s.patternType=Ge.patternType;var Rt;(Rt=tn(O(Ge.icvFore)))&&($e.s.fgColor={rgb:Rt}),(Rt=tn(O(Ge.icvBack)))&&($e.s.bgColor={rgb:Rt})}},V=function(me,$e,Rr){if(!(he>1)&&!(Rr.sheetRows&&me.r>=Rr.sheetRows)){if(Rr.cellStyles&&$e.XF&&$e.XF.data&&z(me,$e,Rr),delete $e.ixfe,delete $e.XF,u=me,h=de(me),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),me.r<i.s.r&&(i.s.r=me.r),me.c<i.s.c&&(i.s.c=me.c),me.r+1>i.e.r&&(i.e.r=me.r+1),me.c+1>i.e.c&&(i.e.c=me.c+1),Rr.cellFormula&&$e.f){for(var Ge=0;Ge<F.length;++Ge)if(!(F[Ge][0].s.c>me.c||F[Ge][0].s.r>me.r)&&!(F[Ge][0].e.c<me.c||F[Ge][0].e.r<me.r)){$e.F=Ee(F[Ge][0]),(F[Ge][0].s.c!=me.c||F[Ge][0].s.r!=me.r)&&delete $e.f,$e.f&&($e.f=""+or(F[Ge][1],i,me,H,L));break}}Rr.dense?(n[me.r]||(n[me.r]=[]),n[me.r][me.c]=$e):n[h]=$e}},L={enc:!1,sbcch:0,snames:[],sharedf:y,arrayf:F,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(L.password=t.password);var Y,ce=[],re=[],oe=[],ie=[],Ie=!1,H=[];H.SheetNames=L.snames,H.sharedf=L.sharedf,H.arrayf=L.arrayf,H.names=[],H.XTI=[];var ue=0,he=0,A=0,U=[],R=[],D;L.codepage=1200,qr(1200);for(var q=!1;e.l<e.length-1;){var ee=e.l,ne=e.read_shift(2);if(ne===0&&ue===10)break;var Z=e.l===e.length?0:e.read_shift(2),K=Bs[ne];if(K&&K.f){if(t.bookSheets&&ue===133&&ne!==133)break;if(ue=ne,K.r===2||K.r==12){var ke=e.read_shift(2);if(Z-=2,!L.enc&&ke!==ne&&((ke&255)<<8|ke>>8)!==ne)throw new Error("rt mismatch: "+ke+"!="+ne);K.r==12&&(e.l+=10,Z-=10)}var b={};if(ne===10?b=K.f(e,Z,L):b=__(ne,K,e,Z,L),he==0&&[9,521,1033,2057].indexOf(ue)===-1)continue;switch(ne){case 34:r.opts.Date1904=S.WBProps.date1904=b;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(L.enc||(e.l=0),L.enc=b,!t.password)throw new Error("File is password-protected");if(b.valid==null)throw new Error("Encryption scheme unsupported");if(!b.valid)throw new Error("Password is incorrect");break;case 92:L.lastuser=b;break;case 66:var Be=Number(b);switch(Be){case 21010:Be=1200;break;case 32768:Be=1e4;break;case 32769:Be=1252;break}qr(L.codepage=Be),q=!0;break;case 317:L.rrtabid=b;break;case 25:L.winlocked=b;break;case 439:r.opts.RefreshAll=b;break;case 12:r.opts.CalcCount=b;break;case 16:r.opts.CalcDelta=b;break;case 17:r.opts.CalcIter=b;break;case 13:r.opts.CalcMode=b;break;case 14:r.opts.CalcPrecision=b;break;case 95:r.opts.CalcSaveRecalc=b;break;case 15:L.CalcRefMode=b;break;case 2211:r.opts.FullCalc=b;break;case 129:b.fDialog&&(n["!type"]="dialog"),b.fBelow||((n["!outline"]||(n["!outline"]={})).above=!0),b.fRight||((n["!outline"]||(n["!outline"]={})).left=!0);break;case 224:P.push(b);break;case 430:H.push([b]),H[H.length-1].XTI=[];break;case 35:case 547:H[H.length-1].push(b);break;case 24:case 536:D={Name:b.Name,Ref:or(b.rgce,i,null,H,L)},b.itab>0&&(D.Sheet=b.itab-1),H.names.push(D),H[0]||(H[0]=[],H[0].XTI=[]),H[H.length-1].push(b),b.Name=="_xlnm._FilterDatabase"&&b.itab>0&&b.rgce&&b.rgce[0]&&b.rgce[0][0]&&b.rgce[0][0][0]=="PtgArea3d"&&(R[b.itab-1]={ref:Ee(b.rgce[0][0][1][2])});break;case 22:L.ExternCount=b;break;case 23:H.length==0&&(H[0]=[],H[0].XTI=[]),H[H.length-1].XTI=H[H.length-1].XTI.concat(b),H.XTI=H.XTI.concat(b);break;case 2196:if(L.biff<8)break;D!=null&&(D.Comment=b[1]);break;case 18:n["!protect"]=b;break;case 19:b!==0&&L.WTF&&console.error("Password verifier: "+b);break;case 133:s[b.pos]=b,L.snames.push(b.name);break;case 10:{if(--he)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,n["!ref"]=Ee(i),t.sheetRows&&t.sheetRows<=i.e.r){var Se=i.e.r;i.e.r=t.sheetRows-1,n["!fullref"]=n["!ref"],n["!ref"]=Ee(i),i.e.r=Se}i.e.r++,i.e.c++}ce.length>0&&(n["!merges"]=ce),re.length>0&&(n["!objects"]=re),oe.length>0&&(n["!cols"]=oe),ie.length>0&&(n["!rows"]=ie),S.Sheets.push(W)}l===""?f=n:a[l]=n,n=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(L.biff===8&&(L.biff={9:2,521:3,1033:4}[ne]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[b.BIFFVer]||8),L.biffguess=b.BIFFVer==0,b.BIFFVer==0&&b.dt==4096&&(L.biff=5,q=!0,qr(L.codepage=28591)),L.biff==8&&b.BIFFVer==0&&b.dt==16&&(L.biff=2),he++)break;if(n=t.dense?[]:{},L.biff<8&&!q&&(q=!0,qr(L.codepage=t.codepage||1252)),L.biff<5||b.BIFFVer==0&&b.dt==4096){l===""&&(l="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var be={pos:e.l-Z,name:l};s[be.pos]=be,L.snames.push(l)}else l=(s[ee]||{name:""}).name;b.dt==32&&(n["!type"]="chart"),b.dt==64&&(n["!type"]="macro"),ce=[],re=[],L.arrayf=F=[],oe=[],ie=[],Ie=!1,W={Hidden:(s[ee]||{hs:0}).hs,name:l}}break;case 515:case 3:case 2:n["!type"]=="chart"&&(t.dense?(n[b.r]||[])[b.c]:n[de({c:b.c,r:b.r})])&&++b.c,v={ixfe:b.ixfe,XF:P[b.ixfe]||{},v:b.val,t:"n"},A>0&&(v.z=U[v.ixfe>>8&63]),Zr(v,t,r.opts.Date1904),V({c:b.c,r:b.r},v,t);break;case 5:case 517:v={ixfe:b.ixfe,XF:P[b.ixfe],v:b.val,t:b.t},A>0&&(v.z=U[v.ixfe>>8&63]),Zr(v,t,r.opts.Date1904),V({c:b.c,r:b.r},v,t);break;case 638:v={ixfe:b.ixfe,XF:P[b.ixfe],v:b.rknum,t:"n"},A>0&&(v.z=U[v.ixfe>>8&63]),Zr(v,t,r.opts.Date1904),V({c:b.c,r:b.r},v,t);break;case 189:for(var ve=b.c;ve<=b.C;++ve){var te=b.rkrec[ve-b.c][0];v={ixfe:te,XF:P[te],v:b.rkrec[ve-b.c][1],t:"n"},A>0&&(v.z=U[v.ixfe>>8&63]),Zr(v,t,r.opts.Date1904),V({c:ve,r:b.r},v,t)}break;case 6:case 518:case 1030:{if(b.val=="String"){o=b;break}if(v=On(b.val,b.cell.ixfe,b.tt),v.XF=P[v.ixfe],t.cellFormula){var Me=b.formula;if(Me&&Me[0]&&Me[0][0]&&Me[0][0][0]=="PtgExp"){var Dr=Me[0][0][1][0],Yr=Me[0][0][1][1],nt=de({r:Dr,c:Yr});y[nt]?v.f=""+or(b.formula,i,b.cell,H,L):v.F=((t.dense?(n[Dr]||[])[Yr]:n[nt])||{}).F}else v.f=""+or(b.formula,i,b.cell,H,L)}A>0&&(v.z=U[v.ixfe>>8&63]),Zr(v,t,r.opts.Date1904),V(b.cell,v,t),o=b}break;case 7:case 519:if(o)o.val=b,v=On(b,o.cell.ixfe,"s"),v.XF=P[v.ixfe],t.cellFormula&&(v.f=""+or(o.formula,i,o.cell,H,L)),A>0&&(v.z=U[v.ixfe>>8&63]),Zr(v,t,r.opts.Date1904),V(o.cell,v,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{F.push(b);var ka=de(b[0].s);if(d=t.dense?(n[b[0].s.r]||[])[b[0].s.c]:n[ka],t.cellFormula&&d){if(!o||!ka||!d)break;d.f=""+or(b[1],i,b[0],H,L),d.F=Ee(b[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!o)break;y[de(o.cell)]=b[0],d=t.dense?(n[o.cell.r]||[])[o.cell.c]:n[de(o.cell)],(d||{}).f=""+or(b[0],i,u,H,L)}}break;case 253:v=On(c[b.isst].t,b.ixfe,"s"),c[b.isst].h&&(v.h=c[b.isst].h),v.XF=P[v.ixfe],A>0&&(v.z=U[v.ixfe>>8&63]),Zr(v,t,r.opts.Date1904),V({c:b.c,r:b.r},v,t);break;case 513:t.sheetStubs&&(v={ixfe:b.ixfe,XF:P[b.ixfe],t:"z"},A>0&&(v.z=U[v.ixfe>>8&63]),Zr(v,t,r.opts.Date1904),V({c:b.c,r:b.r},v,t));break;case 190:if(t.sheetStubs)for(var xt=b.c;xt<=b.C;++xt){var Sr=b.ixfe[xt-b.c];v={ixfe:Sr,XF:P[Sr],t:"z"},A>0&&(v.z=U[v.ixfe>>8&63]),Zr(v,t,r.opts.Date1904),V({c:xt,r:b.r},v,t)}break;case 214:case 516:case 4:v=On(b.val,b.ixfe,"s"),v.XF=P[v.ixfe],A>0&&(v.z=U[v.ixfe>>8&63]),Zr(v,t,r.opts.Date1904),V({c:b.c,r:b.r},v,t);break;case 0:case 512:he===1&&(i=b);break;case 252:c=b;break;case 1054:if(L.biff==4){U[A++]=b[1];for(var st=0;st<A+163&&xe[st]!=b[1];++st);st>=163&&Ut(b[1],A+163)}else Ut(b[1],b[0]);break;case 30:{U[A++]=b;for(var mt=0;mt<A+163&&xe[mt]!=b;++mt);mt>=163&&Ut(b,A+163)}break;case 229:ce=ce.concat(b);break;case 93:re[b.cmo[0]]=L.lastobj=b;break;case 438:L.lastobj.TxO=b;break;case 127:L.lastobj.ImData=b;break;case 440:for(x=b[0].s.r;x<=b[0].e.r;++x)for(p=b[0].s.c;p<=b[0].e.c;++p)d=t.dense?(n[x]||[])[p]:n[de({c:p,r:x})],d&&(d.l=b[1]);break;case 2048:for(x=b[0].s.r;x<=b[0].e.r;++x)for(p=b[0].s.c;p<=b[0].e.c;++p)d=t.dense?(n[x]||[])[p]:n[de({c:p,r:x})],d&&d.l&&(d.l.Tooltip=b[1]);break;case 28:{if(L.biff<=5&&L.biff>=2)break;d=t.dense?(n[b[0].r]||[])[b[0].c]:n[de(b[0])];var Ta=re[b[2]];d||(t.dense?(n[b[0].r]||(n[b[0].r]=[]),d=n[b[0].r][b[0].c]={t:"z"}):d=n[de(b[0])]={t:"z"},i.e.r=Math.max(i.e.r,b[0].r),i.s.r=Math.min(i.s.r,b[0].r),i.e.c=Math.max(i.e.c,b[0].c),i.s.c=Math.min(i.s.c,b[0].c)),d.c||(d.c=[]),g={a:b[1],t:Ta.TxO.t},d.c.push(g)}break;case 2173:Hx(P[b.ixfe],b.ext);break;case 125:{if(!L.cellStyles)break;for(;b.e>=b.s;)oe[b.e--]={width:b.w/256,level:b.level||0,hidden:!!(b.flags&1)},Ie||(Ie=!0,Ai(b.w/256)),xa(oe[b.e+1])}break;case 520:{var dr={};b.level!=null&&(ie[b.r]=dr,dr.level=b.level),b.hidden&&(ie[b.r]=dr,dr.hidden=!0),b.hpt&&(ie[b.r]=dr,dr.hpt=b.hpt,dr.hpx=an(b.hpt))}break;case 38:case 39:case 40:case 41:n["!margins"]||za(n["!margins"]={}),n["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ne]]=b;break;case 161:n["!margins"]||za(n["!margins"]={}),n["!margins"].header=b.header,n["!margins"].footer=b.footer;break;case 574:b.RTL&&(S.Views[0].RTL=!0);break;case 146:I=b;break;case 2198:Y=b;break;case 140:C=b;break;case 442:l?W.CodeName=b||W.name:S.WBProps.CodeName=b||"ThisWorkbook";break}}else K||console.error("Missing Info for XLS Record 0x"+ne.toString(16)),e.l+=Z}return r.SheetNames=rt(s).sort(function(Jr,me){return Number(Jr)-Number(me)}).map(function(Jr){return s[Jr].name}),t.bookSheets||(r.Sheets=a),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&R.forEach(function(Jr,me){r.Sheets[r.SheetNames[me]]["!autofilter"]=Jr}),r.Strings=c,r.SSF=tr(xe),L.enc&&(r.Encryption=L.enc),Y&&(r.Themes=Y),r.Metadata={},C!==void 0&&(r.Metadata.Country=C),H.names.length>0&&(S.Names=H.names),r.Workbook=S,r}var ec={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function E_(e,t,r){var a=ye.find(e,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var n=Bo(a,$1,ec.DSI);for(var s in n)t[s]=n[s]}catch(l){if(r.WTF)throw l}var i=ye.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=Bo(i,U1,ec.SI);for(var c in o)t[c]==null&&(t[c]=o[c])}catch(l){if(r.WTF)throw l}t.HeadingPairs&&t.TitlesOfParts&&(H0(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function Al(e,t){t||(t={}),Oi(t),r0(),t.codepage&&li(t.codepage);var r,a;if(e.FullPaths){if(ye.find(e,"/encryption"))throw new Error("File is password-protected");r=ye.find(e,"!CompObj"),a=ye.find(e,"/Workbook")||ye.find(e,"/Book")}else{switch(t.type){case"base64":e=Gr(Or(e));break;case"binary":e=Gr(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}er(e,0),a={content:e}}var n,s;if(r&&v_(r),t.bookProps&&!t.bookSheets)n={};else{var i=_e?"buffer":"array";if(a&&a.content)n=y_(a.content,t);else if((s=ye.find(e,"PerfectOffice_MAIN"))&&s.content)n=Va.to_workbook(s.content,(t.type=i,t));else if((s=ye.find(e,"NativeContent_MAIN"))&&s.content)n=Va.to_workbook(s.content,(t.type=i,t));else throw(s=ye.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&ye.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=om(e))}var o={};return e.FullPaths&&E_(e,o,t),n.Props=n.Custprops=o,t.bookFiles&&(n.cfb=e),n}var Gn={0:{f:aw},1:{f:ow},2:{f:xw},3:{f:uw},4:{f:lw},5:{f:gw},6:{f:ww},7:{f:dw},8:{f:Tw},9:{f:kw},10:{f:yw},11:{f:Ew},12:{f:cw},13:{f:mw},14:{f:hw},15:{f:fw},16:{f:yl},17:{f:_w},18:{f:pw},19:{f:_i},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Jw},40:{},42:{},43:{f:yx},44:{f:_x},45:{f:Ex},46:{f:Tx},47:{f:kx},48:{},49:{f:S1},50:{},51:{f:Gx},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:rl},62:{f:vw},63:{f:Yx},64:{f:Rw},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ur,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Dw},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:iw},148:{f:nw,p:16},151:{f:bw},152:{},153:{f:Kw},154:{},155:{},156:{f:Xw},157:{},158:{},159:{T:1,f:Ug},160:{T:-1},161:{T:1,f:Zt},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Sw},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Vx},336:{T:-1},337:{f:zx,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Ds},357:{},358:{},359:{},360:{T:1},361:{},362:{f:el},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Fw},427:{f:Cw},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Ow},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:sw},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Aw},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Ds},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:nm},633:{T:1},634:{T:-1},635:{T:1,f:am},636:{T:-1},637:{f:b1},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:$w},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Pw},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Bs={6:{f:vs},10:{f:vt},12:{f:Ve},13:{f:Ve},14:{f:Ue},15:{f:Ue},16:{f:cr},17:{f:Ue},18:{f:Ue},19:{f:Ve},20:{f:jo},21:{f:jo},23:{f:el},24:{f:Ho},25:{f:Ue},26:{},27:{},28:{f:rg},29:{},34:{f:Ue},35:{f:Wo},38:{f:cr},39:{f:cr},40:{f:cr},41:{f:cr},42:{f:Ue},43:{f:Ue},47:{f:sx},49:{f:Np},51:{f:Ve},60:{},61:{f:Rp},64:{f:Ue},65:{f:Lp},66:{f:Ve},77:{},80:{},81:{},82:{},85:{f:Ve},89:{},90:{},91:{},92:{f:Sp},93:{f:ag},94:{},95:{f:Ue},96:{},97:{},99:{f:Ue},125:{f:rl},128:{f:zp},129:{f:Ap},130:{f:Ve},131:{f:Ue},132:{f:Ue},133:{f:bp},134:{},140:{f:lg},141:{f:Ve},144:{},146:{f:ug},151:{},152:{},153:{},154:{},155:{},156:{f:Ve},157:{},158:{},160:{f:xg},161:{f:dg},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:Wp},190:{f:Hp},193:{f:vt},197:{},198:{},199:{},200:{},201:{},202:{f:Ue},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Ve},220:{},221:{f:Ue},222:{},224:{f:Gp},225:{f:Tp},226:{f:vt},227:{},229:{f:tg},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Fp},253:{f:Bp},255:{f:Cp},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:X0},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Ue},353:{f:vt},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:Xp},431:{f:Ue},432:{},433:{},434:{},437:{},438:{f:ig},439:{f:Ue},440:{f:og},441:{},442:{f:un},443:{},444:{f:Ve},445:{},446:{},448:{f:vt},449:{f:Dp,r:2},450:{f:vt},512:{f:$o},513:{f:gg},515:{f:qp},516:{f:Mp},517:{f:Uo},519:{f:mg},520:{f:Ip},523:{},545:{f:Vo},549:{f:Mo},566:{},574:{f:Pp},638:{f:jp},659:{},1048:{},1054:{f:$p},1084:{},1212:{f:Zp},2048:{f:cg},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Fn},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:vt},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:hg,r:12},2173:{f:Wx,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Ue,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Jp,r:12},2197:{},2198:{f:Nx,r:12},2199:{},2200:{},2201:{},2202:{f:Qp,r:12},2203:{f:vt},2204:{},2205:{},2206:{},2207:{},2211:{f:Op},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Ve},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:pg},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:fg},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:$o},1:{},2:{f:yg},3:{f:_g},4:{f:wg},5:{f:Uo},7:{f:Eg},8:{},9:{f:Fn},11:{},22:{f:Ve},30:{f:Up},31:{},32:{},33:{f:Vo},36:{},37:{f:Mo},50:{f:kg},62:{},52:{},67:{},68:{f:Ve},69:{},86:{},126:{},127:{f:vg},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:Tg},223:{},234:{},354:{},421:{},518:{f:vs},521:{f:Fn},536:{f:Ho},547:{f:Wo},561:{},579:{},1030:{f:vs},1033:{f:Fn},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Wr(e,t,r,a){var n=t;if(!isNaN(n)){var s=(r||[]).length||0,i=e.next(4);i.write_shift(2,n),i.write_shift(2,s),s>0&&L0(r)&&e.push(r)}}function rc(e,t){var r=t||{},a=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var n=e.match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),i=n.index,o=s&&s.index||e.length,c=qd(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),l=-1,f=0,u=0,h=0,d={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(i=0;i<c.length;++i){var p=c[i].trim(),x=p.slice(0,3).toLowerCase();if(x=="<tr"){if(++l,r.sheetRows&&r.sheetRows<=l){--l;break}f=0;continue}if(!(x!="<td"&&x!="<th")){var y=p.split(/<\/t[dh]>/i);for(o=0;o<y.length;++o){var F=y[o].trim();if(F.match(/<t[dh]/i)){for(var v=F,C=0;v.charAt(0)=="<"&&(C=v.indexOf(">"))>-1;)v=v.slice(C+1);for(var P=0;P<g.length;++P){var I=g[P];I.s.c==f&&I.s.r<l&&l<=I.e.r&&(f=I.e.c+1,P=-1)}var S=fe(F.slice(0,F.indexOf(">")));h=S.colspan?+S.colspan:1,((u=+S.rowspan)>1||h>1)&&g.push({s:{r:l,c:f},e:{r:l+(u||1)-1,c:f+h-1}});var W=S.t||S["data-t"]||"";if(!v.length){f+=h;continue}if(v=E0(v),d.s.r>l&&(d.s.r=l),d.e.r<l&&(d.e.r=l),d.s.c>f&&(d.s.c=f),d.e.c<f&&(d.e.c=f),!v.length){f+=h;continue}var O={t:"s",v};r.raw||!v.trim().length||W=="s"||(v==="TRUE"?O={t:"b",v:!0}:v==="FALSE"?O={t:"b",v:!1}:isNaN(Kr(v))?isNaN(ga(v).getDate())||(O={t:"d",v:Qe(v)},r.cellDates||(O={t:"n",v:wr(O.v)}),O.z=r.dateNF||xe[14]):O={t:"n",v:Kr(v)}),r.dense?(a[l]||(a[l]=[]),a[l][f]=O):a[de({r:l,c:f})]=O,f+=h}}}}return a["!ref"]=Ee(d),g.length&&(a["!merges"]=g),a}function k_(e,t,r,a){for(var n=e["!merges"]||[],s=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,c=0,l=0;l<n.length;++l)if(!(n[l].s.r>r||n[l].s.c>i)&&!(n[l].e.r<r||n[l].e.c<i)){if(n[l].s.r<r||n[l].s.c<i){o=-1;break}o=n[l].e.r-n[l].s.r+1,c=n[l].e.c-n[l].s.c+1;break}if(!(o<0)){var f=de({r,c:i}),u=a.dense?(e[r]||[])[i]:e[f],h=u&&u.v!=null&&(u.h||gi(u.w||(pt(u),u.w)||""))||"",d={};o>1&&(d.rowspan=o),c>1&&(d.colspan=c),a.editable?h='<span contenteditable="true">'+h+"</span>":u&&(d["data-t"]=u&&u.t||"z",u.v!=null&&(d["data-v"]=u.v),u.z!=null&&(d["data-z"]=u.z),u.l&&(u.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+u.l.Target+'">'+h+"</a>")),d.id=(a.id||"sjs")+"-"+f,s.push(l1("td",h,d))}}var g="<tr>";return g+s.join("")+"</tr>"}var T_='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',S_="</body></html>";function A_(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Dt(rc(r[0],t),t);var a=Ri();return r.forEach(function(n,s){Pi(a,rc(n,t),"Sheet"+(s+1))}),a}function b_(e,t,r){var a=[];return a.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function F_(e,t){var r=t||{},a=r.header!=null?r.header:T_,n=r.footer!=null?r.footer:S_,s=[a],i=ya(e["!ref"]);r.dense=Array.isArray(e),s.push(b_(e,i,r));for(var o=i.s.r;o<=i.e.r;++o)s.push(k_(e,i,o,r));return s.push("</table>"+n),s.join("")}function bl(e,t,r){var a=r||{},n=0,s=0;if(a.origin!=null)if(typeof a.origin=="number")n=a.origin;else{var i=typeof a.origin=="string"?mr(a.origin):a.origin;n=i.r,s=i.c}var o=t.getElementsByTagName("tr"),c=Math.min(a.sheetRows||1e7,o.length),l={s:{r:0,c:0},e:{r:n,c:s}};if(e["!ref"]){var f=ya(e["!ref"]);l.s.r=Math.min(l.s.r,f.s.r),l.s.c=Math.min(l.s.c,f.s.c),l.e.r=Math.max(l.e.r,f.e.r),l.e.c=Math.max(l.e.c,f.e.c),n==-1&&(l.e.r=n=f.e.r+1)}var u=[],h=0,d=e["!rows"]||(e["!rows"]=[]),g=0,p=0,x=0,y=0,F=0,v=0;for(e["!cols"]||(e["!cols"]=[]);g<o.length&&p<c;++g){var C=o[g];if(tc(C)){if(a.display)continue;d[p]={hidden:!0}}var P=C.children;for(x=y=0;x<P.length;++x){var I=P[x];if(!(a.display&&tc(I))){var S=I.hasAttribute("data-v")?I.getAttribute("data-v"):I.hasAttribute("v")?I.getAttribute("v"):E0(I.innerHTML),W=I.getAttribute("data-z")||I.getAttribute("z");for(h=0;h<u.length;++h){var O=u[h];O.s.c==y+s&&O.s.r<p+n&&p+n<=O.e.r&&(y=O.e.c+1-s,h=-1)}v=+I.getAttribute("colspan")||1,((F=+I.getAttribute("rowspan")||1)>1||v>1)&&u.push({s:{r:p+n,c:y+s},e:{r:p+n+(F||1)-1,c:y+s+(v||1)-1}});var z={t:"s",v:S},V=I.getAttribute("data-t")||I.getAttribute("t")||"";S!=null&&(S.length==0?z.t=V||"z":a.raw||S.trim().length==0||V=="s"||(S==="TRUE"?z={t:"b",v:!0}:S==="FALSE"?z={t:"b",v:!1}:isNaN(Kr(S))?isNaN(ga(S).getDate())||(z={t:"d",v:Qe(S)},a.cellDates||(z={t:"n",v:wr(z.v)}),z.z=a.dateNF||xe[14]):z={t:"n",v:Kr(S)})),z.z===void 0&&W!=null&&(z.z=W);var L="",Y=I.getElementsByTagName("A");if(Y&&Y.length)for(var ce=0;ce<Y.length&&!(Y[ce].hasAttribute("href")&&(L=Y[ce].getAttribute("href"),L.charAt(0)!="#"));++ce);L&&L.charAt(0)!="#"&&(z.l={Target:L}),a.dense?(e[p+n]||(e[p+n]=[]),e[p+n][y+s]=z):e[de({c:y+s,r:p+n})]=z,l.e.c<y+s&&(l.e.c=y+s),y+=v}}++p}return u.length&&(e["!merges"]=(e["!merges"]||[]).concat(u)),l.e.r=Math.max(l.e.r,p-1+n),e["!ref"]=Ee(l),p>=c&&(e["!fullref"]=Ee((l.e.r=o.length-g+p-1+n,l))),e}function Fl(e,t){var r=t||{},a=r.dense?[]:{};return bl(a,e,t)}function C_(e,t){return Dt(Fl(e,t),t)}function tc(e){var t="",r=I_(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function I_(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function O_(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,n){return Array(parseInt(n,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Te(t.replace(/<[^>]*>/g,""));return[r]}var ac={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Cl(e,t){var r=t||{},a=xi(e),n=[],s,i,o={name:""},c="",l=0,f,u,h={},d=[],g=r.dense?[]:{},p,x,y={value:""},F="",v=0,C=[],P=-1,I=-1,S={s:{r:1e6,c:1e7},e:{r:0,c:0}},W=0,O={},z=[],V={},L=0,Y=0,ce=[],re=1,oe=1,ie=[],Ie={Names:[]},H={},ue=["",""],he=[],A={},U="",R=0,D=!1,q=!1,ee=0;for(en.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=en.exec(a);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"工作表":p[1]==="/"?(S.e.c>=S.s.c&&S.e.r>=S.s.r?g["!ref"]=Ee(S):g["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=S.e.r&&(g["!fullref"]=g["!ref"],S.e.r=r.sheetRows-1,g["!ref"]=Ee(S)),z.length&&(g["!merges"]=z),ce.length&&(g["!rows"]=ce),f.name=f.名称||f.name,typeof JSON<"u"&&JSON.stringify(f),d.push(f.name),h[f.name]=g,q=!1):p[0].charAt(p[0].length-2)!=="/"&&(f=fe(p[0],!1),P=I=-1,S.s.r=S.s.c=1e7,S.e.r=S.e.c=0,g=r.dense?[]:{},z=[],ce=[],q=!0);break;case"table-row-group":p[1]==="/"?--W:++W;break;case"table-row":case"行":if(p[1]==="/"){P+=re,re=1;break}if(u=fe(p[0],!1),u.行号?P=u.行号-1:P==-1&&(P=0),re=+u["number-rows-repeated"]||1,re<10)for(ee=0;ee<re;++ee)W>0&&(ce[P+ee]={level:W});I=-1;break;case"covered-table-cell":p[1]!=="/"&&++I,r.sheetStubs&&(r.dense?(g[P]||(g[P]=[]),g[P][I]={t:"z"}):g[de({r:P,c:I})]={t:"z"}),F="",C=[];break;case"table-cell":case"数据":if(p[0].charAt(p[0].length-2)==="/")++I,y=fe(p[0],!1),oe=parseInt(y["number-columns-repeated"]||"1",10),x={t:"z",v:null},y.formula&&r.cellFormula!=!1&&(x.f=Jo(Te(y.formula))),(y.数据类型||y["value-type"])=="string"&&(x.t="s",x.v=Te(y["string-value"]||""),r.dense?(g[P]||(g[P]=[]),g[P][I]=x):g[de({r:P,c:I})]=x),I+=oe-1;else if(p[1]!=="/"){++I,F="",v=0,C=[],oe=1;var ne=re?P+re-1:P;if(I>S.e.c&&(S.e.c=I),I<S.s.c&&(S.s.c=I),P<S.s.r&&(S.s.r=P),ne>S.e.r&&(S.e.r=ne),y=fe(p[0],!1),he=[],A={},x={t:y.数据类型||y["value-type"],v:null},r.cellFormula)if(y.formula&&(y.formula=Te(y.formula)),y["number-matrix-columns-spanned"]&&y["number-matrix-rows-spanned"]&&(L=parseInt(y["number-matrix-rows-spanned"],10)||0,Y=parseInt(y["number-matrix-columns-spanned"],10)||0,V={s:{r:P,c:I},e:{r:P+L-1,c:I+Y-1}},x.F=Ee(V),ie.push([V,x.F])),y.formula)x.f=Jo(y.formula);else for(ee=0;ee<ie.length;++ee)P>=ie[ee][0].s.r&&P<=ie[ee][0].e.r&&I>=ie[ee][0].s.c&&I<=ie[ee][0].e.c&&(x.F=ie[ee][1]);switch((y["number-columns-spanned"]||y["number-rows-spanned"])&&(L=parseInt(y["number-rows-spanned"],10)||0,Y=parseInt(y["number-columns-spanned"],10)||0,V={s:{r:P,c:I},e:{r:P+L-1,c:I+Y-1}},z.push(V)),y["number-columns-repeated"]&&(oe=parseInt(y["number-columns-repeated"],10)),x.t){case"boolean":x.t="b",x.v=De(y["boolean-value"]);break;case"float":x.t="n",x.v=parseFloat(y.value);break;case"percentage":x.t="n",x.v=parseFloat(y.value);break;case"currency":x.t="n",x.v=parseFloat(y.value);break;case"date":x.t="d",x.v=Qe(y["date-value"]),r.cellDates||(x.t="n",x.v=wr(x.v)),x.z="m/d/yy";break;case"time":x.t="n",x.v=Vd(y["time-value"])/86400,r.cellDates&&(x.t="d",x.v=Qn(x.v)),x.z="HH:MM:SS";break;case"number":x.t="n",x.v=parseFloat(y.数据数值);break;default:if(x.t==="string"||x.t==="text"||!x.t)x.t="s",y["string-value"]!=null&&(F=Te(y["string-value"]),C=[]);else throw new Error("Unsupported value type "+x.t)}}else{if(D=!1,x.t==="s"&&(x.v=F||"",C.length&&(x.R=C),D=v==0),H.Target&&(x.l=H),he.length>0&&(x.c=he,he=[]),F&&r.cellText!==!1&&(x.w=F),D&&(x.t="z",delete x.v),(!D||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=P))for(var Z=0;Z<re;++Z){if(oe=parseInt(y["number-columns-repeated"]||"1",10),r.dense)for(g[P+Z]||(g[P+Z]=[]),g[P+Z][I]=Z==0?x:tr(x);--oe>0;)g[P+Z][I+oe]=tr(x);else for(g[de({r:P+Z,c:I})]=x;--oe>0;)g[de({r:P+Z,c:I+oe})]=tr(x);S.e.c<=I&&(S.e.c=I)}oe=parseInt(y["number-columns-repeated"]||"1",10),I+=oe-1,oe=0,x={},F="",C=[]}H={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((s=n.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&n.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((s=n.pop())[0]!==p[3])throw"Bad state: "+s;A.t=F,C.length&&(A.R=C),A.a=U,he.push(A)}else p[0].charAt(p[0].length-2)!=="/"&&n.push([p[3],!1]);U="",R=0,F="",v=0,C=[];break;case"creator":p[1]==="/"?U=a.slice(R,p.index):R=p.index+p[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((s=n.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&n.push([p[3],!1]);F="",v=0,C=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(O[o.name]=c,(s=n.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&(c="",o=fe(p[0],!1),n.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(n[n.length-1][0]){case"time-style":case"date-style":i=fe(p[0],!1),c+=ac[p[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(n[n.length-1][0]){case"time-style":case"date-style":i=fe(p[0],!1),c+=ac[p[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(n[n.length-1][0]){case"number-style":case"date-style":case"time-style":c+=a.slice(l,p.index);break}else l=p.index+p[0].length;break;case"named-range":i=fe(p[0],!1),ue=ws(i["cell-range-address"]);var K={Name:i.name,Ref:ue[0]+"!"+ue[1]};q&&(K.Sheet=d.length),Ie.Names.push(K);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(n[n.length-1][0])>-1)break;if(p[1]==="/"&&(!y||!y["string-value"])){var ke=O_(a.slice(v,p.index));F=(F.length>0?F+`
`:"")+ke[0]}else fe(p[0],!1),v=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{ue=ws(fe(p[0])["target-range-address"]),h[ue[0]]["!autofilter"]={ref:ue[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(H=fe(p[0],!1),!H.href)break;H.Target=Te(H.href),delete H.href,H.Target.charAt(0)=="#"&&H.Target.indexOf(".")>-1?(ue=ws(H.Target.slice(1)),H.Target="#"+ue[0]+"!"+ue[1]):H.Target.match(/^\.\.[\\\/]/)&&(H.Target=H.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(r.WTF)throw new Error(p)}}var b={Sheets:h,SheetNames:d,Workbook:Ie};return r.bookSheets&&delete b.Sheets,b}function nc(e,t){t=t||{},Nr(e,"META-INF/manifest.xml")&&q1(He(e,"META-INF/manifest.xml"),t);var r=Fr(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var a=Cl(Ce(r),t);return Nr(e,"meta.xml")&&(a.Props=W0(He(e,"meta.xml"))),a}function sc(e,t){return Cl(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Ci(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Ms(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Ce(Yt(e))}function $s(e){var t=e.reduce(function(n,s){return n+s.length},0),r=new Uint8Array(t),a=0;return e.forEach(function(n){r.set(n,a),a+=n.length}),r}function ic(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function D_(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,a=e[t+14]&1,n=t+13;n>=t;--n)a=a*256+e[n];return(e[t+15]&128?-a:a)*Math.pow(10,r-6176)}function nn(e,t){var r=t?t[0]:0,a=e[r]&127;e:if(e[r++]>=128&&(a|=(e[r]&127)<<7,e[r++]<128||(a|=(e[r]&127)<<14,e[r++]<128)||(a|=(e[r]&127)<<21,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),a}function Xe(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function lr(e){for(var t=[],r=[0];r[0]<e.length;){var a=r[0],n=nn(e,r),s=n&7;n=Math.floor(n/8);var i=0,o;if(n==0)break;switch(s){case 0:{for(var c=r[0];e[r[0]++]>=128;);o=e.slice(c,r[0])}break;case 5:i=4,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=nn(e,r),o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(n," at offset ").concat(a))}var l={data:o,type:s};t[n]==null?t[n]=[l]:t[n].push(l)}return t}function Ii(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function R_(e){for(var t,r=[],a=[0];a[0]<e.length;){var n=nn(e,a),s=lr(e.slice(a[0],a[0]+n));a[0]+=n;var i={id:Xe(s[1][0].data),messages:[]};s[2].forEach(function(o){var c=lr(o.data),l=Xe(c[3][0].data);i.messages.push({meta:c,data:e.slice(a[0],a[0]+l)}),a[0]+=l}),(t=s[3])!=null&&t[0]&&(i.merge=Xe(s[3][0].data)>>>0>0),r.push(i)}return r}function P_(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],a=nn(t,r),n=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=t[r[0]],o>1&&(i|=t[r[0]+1]<<8),o>2&&(i|=t[r[0]+2]<<16),o>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}n.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var c=0,l=0;if(s==1?(l=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(l=(t[r[0]++]>>2)+1,s==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),n=[$s(n)],c==0)throw new Error("Invalid offset 0");if(c>n[0].length)throw new Error("Invalid offset beyond length");if(l>=c)for(n.push(n[0].slice(-c)),l-=c;l>=n[n.length-1].length;)n.push(n[n.length-1]),l-=n[n.length-1].length;n.push(n[0].slice(-c,-c+l))}}var f=$s(n);if(f.length!=a)throw new Error("Unexpected length: ".concat(f.length," != ").concat(a));return f}function L_(e){for(var t=[],r=0;r<e.length;){var a=e[r++],n=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(P_(a,e.slice(r,r+n))),r+=n}if(r!==e.length)throw new Error("data is not a valid framed stream!");return $s(t)}function N_(e,t,r,a){var n=Ci(e),s=n.getUint32(4,!0),i=(a>1?12:8)+ic(s&(a>1?3470:398))*4,o=-1,c=-1,l=NaN,f=new Date(2001,0,1);s&512&&(o=n.getUint32(i,!0),i+=4),i+=ic(s&(a>1?12288:4096))*4,s&16&&(c=n.getUint32(i,!0),i+=4),s&32&&(l=n.getFloat64(i,!0),i+=8),s&64&&(f.setTime(f.getTime()+n.getFloat64(i,!0)*1e3),i+=8);var u;switch(e[2]){case 0:break;case 2:u={t:"n",v:l};break;case 3:u={t:"s",v:t[c]};break;case 5:u={t:"d",v:f};break;case 6:u={t:"b",v:l>0};break;case 7:u={t:"n",v:l/86400};break;case 8:u={t:"e",v:0};break;case 9:if(o>-1)u={t:"s",v:r[o]};else if(c>-1)u={t:"s",v:t[c]};else if(!isNaN(l))u={t:"n",v:l};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return u}function B_(e,t,r){var a=Ci(e),n=a.getUint32(8,!0),s=12,i=-1,o=-1,c=NaN,l=NaN,f=new Date(2001,0,1);n&1&&(c=D_(e,s),s+=16),n&2&&(l=a.getFloat64(s,!0),s+=8),n&4&&(f.setTime(f.getTime()+a.getFloat64(s,!0)*1e3),s+=8),n&8&&(o=a.getUint32(s,!0),s+=4),n&16&&(i=a.getUint32(s,!0),s+=4);var u;switch(e[1]){case 0:break;case 2:u={t:"n",v:c};break;case 3:u={t:"s",v:t[o]};break;case 5:u={t:"d",v:f};break;case 6:u={t:"b",v:l>0};break;case 7:u={t:"n",v:l/86400};break;case 8:u={t:"e",v:0};break;case 9:if(i>-1)u={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)));break;case 10:u={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)))}return u}function M_(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return N_(e,t,r,e[0]);case 5:return B_(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function bt(e){var t=lr(e);return nn(t[1][0].data)}function oc(e,t){var r=lr(t.data),a=Xe(r[1][0].data),n=r[3],s=[];return(n||[]).forEach(function(i){var o=lr(i.data),c=Xe(o[1][0].data)>>>0;switch(a){case 1:s[c]=Ms(o[3][0].data);break;case 8:{var l=e[bt(o[9][0].data)][0],f=lr(l.data),u=e[bt(f[1][0].data)][0],h=Xe(u.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var d=lr(u.data);s[c]=d[3].map(function(g){return Ms(g.data)}).join("")}break}}),s}function $_(e,t){var r,a,n,s,i,o,c,l,f,u,h,d,g,p,x=lr(e),y=Xe(x[1][0].data)>>>0,F=Xe(x[2][0].data)>>>0,v=((a=(r=x[8])==null?void 0:r[0])==null?void 0:a.data)&&Xe(x[8][0].data)>0||!1,C,P;if((s=(n=x[7])==null?void 0:n[0])!=null&&s.data&&t!=0)C=(o=(i=x[7])==null?void 0:i[0])==null?void 0:o.data,P=(l=(c=x[6])==null?void 0:c[0])==null?void 0:l.data;else if((u=(f=x[4])==null?void 0:f[0])!=null&&u.data&&t!=1)C=(d=(h=x[4])==null?void 0:h[0])==null?void 0:d.data,P=(p=(g=x[3])==null?void 0:g[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var I=v?4:1,S=Ci(C),W=[],O=0;O<C.length/2;++O){var z=S.getUint16(O*2,!0);z<65535&&W.push([O,z])}if(W.length!=F)throw"Expected ".concat(F," cells, found ").concat(W.length);var V=[];for(O=0;O<W.length-1;++O)V[W[O][0]]=P.subarray(W[O][1]*I,W[O+1][1]*I);return W.length>=1&&(V[W[W.length-1][0]]=P.subarray(W[W.length-1][1]*I)),{R:y,cells:V}}function U_(e,t){var r,a=lr(t.data),n=(r=a==null?void 0:a[7])!=null&&r[0]?Xe(a[7][0].data)>>>0>0?1:0:-1,s=Ii(a[5],function(i){return $_(i,n)});return{nrows:Xe(a[4][0].data)>>>0,data:s.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(c,l){if(i[o.R][l])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(l));i[o.R][l]=c}),i},[])}}function j_(e,t,r){var a,n=lr(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Xe(n[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(s.e.c=(Xe(n[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));r["!ref"]=Ee(s);var i=lr(n[4][0].data),o=oc(e,e[bt(i[4][0].data)][0]),c=(a=i[17])!=null&&a[0]?oc(e,e[bt(i[17][0].data)][0]):[],l=lr(i[3][0].data),f=0;l[1].forEach(function(u){var h=lr(u.data),d=e[bt(h[2][0].data)][0],g=Xe(d.meta[1][0].data);if(g!=6002)throw new Error("6001 unexpected reference to ".concat(g));var p=U_(e,d);p.data.forEach(function(x,y){x.forEach(function(F,v){var C=de({r:f+y,c:v}),P=M_(F,o,c);P&&(r[C]=P)})}),f+=p.nrows})}function W_(e,t){var r=lr(t.data),a={"!ref":"A1"},n=e[bt(r[2][0].data)],s=Xe(n[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return j_(e,n[0],a),a}function H_(e,t){var r,a=lr(t.data),n={name:(r=a[1])!=null&&r[0]?Ms(a[1][0].data):"",sheets:[]},s=Ii(a[2],bt);return s.forEach(function(i){e[i].forEach(function(o){var c=Xe(o.meta[1][0].data);c==6e3&&n.sheets.push(W_(e,o))})}),n}function V_(e,t){var r=Ri(),a=lr(t.data),n=Ii(a[1],bt);if(n.forEach(function(s){e[s].forEach(function(i){var o=Xe(i.meta[1][0].data);if(o==2){var c=H_(e,i);c.sheets.forEach(function(l,f){Pi(r,l,f==0?c.name:c.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function ys(e){var t,r,a,n,s={},i=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var l;try{l=L_(c.content)}catch(u){return console.log("?? "+c.content.length+" "+(u.message||u))}var f;try{f=R_(l)}catch(u){return console.log("## "+(u.message||u))}f.forEach(function(u){s[u.id]=u.messages,i.push(u.id)})}}),!i.length)throw new Error("File has no messages");var o=((n=(a=(r=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:a[1])==null?void 0:n[0].data)&&Xe(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||i.forEach(function(c){s[c].forEach(function(l){var f=Xe(l.meta[1][0].data)>>>0;if(f==1)if(!o)o=l;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return V_(s,o)}function G_(e){return function(r){for(var a=0;a!=e.length;++a){var n=e[a];r[n[0]]===void 0&&(r[n[0]]=n[1]),n[2]==="n"&&(r[n[0]]=Number(r[n[0]]))}}}function Oi(e){G_([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function z_(e){return ca.WS.indexOf(e)>-1?"sheet":e==ca.CS?"chart":e==ca.DS?"dialog":e==ca.MS?"macro":e&&e.length?e:"sheet"}function q_(e,t){if(!e)return 0;try{e=t.map(function(a){return a.id||(a.id=a.strRelID),[a.name,e["!id"][a.id].Target,z_(e["!id"][a.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function X_(e,t,r,a,n,s,i,o,c,l,f,u){try{s[a]=Wa(Fr(e,r,!0),t);var h=He(e,t),d;switch(o){case"sheet":d=e_(h,t,n,c,s[a],l,f,u);break;case"chart":if(d=r_(h,t,n,c,s[a],l,f,u),!d||!d["!drawel"])break;var g=Ra(d["!drawel"].Target,t),p=Rs(g),x=Qx(Fr(e,g,!0),Wa(Fr(e,p,!0),g)),y=Ra(x,g),F=Rs(y);d=Bw(Fr(e,y,!0),y,c,Wa(Fr(e,F,!0),y),l,d);break;case"macro":d=t_(h,t,n,c,s[a],l,f,u);break;case"dialog":d=a_(h,t,n,c,s[a],l,f,u);break;default:throw new Error("Unrecognized sheet type "+o)}i[a]=d;var v=[];s&&s[a]&&rt(s[a]).forEach(function(C){var P="";if(s[a][C].Type==ca.CMNT){P=Ra(s[a][C].Target,t);var I=o_(He(e,P,!0),P,c);if(!I||!I.length)return;zo(d,I,!1)}s[a][C].Type==ca.TCMNT&&(P=Ra(s[a][C].Target,t),v=v.concat(rm(He(e,P,!0),c)))}),v&&v.length&&zo(d,v,!0,c.people||[])}catch(C){if(c.WTF)throw C}}function Pr(e){return e.charAt(0)=="/"?e.slice(1):e}function K_(e,t){if(d0(),t=t||{},Oi(t),Nr(e,"META-INF/manifest.xml")||Nr(e,"objectdata.xml"))return nc(e,t);if(Nr(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof ys<"u"){if(e.FileIndex)return ys(e);var r=ye.utils.cfb_new();return wo(e).forEach(function(ce){Yd(r,ce,Kd(e,ce))}),ys(r)}throw new Error("Unsupported NUMBERS file")}if(!Nr(e,"[Content_Types].xml"))throw Nr(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Nr(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=wo(e),n=G1(Fr(e,"[Content_Types].xml")),s=!1,i,o;if(n.workbooks.length===0&&(o="xl/workbook.xml",He(e,o,!0)&&n.workbooks.push(o)),n.workbooks.length===0){if(o="xl/workbook.bin",!He(e,o,!0))throw new Error("Could not find workbook");n.workbooks.push(o),s=!0}n.workbooks[0].slice(-3)=="bin"&&(s=!0);var c={},l={};if(!t.bookSheets&&!t.bookProps){if(Ga=[],n.sst)try{Ga=i_(He(e,Pr(n.sst)),n.sst,t)}catch(ce){if(t.WTF)throw ce}t.cellStyles&&n.themes.length&&(c=s_(Fr(e,n.themes[0].replace(/^\//,""),!0)||"",n.themes[0],t)),n.style&&(l=n_(He(e,Pr(n.style)),n.style,c,t))}n.links.map(function(ce){try{var re=Wa(Fr(e,Rs(Pr(ce))),ce);return l_(He(e,Pr(ce)),re,ce,t)}catch{}});var f=Qw(He(e,Pr(n.workbooks[0])),n.workbooks[0],t),u={},h="";n.coreprops.length&&(h=He(e,Pr(n.coreprops[0]),!0),h&&(u=W0(h)),n.extprops.length!==0&&(h=He(e,Pr(n.extprops[0]),!0),h&&Y1(h,u,t)));var d={};(!t.bookSheets||t.bookProps)&&n.custprops.length!==0&&(h=Fr(e,Pr(n.custprops[0]),!0),h&&(d=Z1(h,t)));var g={};if((t.bookSheets||t.bookProps)&&(f.Sheets?i=f.Sheets.map(function(re){return re.name}):u.Worksheets&&u.SheetNames.length>0&&(i=u.SheetNames),t.bookProps&&(g.Props=u,g.Custprops=d),t.bookSheets&&typeof i<"u"&&(g.SheetNames=i),t.bookSheets?g.SheetNames:t.bookProps))return g;i={};var p={};t.bookDeps&&n.calcchain&&(p=c_(He(e,Pr(n.calcchain)),n.calcchain));var x=0,y={},F,v;{var C=f.Sheets;u.Worksheets=C.length,u.SheetNames=[];for(var P=0;P!=C.length;++P)u.SheetNames[P]=C[P].name}var I=s?"bin":"xml",S=n.workbooks[0].lastIndexOf("/"),W=(n.workbooks[0].slice(0,S+1)+"_rels/"+n.workbooks[0].slice(S+1)+".rels").replace(/^\//,"");Nr(e,W)||(W="xl/_rels/workbook."+I+".rels");var O=Wa(Fr(e,W,!0),W.replace(/_rels.*/,"s5s"));(n.metadata||[]).length>=1&&(t.xlmeta=f_(He(e,Pr(n.metadata[0])),n.metadata[0],t)),(n.people||[]).length>=1&&(t.people=tm(He(e,Pr(n.people[0])),t)),O&&(O=q_(O,f.Sheets));var z=He(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(x=0;x!=u.Worksheets;++x){var V="sheet";if(O&&O[x]?(F="xl/"+O[x][1].replace(/[\/]?xl\//,""),Nr(e,F)||(F=O[x][1]),Nr(e,F)||(F=W.replace(/_rels\/.*$/,"")+O[x][1]),V=O[x][2]):(F="xl/worksheets/sheet"+(x+1-z)+"."+I,F=F.replace(/sheet0\./,"sheet.")),v=F.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(x!=t.sheets)continue e;break;case"string":if(u.SheetNames[x].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var L=!1,Y=0;Y!=t.sheets.length;++Y)typeof t.sheets[Y]=="number"&&t.sheets[Y]==x&&(L=1),typeof t.sheets[Y]=="string"&&t.sheets[Y].toLowerCase()==u.SheetNames[x].toLowerCase()&&(L=1);if(!L)continue e}}X_(e,F,v,u.SheetNames[x],x,y,i,V,t,f,c,l)}return g={Directory:n,Workbook:f,Props:u,Custprops:d,Deps:p,Sheets:i,SheetNames:u.SheetNames,Strings:Ga,Styles:l,Themes:c,SSF:tr(xe)},t&&t.bookFiles&&(e.files?(g.keys=a,g.files=e.files):(g.keys=[],g.files={},e.FullPaths.forEach(function(ce,re){ce=ce.replace(/^Root Entry[\/]/,""),g.keys.push(ce),g.files[ce]=e.FileIndex[re]}))),t&&t.bookVBA&&(n.vba.length>0?g.vbaraw=He(e,Pr(n.vba[0]),!0):n.defaults&&n.defaults.bin===im&&(g.vbaraw=He(e,"xl/vbaProject.bin",!0))),g}function Y_(e,t){var r=t||{},a="Workbook",n=ye.find(e,a);try{if(a="/!DataSpaces/Version",n=ye.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(Wg(n.content),a="/!DataSpaces/DataSpaceMap",n=ye.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var s=Vg(n.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",n=ye.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var i=Gg(n.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",n=ye.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);qg(n.content)}catch{}if(a="/EncryptionInfo",n=ye.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var o=Xg(n.content);if(a="/EncryptedPackage",n=ye.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],n.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],n.content,r.password||"",r);throw new Error("File is password-protected")}function Di(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Or(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function J_(e,t){return ye.find(e,"EncryptedPackage")?Y_(e,t):Al(e,t)}function Z_(e,t){var r,a=e,n=t||{};return n.type||(n.type=_e&&Buffer.isBuffer(e)?"buffer":"base64"),r=w0(a,n),K_(r,n)}function Il(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Ns(e.slice(r),t);default:break e}return rn.to_workbook(e,t)}function Q_(e,t){var r="",a=Di(e,t);switch(t.type){case"base64":r=Or(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Ht(e);break;default:throw new Error("Unrecognized type "+t.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(r=Ce(r)),t.type="binary",Il(r,t)}function e2(e,t){var r=e;return t.type=="base64"&&(r=Or(r)),r=Ja.utils.decode(1200,r.slice(2),"str"),t.type="binary",Il(r,t)}function r2(e){return e.match(/[^\x00-\x7F]/)?Pa(e):e}function Es(e,t,r,a){return a?(r.type="string",rn.to_workbook(e,r)):rn.to_workbook(t,r)}function Us(e,t){r0();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Us(new Uint8Array(e),(r=tr(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var a=e,n=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),ha={},r.dateNF&&(ha.dateNF=r.dateNF),r.type||(r.type=_e&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=_e?"buffer":"binary",a=Wd(e),typeof Uint8Array<"u"&&!_e&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,a=r2(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return r=tr(r),r.type="array",Us(fi(a),r)}switch((n=Di(a,r))[0]){case 208:if(n[1]===207&&n[2]===17&&n[3]===224&&n[4]===161&&n[5]===177&&n[6]===26&&n[7]===225)return J_(ye.read(a,r),r);break;case 9:if(n[1]<=8)return Al(a,r);break;case 60:return Ns(a,r);case 73:if(n[1]===73&&n[2]===42&&n[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(n[1]===68)return Cg(a,r);break;case 84:if(n[1]===65&&n[2]===66&&n[3]===76)return bg.to_workbook(a,r);break;case 80:return n[1]===75&&n[2]<9&&n[3]<9?Z_(a,r):Es(e,a,r,s);case 239:return n[3]===60?Ns(a,r):Es(e,a,r,s);case 255:if(n[1]===254)return e2(a,r);if(n[1]===0&&n[2]===2&&n[3]===0)return Va.to_workbook(a,r);break;case 0:if(n[1]===0&&(n[2]>=2&&n[3]===0||n[2]===0&&(n[3]===8||n[3]===9)))return Va.to_workbook(a,r);break;case 3:case 131:case 139:case 140:return Go.to_workbook(a,r);case 123:if(n[1]===92&&n[2]===114&&n[3]===116)return ix.to_workbook(a,r);break;case 10:case 13:case 32:return Q_(a,r);case 137:if(n[1]===80&&n[2]===78&&n[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return Sg.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?Go.to_workbook(a,r):Es(e,a,r,s)}function t2(e,t,r,a,n,s,i,o){var c=ar(r),l=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),u=!0,h=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!i||e[r])for(var d=t.s.c;d<=t.e.c;++d){var g=i?e[r][d]:e[a[d]+c];if(g===void 0||g.t===void 0){if(l===void 0)continue;s[d]!=null&&(h[s[d]]=l);continue}var p=g.v;switch(g.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(s[d]!=null){if(p==null)if(g.t=="e"&&p===null)h[s[d]]=null;else if(l!==void 0)h[s[d]]=l;else if(f&&p===null)h[s[d]]=null;else continue;else h[s[d]]=f&&(g.t!=="n"||g.t==="n"&&o.rawNumbers!==!1)?p:pt(g,p,o);p!=null&&(u=!1)}}return{row:h,isempty:u}}function js(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},a=0,n=1,s=[],i=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},l=t||{},f=l.range!=null?l.range:e["!ref"];switch(l.header===1?a=1:l.header==="A"?a=2:Array.isArray(l.header)?a=3:l.header==null&&(a=0),typeof f){case"string":c=Ne(f);break;case"number":c=Ne(e["!ref"]),c.s.r=f;break;default:c=f}a>0&&(n=0);var u=ar(c.s.r),h=[],d=[],g=0,p=0,x=Array.isArray(e),y=c.s.r,F=0,v={};x&&!e[y]&&(e[y]=[]);var C=l.skipHidden&&e["!cols"]||[],P=l.skipHidden&&e["!rows"]||[];for(F=c.s.c;F<=c.e.c;++F)if(!(C[F]||{}).hidden)switch(h[F]=qe(F),r=x?e[y][F]:e[h[F]+u],a){case 1:s[F]=F-c.s.c;break;case 2:s[F]=h[F];break;case 3:s[F]=l.header[F-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=pt(r,null,l),p=v[i]||0,!p)v[i]=1;else{do o=i+"_"+p++;while(v[o]);v[i]=p,v[o]=1}s[F]=o}for(y=c.s.r+n;y<=c.e.r;++y)if(!(P[y]||{}).hidden){var I=t2(e,c,y,h,a,s,x,l);(I.isempty===!1||(a===1?l.blankrows!==!1:l.blankrows))&&(d[g++]=I.row)}return d.length=g,d}var cc=/"/g;function a2(e,t,r,a,n,s,i,o){for(var c=!0,l=[],f="",u=ar(r),h=t.s.c;h<=t.e.c;++h)if(a[h]){var d=o.dense?(e[r]||[])[h]:e[a[h]+u];if(d==null)f="";else if(d.v!=null){c=!1,f=""+(o.rawNumbers&&d.t=="n"?d.v:pt(d,null,o));for(var g=0,p=0;g!==f.length;++g)if((p=f.charCodeAt(g))===n||p===s||p===34||o.forceQuotes){f='"'+f.replace(cc,'""')+'"';break}f=="ID"&&(f='"ID"')}else d.f!=null&&!d.F?(c=!1,f="="+d.f,f.indexOf(",")>=0&&(f='"'+f.replace(cc,'""')+'"')):f="";l.push(f)}return o.blankrows===!1&&c?null:l.join(i)}function Ol(e,t){var r=[],a=t??{};if(e==null||e["!ref"]==null)return"";var n=Ne(e["!ref"]),s=a.FS!==void 0?a.FS:",",i=s.charCodeAt(0),o=a.RS!==void 0?a.RS:`
`,c=o.charCodeAt(0),l=new RegExp((s=="|"?"\\|":s)+"+$"),f="",u=[];a.dense=Array.isArray(e);for(var h=a.skipHidden&&e["!cols"]||[],d=a.skipHidden&&e["!rows"]||[],g=n.s.c;g<=n.e.c;++g)(h[g]||{}).hidden||(u[g]=qe(g));for(var p=0,x=n.s.r;x<=n.e.r;++x)(d[x]||{}).hidden||(f=a2(e,n,x,u,i,c,s,a),f!=null&&(a.strip&&(f=f.replace(l,"")),(f||a.blankrows!==!1)&&r.push((p++?o:"")+f)));return delete a.dense,r.join("")}function n2(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Ol(e,t);return r}function s2(e){var t="",r,a="";if(e==null||e["!ref"]==null)return[];var n=Ne(e["!ref"]),s="",i=[],o,c=[],l=Array.isArray(e);for(o=n.s.c;o<=n.e.c;++o)i[o]=qe(o);for(var f=n.s.r;f<=n.e.r;++f)for(s=ar(f),o=n.s.c;o<=n.e.c;++o)if(t=i[o]+s,r=l?(e[f]||[])[o]:e[t],a="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;a=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)a=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)a=""+r.v;else if(r.t=="b")a=r.v?"TRUE":"FALSE";else if(r.w!==void 0)a="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?a="'"+r.v:a=""+r.v}}c[c.length]=t+"="+a}return c}function Dl(e,t,r){var a=r||{},n=+!a.skipHeader,s=e||{},i=0,o=0;if(s&&a.origin!=null)if(typeof a.origin=="number")i=a.origin;else{var c=typeof a.origin=="string"?mr(a.origin):a.origin;i=c.r,o=c.c}var l,f={s:{c:0,r:0},e:{c:o,r:i+t.length-1+n}};if(s["!ref"]){var u=Ne(s["!ref"]);f.e.c=Math.max(f.e.c,u.e.c),f.e.r=Math.max(f.e.r,u.e.r),i==-1&&(i=u.e.r+1,f.e.r=i+t.length-1+n)}else i==-1&&(i=0,f.e.r=t.length-1+n);var h=a.header||[],d=0;t.forEach(function(p,x){rt(p).forEach(function(y){(d=h.indexOf(y))==-1&&(h[d=h.length]=y);var F=p[y],v="z",C="",P=de({c:o+d,r:i+x+n});l=sn(s,P),F&&typeof F=="object"&&!(F instanceof Date)?s[P]=F:(typeof F=="number"?v="n":typeof F=="boolean"?v="b":typeof F=="string"?v="s":F instanceof Date?(v="d",a.cellDates||(v="n",F=wr(F)),C=a.dateNF||xe[14]):F===null&&a.nullError&&(v="e",F=0),l?(l.t=v,l.v=F,delete l.w,delete l.R,C&&(l.z=C)):s[P]=l={t:v,v:F},C&&(l.z=C))})}),f.e.c=Math.max(f.e.c,o+h.length-1);var g=ar(i);if(n)for(d=0;d<h.length;++d)s[qe(d+o)+g]={t:"s",v:h[d]};return s["!ref"]=Ee(f),s}function i2(e,t){return Dl(null,e,t)}function sn(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var a=mr(t);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?sn(e,de(t)):sn(e,de({r:t,c:r||0}))}function o2(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Ri(){return{SheetNames:[],Sheets:{}}}function Pi(e,t,r,a){var n=1;if(!r)for(;n<=65535&&e.SheetNames.indexOf(r="Sheet"+n)!=-1;++n,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);n=s&&+s[2]||0;var i=s&&s[1]||r;for(++n;n<=65535&&e.SheetNames.indexOf(r=i+n)!=-1;++n);}if(Gw(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function c2(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=o2(e,t);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[a].Hidden=r}function l2(e,t){return e.z=t,e}function Rl(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function f2(e,t,r){return Rl(e,"#"+t,r)}function u2(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function h2(e,t,r,a){for(var n=typeof t!="string"?t:Ne(t),s=typeof t=="string"?t:Ee(t),i=n.s.r;i<=n.e.r;++i)for(var o=n.s.c;o<=n.e.c;++o){var c=sn(e,i,o);c.t="n",c.F=s,delete c.v,i==n.s.r&&o==n.s.c&&(c.f=r,a&&(c.D=!0))}return e}var d2={encode_col:qe,encode_row:ar,encode_cell:de,encode_range:Ee,decode_col:wi,decode_row:vi,split_cell:T1,decode_cell:mr,decode_range:ya,format_cell:pt,sheet_add_aoa:B0,sheet_add_json:Dl,sheet_add_dom:bl,aoa_to_sheet:Ea,json_to_sheet:i2,table_to_sheet:Fl,table_to_book:C_,sheet_to_csv:Ol,sheet_to_txt:n2,sheet_to_json:js,sheet_to_html:F_,sheet_to_formulae:s2,sheet_to_row_object_array:js,sheet_get_cell:sn,book_new:Ri,book_append_sheet:Pi,book_set_sheet_visibility:c2,cell_set_number_format:l2,cell_set_hyperlink:Rl,cell_set_internal_link:f2,cell_add_comment:u2,sheet_set_array_formula:h2,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};let Oe=[],kr={};async function p2(){console.log("🍽️ Initializing Meals module"),await E2(),g2(),D2(),gn(),Ml(),console.log("✅ Meals module initialized successfully")}function g2(){const e=document.getElementById("mealFileInput");e&&e.addEventListener("change",x2),document.addEventListener("click",t=>{t.target.closest(".add-to-plan-container")||document.querySelectorAll(".meal-plan-dropdown").forEach(a=>{a.style.display="none"})})}window.showMealUploadModal=function(){const e=document.getElementById("mealUploadModal");e&&(e.style.display="block")};window.closeMealUploadModal=function(){const e=document.getElementById("mealUploadModal");e&&(e.style.display="none")};async function x2(e){var a;const r=(a=e.target.files)==null?void 0:a[0];r&&(console.log("📁 Meal file selected:",r.name),Ae(`File selected: ${r.name}`,"info"),await m2(r))}async function m2(e){if(!e.name.match(/\.(xlsx|xls)$/i)){Ae("Please select a valid Excel file (.xlsx or .xls)","error");return}try{if(Ae("📊 Processing meal Excel file...","info"),!le){Ae("Database not available.","error");return}const{data:{user:t}}=await le.auth.getUser();if(!t){Ae("Please log in first.","error");return}await _2(t.id);const r=await w2(e);if(console.log(`📊 Parsed ${r.length} meals from Excel file`),r.length===0){Ae("No valid meals found in the Excel file.","error");return}await y2(r,t.id),Oe=r,localStorage.setItem("nutrivalor_meals",JSON.stringify(r)),as(r);const a=document.getElementById("mealUploadModal");a&&(a.style.display="none"),Ae(`✅ Successfully loaded ${r.length} meals! They will persist after refresh.`,"success"),M2()}catch(t){console.error("❌ Error uploading meal file:",t),Ae("Error uploading meal file. Please try again.","error")}}function v2(e){const t=[];let r=null,a="";for(let n=0;n<e.length;n++){const s=e[n];if(!s||s.every(g=>!g)||s[0]==="Meal #"||s[1]==="Meal Name")continue;const i=(s[0]||"").toString().trim(),o=(s[1]||"").toString().trim(),c=(s[2]||"").toString().trim(),l=parseFloat(s[3])||0,f=(s[4]||"").toString().trim(),u=(s[5]||"").toString().trim(),h=0,d=0;if(n%10===0&&console.log(`📋 Row ${n}:`,s.slice(0,6)),o&&!i&&!c&&l===0&&h===0&&d===0){a=o.toUpperCase(),console.log(`📋 Found meal type: ${a}`);continue}if(i&&i.startsWith("#")&&o){r&&r.ingredients.length>0&&t.push(r);const g=`meal_${o.replace(/[^a-zA-Z0-9]/g,"_").toLowerCase()}_${n}`;r={id:g,number:i,name:o,mealType:a||"OTHER",ingredients:[],totalCarbs:0,totalFat:0,totalProtein:0,picture:u,startRow:n+1,endRow:n+1,images:[]},console.log(`🆕 Started new meal: ${o} (${a}) with ID: ${g} at row ${n+1}`)}r&&c&&c.toLowerCase()!=="total"&&(r.ingredients.push({name:c,carbs:l,fat:h,protein:d,instructions:f,row:n+1}),r.endRow=n+1),r&&c&&c.toLowerCase()==="total"&&(r.totalCarbs=l,r.endRow=n+1)}return r&&r.ingredients.length>0&&t.push(r),t}async function w2(e){return new Promise((t,r)=>{const a=new FileReader;a.onload=n=>{var s;try{const i=new Uint8Array((s=n.target)==null?void 0:s.result),o=Us(i,{type:"array"}),c=o.SheetNames[0],l=o.Sheets[c],f=d2.sheet_to_json(l,{header:1,raw:!1,defval:""});console.log(`📊 Read ${f.length} rows from Excel sheet`);const u=v2(f);console.log(`✅ Parsed ${u.length} meals from data`),t(u)}catch(i){console.error("❌ Error parsing Excel file:",i),r(i)}},a.onerror=()=>{r(new Error("Failed to read file"))},a.readAsArrayBuffer(e)})}async function _2(e){try{if(!le)throw new Error("Database not available");const{error:t}=await le.from("meals").delete().eq("user_id",e);if(t)throw console.error("❌ Error clearing meals:",t),t;console.log("🗑️ Cleared all existing meals for user")}catch(t){throw console.error("❌ Error in clearAllMealsForUser:",t),t}}async function y2(e,t){try{if(!le)throw new Error("Database not available");const r=e.map(n=>({user_id:t,number:n.number,name:n.name,meal_type:n.mealType,ingredients:JSON.stringify(n.ingredients),total_carbs:n.totalCarbs,picture:n.picture,start_row:n.startRow,end_row:n.endRow})),{error:a}=await le.from("meals").insert(r);if(a)throw console.error("❌ Error saving meals:",a),a;console.log(`✅ Saved ${e.length} meals to database`)}catch(r){throw console.error("❌ Error in saveMealsToDatabase:",r),r}}async function E2(){try{if(!le){console.log("❌ Database not available, checking localStorage..."),Ca();return}const{data:{user:e}}=await le.auth.getUser();if(!e){console.log("❌ No user logged in, checking localStorage..."),Ca();return}const{data:t,error:r}=await le.from("meals").select("*").eq("user_id",e.id).order("start_row");if(r){console.error("❌ Error loading meals from database:",r),console.log("📂 Falling back to localStorage..."),Ca();return}t&&t.length>0?(Oe=t.map(a=>({id:a.id,number:a.number,name:a.name,mealType:a.meal_type,ingredients:JSON.parse(a.ingredients||"[]"),totalCarbs:a.total_carbs||0,totalFat:0,totalProtein:0,picture:a.picture,startRow:a.start_row,endRow:a.end_row,images:[],user_id:a.user_id})),localStorage.setItem("nutrivalor_meals",JSON.stringify(Oe)),console.log(`📂 Loaded ${Oe.length} meals from database`),as(Oe)):(console.log("📂 No existing meals found in database, checking localStorage..."),Ca())}catch(e){console.error("❌ Error loading user meals:",e),console.log("📂 Falling back to localStorage..."),Ca()}}function Ca(){const e=localStorage.getItem("nutrivalor_meals");if(e)try{Oe=JSON.parse(e).map((r,a)=>(r.id||(r.id=`meal_${r.name.replace(/[^a-zA-Z0-9]/g,"_").toLowerCase()}_${a}`,console.log(`🔧 Generated ID for meal: ${r.name} -> ${r.id}`)),r)),localStorage.setItem("nutrivalor_meals",JSON.stringify(Oe)),console.log(`📂 Loaded ${Oe.length} meals from localStorage`),as(Oe)}catch(t){console.error("❌ Error loading meals from localStorage:",t),lc()}else console.log("📂 No meals found in localStorage"),lc()}function lc(){const e=document.getElementById("mealGrid"),t=document.getElementById("availableMealsGrid");e&&(e.innerHTML='<p class="no-data">No meals loaded. Please upload your meal Excel file.</p>'),t&&(t.innerHTML='<p class="no-data">No meals loaded. Please upload your meal Excel file.</p>')}function as(e,t=!1){const r=document.getElementById("mealGrid"),a=document.getElementById("availableMealsGrid");e.length>0&&!t&&k2(Oe),r&&fc(r,e),a&&fc(a,e),t||S2()}function k2(e){const t=document.querySelectorAll(".meal-filters");if(!t.length){console.log("⚠️ No meal filter containers found");return}const r=[...new Set(e.map(s=>s.mealType).filter(s=>s))];console.log("🔍 Available meal types:",r);const n=["all",...["BREAKFAST","LUNCH","DINNER","SNACKS","SAUCES","OTHER"].filter(s=>r.includes(s))];t.forEach((s,i)=>{console.log(`📝 Updating filter container ${i+1}`),s.innerHTML=n.map((o,c)=>`
              <button class="filter-btn ${c===0?"active":""}" onclick="filterMealsByCategory('${o}')" data-category="${o}">
                ${o==="all"?"All":o==="BREAKFAST"?"Breakfast":o==="LUNCH"?"Lunch":o==="DINNER"?"Dinner":o==="SNACKS"?"Snacks":o==="SAUCES"?"Sauces":o}
              </button>
            `).join("")}),console.log(`✅ Created meal filters for categories: ${n.join(", ")}`)}function fc(e,t){if(t.length===0){e.innerHTML='<p class="no-data">No meals loaded. Please upload your meal Excel file.</p>';return}const r=["Breakfast","Lunch","Dinner","Snacks","Sauces"],a=[...t].sort((s,i)=>{const o=r.indexOf(s.mealType),c=r.indexOf(i.mealType);return o!==-1&&c!==-1?o-c:o!==-1?-1:c!==-1?1:s.mealType.localeCompare(i.mealType)});let n="";a.forEach(s=>{n+=T2(s)}),e.innerHTML=n,console.log(`✅ Displayed ${t.length} meals in continuous 3-column layout`)}function T2(e){const t=e.ingredients.reduce((s,i)=>s+(i.carbs||0),0),r=e.ingredients.reduce((s,i)=>s+(i.fat||0),0),a=e.ingredients.reduce((s,i)=>s+(i.protein||0),0);let n=null;return e.picture?n=`/images/${e.picture}`:n=`/images/${e.name.replace(/[^\w\s]/g,"").trim()}.jpg`,`
        <div class="meal-card" data-meal-id="${e.id||""}" data-meal-name="${e.name}">
            ${n?`
                <div class="meal-image-container">
                    <img src="${n}" alt="${e.name}" class="meal-image" 
                         onerror="this.style.display='none'; this.nextElementSibling.style.display='block';"
                         onload="this.style.display='block'; this.nextElementSibling.style.display='none';">
                    <div class="meal-image-fallback" style="display: none;">
                        <span class="image-icon">📷</span>
                        <div class="fallback-text">No Image</div>
                    </div>
                    <div class="meal-image-name">${e.picture||e.name}</div>
                </div>
            `:`
                <div class="meal-image-container">
                    <div class="meal-image-fallback">
                        <span class="image-icon">📷</span>
                        <div class="fallback-text">No Image</div>
                    </div>
                </div>
            `}
            <div class="meal-header">
                <h4 class="meal-name">${e.name}</h4>
            </div>
            <div class="meal-ingredients">
                ${e.ingredients.map(s=>`
                    <div class="ingredient-item">
                        <span class="ingredient-name">${s.name}</span>
                        <div class="ingredient-nutrition">
                            <span class="ingredient-carbs">${br(s.carbs)}g carbs</span>
                            ${s.fat?`<span class="ingredient-fat">${br(s.fat)}g fat</span>`:""}
                            ${s.protein?`<span class="ingredient-protein">${br(s.protein)}g protein</span>`:""}
                        </div>
                        ${s.instructions?`<div class="ingredient-instructions">${s.instructions}</div>`:""}
                    </div>
                `).join("")}
            </div>
            <div class="nutrition-info">
                <span>Carbs: ${br(t)}g</span>
                <span>Fat: ${br(r)}g</span>
                <span>Protein: ${br(a)}g</span>
            </div>
            <div class="meal-actions">
                <div class="add-to-plan-container">
                    <button class="secondary-btn add-to-plan-btn" onclick="toggleMealPlanDropdown('${e.id}')">
                        Add to Plan
                    </button>
                    <div class="meal-plan-dropdown" id="dropdown-${e.id}" style="display: none;">
                        <div class="dropdown-content">
                            <div class="dropdown-section">
                                <label>Day:</label>
                                <select class="day-select" id="day-${e.id}">
                                    <option value="Monday">Monday</option>
                                    <option value="Tuesday">Tuesday</option>
                                    <option value="Wednesday">Wednesday</option>
                                    <option value="Thursday">Thursday</option>
                                    <option value="Friday">Friday</option>
                                    <option value="Saturday">Saturday</option>
                                    <option value="Sunday">Sunday</option>
                                </select>
                            </div>
                            <div class="dropdown-section">
                                <label>Meal Time:</label>
                                <select class="meal-time-select" id="mealtime-${e.id}">
                                    <option value="breakfast" ${e.mealType.toLowerCase()==="breakfast"?"selected":""}>Breakfast</option>
                                    <option value="lunch" ${e.mealType.toLowerCase()==="lunch"?"selected":""}>Lunch</option>
                                    <option value="dinner" ${e.mealType.toLowerCase()==="dinner"?"selected":""}>Dinner</option>
                                    <option value="snack" ${e.mealType.toLowerCase()==="snack"||e.mealType.toLowerCase()==="snacks"?"selected":""}>Snack</option>
                                </select>
                            </div>
                            <div class="dropdown-actions">
                                <button class="primary-btn" onclick="addMealToWeeklyPlan('${e.id}', '${e.name.replace(/'/g,"\\'")}')">Add</button>
                                <button class="secondary-btn" onclick="hideMealPlanDropdown('${e.id}')">Cancel</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    `}function S2(){const e=document.getElementById("weeklyMealPlan");if(!e)return;const t=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],r=["Breakfast","Lunch","Dinner","Snack"];let a="";t.forEach(n=>{a+=`
            <div class="day-plan">
                <h4 class="day-header">${n}</h4>
                ${r.map(s=>`
                    <div class="meal-slot" data-day="${n}" data-meal-type="${s.toLowerCase()}">
                        <h5>${s}</h5>
                        <div class="meal-drop-zone">
                            <p class="drop-hint">Drag meals here or click to add</p>
                        </div>
                    </div>
                `).join("")}
            </div>
        `}),e.innerHTML=a,console.log("✅ Weekly meal plan initialized")}function Ae(e,t="info"){window.showMessage?window.showMessage(e,t):console.log(`${t.toUpperCase()}: ${e}`)}function A2(e){const t=Oe.find(s=>s.id===e);if(!t){console.error("Meal not found:",e);return}const r=new Date().toISOString().split("T")[0];kr[r]||(kr[r]={breakfast:[],lunch:[],dinner:[],snack:[]});const a=["breakfast","lunch","dinner","snack"];let n=!1;for(const s of a)if(kr[r][s].length<2){kr[r][s].push(t),n=!0;break}if(!n){Ae("Meal plan is full for today","error");return}localStorage.setItem("nutrivalor_meal_plan",JSON.stringify(kr)),Li(),Ae(`Added "${t.name}" to meal plan!`,"success")}function Li(){const e=document.getElementById("mealPlanGrid");if(!e)return;if(Object.keys(kr).length===0){const n=localStorage.getItem("nutrivalor_meal_plan");if(n)try{kr=JSON.parse(n),console.log("📅 Loaded daily meal plan from localStorage")}catch(s){console.error("Error loading daily meal plan:",s)}}const t=new Date().toISOString().split("T")[0],r=kr[t]||{breakfast:[],lunch:[],dinner:[],snack:[]},a=["breakfast","lunch","dinner","snack"];e.innerHTML=`
        <div class="meal-plan-day">
            <h3>Today's Meal Plan</h3>
            ${a.map(n=>{const s=r[n]||[],i=s.reduce((o,c)=>o+(c.totalCarbs||0),0);return`
                    <div class="meal-type-plan">
                        <h4>${n.charAt(0).toUpperCase()+n.slice(1)}</h4>
                        <div class="meal-type-totals">
                            <span>Carbs: ${br(i)}g</span>
                        </div>
                        <div class="planned-meals">
                            ${s.map(o=>`
                                <div class="planned-meal">
                                    <span>${o.name}</span>
                                    <button onclick="removeMealFromPlan('${o.id}', '${n}')" class="remove-btn">×</button>
                                </div>
                            `).join("")}
                        </div>
                    </div>
                `}).join("")}
        </div>
    `}function br(e){if(e==null||e==="")return"0";const t=parseFloat(e);return isNaN(t)?"0":t.toFixed(1)}function b2(e){if(console.log(`🔍 Filtering meals by category: ${e}`),!Oe||Oe.length===0){console.log("⚠️ No meals available for filtering");const r=document.getElementById("mealGrid"),a=document.getElementById("availableMealsGrid");r&&(r.innerHTML='<p class="no-data">No meals loaded. Please upload your meal Excel file.</p>'),a&&(a.innerHTML='<p class="no-data">No meals loaded. Please upload your meal Excel file.</p>');return}let t;e==="all"||e==="ALL"?t=Oe:t=Oe.filter(r=>r.mealType.toUpperCase()===e.toUpperCase()),console.log(`📊 Found ${t.length} meals for category: ${e}`),document.querySelectorAll(".meal-filters .filter-btn").forEach(r=>{r.classList.remove("active")}),document.querySelectorAll(`[data-category="${e}"]`).forEach(r=>{r.classList.add("active")}),as(t,!0)}let rr={};function F2(e){document.querySelectorAll(".meal-plan-dropdown").forEach(r=>{r.id!==`dropdown-${e}`&&(r.style.display="none")});const t=document.getElementById(`dropdown-${e}`);if(t){const r=t.style.display==="block";if(t.style.display=r?"none":"block",t.style.visibility=r?"hidden":"visible",t.style.opacity=r?"0":"1",t.style.pointerEvents=r?"none":"auto",!r){const a=t.closest(".add-to-plan-container");if(a){const n=a.getBoundingClientRect(),i=window.innerHeight-n.bottom;n.top>i||i<200?(t.style.bottom="100%",t.style.top="auto",t.style.marginBottom="5px",t.style.marginTop="0"):(t.style.top="100%",t.style.bottom="auto",t.style.marginTop="5px",t.style.marginBottom="0")}setTimeout(()=>{document.addEventListener("click",function n(s){const i=s.target;!t.contains(i)&&!(i!=null&&i.closest(`#dropdown-${e}`))&&!(i!=null&&i.closest(".add-to-plan-btn"))&&(t.style.display="none",t.style.visibility="hidden",t.style.opacity="0",t.style.pointerEvents="none",document.removeEventListener("click",n))})},10)}}}function Ws(e){const t=document.getElementById(`dropdown-${e}`);t&&(t.style.display="none",t.style.visibility="hidden",t.style.opacity="0",t.style.pointerEvents="none")}function C2(e,t){console.log(`🔍 addMealToWeeklyPlan called with mealId: "${e}", mealName: "${t}"`),console.log(`📊 Current meals count: ${Oe.length}`),console.log("📋 Available meal IDs:",Oe.map(c=>({id:c.id,name:c.name})));const r=Oe.find(c=>c.id===e);if(!r){console.error(`❌ Meal not found with ID: "${e}"`),console.error("Available meals:",Oe.map(c=>`ID: "${c.id}", Name: "${c.name}"`)),Ae(`Meal not found: ${t}`,"error");return}console.log(`✅ Found meal: ${r.name} with ID: ${r.id}`);const a=document.getElementById(`day-${e}`),n=document.getElementById(`mealtime-${e}`);if(!a||!n){console.error(`❌ Dropdown selects not found for meal ID: ${e}`),console.error("daySelect:",a),console.error("mealTimeSelect:",n),Ae("Error: Dropdown elements not found","error");return}const s=a.value,i=n.value;if(console.log(`📅 Selected day: ${s}, meal time: ${i}`),rr[s]||(rr[s]={breakfast:[],lunch:[],dinner:[],snack:[]}),rr[s][i].find(c=>c.id===e)){Ae(`${t} is already planned for ${s} ${i}`,"error"),Ws(e);return}rr[s][i].push(r),localStorage.setItem("nutrivalor_weekly_meal_plan",JSON.stringify(rr)),gn(),Ws(e),Ae(`Added "${t}" to ${s} ${i}!`,"success"),console.log("✅ Successfully added meal to weekly plan")}function I2(e,t,r){if(rr[t]&&rr[t][r]){const a=rr[t][r].findIndex(n=>n.id===e);a!==-1&&(rr[t][r].splice(a,1),localStorage.setItem("nutrivalor_weekly_meal_plan",JSON.stringify(rr)),gn(),Ae("Meal removed from weekly plan","success"))}}function gn(){const e=document.getElementById("weeklyMealPlan");if(!e)return;const t=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],r=["breakfast","lunch","dinner","snack"],a=["Breakfast","Lunch","Dinner","Snack"];let n="";t.forEach(s=>{const i=rr[s]||{breakfast:[],lunch:[],dinner:[],snack:[]};let o=0,c=0,l=0,f=!1;n+=`
            <div class="day-plan">
                <div class="day-header">
                    <div class="day-name">${s}</div>
                </div>
                <div class="meal-types">
                    ${r.map((u,h)=>{const d=i[u]||[],g=d.reduce((y,F)=>y+(F.totalCarbs||0),0),p=d.reduce((y,F)=>y+(F.totalFat||0),0),x=d.reduce((y,F)=>y+(F.totalProtein||0),0);return o+=g,c+=p,l+=x,d.length>0&&(f=!0),`
                            <div class="meal-type">
                                <div class="meal-type-label">${a[h]}</div>
                                ${d.map(y=>`
                                    <div class="planned-meal">
                                        <div class="planned-meal-content">
                                            <input 
                                                type="checkbox" 
                                                class="meal-shopping-checkbox" 
                                                id="shopping-${y.id}-${s}-${u}"
                                                title="Add ingredients to Shopping List"
                                                onchange="handleMealToShoppingList('${y.id}', '${y.name.replace(/'/g,"\\'")}', this.checked)"
                                            />
                                            <span class="planned-meal-name">${y.name}</span>
                                        </div>
                                        <button class="remove-planned-btn" onclick="removeMealFromWeeklyPlan('${y.id}', '${s}', '${u}')">×</button>
                                    </div>
                                `).join("")}
                                ${d.length===0?'<div class="empty-meal-slot">No meals planned</div>':""}
                                ${d.length>0?`
                                    <div class="meal-time-totals">
                                        <span class="total-carbs">Carbs: ${br(g)}g</span>
                                        <span class="total-fat">Fat: ${br(p)}g</span>
                                        <span class="total-protein">Protein: ${br(x)}g</span>
                                    </div>
                                `:""}
                            </div>
                        `}).join("")}
                    
                    <div class="daily-totals-column">
                        <div class="daily-totals-label">Daily Total</div>
                        ${f?`
                            <div class="daily-totals-values">
                                <span class="daily-total-carbs">Carbs: ${br(o)}g</span>
                                <span class="daily-total-fat">Fat: ${br(c)}g</span>
                                <span class="daily-total-protein">Protein: ${br(l)}g</span>
                            </div>
                        `:'<div class="empty-meal-slot">No meals</div>'}
                    </div>
                </div>
            </div>
        `}),e.innerHTML=n,Pl()}async function Pl(){try{console.log("🔄 Updating meal shopping checkboxes based on current shopping list...");const e=await O2();console.log(`📊 Found ${e.length} items in shopping list`);const t=await Nl();console.log(`📊 Found ${t.length} foods available for matching`);const r=new Set(e.map(n=>n.food_id).filter(n=>n!==null)),a=new Set(e.map(n=>n.name.toLowerCase().trim()));console.log("🔍 Shopping list contains:",{foodIds:Array.from(r),names:Array.from(a)}),Object.keys(rr).forEach(n=>{Object.keys(rr[n]).forEach(s=>{rr[n][s].forEach(i=>{const o=`shopping-${i.id}-${n}-${s}`,c=document.getElementById(o);if(c&&i.ingredients){let l=!1;for(const u of i.ingredients){const h=u.name.trim().toLowerCase(),d=Bl(h,t);if(d&&r.has(d.id)){l=!0,console.log(`✅ Found ingredient "${u.name}" in shopping list via food match`);break}if(a.has(h)){l=!0,console.log(`✅ Found ingredient "${u.name}" in shopping list as SUNDRIES`);break}}const f=c.checked;c.checked=l,f!==l&&console.log(`🔄 Updated checkbox ${o}: ${f} → ${l}`)}})})}),console.log("✅ Meal shopping checkboxes updated based on current shopping list")}catch(e){console.error("Error updating meal shopping checkboxes:",e)}}async function O2(){try{const{supabase:e}=await $r(async()=>{const{supabase:s}=await Promise.resolve().then(()=>Bc);return{supabase:s}},void 0);if(!e)throw new Error("Supabase client not available");const{data:{user:t},error:r}=await e.auth.getUser();if(r||!t)throw new Error("User must be authenticated");const{data:a,error:n}=await e.from("shopping_list").select("*").eq("user_id",t.id);if(n)throw n;return a||[]}catch(e){return console.error("Error loading shopping list items:",e),[]}}function D2(){const e=localStorage.getItem("nutrivalor_weekly_meal_plan");if(e)try{rr=JSON.parse(e),gn(),console.log("📅 Loaded weekly meal plan from localStorage")}catch(t){console.error("Error loading weekly meal plan:",t),rr={}}}function R2(){confirm("Are you sure you want to clear all meal plan data? This cannot be undone.")&&(rr={},localStorage.removeItem("nutrivalor_weekly_meal_plan"),kr={},localStorage.removeItem("nutrivalor_meal_plan"),gn(),Li(),Ae("All meal plan data has been cleared!","success"),console.log("🗑️ All meal plan data cleared"))}function Ll(){console.log("🗑️ Clearing all meal shopping checkboxes..."),console.log("🔍 Searching for checkboxes with class: .meal-shopping-checkbox");const e=document.querySelectorAll(".meal-shopping-checkbox");console.log(`📊 Found ${e.length} checkboxes total`);let t=0,r=0;e.forEach((a,n)=>{if(a instanceof HTMLInputElement){const s=a.checked;s&&r++,console.log(`🔲 Checkbox ${n+1}: ID="${a.id}", checked=${s}`),s&&(a.checked=!1,t++,console.log(`✅ Unchecked checkbox: ${a.id}`))}}),console.log(`📈 Summary: ${t} unchecked out of ${r} that were checked`),t>0?(Ae(`Cleared ${t} "Add to List" selections`,"success"),console.log(`✅ Successfully unchecked ${t} meal shopping checkboxes`)):r===0?(Ae("No checkboxes were selected to clear","info"),console.log("ℹ️ No meal shopping checkboxes were checked")):(Ae("All checkboxes were already cleared","info"),console.log("ℹ️ All checkboxes were already unchecked"))}window.addMealToPlan=function(e,t){console.log(`🍽️ Adding meal ${t} to plan`),A2(e)};window.toggleMealPlanDropdown=function(e){F2(e)};window.hideMealPlanDropdown=function(e){Ws(e)};window.addMealToWeeklyPlan=function(e,t){C2(e,t)};window.removeMealFromWeeklyPlan=function(e,t,r){I2(e,t,r)};window.filterMealsByCategory=function(e){b2(e)};window.clearAllMealPlanData=function(){R2()};window.clearMealShoppingCheckboxes=function(){Ll()};window.removeMealFromPlan=function(e,t){const r=new Date().toISOString().split("T")[0];if(kr[r]&&kr[r][t]){const a=kr[r][t].findIndex(n=>n.id===e);a!==-1&&(kr[r][t].splice(a,1),localStorage.setItem("nutrivalor_meal_plan",JSON.stringify(kr)),Li(),Ae("Meal removed from plan","success"))}};console.log("🧪 Testing global filterMealsByCategory function availability:",typeof window.filterMealsByCategory);async function P2(e,t,r){var n;if(console.log(`🛒 handleMealToShoppingList called - mealId: "${e}", mealName: "${t}", isChecked: ${r}`),console.log(`📊 Current meals available: ${Oe.length}`),console.log("🔍 Available meal IDs:",Oe.map(s=>s.id)),!r){Ae("Note: Ingredients are not automatically removed from shopping list when unchecked","info");return}const a=Oe.find(s=>s.id===e);if(!a){console.error(`❌ Meal not found with ID: "${e}"`),console.error("Available meals:",Oe.map(s=>({id:s.id,name:s.name}))),Ae("Meal not found","error");return}if(console.log(`✅ Found meal: "${a.name}" with ${((n=a.ingredients)==null?void 0:n.length)||0} ingredients`),!a.ingredients||a.ingredients.length===0){console.warn(`⚠️ No ingredients found in meal: "${a.name}"`),Ae("No ingredients found in this meal","error");return}try{Ae("Processing ingredients...","info");const s=await L2(a),i=s.matched.length,o=s.unmatched.length;let c=`Added ${i+o} ingredients to shopping list`;i>0&&(c+=` (${i} matched from Food Tracker`),o>0&&(c+=`, ${o} added to SUNDRIES`),(i>0||o>0)&&(c+=")"),Ae(c,"success"),await new Promise(f=>setTimeout(f,500)),console.log("🔄 Refreshing shopping list display...");let l=!1;try{typeof window.loadAndDisplayShoppingList=="function"&&(await window.loadAndDisplayShoppingList(),l=!0,console.log("✅ Shopping list display refreshed via global function"))}catch(f){console.warn("⚠️ Global function refresh failed:",f)}if(!l)try{const{loadAndDisplayShoppingList:f}=await $r(async()=>{const{loadAndDisplayShoppingList:u}=await Promise.resolve().then(()=>U2);return{loadAndDisplayShoppingList:u}},void 0);await f(),l=!0,console.log("✅ Shopping list display refreshed via import")}catch(f){console.warn("⚠️ Import refresh failed:",f)}try{const f=new CustomEvent("shoppingListNeedsRefresh",{detail:{source:"meal-plan",timestamp:Date.now()}});window.dispatchEvent(f),console.log("📡 Shopping list refresh event dispatched")}catch(f){console.warn("⚠️ Event dispatch failed:",f)}l?console.log("👁️ Shopping list refresh completed successfully"):(console.warn("⚠️ All automatic refresh methods failed"),Ae("Ingredients added! Please switch to the Shopping List tab to see updates.","info"))}catch(s){console.error("Error adding meal ingredients to shopping list:",s),Ae("Error adding ingredients to shopping list","error")}}async function L2(e){console.log(`🔍 Processing ${e.ingredients.length} ingredients from "${e.name}"`);const t=await Nl(),r=[],a=[];for(const n of e.ingredients){const s=n.name.trim().toLowerCase(),i=Bl(s,t);if(i)try{await N2(i.id),r.push({ingredient:n,matchedFood:i}),console.log(`✅ Matched "${n.name}" with "${i.name}"`)}catch(o){console.error(`Error adding ${i.name} to shopping list:`,o)}else try{await B2(n),a.push(n),console.log(`📝 Added "${n.name}" to SUNDRIES`)}catch(o){console.error(`Error adding ${n.name} to SUNDRIES:`,o)}}return{matched:r,unmatched:a}}async function Nl(){try{const{loadFoodsFromDatabase:e}=await $r(async()=>{const{loadFoodsFromDatabase:t}=await Promise.resolve().then(()=>ti);return{loadFoodsFromDatabase:t}},void 0);return await e()}catch(e){return console.error("Error loading foods for matching:",e),[]}}function Bl(e,t){if(!t||t.length===0)return null;const r=e.toLowerCase().trim();let a=t.find(s=>s.name.toLowerCase().trim()===r);if(a||(a=t.find(s=>{const i=s.name.toLowerCase().trim();return r.includes(i)||i.includes(r)}),a))return a;const n=r.split(/\s+/);return a=t.find(s=>{const i=s.name.toLowerCase().trim().split(/\s+/);return n.some(o=>o.length>2&&i.some(c=>c.includes(o)||o.includes(c)))}),a||null}async function N2(e){try{const{addToShoppingList:t}=await $r(async()=>{const{addToShoppingList:r}=await Promise.resolve().then(()=>ti);return{addToShoppingList:r}},void 0);await t(e,1)}catch(t){throw console.error("Error adding food to shopping list:",t),t}}async function B2(e){try{const{supabase:t}=await $r(async()=>{const{supabase:s}=await Promise.resolve().then(()=>Bc);return{supabase:s}},void 0);if(!t)throw new Error("Supabase client not available");const{data:{user:r},error:a}=await t.auth.getUser();if(a||!r)throw new Error("User must be authenticated");const{error:n}=await t.from("shopping_list").insert([{food_id:null,name:e.name,brand:"SUNDRIES",category:"SUNDRIES",carbs:e.carbs||0,fat:e.fat||0,protein:e.protein||0,quantity:1,user_id:r.id}]);if(n)throw n}catch(t){throw console.error("Error adding ingredient to SUNDRIES:",t),t}}window.handleMealToShoppingList=async function(e,t,r){console.log("🚀 Global handleMealToShoppingList wrapper called!"),console.log(`Parameters: mealId="${e}", mealName="${t}", isChecked=${r}`);try{await P2(e,t,r)}catch(a){console.error("Error in handleMealToShoppingList:",a),Ae("Error processing ingredients","error")}};window.testMealShoppingFunction=function(){console.log("🧪 Testing handleMealToShoppingList availability:"),console.log("- Function exists:",typeof window.handleMealToShoppingList),console.log("- Current meals:",Oe.length),console.log("- Meals data:",Oe.map(e=>({id:e.id,name:e.name})))};window.testClearFunction=function(){console.log("🧪 Testing CLEAR button functionality:"),console.log("- clearMealShoppingCheckboxes function exists:",typeof window.clearMealShoppingCheckboxes),console.log("- clearAllMealPlanData function exists:",typeof window.clearAllMealPlanData);const e=document.querySelectorAll(".meal-shopping-checkbox");console.log("- Meal shopping checkboxes found:",e.length),e.length>0?(console.log("- Checkbox details:"),e.forEach((t,r)=>{t instanceof HTMLInputElement&&console.log(`  Checkbox ${r+1}: ID="${t.id}", checked=${t.checked}`)})):console.log("- No checkboxes found. Make sure you have meals added to your weekly plan first."),console.log("🔧 Testing clearMealShoppingCheckboxes() directly..."),Ll()};window.refreshMealShoppingCheckboxes=async function(){console.log("🔄 Refreshing meal shopping checkboxes from external call..."),await Pl()};function M2(){const e=new Date,t=e.toLocaleDateString()+" "+e.toLocaleTimeString();localStorage.setItem("lastMealUploadDate",t),Ml()}function Ml(){const e=localStorage.getItem("lastMealUploadDate"),t=document.getElementById("lastMealUpdateInfo"),r=document.getElementById("lastMealUpdateDate");e&&t&&r?(r.textContent=e,t.style.display="block"):t&&(t.style.display="none")}let Cr=[];async function $l(){console.log("🛒 Initializing shopping list..."),await Gt(),window.addEventListener("shoppingListNeedsRefresh",async e=>{var r;console.log("📡 Received shopping list refresh event from:",(r=e.detail)==null?void 0:r.source);try{await Gt(),console.log("✅ Shopping list refreshed via event listener")}catch(a){console.error("❌ Error refreshing shopping list via event:",a)}}),console.log("🎧 Shopping list event listeners set up")}async function Gt(){try{console.log("🛒 Loading shopping list from database..."),Cr=await Qs()||[],console.log(`🛒 Loaded ${Cr.length} items from shopping list`),console.log("🛒 Shopping list items:",Cr),uc(Cr);try{typeof window.refreshMealShoppingCheckboxes=="function"&&(await window.refreshMealShoppingCheckboxes(),console.log("✅ Meal plan checkboxes refreshed after loading shopping list"))}catch(t){console.warn("⚠️ Could not refresh meal plan checkboxes:",t)}}catch(e){console.error("❌ Error loading shopping list:",e),Cr=[],uc([])}}function Ul(e){const t={};return e.forEach(r=>{const a=r.brand||"Any",n=r.category||"General",s=`${r.name.toLowerCase().trim()}_${a.toLowerCase().trim()}_${n.toLowerCase().trim()}`;console.log(`🔍 Processing item: ${r.name}, Brand: ${a}, Category: ${n}, Key: ${s}`),t[s]?(t[s].quantity+=r.quantity,console.log(`🔄 Consolidated ${r.name}: ${t[s].quantity} total quantity`)):(t[s]={...r},console.log(`➕ Added new item: ${r.name} with quantity ${r.quantity}`))}),console.log(`📦 Consolidation complete: ${Object.keys(t).length} unique items`),Object.values(t)}function uc(e){const t=document.getElementById("shoppingItems"),r=document.getElementById("shoppingTotals");if(console.log("🛒 displayShoppingList called with:",e.length,"items"),console.log("🛒 Items data:",e),console.log("🛒 currentShoppingList length:",Cr.length),!t){console.warn("❌ Shopping items container not found");return}if(r&&(r.style.display="none",r.innerHTML=""),!e||e.length===0){console.log("🛒 Displaying empty state"),t.innerHTML='<p class="empty-state">Your shopping list is empty. Add items from the Food Tracker!</p>',r&&(r.style.display="none");return}console.log("🛒 Processing",e.length,"items for display");const a=Ul(e);console.log("🛒 After consolidation:",a.length,"unique items");const n=a.reduce((o,c)=>{const l=c.category||c.brand||"General";return o[l]||(o[l]=[]),o[l].push(c),o},{});console.log("🛒 Items grouped by category:",Object.keys(n));const s=Object.keys(n).sort((o,c)=>o==="SUNDRIES"?1:c==="SUNDRIES"?-1:o.localeCompare(c));t.innerHTML=s.map(o=>{const c=n[o],l=o==="SUNDRIES";return`
      <div class="shopping-category">
        <h3 class="category-header ${l?"sundries-header":""}">${o}${l?" (From Meal Plans)":""}</h3>
        <div class="category-items">
          ${c.map(f=>`
            <div class="shopping-item" data-id="${f.id}">
              <div class="item-info">
                <h4>${f.name}</h4>
                <div class="quantity-display">Qty: ${f.quantity}</div>
                ${f.brand&&f.brand!=="SUNDRIES"?`<div class="brand-info">Brand: ${f.brand}</div>`:""}
                <div class="nutrition-info">
                  <span>Carbs: ${da(f.carbs)}g</span>
                  <span>Fat: ${da(f.fat)}g</span>
                  <span>Protein: ${da(f.protein)}g</span>
                </div>
                ${l?"":`<div class="category-info">${f.category||"General"}</div>`}
              </div>
              <div class="item-controls">
                <div class="quantity-controls">
                  <button onclick="updateItemQuantity('${f.id}', ${f.quantity-1})" class="qty-btn" ${f.quantity<=1?"disabled":""}>-</button>
                  <span class="quantity">${f.quantity}</span>
                  <button onclick="updateItemQuantity('${f.id}', ${f.quantity+1})" class="qty-btn">+</button>
                </div>
                <button onclick="removeShoppingItem('${f.id}')" class="remove-btn">Remove</button>
              </div>
            </div>
          `).join("")}
        </div>
      </div>
    `}).join("");const i=jl(a);console.log("🛒 Calculated totals:",i),r&&i.totalItems>0&&(r.style.display="block",r.innerHTML=`
      <div class="totals-header">
        <h3>Shopping List Totals</h3>
        <span class="total-items">${i.totalItems} items</span>
      </div>
      <div class="totals-grid">
        <div class="total-item">
          <span class="label">Total Carbs:</span>
          <span class="value">${i.totalCarbs.toFixed(1)}g</span>
        </div>
        <div class="total-item">
          <span class="label">Total Fat:</span>
          <span class="value">${i.totalFat.toFixed(1)}g</span>
        </div>
        <div class="total-item">
          <span class="label">Total Protein:</span>
          <span class="value">${i.totalProtein.toFixed(1)}g</span>
        </div>
      </div>
    `)}function jl(e){const t={totalItems:e.reduce((r,a)=>r+a.quantity,0),totalCarbs:0,totalFat:0,totalProtein:0};return e.forEach(r=>{t.totalCarbs+=(parseFloat(r.carbs)||0)*r.quantity,t.totalFat+=(parseFloat(r.fat)||0)*r.quantity,t.totalProtein+=(parseFloat(r.protein)||0)*r.quantity}),t}function da(e){if(e==null||e==="")return"0";const t=parseFloat(e);return isNaN(t)?"0":t.toFixed(1)}async function Ni(e){try{await ei(e),await Gt();try{typeof window.refreshMealShoppingCheckboxes=="function"&&(await window.refreshMealShoppingCheckboxes(),console.log("✅ Meal plan checkboxes refreshed after item removal"))}catch(t){console.warn("⚠️ Could not refresh meal plan checkboxes:",t)}dt("Item removed from shopping list","success")}catch(t){console.error("Error removing item:",t),dt("Error removing item","error")}}async function Wl(e,t){if(t<1){await Ni(e);return}try{await Vc(e,t),await Gt()}catch(r){console.error("Error updating quantity:",r),dt("Error updating quantity","error")}}async function Hl(){try{for(const e of Cr)await ei(e.id);await Gt();try{typeof window.refreshMealShoppingCheckboxes=="function"&&(await window.refreshMealShoppingCheckboxes(),console.log("✅ Meal plan checkboxes refreshed after clearing list"))}catch(e){console.warn("⚠️ Could not refresh meal plan checkboxes:",e)}dt("Shopping list cleared","success")}catch(e){console.error("Error clearing shopping list:",e),dt("Error clearing shopping list","error")}}function dt(e,t="success"){let r=document.getElementById("shopping-message");if(!r){r=document.createElement("div"),r.id="shopping-message",r.className="message";const a=document.getElementById("shopping-list")||document.body;a.insertBefore(r,a.firstChild)}r.textContent=e,r.className=`message ${t}`,r.style.display="block",setTimeout(()=>{r&&(r.style.display="none")},3e3)}window.removeShoppingItem=Ni;window.updateItemQuantity=Wl;window.loadAndDisplayShoppingList=Gt;window.printShoppingList=Vl;window.handleClearShoppingList=Gl;function Vl(){if(console.log("🖨️ Printing shopping list..."),!Cr||Cr.length===0){dt("Shopping list is empty - nothing to print!","error");return}const e=window.open("","_blank");if(!e){dt("Unable to open print window. Please check your browser settings.","error");return}const t=$2();e.document.write(`
    <!DOCTYPE html>
    <html>
    <head>
      <title>NutriValor Shopping List</title>
      <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        h1 { color: #333; }
        .category { margin-bottom: 20px; }
        .category h2 { color: #666; border-bottom: 1px solid #ccc; padding-bottom: 5px; }
        .item { margin: 8px 0; padding: 8px 0; border-bottom: 1px dotted #ddd; display: flex; align-items: flex-start; }
        .checkbox { font-size: 24px; font-weight: bold; margin-right: 12px; line-height: 1; color: #333; }
        .item-content { flex: 1; }
        .item-name { font-weight: bold; margin-bottom: 4px; }
        .item-details { font-size: 0.9em; color: #666; }
        .totals { margin-top: 30px; padding: 15px; background: #f5f5f5; border-radius: 5px; }
        @media print { body { margin: 0; } }
      </style>
    </head>
    <body>
      ${t}
    </body>
    </html>
  `),e.document.close(),e.focus(),e.print(),dt("Shopping list opened for printing!","success")}function $2(){const e=Ul(Cr),t=jl(e),r=new Date().toLocaleDateString(),a=e.reduce((i,o)=>{const c=o.category||o.brand||"General";return i[c]||(i[c]=[]),i[c].push(o),i},{}),n=Object.keys(a).sort((i,o)=>i==="SUNDRIES"?1:o==="SUNDRIES"?-1:i.localeCompare(o));let s=`
    <h1>NutriValor Shopping List</h1>
    <p><strong>Generated:</strong> ${r}</p>
    <p><strong>Total Items:</strong> ${t.totalItems}</p>
  `;return n.forEach(i=>{const o=a[i];s+=`
      <div class="category">
        <h2>${i}${i==="SUNDRIES"?" (From Meal Plans)":""}</h2>
    `,o.forEach(l=>{s+=`
        <div class="item">
          <div class="checkbox">☐</div>
          <div class="item-content">
            <div class="item-name">${l.name} (Qty: ${l.quantity})</div>
            <div class="item-details">
              Carbs: ${da(l.carbs)}g | 
              Fat: ${da(l.fat)}g | 
              Protein: ${da(l.protein)}g
              ${l.brand&&l.brand!=="SUNDRIES"?` | Brand: ${l.brand}`:""}
            </div>
          </div>
        </div>
      `}),s+="</div>"}),s+=`
    <div class="totals">
      <h2>Totals</h2>
      <p><strong>Total Carbs:</strong> ${t.totalCarbs.toFixed(1)}g</p>
      <p><strong>Total Fat:</strong> ${t.totalFat.toFixed(1)}g</p>
      <p><strong>Total Protein:</strong> ${t.totalProtein.toFixed(1)}g</p>
    </div>
  `,s}function Gl(){if(console.log("🗑️ Clear shopping list requested..."),!Cr||Cr.length===0){dt("Shopping list is already empty!","info");return}confirm(`Are you sure you want to clear all ${Cr.length} items from your shopping list? This cannot be undone.`)?Hl():console.log("🚫 Clear shopping list cancelled by user")}const U2=Object.freeze(Object.defineProperty({__proto__:null,clearAllShoppingItems:Hl,handleClearShoppingList:Gl,initializeShoppingList:$l,loadAndDisplayShoppingList:Gt,printShoppingList:Vl,removeShoppingItem:Ni,updateItemQuantity:Wl},Symbol.toStringTag,{value:"Module"}));async function j2(){console.log("🚀 Initializing NutriValor Application...");try{Xs(),await Fh(),await $c(),await Gc(),await Jh(),await sd(),await p2(),await $l(),J2(),ry(),ey(),V2(),console.log("✅ NutriValor Application initialized successfully")}catch(e){console.error("❌ Error initializing application:",e)}}function W2(){var l,f,u,h;console.log("👤 Updating profile...");const e=(l=document.getElementById("profileName"))==null?void 0:l.value,t=(f=document.getElementById("dateOfBirth"))==null?void 0:f.value,r=(u=document.getElementById("profileAge"))==null?void 0:u.value,a=(h=document.getElementById("profileCountry"))==null?void 0:h.value,n=document.getElementById("avatarPreview"),s={name:e,dateOfBirth:t,age:r,country:a,avatar:(n==null?void 0:n.src)||null,updatedAt:new Date().toISOString()};localStorage.setItem("nutrivalor_profile",JSON.stringify(s));const i=document.getElementById("userEmail"),o=document.getElementById("headerAvatar"),c=document.getElementById("headerAvatarPlaceholder");i&&e&&e.trim()&&(i.textContent=e),o&&c&&(s.avatar?(o.src=s.avatar,o.style.display="block",c.style.display="none"):(o.style.display="none",c.style.display="flex")),Xa("Profile updated successfully!","success"),console.log("✅ Profile saved:",s)}function zl(){console.log("👤 Loading profile...");try{const e=localStorage.getItem("nutrivalor_profile");if(e){const t=JSON.parse(e),r=document.getElementById("profileName"),a=document.getElementById("dateOfBirth"),n=document.getElementById("profileAge"),s=document.getElementById("profileCountry"),i=document.getElementById("avatarPreview"),o=document.getElementById("avatarPlaceholder"),c=document.getElementById("removeAvatarBtn");r&&(r.value=t.name||""),a&&(a.value=t.dateOfBirth||""),n&&(n.value=t.age||""),s&&(s.value=t.country||""),t.avatar&&i&&o&&(i.src=t.avatar,i.style.display="block",o.style.display="none",c&&(c.style.display="inline-flex")),Xa("Profile loaded successfully!","success"),console.log("✅ Profile loaded:",t)}else Xa("No saved profile found","info")}catch(e){console.error("❌ Error loading profile:",e),Xa("Error loading profile","error")}}function H2(){const e=document.getElementById("avatarPreview"),t=document.getElementById("avatarPlaceholder"),r=document.getElementById("removeAvatarBtn"),a=document.getElementById("avatarInput"),n=document.getElementById("headerAvatar"),s=document.getElementById("headerAvatarPlaceholder");e&&t&&(e.style.display="none",e.src="",t.style.display="flex",r&&(r.style.display="none"),a&&(a.value="")),n&&s&&(n.style.display="none",n.src="",s.style.display="flex"),console.log("🗑️ Avatar removed")}function Xa(e,t="info"){const r=document.getElementById("messageToast");r&&(r.textContent=e,r.className=`message-toast ${t}`,r.style.display="block",setTimeout(()=>{r.style.display="none"},3e3))}function V2(){window.showUploadModal=G2,window.closeUploadModal=z2,window.showSection=q2,window.updateProfile=W2,window.loadProfile=zl,window.removeAvatar=H2,window.exportData=X2,window.clearAllData=K2,window.clearShoppingList=Y2,console.log("✅ Global functions setup complete")}function G2(){const e=document.getElementById("uploadModal");e&&(e.style.display="flex",console.log("📤 Upload modal opened"))}function z2(){const e=document.getElementById("uploadModal");e&&(e.style.display="none",console.log("📤 Upload modal closed"))}function q2(e){document.querySelectorAll(".nav-tab").forEach(a=>{a.classList.remove("active")}),document.querySelectorAll(".content-section").forEach(a=>{a.classList.remove("active")});const t=document.getElementById(e);t&&t.classList.add("active");const r=document.querySelector(`[data-section="${e}"]`);r&&r.classList.add("active"),e==="shopping-list"&&window.updateShoppingListDisplay&&window.updateShoppingListDisplay(),console.log(`📍 Switched to section: ${e}`)}function X2(){console.log("💾 Export data")}function K2(){console.log("🗑️ Clear all data")}function Y2(){console.log("🗑️ Clear shopping list")}function J2(){document.addEventListener("click",e=>{const t=e.target;t.classList.contains("modal")&&Z2(t)}),document.addEventListener("keydown",e=>{e.key==="Escape"&&Q2()}),console.log("✅ Modal event listeners setup complete")}function Z2(e){e.style.display="none"}function Q2(){document.querySelectorAll(".modal").forEach(e=>{e.style.display="none"})}function ey(){const e=document.getElementById("avatarPreview"),t=document.getElementById("chooseAvatarBtn"),r=document.getElementById("changeAvatarBtn");t&&(t.style.display="inline-flex"),r&&(r.style.display="none"),e&&e.src&&e.style.display!=="none"&&(t&&(t.style.display="none"),r&&(r.style.display="inline-flex")),console.log("✅ Avatar state initialized")}function ry(){const e=document.getElementById("avatarInput");e&&e.addEventListener("change",ty);const t=document.getElementById("dateOfBirth");t&&t.addEventListener("change",ay),setTimeout(()=>{zl()},1e3),console.log("✅ Profile event listeners setup complete")}function ty(e){var a;const r=(a=e.target.files)==null?void 0:a[0];if(r&&r.type.startsWith("image/")){const n=new FileReader;n.onload=s=>{var l;const i=document.getElementById("avatarPreview"),o=document.getElementById("avatarPlaceholder"),c=document.getElementById("removeAvatarBtn");i&&o&&((l=s.target)!=null&&l.result)&&(i.src=s.target.result,i.style.display="block",o.style.display="none",c&&(c.style.display="block"))},n.readAsDataURL(r)}else Xa("Please select a valid image file","error")}function ay(){const e=document.getElementById("dateOfBirth"),t=document.getElementById("profileAge");if(e&&t&&e.value){const r=new Date(e.value),a=new Date;let n=a.getFullYear()-r.getFullYear();const s=a.getMonth()-r.getMonth();(s<0||s===0&&a.getDate()<r.getDate())&&n--,t.value=n.toString()}}document.addEventListener("DOMContentLoaded",()=>{console.log("📱 DOM loaded, starting NutriValor..."),j2()});
//# sourceMappingURL=index-YDVPmHnt.js.map
